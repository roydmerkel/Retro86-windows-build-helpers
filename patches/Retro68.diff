diff --git a/ConvertDiskImage/ConvertDiskImage.cc b/ConvertDiskImage/ConvertDiskImage.cc
index c48cff2bfb..57e358833d 100644
--- a/ConvertDiskImage/ConvertDiskImage.cc
+++ b/ConvertDiskImage/ConvertDiskImage.cc
@@ -65,8 +65,8 @@ int main(int argc, char* argv[])
         return 1;
     }
 
-    std::istringstream bcem(file.resources.resources[ResRef("bcem",128)].getData());
-    std::istringstream ndif(file.data);
+    std::istringstream bcem(file.resources.resources[ResRef("bcem",128)].getData(), std::ios::in | std::ios::binary);
+    std::istringstream ndif(file.data, std::ios::in | std::ios::binary);
     std::ofstream output(argv[2], std::ios::binary | std::ios::trunc);
 
     word(bcem);
diff --git a/ConvertObj/ConvertObj.cc b/ConvertObj/ConvertObj.cc
index 11ce034239..7493a27bc8 100644
--- a/ConvertObj/ConvertObj.cc
+++ b/ConvertObj/ConvertObj.cc
@@ -11,6 +11,7 @@
 #include <ctype.h>
 #include <sstream>
 #include <memory>
+#include <ios>
 
 using std::string;
 using std::vector;
@@ -304,7 +305,7 @@ int main(int argc, char* argv[])
         std::cerr << "Usage: ConvertObj mpw.o > retro68.s\n";
         return 1;
     }
-    std::ifstream in(argv[1]);
+    std::ifstream in(argv[1], std::ios::in | std::ios::binary);
     if(!in)
     {
         std::cerr << "Could not read input file \"" << argv[1] << "\"\n";
diff --git a/Elf2Mac/CMakeLists.txt b/Elf2Mac/CMakeLists.txt
index 592996d0da..c6d2cf1b9a 100644
--- a/Elf2Mac/CMakeLists.txt
+++ b/Elf2Mac/CMakeLists.txt
@@ -23,7 +23,8 @@ add_executable(Elf2Mac
     Symbol.h Symbol.cc
     Symtab.h Symtab.cc
     Section.h Section.cc
-    Object.h Object.cc)
+    Object.h Object.cc
+    err.h err.c)
 target_link_libraries(Elf2Mac ResourceFiles ELF)
 
 target_include_directories(Elf2Mac PRIVATE ${CMAKE_INSTALL_PREFIX}/include)
diff --git a/Elf2Mac/Elf2Mac.cc b/Elf2Mac/Elf2Mac.cc
index 76b81a76a9..6faff04b98 100644
--- a/Elf2Mac/Elf2Mac.cc
+++ b/Elf2Mac/Elf2Mac.cc
@@ -22,21 +22,26 @@
 
 #include <gelf.h>
 
-#include <err.h>
+//#include <err.h>
+#include "err.h"
 
 #include <string>
 #include <vector>
 #include <fstream>
 #include <iostream>
+#include <ios>
 
 #include <unistd.h>
 #include <sys/types.h>
-#include <sys/wait.h>
+//#include <sys/wait.h>
+#include "wait.h"
 
 #include <boost/algorithm/string/predicate.hpp>
 
 #include "Object.h"
 
+#include <windows.h>
+
 using std::string;
 using std::vector;
 using std::ofstream;
@@ -51,45 +56,31 @@ void RealLD(vector<string> args)
         argv.push_back(s.c_str());
     argv.push_back(NULL);
 
-    pid_t pid = fork();
-    if(pid < 0)
-    {
-        perror("unable to fork");
-        exit(-1);
-    }
-    else if(pid == 0)
+    errno = 0;
+    int status = _spawnvp(_P_WAIT, argv[0], const_cast<char* const *> (argv.data()));
+    if(status == -1)
     {
-        execvp(argv[0], const_cast<char* const *> (argv.data()));
-        perror("exec failed");
-        exit(-1);
-    }
-    else
-    {
-        int wstatus;
-        int result = 0;
-        do
-        {
-            result = waitpid(pid, &wstatus, 0);
-        } while(result == -1 && errno == EINTR);
-        if(!WIFEXITED(wstatus))
+        if(errno == ENOENT)
         {
-            errx(EXIT_FAILURE, "ld process did not exit properly");
+            fprintf(stderr, "spawn failed: %s: %s\n", strerror(errno), argv[0]);
         }
-        else
+        else 
         {
-            int exitcode = WEXITSTATUS(wstatus);
-            if(exitcode)
-                exit(exitcode);
+            perror("spawn failed");
         }
+        exit(-1);
+    }
+    else if (status != 0)
+    {
+        exit(status);
     }
-
 }
 
 int main(int argc, char *argv[])
 {
     vector<string> args;
     std::copy(argv + 1, argv+argc, std::back_inserter(args));
-    realLdPath = string(argv[0]) + ".real";
+    realLdPath = string(argv[0]) + ".real.exe";
 
     if (char *path = getenv("RETRO68_REAL_LD"); path && path[0])
         realLdPath = path;
@@ -178,13 +169,32 @@ int main(int argc, char *argv[])
 
     if(elf2mac)
     {
-        char tmpfile[] = "/tmp/ldscriptXXXXXX";
-        int fd = mkstemp(tmpfile);
-        if(fd < 0)
-            err(EXIT_FAILURE, "can't create temp file");
+        //char tmpfile[] = "/tmp/ldscriptXXXXXX";
+        char tmpfile[MAX_PATH + 1];
+        char tmpfolder[MAX_PATH + 1];
+        if(!GetTempPathA(sizeof tmpfolder / sizeof (char), tmpfolder))
+        {
+                err(EXIT_FAILURE, "can't create temp file");
+        }
 
+        if(strlen(tmpfolder) + strlen("\\ldscriptXXXXXXXXXXXXXX") >= MAX_PATH + 1)
         {
-            ofstream out(tmpfile);
+                err(EXIT_FAILURE, "can't create temp file");
+        }
+
+	if(!GetTempFileNameA(tmpfolder, "ldscript", 0, tmpfile))
+	{
+                err(EXIT_FAILURE, "can't create temp file");
+	}
+
+        //int fd = mkstemp(tmpfile);
+        //if(fd < 0)
+        {
+            ofstream out(tmpfile, std::ios::out | std::ios::binary);
+            if( !out.is_open() )
+            {
+                err(EXIT_FAILURE, "couldn't open temporary file");
+            }
             if(segments)
             {
                 segmentMap.CreateLdScript(out, entryPoint, stripMacsbug);
@@ -193,6 +203,8 @@ int main(int argc, char *argv[])
             {
                 CreateFlatLdScript(out, entryPoint, stripMacsbug);
             }
+	    out.flush();
+	    out.close();
         }
  
         args2.push_back("--no-warn-rwx-segments");
diff --git a/Elf2Mac/Object.cc b/Elf2Mac/Object.cc
index 197d23aa03..3d00fb535b 100644
--- a/Elf2Mac/Object.cc
+++ b/Elf2Mac/Object.cc
@@ -24,15 +24,18 @@
 #include "SegmentMap.h"
 #include "Reloc.h"
 
-#include <err.h>
+//#include <err.h>
+#include "err.h"
 #include <fcntl.h>
 #include <sys/types.h>
-#include <sys/wait.h>
+//#include <sys/wait.h>
+#include "wait.h"
 #include <fstream>
 #include <iomanip>
 #include <iostream>
 #include <sstream>
 #include <string>
+#include <ios>
 
 #include <boost/algorithm/string/predicate.hpp>
 
@@ -56,7 +59,7 @@ Object::Object(string input)
     if(elf_version ( EV_CURRENT ) == EV_NONE)
         errx(EXIT_FAILURE , "ELF library initialization failed: %s", elf_errmsg( -1));
 
-    int fd = open(input.c_str(), O_RDONLY, 0);
+    int fd = open(input.c_str(), O_RDONLY | _O_BINARY, 0);
     elf = elf_begin(fd, ELF_C_READ, NULL);
 
     elf_getshdrstrndx(elf, &sectionHeaderStringTableIdx);
@@ -156,7 +159,7 @@ void Object::FlatCode(std::ostream& out)
 
 void Object::FlatCode(string fn)
 {
-    ofstream out(fn);
+    ofstream out(fn, std::ios::out | std::ios::binary);
     FlatCode(out);
 }
 
diff --git a/Elf2Mac/SegmentMap.cc b/Elf2Mac/SegmentMap.cc
index 7c102ec2bc..d6846fd4fc 100644
--- a/Elf2Mac/SegmentMap.cc
+++ b/Elf2Mac/SegmentMap.cc
@@ -22,6 +22,7 @@
 #include <cctype>
 #include <algorithm>
 #include <iostream>
+#include <ios>
 
 SegmentInfo::SegmentInfo()
 {
@@ -71,7 +72,7 @@ SegmentMap::SegmentMap(std::string filename)
                           "*/libc.a:*"
                           );
 
-    std::ifstream in(filename);
+    std::ifstream in(filename, std::ios::in | std::ios::binary);
     int id = -1;
     int nextID = 3;
     while(in)
diff --git a/LaunchAPPL/Client/CMakeLists.txt b/LaunchAPPL/Client/CMakeLists.txt
index 5668d7339f..31d5ed3550 100644
--- a/LaunchAPPL/Client/CMakeLists.txt
+++ b/LaunchAPPL/Client/CMakeLists.txt
@@ -10,6 +10,8 @@ set(LAUNCHMETHODS
     Serial.h Serial.cc
     TCP.h TCP.cc
     SharedFile.h SharedFile.cc
+    env.h env.c
+    pspawn.c pspawn.h tpspawn.c wpspawn.c strFuncs.c errFuncs.c
 )
 
 if(APPLE)
@@ -40,4 +42,8 @@ if(APPLE)
     target_link_libraries(LaunchAPPL ${APPLICATIONSERVICES_FW})    
 endif()
 
+if(WIN32)
+    target_link_libraries(LaunchAPPL wsock32 ws2_32)
+endif()
+
 install(TARGETS LaunchAPPL RUNTIME DESTINATION bin)
diff --git a/LaunchAPPL/Client/Executor.cc b/LaunchAPPL/Client/Executor.cc
index f14f0b4a50..9a53202afb 100644
--- a/LaunchAPPL/Client/Executor.cc
+++ b/LaunchAPPL/Client/Executor.cc
@@ -1,6 +1,7 @@
 #include "Executor.h"
 #include "Launcher.h"
 #include "Utilities.h"
+#include "env.h"
 
 namespace po = boost::program_options;
 
diff --git a/LaunchAPPL/Client/LaunchAPPL.cc b/LaunchAPPL/Client/LaunchAPPL.cc
index e1dc81ea80..6df01081c2 100644
--- a/LaunchAPPL/Client/LaunchAPPL.cc
+++ b/LaunchAPPL/Client/LaunchAPPL.cc
@@ -2,6 +2,7 @@
 #include <boost/filesystem.hpp>
 #include <boost/filesystem/fstream.hpp>
 #include <iostream>
+#include <ios>
 #include <vector>
 #include <string>
 
@@ -65,7 +66,7 @@ static void usage()
     for(string str : configFiles)
     {
         std::cerr << "\t" << str;
-        if(!std::ifstream(str))
+        if(!std::ifstream(str, std::ios::in | std::ios::binary))
             std::cerr << " (not found)";
         std::cerr << std::endl;
     }
@@ -173,7 +174,7 @@ int main(int argc, char *argv[])
     {
         try
         {
-            std::ifstream cfg(configFileName);
+            std::ifstream cfg(configFileName, std::ios::in | std::ios::binary);
             if(cfg)
             {
                 auto parsed = po::parse_config_file<char>(cfg,configdesc,false);
diff --git a/LaunchAPPL/Client/Launcher.cc b/LaunchAPPL/Client/Launcher.cc
index 963e484114..98eb514623 100644
--- a/LaunchAPPL/Client/Launcher.cc
+++ b/LaunchAPPL/Client/Launcher.cc
@@ -2,6 +2,7 @@
 #include <boost/filesystem/fstream.hpp>
 #include <iostream>
 #include <sstream>
+#include <ios>
 
 
 namespace fs = boost::filesystem;
@@ -32,7 +33,7 @@ Launcher::Launcher(boost::program_options::variables_map &options)
     appPath = tempDir / "Application";
     outPath = tempDir / "out";
 
-    fs::ofstream out(outPath);
+    fs::ofstream out(outPath, std::ios::out | std::ios::binary);
 }
 
 Launcher::Launcher(boost::program_options::variables_map &options, ResourceFile::Format f)
@@ -43,7 +44,7 @@ Launcher::Launcher(boost::program_options::variables_map &options, ResourceFile:
 
 void Launcher::DumpOutput()
 {
-    fs::ifstream in(outPath);
+    fs::ifstream in(outPath, std::ios::in | std::ios::binary);
     std::cout << in.rdbuf();
 }
 
diff --git a/LaunchAPPL/Client/MiniVMac.cc b/LaunchAPPL/Client/MiniVMac.cc
index 3426f33d88..09f4d6e827 100644
--- a/LaunchAPPL/Client/MiniVMac.cc
+++ b/LaunchAPPL/Client/MiniVMac.cc
@@ -1,3 +1,8 @@
+extern "C" {
+unsigned short __declspec(dllimport) htons(unsigned short hostshort);
+unsigned long __declspec(dllimport) htonl(unsigned long hostlong);
+}
+
 #include "MiniVMac.h"
 #include "Launcher.h"
 #include "Utilities.h"
@@ -6,7 +11,7 @@
 
 extern "C" {
 #include "hfs.h"
-#include <arpa/inet.h>
+//#include <arpa/inet.h>
 #define HAVE_MKTIME
 #ifdef HAVE_MKTIME
 #include <time.h>
@@ -16,6 +21,7 @@ extern "C" {
 #include <iostream>
 #include <fstream>
 #include <boost/filesystem/fstream.hpp>
+#include <ios>
 
 
 #ifdef __APPLE__
@@ -194,7 +200,7 @@ static void copyDirectoryRecursively(const fs::path& sourceDir, const fs::path&
 
 fs::path MiniVMacLauncher::ConvertImage(const fs::path& path)
 {
-    fs::ifstream in(path);
+    fs::ifstream in(path, std::ios::in | std::ios::binary);
     
     in.seekg(0x40);
     uint32_t diskCopyLength = longword(in);
@@ -216,7 +222,7 @@ fs::path MiniVMacLauncher::ConvertImage(const fs::path& path)
     {
         auto outPath = tempDir / fs::unique_path();
         
-        fs::ofstream out(outPath);
+        fs::ofstream out(outPath, std::ios::out | std::ios::binary);
 
         in.seekg(0x54);
 
@@ -257,7 +263,7 @@ MiniVMacLauncher::MiniVMacLauncher(po::variables_map &options)
     systemImage = ConvertImage(systemImage);
 
     std::vector<unsigned char> bootblock1(1024);
-    fs::ifstream(systemImage).read((char*) bootblock1.data(), 1024);
+    fs::ifstream(systemImage, std::ios::in | std::ios::binary).read((char*) bootblock1.data(), 1024);
 
     if(bootblock1[0] != 'L' || bootblock1[1] != 'K' || bootblock1[0xA] > 15)
         throw std::runtime_error("Not a bootable Mac disk image: " + systemImage.string());
@@ -514,7 +520,7 @@ void MiniVMacLauncher::ReadSystemResources(const std::string& systemFileName)
     hfs_setfork(system, 1);
     hfs_read(system, buffer.data(), fileent.u.file.rsize);
     hfs_close(system);
-    std::istringstream systemResStream(std::string((char*)buffer.data(), buffer.size()));
+    std::istringstream systemResStream(std::string((char*)buffer.data(), buffer.size()), std::ios::in | std::ios::binary);
     systemRes = std::make_unique<Resources>(systemResStream);
 }
 
diff --git a/LaunchAPPL/Client/SSH.cc b/LaunchAPPL/Client/SSH.cc
index f29ef858ad..837482826b 100644
--- a/LaunchAPPL/Client/SSH.cc
+++ b/LaunchAPPL/Client/SSH.cc
@@ -5,9 +5,14 @@
 #include <iostream>
 #include <unistd.h>
 #include <sys/types.h>
-#include <sys/wait.h>
+//#include <sys/wait.h>
+#include "wait.h"
 #include <signal.h>
 #include <boost/lexical_cast.hpp>
+#include "pspawn.h"
+#include <windows.h>
+#include <io.h>
+#include <fcntl.h>
 
 namespace po = boost::program_options;
 using std::string;
@@ -66,24 +71,75 @@ bool SSHLauncher::Go(int timeout)
         argv.push_back(s.c_str());
     argv.push_back(NULL);
 
-    int fd[2];
-    pipe(fd);
-    const int READ_END = 0;
-    const int WRITE_END = 1;
-
-    pid_t pid = fork();
-    if(pid < 0)
+    //int fd[2];
+    //pipe(fd);
+    //const int READ_END = 0;
+    //const int WRITE_END = 1;
+    HANDLE pipestdin = NULL;
+    HANDLE pipestdout = NULL;
+    HANDLE pipestderr = NULL;
+    int hpipestdin = -1;
+    int hpipestdout = -1;
+    int hpipestderr = -1;
+
+    //pid_t pid = fork();
+    //if(pid < 0)
+    HANDLE procHandle = pspawnvp(&pipestdin, &pipestdout, &pipestderr, argv[0], const_cast<char* const *> (argv.data()));
+    if(procHandle == INVALID_HANDLE_VALUE || procHandle == NULL)
     {
-        perror("unable to fork");
-        return 1;
+        //perror("unable to fork");
+        //return 1;
+        perror("exec failed");
+        std::cerr << "Tried to execute: " << program;
+        for(auto a : args)
+            std::cerr << " " << a;
+        std::cerr << std::endl;
+        _exit(1);
     }
-    else if(pid == 0)
+    //else if(pid == 0)
+    else if(!pipestdin)
     {
-        dup2(fd[READ_END], STDIN_FILENO);
-        close(fd[WRITE_END]);
-        close(fd[READ_END]);
+        //dup2(fd[READ_END], STDIN_FILENO);
+        //close(fd[WRITE_END]);
+        //close(fd[READ_END]);
 
-        execvp(argv[0], const_cast<char* const *> (argv.data()));
+        //execvp(argv[0], const_cast<char* const *> (argv.data()));
+        perror("exec failed");
+        std::cerr << "Tried to execute: " << program;
+        for(auto a : args)
+            std::cerr << " " << a;
+        std::cerr << std::endl;
+        _exit(1);
+    }
+    else if((hpipestdin = _open_osfhandle((intptr_t)pipestdin, _O_WRONLY | _O_WTEXT)) < 0)
+    {
+        CloseHandle(pipestdin);
+        CloseHandle(pipestdout);
+        CloseHandle(pipestderr);
+        perror("exec failed");
+        std::cerr << "Tried to execute: " << program;
+        for(auto a : args)
+            std::cerr << " " << a;
+        std::cerr << std::endl;
+        _exit(1);
+    }
+    else if((hpipestdout = _open_osfhandle((intptr_t)pipestdout, _O_RDONLY | _O_WTEXT)) < 0)
+    {
+        CloseHandle(pipestdout);
+        CloseHandle(pipestderr);
+	close(hpipestdin);
+        perror("exec failed");
+        std::cerr << "Tried to execute: " << program;
+        for(auto a : args)
+            std::cerr << " " << a;
+        std::cerr << std::endl;
+        _exit(1);
+    }
+    else if((hpipestderr = _open_osfhandle((intptr_t)pipestderr, _O_RDONLY | _O_WTEXT)) < 0)
+    {
+        CloseHandle(pipestderr);
+	close(hpipestdin);
+	close(hpipestdout);
         perror("exec failed");
         std::cerr << "Tried to execute: " << program;
         for(auto a : args)
@@ -93,29 +149,37 @@ bool SSHLauncher::Go(int timeout)
     }
     else
     {
-        close(fd[READ_END]);
+        //close(fd[READ_END]);
 
         std::ostringstream tmp;
         app.write(tmp, ResourceFile::Format::macbin);
         const std::string data = tmp.str();
 
-        write(fd[WRITE_END], data.data(), data.size());
-        close(fd[WRITE_END]);
+        //write(fd[WRITE_END], data.data(), data.size());
+        //close(fd[WRITE_END]);
+	write(hpipestdin, data.data(), data.size());
 
-        int wstatus;
-        int result = 0;
-        do
-        {
-            result = waitpid(pid, &wstatus, 0);
-        } while(result == -1 && errno == EINTR);
+        //int wstatus;
+        //int result = 0;
+        //do
+        //{
+        //    result = waitpid(pid, &wstatus, 0);
+        //} while(result == -1 && errno == EINTR);
+	int status = WaitForSingleObject(procHandle, INFINITE);
+
+	close(hpipestdin);
+	close(hpipestdout);
+	close(hpipestderr);
 
-        if(!WIFEXITED(wstatus))
+        //if(!WIFEXITED(wstatus))
+	if(status == WAIT_TIMEOUT || status == WAIT_FAILED)
         {
             return false;
         }
         else
         {
             //int exitcode = WEXITSTATUS(wstatus);
+	    //int exitcode = status;
             return true;
         }
     }
diff --git a/LaunchAPPL/Client/Serial.cc b/LaunchAPPL/Client/Serial.cc
index f37652af78..d6820790f9 100644
--- a/LaunchAPPL/Client/Serial.cc
+++ b/LaunchAPPL/Client/Serial.cc
@@ -4,23 +4,51 @@
 #include "Stream.h"
 #include "ReliableStream.h"
 #include "ServerProtocol.h"
-#include <termios.h>
+//#include <termios.h>
 #include <unistd.h>
 #include <fcntl.h>
-#include <arpa/inet.h>
-#include <poll.h>
+//#include <arpa/inet.h>
+//#include <poll.h>
+#include <windows.h>
+#include <stdexcept>
 #include <chrono>
 #include <iostream>
+#include <queue>
 
 namespace po = boost::program_options;
 using namespace std::literals::chrono_literals;
 
+void InvalidateHandle(HANDLE& hHandle )
+{
+    hHandle = INVALID_HANDLE_VALUE;
+}
+
+#define SERIAL_STREAM_BUFFER_SIZE 4096
+static DWORD WINAPI EventThreadProcInit(LPVOID lpParameter);
 class SerialStream : public WaitableStream
 {
-    static const long kReadBufferSize = 4096;
-    uint8_t readBuffer[kReadBufferSize];
+    //static const long kReadBufferSize = 4096;
+    //uint8_t readBuffer[kReadBufferSize];
+    static const long kReadBufferSize;
+    uint8_t readBuffer[SERIAL_STREAM_BUFFER_SIZE];
+    friend DWORD WINAPI EventThreadProcInit(LPVOID lpParameter);
+private:
+    unsigned EventThreadProc();
+    CRITICAL_SECTION readSection;
+    BOOL readSectionInitialized;
+    CRITICAL_SECTION hDataRxSection;
+    BOOL hDataRxInitialized;
+    HANDLE eventThread;
+    DWORD threadId;
+    HANDLE hThreadTerm;
+    HANDLE hThreadStarted;
+    HANDLE hDataRx;
+    HANDLE hDataTx;
+    BOOL isConnected;
+    std::queue<uint8_t> readData;
 public:
-    int fd;
+    //int fd;
+    HANDLE h;
     int baud;
 
     virtual void write(const void* p, size_t n) override;
@@ -31,6 +59,8 @@ public:
     ~SerialStream();
 };
 
+const long SerialStream::kReadBufferSize = SERIAL_STREAM_BUFFER_SIZE;
+
 class SerialLauncher : public StreamBasedLauncher
 {
     SerialStream stream;
@@ -39,21 +69,181 @@ public:
     SerialLauncher(po::variables_map& options);
 };
 
+static DWORD WINAPI EventThreadProcInit(LPVOID lpParameter)
+{
+    class SerialStream FAR * thisFunc = (class SerialStream FAR *)lpParameter;
+    return thisFunc->EventThreadProc();
+}
+
+unsigned SerialStream::EventThreadProc()
+{
+    BOOL cont = TRUE;
+    DWORD eventMask = 0;
+
+    OVERLAPPED ov;
+    memset(&ov, 0, sizeof ov);
+    ov.hEvent = CreateEvent(NULL, TRUE, FALSE, NULL);
+    HANDLE handles[2];
+    handles[0] = this->hThreadTerm;
+    handles[1] = ov.hEvent;
+
+
+    DWORD wait;
+    SetEvent(this->hThreadStarted);
+
+    while(cont)
+    {
+        BOOL event = WaitCommEvent(h, &eventMask, &ov);
+
+        if(!event)
+        {
+            if(GetLastError() != ERROR_IO_PENDING)
+            {
+                fprintf(stderr, "last Error: %lx\n", (unsigned long)GetLastError());
+                throw std::runtime_error("failed to read serial port.\n");
+            }
+        }
+
+        do {
+            wait = WaitForMultipleObjects(2, handles, FALSE, INFINITE);
+
+            switch(wait)
+            {
+                case WAIT_OBJECT_0:
+                    {
+                        fprintf(stderr, "exit thread.\n");
+                        ExitThread(1);
+                    }
+                    break;
+                case WAIT_OBJECT_0 + 1:
+                    {
+                        DWORD mask;
+
+                        if(GetCommMask(h, &mask))
+                        {
+                            if(mask & EV_TXEMPTY)
+                            {
+                                ResetEvent(ov.hEvent);
+                               SetEvent(this->hDataTx);
+                            }
+                            if(mask & EV_RXCHAR)
+                            {
+                                int accum = 0;
+
+                                EnterCriticalSection(&readSection);
+                                BOOL readFileRet = FALSE;
+                                DWORD bytesRead = 0;
+                                OVERLAPPED ovRead;
+                                memset(&ovRead, '\0', sizeof ovRead);
+                                ovRead.hEvent = CreateEvent(NULL, TRUE, FALSE, NULL);
+                                do
+                                {
+                                    ResetEvent(ovRead.hEvent);
+                                    char szTmp[1];
+                                    memset(szTmp, '\0', sizeof szTmp);
+                                    readFileRet = ReadFile(h, szTmp, sizeof szTmp, &bytesRead, &ovRead);
+                                    if(!readFileRet)
+                                    {
+                                        cont = FALSE;
+                                        break;
+                                    }
+                                    if(bytesRead > 0)
+                                    {
+                                        size_t curByte;
+                                        for(curByte = 0; curByte < bytesRead; curByte++)
+                                        {
+                                            readData.push(((uint8_t*)szTmp)[curByte]);
+                                        }
+                                        accum += bytesRead;
+                                    }
+                                }
+                                while(0);
+                                CloseHandle(ovRead.hEvent);
+
+                                LeaveCriticalSection(&readSection);
+
+                                if(accum > 0)
+                                {
+                                    EnterCriticalSection(&hDataRxSection);
+                                    SetEvent(hDataRx);
+                                    LeaveCriticalSection(&hDataRxSection);
+                                }
+                                ResetEvent(ov.hEvent);
+                            }
+                        }
+                    }
+                    break;
+            }
+        } while(wait == 0x102);
+    }
+    return 0;
+}
 
 SerialStream::SerialStream(po::variables_map &options)
 {
+    readSectionInitialized = FALSE;
+    hDataRxInitialized = FALSE;
+    eventThread = INVALID_HANDLE_VALUE;
+    threadId = 0;
+    hThreadTerm = INVALID_HANDLE_VALUE;
+    hThreadStarted = INVALID_HANDLE_VALUE;
+    hDataRx = INVALID_HANDLE_VALUE;
+    hDataTx = INVALID_HANDLE_VALUE;
+    isConnected = FALSE;
+
     std::string port = options["serial-port"].as<std::string>();
     baud = options["serial-baud"].as<int>();
-    fd = open(port.c_str(), O_RDWR | O_NOCTTY | O_NDELAY );
-    if(fd < 0)
+    //fd = open(port.c_str(), O_RDWR | O_NOCTTY | O_NDELAY | _O_BINARY );
+    h = CreateFile(port.c_str(), GENERIC_READ | GENERIC_WRITE, 0, NULL, OPEN_EXISTING, FILE_FLAG_OVERLAPPED, NULL);
+    //if(fd < 0)
+    //    throw std::runtime_error("Cannot open serial port.\n");
+    if(h == NULL || h == INVALID_HANDLE_VALUE)
+	    throw std::runtime_error("Cannot open serial port.\n");
+
+    DCB dcb;
+    COMMTIMEOUTS cto;
+    if(!GetCommState(h, &dcb))
+    {
         throw std::runtime_error("Cannot open serial port.\n");
+    }
+    if(!GetCommTimeouts(h, &cto))
+    {
+        throw std::runtime_error("Cannot open serial port.\n");
+    }
 
-    struct termios tios;
-    tcgetattr(fd,&tios);
+    //struct termios tios;
+    //tcgetattr(fd,&tios);
 
-    tios.c_cflag = CRTSCTS | CS8 | CLOCAL | CREAD;
+    //tios.c_cflag = CRTSCTS | CS8 | CLOCAL | CREAD;
+    //tios.c_iflag = 0;//IGNPAR | ICRNL;
+    //tios.c_lflag = 0;
+    //tios.c_oflag = 0;
+    dcb.DCBlength = sizeof (DCB);
+    dcb.fBinary = TRUE;
+    dcb.fParity = FALSE;
+    dcb.fOutxCtsFlow = TRUE;
+    dcb.fOutxDsrFlow = FALSE;
+    dcb.fDtrControl = DTR_CONTROL_ENABLE;
+    dcb.fDsrSensitivity = FALSE;
+    dcb.fTXContinueOnXoff = TRUE;
+    dcb.fOutX = FALSE;
+    dcb.fInX = FALSE;
+    dcb.fErrorChar = FALSE;
+    dcb.fNull = FALSE;
+    dcb.fRtsControl = RTS_CONTROL_ENABLE;
+    dcb.fAbortOnError = FALSE;
+    dcb.XonLim = 0;
+    dcb.XoffLim = 0;
+    dcb.ByteSize = 8;
+    dcb.Parity = NOPARITY;
+    dcb.StopBits = ONESTOPBIT;
+    dcb.XonChar = 0; // TODO
+    dcb.XoffChar = 0; // TODO
+    dcb.ErrorChar = 0; // TODO
+    dcb.EofChar = 0; // TODO
+    dcb.EvtChar = 0; // TODO
 
-    switch(baud)
+    /*switch(baud)
     {
         case 9600:      tios.c_cflag |= B9600; break;
         case 19200:     tios.c_cflag |= B19200; break;
@@ -63,39 +253,147 @@ SerialStream::SerialStream(po::variables_map &options)
         case 230400:    tios.c_cflag |= B230400; break;
         default:
             throw std::runtime_error("Unsupported baud rate.\n");
+    }*/
+    switch(baud)
+    {
+        case 9600:      dcb.BaudRate = CBR_9600; break;
+        case 19200:     dcb.BaudRate = CBR_19200; break;
+        case 38400:     dcb.BaudRate = CBR_38400; break;
+        case 57600:     dcb.BaudRate = CBR_57600; break;
+        case 115200:    dcb.BaudRate = CBR_115200; break;
+        case 230400:    dcb.BaudRate = 230400; break;
+        case 256000:    dcb.BaudRate = CBR_256000; break;
+        default:
+            throw std::runtime_error("Unsupported baud rate.\n");
+    }
+
+    //tios.c_iflag = 0;//IGNPAR | ICRNL;
+    //tios.c_lflag = 0;
+    //tios.c_oflag = 0;
+    //tios.c_cc[VTIME]    = 0;   /* inter-character timer unused */
+    //tios.c_cc[VMIN]     = 1;   /* blocking read until 1 chars received */
+    cto.ReadIntervalTimeout = MAXDWORD;
+    cto.ReadTotalTimeoutMultiplier = 0;
+    cto.ReadTotalTimeoutConstant = 0;
+    cto.WriteTotalTimeoutMultiplier = 0;
+    cto.WriteTotalTimeoutConstant = 0;
+    //tcsetattr(fd,TCSANOW,&tios);
+    if(!SetCommState(h, &dcb))
+    {
+        throw std::runtime_error("Cannot open set comm attrs.\n");
+    }
+    if(!SetCommTimeouts(h, &cto))
+    {
+        throw std::runtime_error("Cannot open set comm attrs.\n");
+    }
+    if(!SetCommMask(h, EV_RXCHAR| EV_TXEMPTY))
+    {
+        throw std::runtime_error("Cannot open set comm attrs.\n");
     }
 
-    tios.c_iflag = 0;//IGNPAR | ICRNL;
-    tios.c_lflag = 0;
-    tios.c_oflag = 0;
-    tios.c_cc[VTIME]    = 0;   /* inter-character timer unused */
-    tios.c_cc[VMIN]     = 1;   /* blocking read until 1 chars received */
-    tcsetattr(fd,TCSANOW,&tios);
+    isConnected = FALSE;
+
+    InitializeCriticalSection(&readSection);
+    readSectionInitialized = TRUE;
+
+    InitializeCriticalSection(&hDataRxSection);
+    hDataRxInitialized = TRUE;
+
+    //create thread terminator event...
+    hDataRx = CreateEvent(NULL,FALSE,FALSE,NULL);
+    hDataTx = CreateEvent(NULL,FALSE,TRUE,NULL);
+    hThreadTerm = CreateEvent(NULL,FALSE,FALSE,NULL);
+    hThreadStarted = CreateEvent(NULL,FALSE,FALSE,NULL); 
+
+    eventThread = CreateThread(NULL, 0, EventThreadProcInit, (LPVOID)this, 0, &threadId);
+    DWORD wait = WaitForSingleObject(hThreadStarted, INFINITE);
+
+    if(wait != WAIT_OBJECT_0)
+    {
+        throw std::runtime_error("Cannot create event thread.\n");
+    }
+
+    CloseHandle(hThreadStarted);
+    InvalidateHandle(hThreadStarted);
     usleep(500000);
+
+    isConnected = TRUE;
 }
 SerialStream::~SerialStream()
 {
-    tcdrain(fd);
+    isConnected = FALSE;
+    if(hThreadTerm != INVALID_HANDLE_VALUE)
+    {
+        SetEvent(hThreadTerm);
+        WaitForSingleObject(eventThread,INFINITE);
+        CloseHandle( hThreadTerm);
+        InvalidateHandle(hThreadTerm);
+    }
+    if(hDataRx != INVALID_HANDLE_VALUE)
+    {
+        CloseHandle( hDataRx);
+        InvalidateHandle(hDataRx);
+    }
+    if(hDataTx != INVALID_HANDLE_VALUE)
+    {
+        CloseHandle( hDataTx);
+        InvalidateHandle(hDataTx);
+    }
+    if(eventThread != INVALID_HANDLE_VALUE)
+    {
+        CloseHandle( eventThread);
+        InvalidateHandle(eventThread);
+    }
+    if(readSectionInitialized)
+    {
+        readSectionInitialized = FALSE;
+        DeleteCriticalSection(&readSection);
+    }
+    if(hDataRxInitialized)
+    {
+        hDataRxInitialized = FALSE;
+        DeleteCriticalSection(&hDataRxSection);
+    }
+    //tcdrain(fd);
+    FlushFileBuffers(h);
     usleep(500000);
-    close(fd);
+    //close(fd);
+    CloseHandle(h);
 }
 
 void SerialStream::write(const void* p, size_t n)
 {
     while(n)
     {
-        struct pollfd pfd;
-        pfd.fd = fd;
-        pfd.events = POLLOUT;
-        pfd.revents = 0;
-        poll(&pfd, 1, 1000);
-        if(pfd.revents & POLLOUT)
+        //struct pollfd pfd;
+        //pfd.fd = fd;
+        //pfd.events = POLLOUT;
+        //pfd.revents = 0;
+        //poll(&pfd, 1, 1000);
+        DWORD waitRes = WaitForSingleObject(this->hDataTx, 1000);
+        //if(pfd.revents & POLLOUT)
+        if(waitRes == WAIT_OBJECT_0)
         {
-            ssize_t written = ::write(fd, p, n);
-            if(written > 0)
+            //ssize_t written = ::write(fd, p, n);
+            DWORD dwBytesWritten = 0;
+            OVERLAPPED ov;
+            memset(&ov, '\0', sizeof ov);
+            ov.hEvent = CreateEvent(NULL, TRUE, FALSE, NULL);
+            BOOL writeRes = WriteFile(h, p, n, &dwBytesWritten, &ov);
+            //if(written > 0)
+            if(writeRes || (!writeRes && GetLastError() == ERROR_IO_PENDING))
             {
-                p = (const void*) ( (const char*)p + written );
-                n -= written;
+                //p = (const void*) ( (const char*)p + written );
+                //n -= written;
+                waitRes = WaitForSingleObject(ov.hEvent, INFINITE);
+                if(waitRes == WAIT_OBJECT_0)
+                {
+                    if(GetOverlappedResult(h, &ov, &dwBytesWritten, FALSE))
+                    {
+                        p = (const void*) ( (const char*)p + dwBytesWritten );
+                        n -= dwBytesWritten;
+                    }
+                }
             }
         }
     }
@@ -103,18 +401,45 @@ void SerialStream::write(const void* p, size_t n)
 
 void SerialStream::wait()
 {
-    struct pollfd pfd;
-    pfd.fd = fd;
-    pfd.events = POLLIN;
-    pfd.revents = 0;
-    poll(&pfd, 1, 1000);
-    if(pfd.revents & POLLIN)
-    {
-        ssize_t n = ::read(fd, readBuffer, kReadBufferSize);
-        if(n > 0)
+    //struct pollfd pfd;
+    //pfd.fd = fd;
+    //pfd.events = POLLIN;
+    //pfd.revents = 0;
+    //poll(&pfd, 1, 1000);
+    EnterCriticalSection(&readSection);
+    if(readData.size() > 0)
+    {
+        size_t curByte;
+        for(curByte = 0; readData.size() && curByte + 1 < kReadBufferSize; curByte++)
+        {
+            readBuffer[curByte] = readData.front();
+            readData.pop();
+        }
+        notifyReceive(readBuffer, curByte);
+        LeaveCriticalSection(&readSection);
+        return;
+    }
+    LeaveCriticalSection(&readSection);
+
+    DWORD waitRes = WaitForSingleObject(hDataRx, 1000);
+    if(waitRes == WAIT_OBJECT_0)
+    //if(pfd.revents & POLLIN)
+    {
+        //ssize_t n = ::read(fd, readBuffer, kReadBufferSize);
+        EnterCriticalSection(&hDataRxSection);
+        ResetEvent(hDataRx);
+        EnterCriticalSection(&readSection);
+        size_t curByte;
+	for(curByte = 0; readData.size() && curByte + 1 < kReadBufferSize; curByte++)
+        //if(n > 0)
         {
-            notifyReceive(readBuffer, n);
+            //notifyReceive(readBuffer, n);
+            readBuffer[curByte] = readData.front();
+            readData.pop();
         }
+        notifyReceive(readBuffer, curByte);
+        LeaveCriticalSection(&readSection);
+        LeaveCriticalSection(&hDataRxSection);
     }
 }
 
diff --git a/LaunchAPPL/Client/SharedFile.cc b/LaunchAPPL/Client/SharedFile.cc
index 4f20d18967..aede4c8a48 100644
--- a/LaunchAPPL/Client/SharedFile.cc
+++ b/LaunchAPPL/Client/SharedFile.cc
@@ -7,6 +7,7 @@
 #include <iostream>
 #include <boost/filesystem.hpp>
 #include <boost/filesystem/fstream.hpp>
+#include <windows.h>
 
 namespace fs = boost::filesystem;
 namespace po = boost::program_options;
@@ -57,17 +58,19 @@ void SharedFileStream::write(const void* p, size_t n)
     
     do
     {
-        usleep(100000);
+        //usleep(100000);
+        ::Sleep(100);
     } while(fs::exists(shared_directory / "in_channel"));
 }
 
 void SharedFileStream::wait()
 {
-    usleep(100000);
+    //usleep(100000);
+    ::Sleep(100);
     if(fs::exists(shared_directory / "out_channel"))
     {
         {
-            fs::ifstream in(shared_directory / "out_channel");
+            fs::ifstream in(shared_directory / "out_channel", std::ios::in | std::ios::binary);
 
             while(in.read((char*)readBuffer, sizeof(readBuffer)), in.gcount() > 0)
                 notifyReceive(readBuffer, in.gcount());
diff --git a/LaunchAPPL/Client/StreamBasedLauncher.cc b/LaunchAPPL/Client/StreamBasedLauncher.cc
index 2d1d652315..f451f7a8eb 100644
--- a/LaunchAPPL/Client/StreamBasedLauncher.cc
+++ b/LaunchAPPL/Client/StreamBasedLauncher.cc
@@ -3,7 +3,11 @@
 #include "ServerProtocol.h"
 #include <iostream>
 #include <sstream>
-#include <arpa/inet.h>
+//#include <arpa/inet.h>
+extern "C" {
+    #include <winsock2.h>
+    #include <windows.h>
+}
 
 StreamBasedLauncher::StreamBasedLauncher(boost::program_options::variables_map &options)
     : Launcher(options)
diff --git a/LaunchAPPL/Client/TCP.cc b/LaunchAPPL/Client/TCP.cc
index 26d66ddd39..983d22c363 100644
--- a/LaunchAPPL/Client/TCP.cc
+++ b/LaunchAPPL/Client/TCP.cc
@@ -3,12 +3,16 @@
 #include "Utilities.h"
 #include "Stream.h"
 #include "ServerProtocol.h"
-#include <termios.h>
-#include <arpa/inet.h>
+//#include <termios.h>
+//#include <arpa/inet.h>
+extern "C" {
+    #include <winsock2.h>
+    #include <windows.h>
+}
 #include <chrono>
 #include <iostream>
 #include <sys/types.h>
-#include <sys/socket.h>
+//#include <sys/socket.h>
 #include <unistd.h>
 
 namespace po = boost::program_options;
@@ -20,7 +24,8 @@ class TCPStream : public WaitableStream
     static const long kReadBufferSize = 4096;
     uint8_t readBuffer[kReadBufferSize];
 public:
-    int fd;
+    //int fd;
+    SOCKET fd;
 
     virtual void write(const void* p, size_t n) override;
 
@@ -47,7 +52,8 @@ TCPStream::TCPStream(po::variables_map &options)
     addr.sin_port = htons( 1984 );
  
     //Connect to remote server
-    int result = connect(fd , (struct sockaddr *)&addr , sizeof(addr));
+    //int result = connect(fd , (struct sockaddr *)&addr , sizeof(addr));
+    int result = connect(fd , (struct sockaddr FAR *)&addr , sizeof(addr));
     if(result < 0)
         perror("connect");
 }
@@ -55,7 +61,8 @@ TCPStream::~TCPStream()
 {
     close(fd);
     // a little hack: delay 0.1 seconds so that LaunchAPPLServer has time to reopen the port
-    usleep(100000);
+    //usleep(100000);
+    Sleep(100);
 }
 
 void TCPStream::write(const void* p, size_t n)
diff --git a/LaunchAPPL/Client/Utilities.cc b/LaunchAPPL/Client/Utilities.cc
index 10a25184eb..aa6584d1d0 100644
--- a/LaunchAPPL/Client/Utilities.cc
+++ b/LaunchAPPL/Client/Utilities.cc
@@ -2,10 +2,12 @@
 
 #include <unistd.h>
 #include <sys/types.h>
-#include <sys/wait.h>
+//#include <sys/wait.h>
+#include "wait.h"
 #include <signal.h>
 #include <boost/filesystem.hpp>
 #include <iostream>
+#include <windows.h>
 
 namespace fs = boost::filesystem;
 using std::string;
@@ -19,85 +21,117 @@ int ChildProcess(string program, vector<string> args, int timeout)
         argv.push_back(s.c_str());
     argv.push_back(NULL);
 
-    pid_t pid = fork();
-    if(pid < 0)
+    //pid_t pid = fork();
+    //if(pid < 0)
+    HANDLE worker_pid = (HANDLE)_spawnvp(_P_NOWAIT, argv[0], const_cast<char* const *> (argv.data()));
+    if(worker_pid == INVALID_HANDLE_VALUE || worker_pid == NULL)
     {
-        perror("unable to fork");
-        return 1;
+        //perror("unable to fork");
+        //return 1;
+        perror("exec failed");
+        std::cerr << "Tried to execute: " << program;
+        for(auto a : args)
+            std::cerr << " " << a;
+        std::cerr << std::endl;
+        _exit(1);
     }
-    else if(pid == 0)
+    //else if(pid == 0)
+    //{
+    //    pid_t worker_pid = timeout ? fork() : 0;
+    //    if(worker_pid < 0)
+    //    {
+    //        perror("unable to fork");
+    //        _exit(1);
+    //    }
+    //    if(worker_pid == 0)
+    //    {
+    //        execvp(argv[0], const_cast<char* const *> (argv.data()));
+    //        perror("exec failed");
+    //        std::cerr << "Tried to execute: " << program;
+    //        for(auto a : args)
+    //            std::cerr << " " << a;
+    //        std::cerr << std::endl;
+    //        _exit(1);
+    //    }
+    //
+    //    pid_t timeout_pid = fork();
+    //    if(timeout_pid < 0)
+    //    {
+    //        perror("unable to fork");
+    //        _exit(1);
+    //    }
+    //    if(timeout_pid == 0)
+    //    {
+    //        sleep(timeout);
+    //        _exit(0);
+    //    }
+    //    int wstatus;
+    //    pid_t exited_pid = wait(&wstatus);
+    //    if(exited_pid == worker_pid)
+    //    {
+    //        kill(timeout_pid, SIGKILL);
+    //        wait(NULL);
+    //        if(!WIFEXITED(wstatus))
+    //        {
+    //            return 1;
+    //        }
+    //        else
+    //        {
+    //            int exitcode = WEXITSTATUS(wstatus);
+    //            _exit(exitcode);
+    //        }
+    //    }
+    //    else
+    //    {
+    //        kill(worker_pid, SIGKILL);
+    //        wait(NULL);
+    //        _exit(1);
+    //    }
+    //}
+    //else
+    //{
+    //    int wstatus;
+    //    int result = 0;
+    //    do
+    //    {
+    //        result = waitpid(pid, &wstatus, 0);
+    //    } while(result == -1 && errno == EINTR);
+    //
+    //    if(!WIFEXITED(wstatus))
+    //    {
+    //        return 1;
+    //    }
+    //    else
+    //    {
+    //        int exitcode = WEXITSTATUS(wstatus);
+    //        return exitcode;
+    //    }
+    //}
+    else
     {
-        pid_t worker_pid = timeout ? fork() : 0;
-        if(worker_pid < 0)
-        {
-            perror("unable to fork");
-            _exit(1);
-        }
-        if(worker_pid == 0)
-        {
-            execvp(argv[0], const_cast<char* const *> (argv.data()));
-            perror("exec failed");
-            std::cerr << "Tried to execute: " << program;
-            for(auto a : args)
-                std::cerr << " " << a;
-            std::cerr << std::endl;
-            _exit(1);
-        }
-
-        pid_t timeout_pid = fork();
-        if(timeout_pid < 0)
+        DWORD waitResult = 0;
+        if(timeout >= 0)
         {
-            perror("unable to fork");
-            _exit(1);
-        }
-        if(timeout_pid == 0)
-        {
-            sleep(timeout);
-            _exit(0);
-        }
-        int wstatus;
-        pid_t exited_pid = wait(&wstatus);
-        if(exited_pid == worker_pid)
-        {
-            kill(timeout_pid, SIGKILL);
-            wait(NULL);
-            if(!WIFEXITED(wstatus))
-            {
-                return 1;
-            }
-            else
-            {
-                int exitcode = WEXITSTATUS(wstatus);
-                _exit(exitcode);
-            }
+            waitResult = WaitForSingleObject(worker_pid, timeout * 1000);
         }
         else
         {
-            kill(worker_pid, SIGKILL);
-            wait(NULL);
-            _exit(1);
+            waitResult = WaitForSingleObject(worker_pid, INFINITE);
         }
-    }
-    else
-    {
-        int wstatus;
-        int result = 0;
-        do
-        {
-            result = waitpid(pid, &wstatus, 0);
-        } while(result == -1 && errno == EINTR);
-
-        if(!WIFEXITED(wstatus))
+        if(waitResult == WAIT_FAILED)
         {
             return 1;
         }
+        else if(waitResult == WAIT_TIMEOUT)
+        {
+            TerminateProcess(worker_pid, 1);
+	    return 1;
+        }
         else
         {
-            int exitcode = WEXITSTATUS(wstatus);
-            return exitcode;
+            return waitResult;
         }
     }
-
 }
 
 
diff --git a/PEFTools/CMakeLists.txt b/PEFTools/CMakeLists.txt
index 0abf399596..e9f79be65a 100644
--- a/PEFTools/CMakeLists.txt
+++ b/PEFTools/CMakeLists.txt
@@ -1,8 +1,8 @@
 find_package(Boost COMPONENTS filesystem system REQUIRED)
 
-add_executable(MakePEF MakePEF.cc rs6000.h PEF.h)
+add_executable(MakePEF MakePEF.cc rs6000.h PEF.h mman.c mman.h)
 
-add_executable(MakeImport MakeImport.cc PEF.h)
+add_executable(MakeImport MakeImport.cc PEF.h mman.c mman.h)
 target_link_libraries(MakeImport ResourceFiles ${Boost_LIBRARIES})
 target_include_directories(MakeImport PRIVATE ${Boost_INCLUDE_DIR})
 
diff --git a/PEFTools/MakeImport.cc b/PEFTools/MakeImport.cc
index 1996dc402f..cef960cc8f 100755
--- a/PEFTools/MakeImport.cc
+++ b/PEFTools/MakeImport.cc
@@ -8,9 +8,11 @@
 #include <algorithm>
 
 #include <sys/types.h>
-#include <sys/mman.h>
+//#include <sys/mman.h>
+#include "mman.h"
 #include <sys/stat.h>
-#include <sys/wait.h>
+//#include <sys/wait.h>
+#include "wait.h"
 
 #include <fcntl.h>
 #include <unistd.h>
@@ -61,28 +63,33 @@ void RunCommand(const char *command, std::vector<std::string> args)
         ptrs.push_back(s.c_str());
     ptrs.push_back(NULL);
 
-    pid_t pid = fork();
-    if(pid == -1)
+    //pid_t pid = fork();
+    int status = _spawnvp(_P_WAIT, command, const_cast<char *const*>(ptrs.data()));
+    //if(pid == -1)
+    if(status == -1)
     {
-        perror(command);
+        //perror(command);
+        perror("exec");
         exit(1);
     }
 
-    if(pid)
-    {
-        int status = 0;
-        while(waitpid(pid, &status, 0) == -1 && errno == EINTR)
-            ;
-        if(!WIFEXITED(status) || WEXITSTATUS(status) != 0)
-        {
-            std::cerr << command << " failed.\n";
-            exit(1);
-        }
-    }
-    else
+    //if(pid)
+    else if(status != 0)
     {
-        execvp(command, const_cast<char *const*>(ptrs.data()));
-        perror("exec");
+        //int status = 0;
+        //while(waitpid(pid, &status, 0) == -1 && errno == EINTR)
+        //    ;
+        //if(!WIFEXITED(status) || WEXITSTATUS(status) != 0)
+        //{
+        //    std::cerr << command << " failed.\n";
+        //    exit(1);
+        //}
+    //}
+    //else
+    //{
+    //    execvp(command, const_cast<char *const*>(ptrs.data()));
+    //    perror("exec");
+        std::cerr << command << " failed.\n";
         exit(1);
     }
 }
@@ -171,8 +178,8 @@ void MakeImportLibrary(char *pefptr, size_t pefsize, fs::path dest, fs::path tmp
                 stub_o(tmpdir / "__stub.o");
 
     {
-        fs::ofstream expFile(stub_exp);
-        fs::ofstream sFile(stub_s);
+        fs::ofstream expFile(stub_exp, std::ios::out | std::ios::binary);
+        fs::ofstream sFile(stub_s, std::ios::out | std::ios::binary);
         sFile << "\t.toc\n";
         for(uint32_t i=0; i< nSymbols; i++)
         {
@@ -202,10 +209,10 @@ void MakeImportLibrary(char *pefptr, size_t pefsize, fs::path dest, fs::path tmp
         }
         
         //cerr << "Generating: " << name << " -> " << libname << endl;
-        RunCommand("powerpc-apple-macos-as", std::vector<std::string> {
+        RunCommand("powerpc-apple-macos-as.exe", std::vector<std::string> {
                        stub_s.string(), "-o", stub_o.string()
                    });
-        RunCommand("powerpc-apple-macos-ld", std::vector<std::string> {
+        RunCommand("powerpc-apple-macos-ld.exe", std::vector<std::string> {
                        "-shared", "--no-check-sections", "-bexport:" + stub_exp.string(),
                        "-o", dest.string(), stub_o.string()
                    });
@@ -336,7 +343,7 @@ bool MakeImportLibraryMulti(fs::path path, fs::path libname)
             }
         }
 
-        RunCommand("powerpc-apple-macos-ar", arArguments);
+        RunCommand("powerpc-apple-macos-ar.exe", arArguments);
         fs::rename(archiveTmp, libname);
     }
     catch(...)
@@ -358,7 +365,7 @@ int main (int argc, char * const argv[])
         return 1;
     }
     
-    int fd = open(argv[1], O_RDONLY, 0);
+    int fd = open(argv[1], O_RDONLY | _O_BINARY, 0);
     if(fd < 0)
     {
         perror(argv[1]);
diff --git a/PEFTools/MakePEF.cc b/PEFTools/MakePEF.cc
index f2ee393154..4ed12600be 100755
--- a/PEFTools/MakePEF.cc
+++ b/PEFTools/MakePEF.cc
@@ -1,4 +1,5 @@
 #include <iostream>
+#include <ios>
 #include <string>
 #include <map>
 #include <vector>
@@ -6,7 +7,8 @@
 #include <set>
 #include <algorithm>
 #include <string.h>
-#include <alloca.h>
+//#include <alloca.h>
+#include <malloc.h>
 
 #include <assert.h>
 #include <stdint.h>
@@ -278,7 +280,7 @@ public:
 
 void mkpef(const std::string& inFn, const std::string& outFn)
 {
-    std::ifstream in(inFn);
+    std::ifstream in(inFn, std::ios::in | std::ios::binary);
 
     external_filehdr xcoffHeader;
     external_aouthdr aoutHeader;
@@ -516,7 +518,7 @@ void mkpef(const std::string& inFn, const std::string& outFn)
     loaderSectionHeader.shareKind = kPEFGlobalShare;
     loaderSectionHeader.alignment = 2;
     
-    std::ofstream out(outFn);
+    std::ofstream out(outFn, std::ios::out | std::ios::binary);
     if(verboseFlag)
         std::cerr << "Writing Headers..." << std::flush;
 
diff --git a/ResourceFiles/ResourceFile.cc b/ResourceFiles/ResourceFile.cc
index 0b8e2b7b0a..37e45010ed 100644
--- a/ResourceFiles/ResourceFile.cc
+++ b/ResourceFiles/ResourceFile.cc
@@ -146,7 +146,7 @@ bool ResourceFile::write(std::string path, Format f)
 static bool CheckAppleDouble(fs::path path, std::string prefix)
 {
     fs::path adPath = path.parent_path() / (prefix  + path.filename().string());
-    fs::ifstream in(adPath);
+    fs::ifstream in(adPath, std::ios::in | std::ios::binary);
     if(in)
     {
         int magic1 = longword(in);
@@ -203,7 +203,7 @@ bool ResourceFile::assign(std::string pathstring, ResourceFile::Format f)
     }
     if(format == Format::autodetect)
     {
-        fs::ifstream in(path);
+        fs::ifstream in(path, std::ios::in | std::ios::binary);
         if(in)
         {
             int magic1 = longword(in);
@@ -308,7 +308,7 @@ bool ResourceFile::read()
 
     if(isSingleFork(format))
     {
-        fs::ifstream in(path);
+        fs::ifstream in(path, std::ios::in | std::ios::binary);
         return read(in, format);
     }
 
@@ -316,16 +316,16 @@ bool ResourceFile::read()
     {
         case Format::basilisk:
             {
-                fs::ifstream dataIn(path);
+                fs::ifstream dataIn(path, std::ios::in | std::ios::binary);
                 if(!dataIn)
                     return false;
                 data = std::string(std::istreambuf_iterator<char>(dataIn),
                                    std::istreambuf_iterator<char>());
 
-                fs::ifstream rsrcIn(path.parent_path() / ".rsrc" / path.filename());
+                fs::ifstream rsrcIn(path.parent_path() / ".rsrc" / path.filename(), std::ios::in | std::ios::binary);
                 if(rsrcIn)
                     resources = Resources(rsrcIn);
-                fs::ifstream finfIn(path.parent_path() / ".finf" / path.filename());
+                fs::ifstream finfIn(path.parent_path() / ".finf" / path.filename(), std::ios::in | std::ios::binary);
                 if(finfIn)
                 {
                     type = ostype(finfIn);
@@ -336,12 +336,12 @@ bool ResourceFile::read()
 #ifdef __APPLE__
         case Format::real:
             {
-                fs::ifstream dataIn(path);
+                fs::ifstream dataIn(path, std::ios::in | std::ios::binary);
                 if(!dataIn)
                     return false;
                 data = std::string(std::istreambuf_iterator<char>(dataIn),
                                    std::istreambuf_iterator<char>());
-                fs::ifstream rsrcIn(path / "..namedfork" / "rsrc");
+                fs::ifstream rsrcIn(path / "..namedfork" / "rsrc", std::ios::in | std::ios::binary);
                 if(rsrcIn)
                     resources = Resources(rsrcIn);
 
@@ -350,7 +350,7 @@ bool ResourceFile::read()
                         finf, 32, 0, 0);
                 if(n > 0)
                 {
-                    std::istringstream finfIn(std::string(finf, finf+n));
+                    std::istringstream finfIn(std::string(finf, finf+n), std::ios::in | std::ios::binary);
                     type = ostype(finfIn);
                     creator = ostype(finfIn);
                 }
@@ -361,7 +361,7 @@ bool ResourceFile::read()
         case Format::underscore_appledouble:
         case Format::percent_appledouble:
             {
-                fs::ifstream dataIn(path);
+                fs::ifstream dataIn(path, std::ios::in | std::ios::binary);
                 data = std::string(std::istreambuf_iterator<char>(dataIn),
                                    std::istreambuf_iterator<char>());
 
@@ -369,7 +369,7 @@ bool ResourceFile::read()
                                         "._" : "%";
 
                 fs::path adPath = path.parent_path() / (prefix  + path.filename().string());
-                fs::ifstream in(adPath);
+                fs::ifstream in(adPath, std::ios::in | std::ios::binary);
                 if(longword(in) != 0x00051607)
                     return false;
                 if(longword(in) != 0x00020000)
@@ -454,7 +454,7 @@ bool ResourceFile::write()
 
     if(isSingleFork(format))
     {
-        fs::ofstream out(path);
+        fs::ofstream out(path, std::ios::out | std::ios::binary);
         return write(out, format);
     }
 
@@ -465,9 +465,9 @@ bool ResourceFile::write()
                 fs::create_directory(path.parent_path() / ".rsrc");
                 fs::create_directory(path.parent_path() / ".finf");
 
-                fs::ofstream dataOut(path);
-                fs::ofstream rsrcOut(path.parent_path() / ".rsrc" / path.filename());
-                fs::ofstream finfOut(path.parent_path() / ".finf" / path.filename());
+                fs::ofstream dataOut(path, std::ios::out | std::ios::binary);
+                fs::ofstream rsrcOut(path.parent_path() / ".rsrc" / path.filename(), std::ios::out | std::ios::binary);
+                fs::ofstream finfOut(path.parent_path() / ".finf" / path.filename(), std::ios::out | std::ios::binary);
 
                 dataOut << data;
                 resources.writeFork(rsrcOut);
@@ -481,8 +481,8 @@ bool ResourceFile::write()
 #ifdef __APPLE__
         case Format::real:
             {
-                fs::ofstream dataOut(path);
-                fs::ofstream rsrcOut(path / "..namedfork" / "rsrc");
+                fs::ofstream dataOut(path, std::ios::out | std::ios::binary);
+                fs::ofstream rsrcOut(path / "..namedfork" / "rsrc", std::ios::out | std::ios::binary);
                 std::ostringstream finfOut;
 
                 dataOut << data;
@@ -501,7 +501,7 @@ bool ResourceFile::write()
         case Format::underscore_appledouble:
         case Format::percent_appledouble:
             {
-                fs::ofstream dataOut(path);
+                fs::ofstream dataOut(path, std::ios::out | std::ios::binary);
 
                 dataOut << data;
 
@@ -510,7 +510,7 @@ bool ResourceFile::write()
 
                 fs::path adPath = path.parent_path() / (prefix  + path.filename().string());
 
-                fs::ofstream out(adPath);
+                fs::ofstream out(adPath, std::ios::out | std::ios::binary);
 
                 longword(out, 0x00051607);
                 longword(out, 0x00020000);
diff --git a/Rez/CMakeLists.txt b/Rez/CMakeLists.txt
index e34ce8944c..a3ea20e09b 100644
--- a/Rez/CMakeLists.txt
+++ b/Rez/CMakeLists.txt
@@ -15,7 +15,7 @@
 #   You should have received a copy of the GNU General Public License
 #   along with Retro68.  If not, see <http://www.gnu.org/licenses/>.
 
-find_package(Boost COMPONENTS wave filesystem system thread regex program_options)
+find_package(Boost COMPONENTS wave filesystem system thread_win32 regex program_options)
 
 # Look for bison.
     # We need Version 3, and Mac OS X still comes with an outdated version (2.3).
diff --git a/Rez/Expression.cc b/Rez/Expression.cc
index 2167e49d5b..dbd697db1f 100644
--- a/Rez/Expression.cc
+++ b/Rez/Expression.cc
@@ -3,6 +3,7 @@
 #include <cassert>
 #include <iostream>
 #include <fstream>
+#include <ios>
 #include "Diagnostic.h"
 
 int Expression::evaluateInt(ResourceCompiler *ctx)
@@ -188,7 +189,7 @@ int ArrayIndexExpr::evaluateInt(ResourceCompiler *ctx)
 std::string ReadExpr::evaluateString(ResourceCompiler *ctx)
 {
     std::string filename = arg->evaluateString(ctx);
-    std::ifstream instream(filename);
+    std::ifstream instream(filename, std::ios::in | std::ios::binary);
     if(!instream)
     {
         ctx->problem(Diagnostic(Diagnostic::Severity::error, "could not $$read file " + filename, location));
diff --git a/Rez/RezLexer.cc b/Rez/RezLexer.cc
index 2bd6bf8f17..83bdd2660a 100644
--- a/Rez/RezLexer.cc
+++ b/Rez/RezLexer.cc
@@ -4,6 +4,7 @@
 #include <boost/wave/cpplexer/cpp_lex_iterator.hpp>
 #include <boost/wave/token_ids.hpp>
 #include <boost/regex.hpp>
+#include <ios>
 
 #include "RezLexerWaveToken.h"
 #include "RezWorld.h"
@@ -47,7 +48,7 @@ struct load_file_to_string_filtered
             typedef typename IterContextT::iterator_type iterator_type;
 
             // read in the file
-            std::ifstream instream(iter_ctx.filename.c_str());
+            std::ifstream instream(iter_ctx.filename.c_str(), std::ios::in | std::ios::binary);
             if (!instream.is_open()) {
                 BOOST_WAVE_THROW_CTX(iter_ctx.ctx, preprocess_exception,
                     bad_include_file, iter_ctx.filename.c_str(), act_pos);
@@ -92,7 +93,7 @@ struct RezLexer::Priv
 
 static std::string readInitial(RezWorld& world, std::string filename)
 {
-    std::ifstream in(filename);
+    std::ifstream in(filename, std::ios::in | std::ios::binary);
     if(!in.is_open())
     {
         world.problem(Diagnostic(Diagnostic::error,
diff --git a/Rez/Test/UnitTests.cc b/Rez/Test/UnitTests.cc
index b6486c9688..a27b1a3da3 100644
--- a/Rez/Test/UnitTests.cc
+++ b/Rez/Test/UnitTests.cc
@@ -1,5 +1,5 @@
 #define BOOST_TEST_MODULE UnitTests
-#define BOOST_TEST_DYN_LINK
+//#define BOOST_TEST_DYN_LINK
 #define BOOST_TEST_MAIN
 #include <boost/test/unit_test.hpp>
 
diff --git a/binutils/Makefile.in b/binutils/Makefile.in
index cb39e4790d..122c870bfa 100644
--- a/binutils/Makefile.in
+++ b/binutils/Makefile.in
@@ -44064,6 +44064,7 @@ configure-target-libstdc++-v3:
 	echo "Checking multilib configuration for libstdc++-v3..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs $(TARGET_SUBDIR)/libstdc++-v3; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libstdc++-v3/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp $(TARGET_SUBDIR)/libstdc++-v3/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp; \
@@ -44108,6 +44109,7 @@ configure-stage1-target-libstdc++-v3:
 	TFLAGS="$(STAGE1_TFLAGS)"; \
 	echo "Checking multilib configuration for libstdc++-v3..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libstdc++-v3/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp $(TARGET_SUBDIR)/libstdc++-v3/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp; \
@@ -44152,6 +44154,7 @@ configure-stage2-target-libstdc++-v3:
 	TFLAGS="$(STAGE2_TFLAGS)"; \
 	echo "Checking multilib configuration for libstdc++-v3..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libstdc++-v3/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp $(TARGET_SUBDIR)/libstdc++-v3/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp; \
@@ -44197,6 +44200,7 @@ configure-stage3-target-libstdc++-v3:
 	TFLAGS="$(STAGE3_TFLAGS)"; \
 	echo "Checking multilib configuration for libstdc++-v3..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libstdc++-v3/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp $(TARGET_SUBDIR)/libstdc++-v3/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp; \
@@ -44242,6 +44246,7 @@ configure-stage4-target-libstdc++-v3:
 	TFLAGS="$(STAGE4_TFLAGS)"; \
 	echo "Checking multilib configuration for libstdc++-v3..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libstdc++-v3/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp $(TARGET_SUBDIR)/libstdc++-v3/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp; \
@@ -44287,6 +44292,7 @@ configure-stageprofile-target-libstdc++-v3:
 	TFLAGS="$(STAGEprofile_TFLAGS)"; \
 	echo "Checking multilib configuration for libstdc++-v3..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libstdc++-v3/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp $(TARGET_SUBDIR)/libstdc++-v3/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp; \
@@ -44332,6 +44338,7 @@ configure-stagetrain-target-libstdc++-v3:
 	TFLAGS="$(STAGEtrain_TFLAGS)"; \
 	echo "Checking multilib configuration for libstdc++-v3..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libstdc++-v3/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp $(TARGET_SUBDIR)/libstdc++-v3/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp; \
@@ -44377,6 +44384,7 @@ configure-stagefeedback-target-libstdc++-v3:
 	TFLAGS="$(STAGEfeedback_TFLAGS)"; \
 	echo "Checking multilib configuration for libstdc++-v3..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libstdc++-v3/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp $(TARGET_SUBDIR)/libstdc++-v3/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp; \
@@ -44422,6 +44430,7 @@ configure-stageautoprofile-target-libstdc++-v3:
 	TFLAGS="$(STAGEautoprofile_TFLAGS)"; \
 	echo "Checking multilib configuration for libstdc++-v3..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libstdc++-v3/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp $(TARGET_SUBDIR)/libstdc++-v3/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp; \
@@ -44467,6 +44476,7 @@ configure-stageautofeedback-target-libstdc++-v3:
 	TFLAGS="$(STAGEautofeedback_TFLAGS)"; \
 	echo "Checking multilib configuration for libstdc++-v3..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libstdc++-v3/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp $(TARGET_SUBDIR)/libstdc++-v3/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp; \
@@ -45334,6 +45344,7 @@ configure-target-libsanitizer:
 	echo "Checking multilib configuration for libsanitizer..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs $(TARGET_SUBDIR)/libsanitizer; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libsanitizer/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libsanitizer/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libsanitizer/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libsanitizer/multilib.tmp $(TARGET_SUBDIR)/libsanitizer/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libsanitizer/multilib.tmp; \
@@ -45378,6 +45389,7 @@ configure-stage1-target-libsanitizer:
 	TFLAGS="$(STAGE1_TFLAGS)"; \
 	echo "Checking multilib configuration for libsanitizer..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libsanitizer/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libsanitizer/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libsanitizer/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libsanitizer/multilib.tmp $(TARGET_SUBDIR)/libsanitizer/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libsanitizer/multilib.tmp; \
@@ -45422,6 +45434,7 @@ configure-stage2-target-libsanitizer:
 	TFLAGS="$(STAGE2_TFLAGS)"; \
 	echo "Checking multilib configuration for libsanitizer..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libsanitizer/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libsanitizer/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libsanitizer/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libsanitizer/multilib.tmp $(TARGET_SUBDIR)/libsanitizer/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libsanitizer/multilib.tmp; \
@@ -45467,6 +45480,7 @@ configure-stage3-target-libsanitizer:
 	TFLAGS="$(STAGE3_TFLAGS)"; \
 	echo "Checking multilib configuration for libsanitizer..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libsanitizer/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libsanitizer/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libsanitizer/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libsanitizer/multilib.tmp $(TARGET_SUBDIR)/libsanitizer/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libsanitizer/multilib.tmp; \
@@ -45512,6 +45526,7 @@ configure-stage4-target-libsanitizer:
 	TFLAGS="$(STAGE4_TFLAGS)"; \
 	echo "Checking multilib configuration for libsanitizer..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libsanitizer/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libsanitizer/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libsanitizer/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libsanitizer/multilib.tmp $(TARGET_SUBDIR)/libsanitizer/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libsanitizer/multilib.tmp; \
@@ -45557,6 +45572,7 @@ configure-stageprofile-target-libsanitizer:
 	TFLAGS="$(STAGEprofile_TFLAGS)"; \
 	echo "Checking multilib configuration for libsanitizer..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libsanitizer/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libsanitizer/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libsanitizer/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libsanitizer/multilib.tmp $(TARGET_SUBDIR)/libsanitizer/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libsanitizer/multilib.tmp; \
@@ -45602,6 +45618,7 @@ configure-stagetrain-target-libsanitizer:
 	TFLAGS="$(STAGEtrain_TFLAGS)"; \
 	echo "Checking multilib configuration for libsanitizer..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libsanitizer/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libsanitizer/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libsanitizer/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libsanitizer/multilib.tmp $(TARGET_SUBDIR)/libsanitizer/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libsanitizer/multilib.tmp; \
@@ -45647,6 +45664,7 @@ configure-stagefeedback-target-libsanitizer:
 	TFLAGS="$(STAGEfeedback_TFLAGS)"; \
 	echo "Checking multilib configuration for libsanitizer..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libsanitizer/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libsanitizer/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libsanitizer/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libsanitizer/multilib.tmp $(TARGET_SUBDIR)/libsanitizer/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libsanitizer/multilib.tmp; \
@@ -45692,6 +45710,7 @@ configure-stageautoprofile-target-libsanitizer:
 	TFLAGS="$(STAGEautoprofile_TFLAGS)"; \
 	echo "Checking multilib configuration for libsanitizer..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libsanitizer/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libsanitizer/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libsanitizer/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libsanitizer/multilib.tmp $(TARGET_SUBDIR)/libsanitizer/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libsanitizer/multilib.tmp; \
@@ -45737,6 +45756,7 @@ configure-stageautofeedback-target-libsanitizer:
 	TFLAGS="$(STAGEautofeedback_TFLAGS)"; \
 	echo "Checking multilib configuration for libsanitizer..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libsanitizer/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libsanitizer/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libsanitizer/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libsanitizer/multilib.tmp $(TARGET_SUBDIR)/libsanitizer/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libsanitizer/multilib.tmp; \
@@ -46604,6 +46624,7 @@ configure-target-libvtv:
 	echo "Checking multilib configuration for libvtv..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs $(TARGET_SUBDIR)/libvtv; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libvtv/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libvtv/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libvtv/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libvtv/multilib.tmp $(TARGET_SUBDIR)/libvtv/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libvtv/multilib.tmp; \
@@ -46648,6 +46669,7 @@ configure-stage1-target-libvtv:
 	TFLAGS="$(STAGE1_TFLAGS)"; \
 	echo "Checking multilib configuration for libvtv..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libvtv/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libvtv/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libvtv/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libvtv/multilib.tmp $(TARGET_SUBDIR)/libvtv/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libvtv/multilib.tmp; \
@@ -46692,6 +46714,7 @@ configure-stage2-target-libvtv:
 	TFLAGS="$(STAGE2_TFLAGS)"; \
 	echo "Checking multilib configuration for libvtv..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libvtv/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libvtv/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libvtv/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libvtv/multilib.tmp $(TARGET_SUBDIR)/libvtv/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libvtv/multilib.tmp; \
@@ -46737,6 +46760,7 @@ configure-stage3-target-libvtv:
 	TFLAGS="$(STAGE3_TFLAGS)"; \
 	echo "Checking multilib configuration for libvtv..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libvtv/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libvtv/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libvtv/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libvtv/multilib.tmp $(TARGET_SUBDIR)/libvtv/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libvtv/multilib.tmp; \
@@ -46782,6 +46806,7 @@ configure-stage4-target-libvtv:
 	TFLAGS="$(STAGE4_TFLAGS)"; \
 	echo "Checking multilib configuration for libvtv..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libvtv/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libvtv/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libvtv/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libvtv/multilib.tmp $(TARGET_SUBDIR)/libvtv/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libvtv/multilib.tmp; \
@@ -46827,6 +46852,7 @@ configure-stageprofile-target-libvtv:
 	TFLAGS="$(STAGEprofile_TFLAGS)"; \
 	echo "Checking multilib configuration for libvtv..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libvtv/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libvtv/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libvtv/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libvtv/multilib.tmp $(TARGET_SUBDIR)/libvtv/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libvtv/multilib.tmp; \
@@ -46872,6 +46898,7 @@ configure-stagetrain-target-libvtv:
 	TFLAGS="$(STAGEtrain_TFLAGS)"; \
 	echo "Checking multilib configuration for libvtv..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libvtv/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libvtv/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libvtv/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libvtv/multilib.tmp $(TARGET_SUBDIR)/libvtv/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libvtv/multilib.tmp; \
@@ -46917,6 +46944,7 @@ configure-stagefeedback-target-libvtv:
 	TFLAGS="$(STAGEfeedback_TFLAGS)"; \
 	echo "Checking multilib configuration for libvtv..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libvtv/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libvtv/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libvtv/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libvtv/multilib.tmp $(TARGET_SUBDIR)/libvtv/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libvtv/multilib.tmp; \
@@ -46962,6 +46990,7 @@ configure-stageautoprofile-target-libvtv:
 	TFLAGS="$(STAGEautoprofile_TFLAGS)"; \
 	echo "Checking multilib configuration for libvtv..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libvtv/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libvtv/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libvtv/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libvtv/multilib.tmp $(TARGET_SUBDIR)/libvtv/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libvtv/multilib.tmp; \
@@ -47007,6 +47036,7 @@ configure-stageautofeedback-target-libvtv:
 	TFLAGS="$(STAGEautofeedback_TFLAGS)"; \
 	echo "Checking multilib configuration for libvtv..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libvtv/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libvtv/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libvtv/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libvtv/multilib.tmp $(TARGET_SUBDIR)/libvtv/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libvtv/multilib.tmp; \
@@ -47875,6 +47905,7 @@ configure-target-liboffloadmic:
 	echo "Checking multilib configuration for liboffloadmic..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs $(TARGET_SUBDIR)/liboffloadmic; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/liboffloadmic/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/liboffloadmic/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/liboffloadmic/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/liboffloadmic/multilib.tmp $(TARGET_SUBDIR)/liboffloadmic/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/liboffloadmic/multilib.tmp; \
@@ -48360,6 +48391,7 @@ configure-target-libssp:
 	echo "Checking multilib configuration for libssp..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs $(TARGET_SUBDIR)/libssp; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libssp/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libssp/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libssp/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libssp/multilib.tmp $(TARGET_SUBDIR)/libssp/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libssp/multilib.tmp; \
@@ -48845,6 +48877,7 @@ configure-target-newlib:
 	echo "Checking multilib configuration for newlib..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs $(TARGET_SUBDIR)/newlib; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/newlib/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/newlib/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/newlib/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/newlib/multilib.tmp $(TARGET_SUBDIR)/newlib/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/newlib/multilib.tmp; \
@@ -49329,6 +49362,7 @@ configure-target-libgcc:
 	echo "Checking multilib configuration for libgcc..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs $(TARGET_SUBDIR)/libgcc; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libgcc/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libgcc/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libgcc/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libgcc/multilib.tmp $(TARGET_SUBDIR)/libgcc/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libgcc/multilib.tmp; \
@@ -49373,6 +49407,7 @@ configure-stage1-target-libgcc:
 	TFLAGS="$(STAGE1_TFLAGS)"; \
 	echo "Checking multilib configuration for libgcc..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libgcc/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libgcc/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libgcc/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libgcc/multilib.tmp $(TARGET_SUBDIR)/libgcc/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libgcc/multilib.tmp; \
@@ -49417,6 +49452,7 @@ configure-stage2-target-libgcc:
 	TFLAGS="$(STAGE2_TFLAGS)"; \
 	echo "Checking multilib configuration for libgcc..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libgcc/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libgcc/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libgcc/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libgcc/multilib.tmp $(TARGET_SUBDIR)/libgcc/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libgcc/multilib.tmp; \
@@ -49462,6 +49498,7 @@ configure-stage3-target-libgcc:
 	TFLAGS="$(STAGE3_TFLAGS)"; \
 	echo "Checking multilib configuration for libgcc..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libgcc/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libgcc/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libgcc/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libgcc/multilib.tmp $(TARGET_SUBDIR)/libgcc/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libgcc/multilib.tmp; \
@@ -49507,6 +49544,7 @@ configure-stage4-target-libgcc:
 	TFLAGS="$(STAGE4_TFLAGS)"; \
 	echo "Checking multilib configuration for libgcc..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libgcc/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libgcc/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libgcc/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libgcc/multilib.tmp $(TARGET_SUBDIR)/libgcc/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libgcc/multilib.tmp; \
@@ -49552,6 +49590,7 @@ configure-stageprofile-target-libgcc:
 	TFLAGS="$(STAGEprofile_TFLAGS)"; \
 	echo "Checking multilib configuration for libgcc..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libgcc/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libgcc/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libgcc/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libgcc/multilib.tmp $(TARGET_SUBDIR)/libgcc/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libgcc/multilib.tmp; \
@@ -49597,6 +49636,7 @@ configure-stagetrain-target-libgcc:
 	TFLAGS="$(STAGEtrain_TFLAGS)"; \
 	echo "Checking multilib configuration for libgcc..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libgcc/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libgcc/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libgcc/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libgcc/multilib.tmp $(TARGET_SUBDIR)/libgcc/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libgcc/multilib.tmp; \
@@ -49642,6 +49682,7 @@ configure-stagefeedback-target-libgcc:
 	TFLAGS="$(STAGEfeedback_TFLAGS)"; \
 	echo "Checking multilib configuration for libgcc..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libgcc/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libgcc/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libgcc/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libgcc/multilib.tmp $(TARGET_SUBDIR)/libgcc/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libgcc/multilib.tmp; \
@@ -49687,6 +49728,7 @@ configure-stageautoprofile-target-libgcc:
 	TFLAGS="$(STAGEautoprofile_TFLAGS)"; \
 	echo "Checking multilib configuration for libgcc..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libgcc/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libgcc/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libgcc/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libgcc/multilib.tmp $(TARGET_SUBDIR)/libgcc/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libgcc/multilib.tmp; \
@@ -49732,6 +49774,7 @@ configure-stageautofeedback-target-libgcc:
 	TFLAGS="$(STAGEautofeedback_TFLAGS)"; \
 	echo "Checking multilib configuration for libgcc..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libgcc/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libgcc/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libgcc/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libgcc/multilib.tmp $(TARGET_SUBDIR)/libgcc/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libgcc/multilib.tmp; \
@@ -50562,6 +50605,7 @@ configure-target-libbacktrace:
 	echo "Checking multilib configuration for libbacktrace..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs $(TARGET_SUBDIR)/libbacktrace; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libbacktrace/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libbacktrace/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libbacktrace/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libbacktrace/multilib.tmp $(TARGET_SUBDIR)/libbacktrace/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libbacktrace/multilib.tmp; \
@@ -51047,6 +51091,7 @@ configure-target-libquadmath:
 	echo "Checking multilib configuration for libquadmath..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs $(TARGET_SUBDIR)/libquadmath; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libquadmath/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libquadmath/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libquadmath/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libquadmath/multilib.tmp $(TARGET_SUBDIR)/libquadmath/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libquadmath/multilib.tmp; \
@@ -51532,6 +51577,7 @@ configure-target-libgfortran:
 	echo "Checking multilib configuration for libgfortran..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs $(TARGET_SUBDIR)/libgfortran; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libgfortran/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libgfortran/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libgfortran/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libgfortran/multilib.tmp $(TARGET_SUBDIR)/libgfortran/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libgfortran/multilib.tmp; \
@@ -52017,6 +52063,7 @@ configure-target-libobjc:
 	echo "Checking multilib configuration for libobjc..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs $(TARGET_SUBDIR)/libobjc; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libobjc/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libobjc/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libobjc/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libobjc/multilib.tmp $(TARGET_SUBDIR)/libobjc/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libobjc/multilib.tmp; \
@@ -52469,6 +52516,7 @@ configure-target-libgo:
 	echo "Checking multilib configuration for libgo..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs $(TARGET_SUBDIR)/libgo; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libgo/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libgo/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libgo/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libgo/multilib.tmp $(TARGET_SUBDIR)/libgo/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libgo/multilib.tmp; \
@@ -52954,6 +53002,7 @@ configure-target-libphobos:
 	echo "Checking multilib configuration for libphobos..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs $(TARGET_SUBDIR)/libphobos; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libphobos/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libphobos/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libphobos/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libphobos/multilib.tmp $(TARGET_SUBDIR)/libphobos/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libphobos/multilib.tmp; \
@@ -53439,6 +53488,7 @@ configure-target-libtermcap:
 	echo "Checking multilib configuration for libtermcap..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs $(TARGET_SUBDIR)/libtermcap; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libtermcap/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libtermcap/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libtermcap/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libtermcap/multilib.tmp $(TARGET_SUBDIR)/libtermcap/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libtermcap/multilib.tmp; \
@@ -53859,6 +53909,7 @@ configure-target-winsup:
 	echo "Checking multilib configuration for winsup..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs $(TARGET_SUBDIR)/winsup; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/winsup/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/winsup/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/winsup/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/winsup/multilib.tmp $(TARGET_SUBDIR)/winsup/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/winsup/multilib.tmp; \
@@ -54344,6 +54395,7 @@ configure-target-libgloss:
 	echo "Checking multilib configuration for libgloss..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs $(TARGET_SUBDIR)/libgloss; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libgloss/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libgloss/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libgloss/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libgloss/multilib.tmp $(TARGET_SUBDIR)/libgloss/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libgloss/multilib.tmp; \
@@ -54824,6 +54876,7 @@ configure-target-libffi:
 	echo "Checking multilib configuration for libffi..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs $(TARGET_SUBDIR)/libffi; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libffi/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libffi/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libffi/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libffi/multilib.tmp $(TARGET_SUBDIR)/libffi/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libffi/multilib.tmp; \
@@ -55299,6 +55352,7 @@ configure-target-zlib:
 	echo "Checking multilib configuration for zlib..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs $(TARGET_SUBDIR)/zlib; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/zlib/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/zlib/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/zlib/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/zlib/multilib.tmp $(TARGET_SUBDIR)/zlib/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/zlib/multilib.tmp; \
@@ -55784,6 +55838,7 @@ configure-target-rda:
 	echo "Checking multilib configuration for rda..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs $(TARGET_SUBDIR)/rda; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/rda/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/rda/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/rda/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/rda/multilib.tmp $(TARGET_SUBDIR)/rda/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/rda/multilib.tmp; \
@@ -56269,6 +56324,7 @@ configure-target-libada:
 	echo "Checking multilib configuration for libada..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs $(TARGET_SUBDIR)/libada; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libada/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libada/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libada/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libada/multilib.tmp $(TARGET_SUBDIR)/libada/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libada/multilib.tmp; \
@@ -56753,6 +56809,7 @@ configure-target-libgomp:
 	echo "Checking multilib configuration for libgomp..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs $(TARGET_SUBDIR)/libgomp; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libgomp/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libgomp/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libgomp/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libgomp/multilib.tmp $(TARGET_SUBDIR)/libgomp/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libgomp/multilib.tmp; \
@@ -56797,6 +56854,7 @@ configure-stage1-target-libgomp:
 	TFLAGS="$(STAGE1_TFLAGS)"; \
 	echo "Checking multilib configuration for libgomp..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libgomp/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libgomp/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libgomp/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libgomp/multilib.tmp $(TARGET_SUBDIR)/libgomp/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libgomp/multilib.tmp; \
@@ -56841,6 +56899,7 @@ configure-stage2-target-libgomp:
 	TFLAGS="$(STAGE2_TFLAGS)"; \
 	echo "Checking multilib configuration for libgomp..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libgomp/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libgomp/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libgomp/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libgomp/multilib.tmp $(TARGET_SUBDIR)/libgomp/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libgomp/multilib.tmp; \
@@ -56886,6 +56945,7 @@ configure-stage3-target-libgomp:
 	TFLAGS="$(STAGE3_TFLAGS)"; \
 	echo "Checking multilib configuration for libgomp..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libgomp/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libgomp/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libgomp/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libgomp/multilib.tmp $(TARGET_SUBDIR)/libgomp/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libgomp/multilib.tmp; \
@@ -56931,6 +56991,7 @@ configure-stage4-target-libgomp:
 	TFLAGS="$(STAGE4_TFLAGS)"; \
 	echo "Checking multilib configuration for libgomp..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libgomp/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libgomp/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libgomp/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libgomp/multilib.tmp $(TARGET_SUBDIR)/libgomp/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libgomp/multilib.tmp; \
@@ -56976,6 +57037,7 @@ configure-stageprofile-target-libgomp:
 	TFLAGS="$(STAGEprofile_TFLAGS)"; \
 	echo "Checking multilib configuration for libgomp..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libgomp/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libgomp/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libgomp/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libgomp/multilib.tmp $(TARGET_SUBDIR)/libgomp/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libgomp/multilib.tmp; \
@@ -57021,6 +57083,7 @@ configure-stagetrain-target-libgomp:
 	TFLAGS="$(STAGEtrain_TFLAGS)"; \
 	echo "Checking multilib configuration for libgomp..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libgomp/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libgomp/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libgomp/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libgomp/multilib.tmp $(TARGET_SUBDIR)/libgomp/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libgomp/multilib.tmp; \
@@ -57066,6 +57129,7 @@ configure-stagefeedback-target-libgomp:
 	TFLAGS="$(STAGEfeedback_TFLAGS)"; \
 	echo "Checking multilib configuration for libgomp..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libgomp/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libgomp/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libgomp/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libgomp/multilib.tmp $(TARGET_SUBDIR)/libgomp/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libgomp/multilib.tmp; \
@@ -57111,6 +57175,7 @@ configure-stageautoprofile-target-libgomp:
 	TFLAGS="$(STAGEautoprofile_TFLAGS)"; \
 	echo "Checking multilib configuration for libgomp..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libgomp/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libgomp/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libgomp/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libgomp/multilib.tmp $(TARGET_SUBDIR)/libgomp/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libgomp/multilib.tmp; \
@@ -57156,6 +57221,7 @@ configure-stageautofeedback-target-libgomp:
 	TFLAGS="$(STAGEautofeedback_TFLAGS)"; \
 	echo "Checking multilib configuration for libgomp..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libgomp/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libgomp/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libgomp/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libgomp/multilib.tmp $(TARGET_SUBDIR)/libgomp/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libgomp/multilib.tmp; \
@@ -58024,6 +58090,7 @@ configure-target-libitm:
 	echo "Checking multilib configuration for libitm..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs $(TARGET_SUBDIR)/libitm; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libitm/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libitm/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libitm/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libitm/multilib.tmp $(TARGET_SUBDIR)/libitm/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libitm/multilib.tmp; \
@@ -58509,6 +58576,7 @@ configure-target-libatomic:
 	echo "Checking multilib configuration for libatomic..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs $(TARGET_SUBDIR)/libatomic; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libatomic/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libatomic/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libatomic/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libatomic/multilib.tmp $(TARGET_SUBDIR)/libatomic/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libatomic/multilib.tmp; \
diff --git a/binutils/Makefile.tpl b/binutils/Makefile.tpl
index 88db8f44d5..b41aad9b7f 100644
--- a/binutils/Makefile.tpl
+++ b/binutils/Makefile.tpl
@@ -1146,6 +1146,7 @@ configure-[+prefix+][+module+]: [+ IF bootstrap +][+ ELSE +]
 	+]echo "Checking multilib configuration for [+module+]..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs [+subdir+]/[+module+]; \
 	$(CC_FOR_TARGET) --print-multi-lib > [+subdir+]/[+module+]/multilib.tmp 2> /dev/null; \
+	dos2unix -q [+subdir+]/[+module+]/multilib.tmp; \
 	if test -r [+subdir+]/[+module+]/multilib.out; then \
 	  if cmp -s [+subdir+]/[+module+]/multilib.tmp [+subdir+]/[+module+]/multilib.out; then \
 	    rm -f [+subdir+]/[+module+]/multilib.tmp; \
@@ -1191,6 +1192,7 @@ configure-stage[+id+]-[+prefix+][+module+]:
 	[+ IF check_multilibs
 	+]echo "Checking multilib configuration for [+module+]..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > [+subdir+]/[+module+]/multilib.tmp 2> /dev/null; \
+	dos2unix -q [+subdir+]/[+module+]/multilib.tmp; \
 	if test -r [+subdir+]/[+module+]/multilib.out; then \
 	  if cmp -s [+subdir+]/[+module+]/multilib.tmp [+subdir+]/[+module+]/multilib.out; then \
 	    rm -f [+subdir+]/[+module+]/multilib.tmp; \
diff --git a/binutils/bfd/configure b/binutils/bfd/configure
index 24531087d4..5085616aaf 100755
--- a/binutils/bfd/configure
+++ b/binutils/bfd/configure
@@ -1617,9 +1617,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1654,9 +1655,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1779,7 +1781,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -1852,9 +1854,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -3830,9 +3833,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -3883,7 +3887,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3953,7 +3957,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4009,7 +4013,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -4066,7 +4070,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4455,7 +4459,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -4513,6 +4517,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -4857,7 +4866,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -4874,7 +4883,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -5294,9 +5303,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -5338,7 +5347,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -5369,7 +5378,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -5584,10 +5593,12 @@ else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
   (eval echo "\"\$as_me:$LINENO: $ac_compile\"" >&5)
-  (eval "$ac_compile" 2>conftest.err)
+  (eval "($ac_compile | sed -e 's/\r//g')" 2>conftest.err)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: output\"" >&5)
   cat conftest.out >&5
@@ -6008,7 +6019,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -6070,7 +6081,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|_pic\.a)$'
@@ -6088,7 +6099,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
@@ -6164,9 +6175,9 @@ test -z "$deplibs_check_method" && deplibs_check_method=unknown
 plugin_option=
 plugin_names="liblto_plugin.so liblto_plugin-0.dll cyglto_plugin-0.dll"
 for plugin in $plugin_names; do
-  plugin_so=`${CC} ${CFLAGS} --print-prog-name $plugin`
+  plugin_so=`${CC} ${CFLAGS} --print-prog-name $plugin | sed -e 's/\r//g'`
   if test x$plugin_so = x$plugin; then
-    plugin_so=`${CC} ${CFLAGS} --print-file-name $plugin`
+    plugin_so=`${CC} ${CFLAGS} --print-file-name $plugin | sed -e 's/\r//g'`
   fi
   if test x$plugin_so != x$plugin; then
     plugin_option="--plugin $plugin_so"
@@ -6620,7 +6631,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g' | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[ABCDGIRSTW]' ;;
 esac
@@ -6628,11 +6639,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -6666,7 +6677,7 @@ for ac_symprfx in "" "_"; do
 "     s[1]~prfx {split(s[1],t,\"@\"); print t[1], substr(t[1],length(prfx))}"\
 "     ' prfx=^$ac_symprfx"
   else
-    lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
+    lt_cv_sys_global_symbol_pipe="sed -n -e 's/\r//g' -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
   fi
 
   # Check to see that the pipe works correctly.
@@ -6687,14 +6698,14 @@ int main(){nm_test_var='a';nm_test_func();return(0);}
 _LT_EOF
 
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist\""; } >&5
-  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) 2>&5
+    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist\""; } >&5
+  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s "$nlist"; then
@@ -6715,7 +6726,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | sed -e '"'"'s/\r//g'"'"' | $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -6728,7 +6739,7 @@ lt__PROGRAM__LTX_preloaded_symbols[] =
 {
   { "@PROGRAM@", (void *) 0 },
 _LT_EOF
-	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | $GREP -v main >> conftest.$ac_ext
+	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | sed -e 's/\r//g' | $GREP -v main >> conftest.$ac_ext
 	  cat <<\_LT_EOF >> conftest.$ac_ext
   {0, (void *) 0}
 };
@@ -6751,7 +6762,7 @@ _LT_EOF
 	  LIBS="conftstm.$ac_objext"
 	  CFLAGS="$CFLAGS$lt_prog_compiler_no_builtin_flag"
 	  if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext}; then
@@ -6830,7 +6841,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6849,7 +6860,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo '#line '$LINENO' "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6887,7 +6898,7 @@ s390*-*linux*|s390*-*tpf*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6999,7 +7010,7 @@ sparc*-*solaris*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7532,6 +7543,7 @@ else
 	if test -f libconftest.dylib && test ! -s conftest.err && test $_lt_result = 0; then
 	  lt_cv_apple_cc_single_mod=yes
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err >&5
 	fi
 	rm -rf libconftest.dylib*
@@ -7594,6 +7606,7 @@ _LT_EOF
       if test -f conftest && test ! -s conftest.err && test $_lt_result = 0 && $GREP forced_load conftest 2>&1 >/dev/null; then
 	lt_cv_ld_force_load=yes
       else
+        dos2unix -q conftest.err
 	cat conftest.err >&5
       fi
         rm -f conftest.err libconftest.a conftest conftest.c
@@ -8054,13 +8067,15 @@ compiler_DEFAULT=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -8100,14 +8115,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -8322,7 +8339,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic='-KPIC'
@@ -8453,14 +8470,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works=yes
@@ -8502,10 +8521,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -8558,8 +8578,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8567,6 +8588,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8613,8 +8635,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8622,6 +8645,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8682,7 +8706,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object=no
   enable_shared_with_static_runtimes=no
   export_dynamic_flag_spec=
-  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic=no
   hardcode_direct=no
   hardcode_direct_absolute=no
@@ -8745,7 +8769,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -8771,13 +8795,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -8821,7 +8845,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -8839,9 +8863,9 @@ _LT_EOF
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -8884,7 +8908,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -8915,7 +8939,7 @@ _LT_EOF
 	  compiler_needs_object=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object=yes
@@ -8953,7 +8977,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -8963,7 +8987,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
 
@@ -8975,7 +8999,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -8984,7 +9008,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
@@ -9003,7 +9027,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
 	    archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -9022,7 +9046,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9066,10 +9090,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -9416,10 +9440,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS -b"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -9500,7 +9525,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -9526,7 +9551,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct=yes
 	hardcode_shlibpath_var=no
 	hardcode_direct_absolute=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
@@ -9595,7 +9620,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -9788,10 +9813,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -9817,6 +9843,7 @@ else
 	  fi
 	  allow_undefined_flag=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -9999,7 +10026,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([A-Za-z]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -10103,7 +10130,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -10466,7 +10493,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -10511,7 +10538,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -11157,7 +11184,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -11263,7 +11290,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -12076,7 +12103,7 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 __GNUC__
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "(^[0-3]$|^__GNUC__$)" >/dev/null 2>&1; then :
 
 else
@@ -12090,7 +12117,7 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 __GNUC__
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "(^[0-4]$|^__GNUC__$)" >/dev/null 2>&1; then :
 
 else
@@ -12105,7 +12132,7 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 __GNUC__
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "(^[0-3]$|^__GNUC__$)" >/dev/null 2>&1; then :
 
 else
@@ -12121,7 +12148,7 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 __GNUC__
 _ACEOF
-if (eval "$ac_cpp_for_build conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp_for_build conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "(^[0-3]$|^__GNUC__$)" >/dev/null 2>&1; then :
 
 else
@@ -12135,7 +12162,7 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 __GNUC__
 _ACEOF
-if (eval "$ac_cpp_for_build conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp_for_build conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "(^[0-4]$|^__GNUC__$)" >/dev/null 2>&1; then :
 
 else
@@ -13074,7 +13101,7 @@ if ${bfd_cv_ld_as_needed+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   bfd_cv_ld_as_needed=no
-	if $LD --help 2>/dev/null | grep as-needed > /dev/null; then
+	if $LD --help 2>/dev/null | sed -e 's/\r//g' | grep as-needed > /dev/null; then
 		bfd_cv_ld_as_needed=yes
 	fi
 
@@ -13713,7 +13740,7 @@ $as_echo_n "checking for gcc version with buggy 64-bit support... " >&6; }
 /* end confdefs.h.  */
 :__GNUC__:__GNUC_MINOR__:__i386__:
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP ": 2 : 91 : 1 :" >/dev/null 2>&1; then :
   bad_64bit_gcc=yes;
 		    { $as_echo "$as_me:${as_lineno-$LINENO}: result: yes: egcs-1.1.2 on ix86 spotted" >&5
diff --git a/binutils/bfd/configure.ac b/binutils/bfd/configure.ac
index 6146efb5ae..a78d85d930 100644
--- a/binutils/bfd/configure.ac
+++ b/binutils/bfd/configure.ac
@@ -263,7 +263,7 @@ AC_SUBST(BFD_INT64_FMT)
 # Check if linker supports --as-needed and --no-as-needed options
 AC_CACHE_CHECK(linker --as-needed support, bfd_cv_ld_as_needed,
 	[bfd_cv_ld_as_needed=no
-	if $LD --help 2>/dev/null | grep as-needed > /dev/null; then
+	if $LD --help 2>/dev/null | sed -e 's/\r//g' | grep as-needed > /dev/null; then
 		bfd_cv_ld_as_needed=yes
 	fi
 	])
diff --git a/binutils/bfd/warning.m4 b/binutils/bfd/warning.m4
index 6f3e190b81..6405cd2f03 100644
--- a/binutils/bfd/warning.m4
+++ b/binutils/bfd/warning.m4
@@ -26,7 +26,7 @@ AC_REQUIRE([AC_PROG_EGREP])dnl
 AC_LANG_CONFTEST([AC_LANG_SOURCE([[$2]])])
 AS_IF([dnl eval is necessary to expand ac_cpp.
 dnl Ultrix and Pyramid sh refuse to redirect output of eval, so use subshell.
-(eval "$ac_cpp_for_build conftest.$ac_ext") 2>&AS_MESSAGE_LOG_FD |
+(eval "$ac_cpp_for_build conftest.$ac_ext | sed -e 's/\r//g'") 2>&AS_MESSAGE_LOG_FD |
 dnl Quote $1 to prevent m4 from eating character classes
   $EGREP "[$1]" >/dev/null 2>&1],
   [$3],
diff --git a/binutils/binutils/configure b/binutils/binutils/configure
index 49d3019e5b..39c0f8a56f 100755
--- a/binutils/binutils/configure
+++ b/binutils/binutils/configure
@@ -1646,9 +1646,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1683,9 +1684,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1808,7 +1810,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -1881,9 +1883,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -3699,9 +3702,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -3752,7 +3756,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3822,7 +3826,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3878,7 +3882,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -3935,7 +3939,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4324,7 +4328,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -4382,6 +4386,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -4726,7 +4735,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -4743,7 +4752,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -5163,9 +5172,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -5207,7 +5216,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -5238,7 +5247,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -5453,10 +5462,12 @@ else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
   (eval echo "\"\$as_me:$LINENO: $ac_compile\"" >&5)
-  (eval "$ac_compile" 2>conftest.err)
+  (eval "($ac_compile | sed -e 's/\r//g')" 2>conftest.err)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: output\"" >&5)
   cat conftest.out >&5
@@ -5877,7 +5888,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -5939,7 +5950,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|_pic\.a)$'
@@ -5957,7 +5968,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
@@ -6033,9 +6044,9 @@ test -z "$deplibs_check_method" && deplibs_check_method=unknown
 plugin_option=
 plugin_names="liblto_plugin.so liblto_plugin-0.dll cyglto_plugin-0.dll"
 for plugin in $plugin_names; do
-  plugin_so=`${CC} ${CFLAGS} --print-prog-name $plugin`
+  plugin_so=`${CC} ${CFLAGS} --print-prog-name $plugin | sed -e 's/\r//g'`
   if test x$plugin_so = x$plugin; then
-    plugin_so=`${CC} ${CFLAGS} --print-file-name $plugin`
+    plugin_so=`${CC} ${CFLAGS} --print-file-name $plugin | sed -e 's/\r//g'`
   fi
   if test x$plugin_so != x$plugin; then
     plugin_option="--plugin $plugin_so"
@@ -6489,7 +6500,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g' | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[ABCDGIRSTW]' ;;
 esac
@@ -6497,11 +6508,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -6535,7 +6546,7 @@ for ac_symprfx in "" "_"; do
 "     s[1]~prfx {split(s[1],t,\"@\"); print t[1], substr(t[1],length(prfx))}"\
 "     ' prfx=^$ac_symprfx"
   else
-    lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
+    lt_cv_sys_global_symbol_pipe="sed -n -e 's/\r//g' -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
   fi
 
   # Check to see that the pipe works correctly.
@@ -6556,14 +6567,14 @@ int main(){nm_test_var='a';nm_test_func();return(0);}
 _LT_EOF
 
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist\""; } >&5
-  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) 2>&5
+    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist\""; } >&5
+  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s "$nlist"; then
@@ -6584,7 +6595,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | sed -e '"'"'s/\r//g'"'"' | $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -6597,7 +6608,7 @@ lt__PROGRAM__LTX_preloaded_symbols[] =
 {
   { "@PROGRAM@", (void *) 0 },
 _LT_EOF
-	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | $GREP -v main >> conftest.$ac_ext
+	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | sed -e 's/\r//g' | $GREP -v main >> conftest.$ac_ext
 	  cat <<\_LT_EOF >> conftest.$ac_ext
   {0, (void *) 0}
 };
@@ -6620,7 +6631,7 @@ _LT_EOF
 	  LIBS="conftstm.$ac_objext"
 	  CFLAGS="$CFLAGS$lt_prog_compiler_no_builtin_flag"
 	  if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext}; then
@@ -6699,7 +6710,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6718,7 +6729,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo '#line '$LINENO' "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6756,7 +6767,7 @@ s390*-*linux*|s390*-*tpf*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6868,7 +6879,7 @@ sparc*-*solaris*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7401,6 +7412,7 @@ else
 	if test -f libconftest.dylib && test ! -s conftest.err && test $_lt_result = 0; then
 	  lt_cv_apple_cc_single_mod=yes
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err >&5
 	fi
 	rm -rf libconftest.dylib*
@@ -7463,6 +7475,7 @@ _LT_EOF
       if test -f conftest && test ! -s conftest.err && test $_lt_result = 0 && $GREP forced_load conftest 2>&1 >/dev/null; then
 	lt_cv_ld_force_load=yes
       else
+        dos2unix -q conftest.err
 	cat conftest.err >&5
       fi
         rm -f conftest.err libconftest.a conftest conftest.c
@@ -7954,13 +7967,15 @@ compiler_DEFAULT=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -8000,14 +8015,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -8222,7 +8239,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic='-KPIC'
@@ -8353,14 +8370,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works=yes
@@ -8402,10 +8421,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -8458,8 +8478,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8467,6 +8488,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8513,8 +8535,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8522,6 +8545,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8582,7 +8606,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object=no
   enable_shared_with_static_runtimes=no
   export_dynamic_flag_spec=
-  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic=no
   hardcode_direct=no
   hardcode_direct_absolute=no
@@ -8645,7 +8669,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -8671,13 +8695,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -8721,7 +8745,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -8739,9 +8763,9 @@ _LT_EOF
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -8784,7 +8808,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -8815,7 +8839,7 @@ _LT_EOF
 	  compiler_needs_object=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object=yes
@@ -8853,7 +8877,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -8863,7 +8887,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
 
@@ -8875,7 +8899,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -8884,7 +8908,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
@@ -8903,7 +8927,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
 	    archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -8922,7 +8946,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -8966,10 +8990,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -9316,10 +9340,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS -b"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -9400,7 +9425,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -9426,7 +9451,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct=yes
 	hardcode_shlibpath_var=no
 	hardcode_direct_absolute=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
@@ -9495,7 +9520,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -9688,10 +9713,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -9717,6 +9743,7 @@ else
 	  fi
 	  allow_undefined_flag=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -9899,7 +9926,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([A-Za-z]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -10003,7 +10030,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -10366,7 +10393,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -10411,7 +10438,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -11057,7 +11084,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -11163,7 +11190,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -12097,7 +12124,7 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 __GNUC__
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "(^[0-3]$|^__GNUC__$)" >/dev/null 2>&1; then :
 
 else
@@ -12111,7 +12138,7 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 __GNUC__
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "(^[0-4]$|^__GNUC__$)" >/dev/null 2>&1; then :
 
 else
@@ -12126,7 +12153,7 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 __GNUC__
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "(^[0-3]$|^__GNUC__$)" >/dev/null 2>&1; then :
 
 else
@@ -12142,7 +12169,7 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 __GNUC__
 _ACEOF
-if (eval "$ac_cpp_for_build conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp_for_build conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "(^[0-3]$|^__GNUC__$)" >/dev/null 2>&1; then :
 
 else
@@ -12156,7 +12183,7 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 __GNUC__
 _ACEOF
-if (eval "$ac_cpp_for_build conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp_for_build conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "(^[0-4]$|^__GNUC__$)" >/dev/null 2>&1; then :
 
 else
@@ -13927,9 +13954,9 @@ $as_echo_n "checking for ld used by GCC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -13970,7 +13997,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some GNU ld's only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      if "$acl_cv_path_LD" -v 2>&1 < /dev/null | egrep '(GNU|with BFD)' > /dev/null; then
+      if "$acl_cv_path_LD" -v 2>&1 < /dev/null | sed -e 's/\r//g' | egrep '(GNU|with BFD)' > /dev/null; then
 	test "$with_gnu_ld" != no && break
       else
 	test "$with_gnu_ld" != yes && break
@@ -13998,7 +14025,7 @@ if ${acl_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU ld's only accept -v.
-if $LD -v 2>&1 </dev/null | egrep '(GNU|with BFD)' 1>&5; then
+if $LD -v 2>&1 </dev/null | sed -e 's/\r//g' | egrep '(GNU|with BFD)' 1>&5; then
   acl_cv_prog_gnu_ld=yes
 else
   acl_cv_prog_gnu_ld=no
diff --git a/binutils/config-ml.in b/binutils/config-ml.in
index 47f153350e..666c53315f 100644
--- a/binutils/config-ml.in
+++ b/binutils/config-ml.in
@@ -215,7 +215,7 @@ fi
 if [ "${ml_toplevel_p}" = yes ]; then
 
 multidirs=
-for i in `${CC-gcc} --print-multi-lib 2>/dev/null`; do
+for i in `${CC-gcc} --print-multi-lib 2>/dev/null | sed -e 's/\r//g'`; do
   dir=`echo $i | sed -e 's/;.*$//'`
   if [ "${dir}" = "." ]; then
     true
@@ -496,7 +496,7 @@ multi-do:
 	  srcrootpre=`cd $(srcdir); ${PWD_COMMAND}`/; export srcrootpre; \
 	  lib=`echo "$${rootpre}" | sed -e 's,^.*/\([^/][^/]*\)/$$,\1,'`; \
 	  compiler="$(CC)"; \
-	  for i in `$${compiler} --print-multi-lib 2>/dev/null`; do \
+	  for i in `$${compiler} --print-multi-lib 2>/dev/null | sed -e 's/\r//g'`; do \
 	    dir=`echo $$i | sed -e 's/;.*$$//'`; \
 	    if [ "$${dir}" = "." ]; then \
 	      true; \
@@ -738,7 +738,7 @@ if [ -n "${multidirs}" ] && [ -z "${ml_norecursion}" ]; then
     fi
 
     # find compiler flag corresponding to ${ml_dir}
-    for i in `${CC-gcc} --print-multi-lib 2>/dev/null`; do
+    for i in `${CC-gcc} --print-multi-lib 2>/dev/null | sed -e 's/\r//g'`; do
       dir=`echo $i | sed -e 's/;.*$//'`
       if [ "${dir}" = "${ml_dir}" ]; then
         flags=`echo $i | sed -e 's/^[^;]*;//' -e 's/@/ -/g'`
diff --git a/binutils/config.guess b/binutils/config.guess
index 7f76b6228f..74393b8573 100755
--- a/binutils/config.guess
+++ b/binutils/config.guess
@@ -170,7 +170,7 @@ Linux|GNU|GNU/*)
 	#endif
 	#endif
 	EOF
-	cc_set_libc=`$CC_FOR_BUILD -E "$dummy.c" 2>/dev/null | grep '^LIBC' | sed 's, ,,g'`
+	cc_set_libc=`$CC_FOR_BUILD -E "$dummy.c" 2>/dev/null | sed -e 's/\r//g' | grep '^LIBC' | sed 's, ,,g'`
 	eval "$cc_set_libc"
 
 	# Second heuristic to detect musl libc.
@@ -229,6 +229,7 @@ case $UNAME_MACHINE:$UNAME_SYSTEM:$UNAME_RELEASE:$UNAME_VERSION in
 	    arm*|i386|m68k|ns32k|sh3*|sparc|vax)
 		set_cc_for_build
 		if echo __ELF__ | $CC_FOR_BUILD -E - 2>/dev/null \
+			| sed -e 's/\r//g' \
 			| grep -q __ELF__
 		then
 		    # Once all utilities can be ECOFF (netbsdecoff) or a.out (netbsdaout).
@@ -438,6 +439,7 @@ case $UNAME_MACHINE:$UNAME_SYSTEM:$UNAME_RELEASE:$UNAME_VERSION in
 	if test "$CC_FOR_BUILD" != no_compiler_found; then
 	    if (echo '#ifdef __amd64'; echo IS_64BIT_ARCH; echo '#endif') | \
 		(CCOPTS="" $CC_FOR_BUILD -m64 -E - 2>/dev/null) | \
+		sed -e 's/\r//g' | \
 		grep IS_64BIT_ARCH >/dev/null
 	    then
 		SUN_ARCH=x86_64
@@ -757,6 +759,7 @@ EOF
 	    # => hppa64-hp-hpux11.23
 
 	    if echo __LP64__ | (CCOPTS="" $CC_FOR_BUILD -E - 2>/dev/null) |
+		sed -e 's/\r//g' |
 		grep -q __LP64__
 	    then
 		HP_ARCH=hppa2.0w
@@ -894,6 +897,7 @@ EOF
 	UNAME_PROCESSOR=`uname -p`
 	set_cc_for_build
 	if echo __ARM_PCS_VFP | $CC_FOR_BUILD -E - 2>/dev/null \
+	    | sed -e 's/\r//g' \
 	    | grep -q __ARM_PCS_VFP
 	then
 	    FREEBSD_REL=`echo "$UNAME_RELEASE" | sed -e 's/[-(].*//'`
@@ -996,11 +1000,13 @@ EOF
     arm*:Linux:*:*)
 	set_cc_for_build
 	if echo __ARM_EABI__ | $CC_FOR_BUILD -E - 2>/dev/null \
+	    | sed -e 's/\r//g' \
 	    | grep -q __ARM_EABI__
 	then
 	    GUESS=$UNAME_MACHINE-unknown-linux-$LIBC
 	else
 	    if echo __ARM_PCS_VFP | $CC_FOR_BUILD -E - 2>/dev/null \
+	  | sed -e 's/\r//g' \
 		| grep -q __ARM_PCS_VFP
 	    then
 		GUESS=$UNAME_MACHINE-unknown-linux-${LIBC}eabi
@@ -1089,7 +1095,7 @@ EOF
 	#endif
 	#endif
 EOF
-	cc_set_vars=`$CC_FOR_BUILD -E "$dummy.c" 2>/dev/null | grep '^CPU\|^MIPS_ENDIAN\|^LIBCABI'`
+	cc_set_vars=`$CC_FOR_BUILD -E "$dummy.c" 2>/dev/null | sed -e 's/\r//g' | grep '^CPU\|^MIPS_ENDIAN\|^LIBCABI'`
 	eval "$cc_set_vars"
 	test "x$CPU" != x && { echo "$CPU${MIPS_ENDIAN}-unknown-linux-$LIBCABI"; exit; }
 	;;
@@ -1155,6 +1161,7 @@ EOF
 	if test "$CC_FOR_BUILD" != no_compiler_found; then
 	    if (echo '#ifdef __ILP32__'; echo IS_X32; echo '#endif') | \
 		(CCOPTS="" $CC_FOR_BUILD -E - 2>/dev/null) | \
+		sed -e 's/\r//g' | \
 		grep IS_X32 >/dev/null
 	    then
 		LIBCABI=${LIBC}x32
@@ -1417,6 +1424,7 @@ EOF
 	if test "$CC_FOR_BUILD" != no_compiler_found; then
 	    if (echo '#ifdef __LP64__'; echo IS_64BIT_ARCH; echo '#endif') | \
 		   (CCOPTS="" $CC_FOR_BUILD -E - 2>/dev/null) | \
+		   sed -e 's/\r//g' | \
 		   grep IS_64BIT_ARCH >/dev/null
 	    then
 		case $UNAME_PROCESSOR in
@@ -1427,6 +1435,7 @@ EOF
 	    # On 10.4-10.6 one might compile for PowerPC via gcc -arch ppc
 	    if (echo '#ifdef __POWERPC__'; echo IS_PPC; echo '#endif') | \
 		   (CCOPTS="" $CC_FOR_BUILD -E - 2>/dev/null) | \
+		   sed -e 's/\r//g' | \
 		   grep IS_PPC >/dev/null
 	    then
 		UNAME_PROCESSOR=powerpc
diff --git a/binutils/config.rpath b/binutils/config.rpath
index 4dea75957c..0a76adc90f 100755
--- a/binutils/config.rpath
+++ b/binutils/config.rpath
@@ -143,7 +143,7 @@ if test "$with_gnu_ld" = yes; then
       ld_shlibs=no
       ;;
     beos*)
-      if $LD --help 2>&1 | egrep ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | egrep ': supported targets:.* elf' > /dev/null; then
         :
       else
         ld_shlibs=no
@@ -153,7 +153,7 @@ if test "$with_gnu_ld" = yes; then
       # hardcode_libdir_flag_spec is actually meaningless, as there is
       # no search path for DLLs.
       hardcode_libdir_flag_spec='-L$libdir'
-      if $LD --help 2>&1 | grep 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | grep 'auto-import' > /dev/null; then
         :
       else
         ld_shlibs=no
@@ -162,9 +162,9 @@ if test "$with_gnu_ld" = yes; then
     netbsd*)
       ;;
     solaris* | sysv5*)
-      if $LD -v 2>&1 | egrep 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | egrep 'BFD 2\.8' > /dev/null; then
         ld_shlibs=no
-      elif $LD --help 2>&1 | egrep ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | egrep ': supported targets:.* elf' > /dev/null; then
         :
       else
         ld_shlibs=no
@@ -174,7 +174,7 @@ if test "$with_gnu_ld" = yes; then
       hardcode_direct=yes
       ;;
     *)
-      if $LD --help 2>&1 | egrep ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | egrep ': supported targets:.* elf' > /dev/null; then
         :
       else
         ld_shlibs=no
@@ -345,7 +345,7 @@ else
       ;;
     openbsd*)
       hardcode_direct=yes
-      if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+      if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
         hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
       else
         case "$host_os" in
diff --git a/binutils/config/acx.m4 b/binutils/config/acx.m4
index 87c1b5e293..c2aa2e05ce 100644
--- a/binutils/config/acx.m4
+++ b/binutils/config/acx.m4
@@ -302,7 +302,7 @@ cat > conftest.c << \EOF
   gcc_yay;
 #endif
 EOF
-if ($GCC_FOR_TARGET -E conftest.c | grep gcc_yay) > /dev/null 2>&1; then
+if ($GCC_FOR_TARGET -E conftest.c | sed -e 's/\r//g' | grep gcc_yay) > /dev/null 2>&1; then
   have_gcc_for_target=yes
 else
   GCC_FOR_TARGET=${ncn_target_tool_prefix}gcc
@@ -351,7 +351,7 @@ if test -z "$ac_cv_path_$1" ; then
       AC_MSG_RESULT(no)
     fi
   elif test $build != $host && test $have_gcc_for_target = yes; then
-    $1=`$GCC_FOR_TARGET --print-prog-name=$2`
+    $1=`$GCC_FOR_TARGET --print-prog-name=$2 | sed -e 's/\r//g'`
     test [$]$1 = $2 && $1=
     test -n "[$]$1" && ac_cv_path_$1=[$]$1
   fi
diff --git a/binutils/config/gcc-plugin.m4 b/binutils/config/gcc-plugin.m4
index ca98d67491..1a434530fe 100644
--- a/binutils/config/gcc-plugin.m4
+++ b/binutils/config/gcc-plugin.m4
@@ -136,9 +136,9 @@ AC_MSG_CHECKING([for -plugin option])
 plugin_names="liblto_plugin.so liblto_plugin-0.dll cyglto_plugin-0.dll"
 plugin_option=
 for plugin in $plugin_names; do
-  plugin_so=`${CC} ${CFLAGS} --print-prog-name $plugin`
+  plugin_so=`${CC} ${CFLAGS} --print-prog-name $plugin | sed -e 's/\r//g'`
   if test x$plugin_so = x$plugin; then
-    plugin_so=`${CC} ${CFLAGS} --print-file-name $plugin`
+    plugin_so=`${CC} ${CFLAGS} --print-file-name $plugin | sed -e 's/\r//g'`
   fi
   if test x$plugin_so != x$plugin; then
     plugin_option="--plugin $plugin_so"
diff --git a/binutils/config/ld-symbolic.m4 b/binutils/config/ld-symbolic.m4
index 16d64f9ad3..14accdfae1 100644
--- a/binutils/config/ld-symbolic.m4
+++ b/binutils/config/ld-symbolic.m4
@@ -13,7 +13,7 @@ acl_cv_prog_gnu_ld_symbolic, [
 acl_cv_prog_gnu_ld_symbolic=no
 AC_REQUIRE([AC_LIB_PROG_LD_GNU])
 if test x"$with_gnu_ld" = x"yes"; then
-  if $LD --help 2>&1 </dev/null | grep Bsymbolic-functions 1>&5; then
+  if $LD --help 2>&1 </dev/null | sed -e 's/\r//g' | grep Bsymbolic-functions 1>&5; then
     acl_cv_prog_gnu_ld_symbolic=yes
   fi
 fi])
@@ -33,7 +33,7 @@ acl_cv_prog_gnu_ld_dynamic_list_cpp_new=no
 AC_REQUIRE([ACX_PROG_LD_GNU_SYMBOLIC])
 if test x"$with_gnu_ld" = x"yes" -a \
 	x"$acl_cv_prog_gnu_ld_symbolic" = x"yes"; then
-  if $LD --help 2>&1 </dev/null | grep dynamic-list-cpp-new 1>&5; then
+  if $LD --help 2>&1 </dev/null | sed -e 's/\r//g' | grep dynamic-list-cpp-new 1>&5; then
     acl_cv_prog_gnu_ld_dynamic_list_cpp_new=yes
   fi
 fi])
diff --git a/binutils/config/lib-ld.m4 b/binutils/config/lib-ld.m4
index 11d0ce7734..9825d98a06 100644
--- a/binutils/config/lib-ld.m4
+++ b/binutils/config/lib-ld.m4
@@ -14,7 +14,7 @@ dnl From libtool-1.4. Sets the variable with_gnu_ld to yes or no.
 AC_DEFUN([AC_LIB_PROG_LD_GNU],
 [AC_CACHE_CHECK([if the linker ($LD) is GNU ld], acl_cv_prog_gnu_ld,
 [# I'd rather use --version here, but apparently some GNU ld's only accept -v.
-if $LD -v 2>&1 </dev/null | egrep '(GNU|with BFD)' 1>&5; then
+if $LD -v 2>&1 </dev/null | sed -e 's/\r//g' | egrep '(GNU|with BFD)' 1>&5; then
   acl_cv_prog_gnu_ld=yes
 else
   acl_cv_prog_gnu_ld=no
@@ -49,9 +49,9 @@ if test "$GCC" = yes; then
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -88,7 +88,7 @@ AC_CACHE_VAL(acl_cv_path_LD,
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some GNU ld's only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      if "$acl_cv_path_LD" -v 2>&1 < /dev/null | egrep '(GNU|with BFD)' > /dev/null; then
+      if "$acl_cv_path_LD" -v 2>&1 < /dev/null | sed -e 's/\r//g' | egrep '(GNU|with BFD)' > /dev/null; then
 	test "$with_gnu_ld" != no && break
       else
 	test "$with_gnu_ld" != yes && break
diff --git a/binutils/config/stdint.m4 b/binutils/config/stdint.m4
index 59f4359544..35ff345266 100644
--- a/binutils/config/stdint.m4
+++ b/binutils/config/stdint.m4
@@ -193,7 +193,7 @@ fi
 # ----------------- done all checks, emit header -------------
 AC_CONFIG_COMMANDS(_GCC_STDINT_H, [
 if test "$GCC" = yes; then
-  echo "/* generated for " `$CC --version | sed 1q` "*/" > tmp-stdint.h
+  echo "/* generated for " `$CC --version | sed -e 's/\r//g' | sed 1q` "*/" > tmp-stdint.h
 else
   echo "/* generated for $CC */" > tmp-stdint.h
 fi
diff --git a/binutils/config/tcl.m4 b/binutils/config/tcl.m4
index 4542a4b23d..c1273a3ed1 100644
--- a/binutils/config/tcl.m4
+++ b/binutils/config/tcl.m4
@@ -1233,7 +1233,7 @@ dnl AC_CHECK_TOOL(AR, ar)
 	    # Check to enable 64-bit flags for compiler/linker
 	    if test "$do64bit" = "yes" ; then
 		if test "$GCC" = "yes" ; then
-		    hpux_arch=`${CC} -dumpmachine`
+		    hpux_arch=`${CC} -dumpmachine | sed -e 's/\r//g'`
 		    case $hpux_arch in
 			hppa64*)
 			    # 64-bit gcc in use.  Fix flags for GNU ld.
diff --git a/binutils/configure b/binutils/configure
index 0090a06bf3..f2bce8591f 100755
--- a/binutils/configure
+++ b/binutils/configure
@@ -1779,9 +1779,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1817,9 +1818,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1855,9 +1857,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1901,9 +1904,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -4348,9 +4352,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -4401,7 +4406,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4471,7 +4476,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4527,7 +4532,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -4584,7 +4589,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -5122,9 +5127,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -5264,9 +5270,9 @@ if test -z "$LD"; then
   if test "$GCC" = yes; then
     case $build in
     *-*-mingw*)
-      gcc_prog_ld=`$CC -print-prog-name=ld 2>&1 | tr -d '\015'` ;;
+      gcc_prog_ld=`$CC -print-prog-name=ld 2>&1 | sed -e 's/\r//g' | tr -d '\015'` ;;
     *)
-      gcc_prog_ld=`$CC -print-prog-name=ld 2>&1` ;;
+      gcc_prog_ld=`$CC -print-prog-name=ld 2>&1 | sed -e 's/\r//g'` ;;
     esac
     case $gcc_prog_ld in
     # Accept absolute paths.
@@ -8371,7 +8377,7 @@ case " $build_configdirs " in
     # For an installed makeinfo, we require it to be from texinfo 4.7 or
     # higher, else we use the "missing" dummy.
     if ${MAKEINFO} --version \
-       | egrep 'texinfo[^0-9]*(4\.([7-9]|[1-9][0-9])|[5-9]|[1-9][0-9])' >/dev/null 2>&1; then
+       | sed -e 's/\r//g' | egrep 'texinfo[^0-9]*(4\.([7-9]|[1-9][0-9])|[5-9]|[1-9][0-9])' >/dev/null 2>&1; then
       :
     else
       MAKEINFO="$MISSING makeinfo"
@@ -10322,9 +10328,9 @@ $as_echo_n "checking for -plugin option... " >&6; }
 plugin_names="liblto_plugin.so liblto_plugin-0.dll cyglto_plugin-0.dll"
 plugin_option=
 for plugin in $plugin_names; do
-  plugin_so=`${CC} ${CFLAGS} --print-prog-name $plugin`
+  plugin_so=`${CC} ${CFLAGS} --print-prog-name $plugin | sed -e 's/\r//g'`
   if test x$plugin_so = x$plugin; then
-    plugin_so=`${CC} ${CFLAGS} --print-file-name $plugin`
+    plugin_so=`${CC} ${CFLAGS} --print-file-name $plugin | sed -e 's/\r//g'`
   fi
   if test x$plugin_so != x$plugin; then
     plugin_option="--plugin $plugin_so"
@@ -11284,7 +11290,7 @@ cat > conftest.c << \EOF
   gcc_yay;
 #endif
 EOF
-if ($GCC_FOR_TARGET -E conftest.c | grep gcc_yay) > /dev/null 2>&1; then
+if ($GCC_FOR_TARGET -E conftest.c | sed -e 's/\r//g' | grep gcc_yay) > /dev/null 2>&1; then
   have_gcc_for_target=yes
 else
   GCC_FOR_TARGET=${ncn_target_tool_prefix}gcc
@@ -11309,7 +11315,7 @@ $as_echo "$ac_cv_path_AR_FOR_TARGET" >&6; }
 $as_echo "no" >&6; }
     fi
   elif test $build != $host && test $have_gcc_for_target = yes; then
-    AR_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=ar`
+    AR_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=ar | sed -e 's/\r//g'`
     test $AR_FOR_TARGET = ar && AR_FOR_TARGET=
     test -n "$AR_FOR_TARGET" && ac_cv_path_AR_FOR_TARGET=$AR_FOR_TARGET
   fi
@@ -11539,7 +11545,7 @@ $as_echo "$ac_cv_path_AS_FOR_TARGET" >&6; }
 $as_echo "no" >&6; }
     fi
   elif test $build != $host && test $have_gcc_for_target = yes; then
-    AS_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=as`
+    AS_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=as | sed -e 's/\r//g'`
     test $AS_FOR_TARGET = as && AS_FOR_TARGET=
     test -n "$AS_FOR_TARGET" && ac_cv_path_AS_FOR_TARGET=$AS_FOR_TARGET
   fi
@@ -11769,7 +11775,7 @@ $as_echo "$ac_cv_path_DLLTOOL_FOR_TARGET" >&6; }
 $as_echo "no" >&6; }
     fi
   elif test $build != $host && test $have_gcc_for_target = yes; then
-    DLLTOOL_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=dlltool`
+    DLLTOOL_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=dlltool | sed -e 's/\r//g'`
     test $DLLTOOL_FOR_TARGET = dlltool && DLLTOOL_FOR_TARGET=
     test -n "$DLLTOOL_FOR_TARGET" && ac_cv_path_DLLTOOL_FOR_TARGET=$DLLTOOL_FOR_TARGET
   fi
@@ -11999,7 +12005,7 @@ $as_echo "$ac_cv_path_LD_FOR_TARGET" >&6; }
 $as_echo "no" >&6; }
     fi
   elif test $build != $host && test $have_gcc_for_target = yes; then
-    LD_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=ld`
+    LD_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=ld | sed -e 's/\r//g'`
     test $LD_FOR_TARGET = ld && LD_FOR_TARGET=
     test -n "$LD_FOR_TARGET" && ac_cv_path_LD_FOR_TARGET=$LD_FOR_TARGET
   fi
@@ -12229,7 +12235,7 @@ $as_echo "$ac_cv_path_LIPO_FOR_TARGET" >&6; }
 $as_echo "no" >&6; }
     fi
   elif test $build != $host && test $have_gcc_for_target = yes; then
-    LIPO_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=lipo`
+    LIPO_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=lipo | sed -e 's/\r//g'`
     test $LIPO_FOR_TARGET = lipo && LIPO_FOR_TARGET=
     test -n "$LIPO_FOR_TARGET" && ac_cv_path_LIPO_FOR_TARGET=$LIPO_FOR_TARGET
   fi
@@ -12459,7 +12465,7 @@ $as_echo "$ac_cv_path_NM_FOR_TARGET" >&6; }
 $as_echo "no" >&6; }
     fi
   elif test $build != $host && test $have_gcc_for_target = yes; then
-    NM_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=nm`
+    NM_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=nm | sed -e 's/\r//g'`
     test $NM_FOR_TARGET = nm && NM_FOR_TARGET=
     test -n "$NM_FOR_TARGET" && ac_cv_path_NM_FOR_TARGET=$NM_FOR_TARGET
   fi
@@ -12689,7 +12695,7 @@ $as_echo "$ac_cv_path_OBJCOPY_FOR_TARGET" >&6; }
 $as_echo "no" >&6; }
     fi
   elif test $build != $host && test $have_gcc_for_target = yes; then
-    OBJCOPY_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=objcopy`
+    OBJCOPY_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=objcopy | sed -e 's/\r//g'`
     test $OBJCOPY_FOR_TARGET = objcopy && OBJCOPY_FOR_TARGET=
     test -n "$OBJCOPY_FOR_TARGET" && ac_cv_path_OBJCOPY_FOR_TARGET=$OBJCOPY_FOR_TARGET
   fi
@@ -12919,7 +12925,7 @@ $as_echo "$ac_cv_path_OBJDUMP_FOR_TARGET" >&6; }
 $as_echo "no" >&6; }
     fi
   elif test $build != $host && test $have_gcc_for_target = yes; then
-    OBJDUMP_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=objdump`
+    OBJDUMP_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=objdump | sed -e 's/\r//g'`
     test $OBJDUMP_FOR_TARGET = objdump && OBJDUMP_FOR_TARGET=
     test -n "$OBJDUMP_FOR_TARGET" && ac_cv_path_OBJDUMP_FOR_TARGET=$OBJDUMP_FOR_TARGET
   fi
@@ -13149,7 +13155,7 @@ $as_echo "$ac_cv_path_RANLIB_FOR_TARGET" >&6; }
 $as_echo "no" >&6; }
     fi
   elif test $build != $host && test $have_gcc_for_target = yes; then
-    RANLIB_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=ranlib`
+    RANLIB_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=ranlib | sed -e 's/\r//g'`
     test $RANLIB_FOR_TARGET = ranlib && RANLIB_FOR_TARGET=
     test -n "$RANLIB_FOR_TARGET" && ac_cv_path_RANLIB_FOR_TARGET=$RANLIB_FOR_TARGET
   fi
@@ -13379,7 +13385,7 @@ $as_echo "$ac_cv_path_READELF_FOR_TARGET" >&6; }
 $as_echo "no" >&6; }
     fi
   elif test $build != $host && test $have_gcc_for_target = yes; then
-    READELF_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=readelf`
+    READELF_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=readelf | sed -e 's/\r//g'`
     test $READELF_FOR_TARGET = readelf && READELF_FOR_TARGET=
     test -n "$READELF_FOR_TARGET" && ac_cv_path_READELF_FOR_TARGET=$READELF_FOR_TARGET
   fi
@@ -13609,7 +13615,7 @@ $as_echo "$ac_cv_path_STRIP_FOR_TARGET" >&6; }
 $as_echo "no" >&6; }
     fi
   elif test $build != $host && test $have_gcc_for_target = yes; then
-    STRIP_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=strip`
+    STRIP_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=strip | sed -e 's/\r//g'`
     test $STRIP_FOR_TARGET = strip && STRIP_FOR_TARGET=
     test -n "$STRIP_FOR_TARGET" && ac_cv_path_STRIP_FOR_TARGET=$STRIP_FOR_TARGET
   fi
@@ -13839,7 +13845,7 @@ $as_echo "$ac_cv_path_WINDRES_FOR_TARGET" >&6; }
 $as_echo "no" >&6; }
     fi
   elif test $build != $host && test $have_gcc_for_target = yes; then
-    WINDRES_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=windres`
+    WINDRES_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=windres | sed -e 's/\r//g'`
     test $WINDRES_FOR_TARGET = windres && WINDRES_FOR_TARGET=
     test -n "$WINDRES_FOR_TARGET" && ac_cv_path_WINDRES_FOR_TARGET=$WINDRES_FOR_TARGET
   fi
@@ -14069,7 +14075,7 @@ $as_echo "$ac_cv_path_WINDMC_FOR_TARGET" >&6; }
 $as_echo "no" >&6; }
     fi
   elif test $build != $host && test $have_gcc_for_target = yes; then
-    WINDMC_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=windmc`
+    WINDMC_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=windmc | sed -e 's/\r//g'`
     test $WINDMC_FOR_TARGET = windmc && WINDMC_FOR_TARGET=
     test -n "$WINDMC_FOR_TARGET" && ac_cv_path_WINDMC_FOR_TARGET=$WINDMC_FOR_TARGET
   fi
diff --git a/binutils/configure.ac b/binutils/configure.ac
index 59f16220e3..1b9c70525f 100644
--- a/binutils/configure.ac
+++ b/binutils/configure.ac
@@ -1302,9 +1302,9 @@ if test -z "$LD"; then
   if test "$GCC" = yes; then
     case $build in
     *-*-mingw*)
-      gcc_prog_ld=`$CC -print-prog-name=ld 2>&1 | tr -d '\015'` ;;
+      gcc_prog_ld=`$CC -print-prog-name=ld 2>&1 | sed -e 's/\r//g' | tr -d '\015'` ;;
     *)
-      gcc_prog_ld=`$CC -print-prog-name=ld 2>&1` ;;
+      gcc_prog_ld=`$CC -print-prog-name=ld 2>&1 | sed -e 's/\r//g'` ;;
     esac
     case $gcc_prog_ld in
     # Accept absolute paths.
@@ -3425,7 +3425,7 @@ changequote(,)
     # For an installed makeinfo, we require it to be from texinfo 4.7 or
     # higher, else we use the "missing" dummy.
     if ${MAKEINFO} --version \
-       | egrep 'texinfo[^0-9]*(4\.([7-9]|[1-9][0-9])|[5-9]|[1-9][0-9])' >/dev/null 2>&1; then
+       | sed -e 's/\r//g' | egrep 'texinfo[^0-9]*(4\.([7-9]|[1-9][0-9])|[5-9]|[1-9][0-9])' >/dev/null 2>&1; then
       :
     else
       MAKEINFO="$MISSING makeinfo"
diff --git a/binutils/depcomp b/binutils/depcomp
index 4e70ff0bbc..55634b091d 100755
--- a/binutils/depcomp
+++ b/binutils/depcomp
@@ -671,6 +671,7 @@ cpp)
   done
 
   "$@" -E \
+    | sed -e 's/\r//g' \
     | sed -n -e '/^# [0-9][0-9]* "\([^"]*\)".*/ s:: \1 \\:p' \
              -e '/^#line [0-9][0-9]* "\([^"]*\)".*/ s:: \1 \\:p' \
     | sed '$ s: \\$::' > "$tmpdepfile"
@@ -717,6 +718,7 @@ msvisualcpp)
     esac
   done
   "$@" -E 2>/dev/null |
+  sed -e 's/\r//g' |
   sed -n '/^#line [0-9][0-9]* "\([^"]*\)"/ s::\1:p' | $cygpath_u | sort -u > "$tmpdepfile"
   rm -f "$depfile"
   echo "$object : \\" > "$depfile"
diff --git a/binutils/gas/configure b/binutils/gas/configure
index 169b44fc16..cc61e614e7 100755
--- a/binutils/gas/configure
+++ b/binutils/gas/configure
@@ -1604,9 +1604,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1641,9 +1642,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1766,7 +1768,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -1839,9 +1841,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -3414,9 +3417,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -3467,7 +3471,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3537,7 +3541,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3593,7 +3597,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -3650,7 +3654,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4039,7 +4043,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -4097,6 +4101,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -4441,7 +4450,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -4458,7 +4467,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -4878,9 +4887,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -4922,7 +4931,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -4953,7 +4962,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -5168,10 +5177,12 @@ else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
   (eval echo "\"\$as_me:$LINENO: $ac_compile\"" >&5)
-  (eval "$ac_compile" 2>conftest.err)
+  (eval "($ac_compile | sed -e 's/\r//g')" 2>conftest.err)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: output\"" >&5)
   cat conftest.out >&5
@@ -5592,7 +5603,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -5654,7 +5665,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|_pic\.a)$'
@@ -5672,7 +5683,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
@@ -5748,9 +5759,9 @@ test -z "$deplibs_check_method" && deplibs_check_method=unknown
 plugin_option=
 plugin_names="liblto_plugin.so liblto_plugin-0.dll cyglto_plugin-0.dll"
 for plugin in $plugin_names; do
-  plugin_so=`${CC} ${CFLAGS} --print-prog-name $plugin`
+  plugin_so=`${CC} ${CFLAGS} --print-prog-name $plugin | sed -e 's/\r//g'`
   if test x$plugin_so = x$plugin; then
-    plugin_so=`${CC} ${CFLAGS} --print-file-name $plugin`
+    plugin_so=`${CC} ${CFLAGS} --print-file-name $plugin | sed -e 's/\r//g'`
   fi
   if test x$plugin_so != x$plugin; then
     plugin_option="--plugin $plugin_so"
@@ -6204,7 +6215,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g' | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[ABCDGIRSTW]' ;;
 esac
@@ -6212,11 +6223,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -6250,7 +6261,7 @@ for ac_symprfx in "" "_"; do
 "     s[1]~prfx {split(s[1],t,\"@\"); print t[1], substr(t[1],length(prfx))}"\
 "     ' prfx=^$ac_symprfx"
   else
-    lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
+    lt_cv_sys_global_symbol_pipe="sed -n -e 's/\r//g' -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
   fi
 
   # Check to see that the pipe works correctly.
@@ -6271,14 +6282,14 @@ int main(){nm_test_var='a';nm_test_func();return(0);}
 _LT_EOF
 
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist\""; } >&5
-  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) 2>&5
+    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist\""; } >&5
+  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s "$nlist"; then
@@ -6299,7 +6310,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | sed -e '"'"'s/\r//g'"'"' | $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -6312,7 +6323,7 @@ lt__PROGRAM__LTX_preloaded_symbols[] =
 {
   { "@PROGRAM@", (void *) 0 },
 _LT_EOF
-	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | $GREP -v main >> conftest.$ac_ext
+	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | sed -e 's/\r//g' | $GREP -v main >> conftest.$ac_ext
 	  cat <<\_LT_EOF >> conftest.$ac_ext
   {0, (void *) 0}
 };
@@ -6335,7 +6346,7 @@ _LT_EOF
 	  LIBS="conftstm.$ac_objext"
 	  CFLAGS="$CFLAGS$lt_prog_compiler_no_builtin_flag"
 	  if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext}; then
@@ -6414,7 +6425,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6433,7 +6444,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo '#line '$LINENO' "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6471,7 +6482,7 @@ s390*-*linux*|s390*-*tpf*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6583,7 +6594,7 @@ sparc*-*solaris*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7116,6 +7127,7 @@ else
 	if test -f libconftest.dylib && test ! -s conftest.err && test $_lt_result = 0; then
 	  lt_cv_apple_cc_single_mod=yes
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err >&5
 	fi
 	rm -rf libconftest.dylib*
@@ -7178,6 +7190,7 @@ _LT_EOF
       if test -f conftest && test ! -s conftest.err && test $_lt_result = 0 && $GREP forced_load conftest 2>&1 >/dev/null; then
 	lt_cv_ld_force_load=yes
       else
+        dos2unix -q conftest.err
 	cat conftest.err >&5
       fi
         rm -f conftest.err libconftest.a conftest conftest.c
@@ -7669,13 +7682,15 @@ compiler_DEFAULT=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -7715,14 +7730,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -7937,7 +7954,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic='-KPIC'
@@ -8068,14 +8085,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works=yes
@@ -8117,10 +8136,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -8173,8 +8193,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8182,6 +8203,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8228,8 +8250,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8237,6 +8260,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8297,7 +8321,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object=no
   enable_shared_with_static_runtimes=no
   export_dynamic_flag_spec=
-  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic=no
   hardcode_direct=no
   hardcode_direct_absolute=no
@@ -8360,7 +8384,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -8386,13 +8410,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -8436,7 +8460,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -8454,9 +8478,9 @@ _LT_EOF
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -8499,7 +8523,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -8530,7 +8554,7 @@ _LT_EOF
 	  compiler_needs_object=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object=yes
@@ -8568,7 +8592,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -8578,7 +8602,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
 
@@ -8590,7 +8614,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -8599,7 +8623,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
@@ -8618,7 +8642,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
 	    archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -8637,7 +8661,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -8681,10 +8705,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -9031,10 +9055,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS -b"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -9115,7 +9140,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -9141,7 +9166,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct=yes
 	hardcode_shlibpath_var=no
 	hardcode_direct_absolute=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
@@ -9210,7 +9235,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -9403,10 +9428,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -9432,6 +9458,7 @@ else
 	  fi
 	  allow_undefined_flag=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -9614,7 +9641,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([A-Za-z]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -9718,7 +9745,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -10081,7 +10108,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -10126,7 +10153,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -10772,7 +10799,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -10878,7 +10905,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -11570,7 +11597,7 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 __GNUC__
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "(^[0-3]$|^__GNUC__$)" >/dev/null 2>&1; then :
 
 else
@@ -11584,7 +11611,7 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 __GNUC__
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "(^[0-4]$|^__GNUC__$)" >/dev/null 2>&1; then :
 
 else
@@ -11599,7 +11626,7 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 __GNUC__
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "(^[0-3]$|^__GNUC__$)" >/dev/null 2>&1; then :
 
 else
@@ -11615,7 +11642,7 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 __GNUC__
 _ACEOF
-if (eval "$ac_cpp_for_build conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp_for_build conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "(^[0-3]$|^__GNUC__$)" >/dev/null 2>&1; then :
 
 else
@@ -11629,7 +11656,7 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 __GNUC__
 _ACEOF
-if (eval "$ac_cpp_for_build conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp_for_build conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "(^[0-4]$|^__GNUC__$)" >/dev/null 2>&1; then :
 
 else
diff --git a/binutils/gold/configure b/binutils/gold/configure
index 5f5b8c3602..492903ae70 100755
--- a/binutils/gold/configure
+++ b/binutils/gold/configure
@@ -1629,9 +1629,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1666,9 +1667,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1791,7 +1793,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -1864,9 +1866,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1910,9 +1913,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2060,9 +2064,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2231,9 +2236,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -3826,9 +3832,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -3879,7 +3886,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3949,7 +3956,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4005,7 +4012,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -4062,7 +4069,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4388,7 +4395,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -4446,6 +4453,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -4790,7 +4802,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -4807,7 +4819,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -5854,9 +5866,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -6166,7 +6179,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -6224,6 +6237,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -6388,9 +6406,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -6551,7 +6570,7 @@ else
 
   am_cv_CXX_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -6609,6 +6628,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -7851,7 +7875,7 @@ invoke();
 _ACEOF
 if ac_fn_c_try_link "$LINENO"; then :
 
-if ${NM} conftest$EXEEXT | grep "__rela\?_iplt_start" >/dev/null 2>&1; then
+if ${NM} conftest$EXEEXT | sed -e 's/\r//g' | grep "__rela\?_iplt_start" >/dev/null 2>&1; then
   gold_cv_lib_glibc_ifunc=both
 else
   gold_cv_lib_glibc_ifunc=dyn
@@ -7899,7 +7923,7 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 __GNUC__
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "(^[0-3]$|^__GNUC__$)" >/dev/null 2>&1; then :
 
 else
@@ -7913,7 +7937,7 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 __GNUC__
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "(^[0-4]$|^__GNUC__$)" >/dev/null 2>&1; then :
 
 else
@@ -7928,7 +7952,7 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 __GNUC__
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "(^[0-3]$|^__GNUC__$)" >/dev/null 2>&1; then :
 
 else
@@ -7944,7 +7968,7 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 __GNUC__
 _ACEOF
-if (eval "$ac_cpp_for_build conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp_for_build conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "(^[0-3]$|^__GNUC__$)" >/dev/null 2>&1; then :
 
 else
@@ -7958,7 +7982,7 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 __GNUC__
 _ACEOF
-if (eval "$ac_cpp_for_build conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp_for_build conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "(^[0-4]$|^__GNUC__$)" >/dev/null 2>&1; then :
 
 else
@@ -8409,7 +8433,7 @@ case $host_os in
 #            endif
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "AX_PTHREAD_ZOS_MISSING" >/dev/null 2>&1; then :
   { $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: IBM z/OS requires -D_OPEN_THREADS or -D_UNIX03_THREADS to enable pthreads support." >&5
 $as_echo "$as_me: WARNING: IBM z/OS requires -D_OPEN_THREADS or -D_UNIX03_THREADS to enable pthreads support." >&2;}
@@ -8479,7 +8503,7 @@ else
 #            endif
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "AX_PTHREAD_CC_IS_CLANG" >/dev/null 2>&1; then :
   ax_cv_PTHREAD_CLANG=yes
 fi
@@ -9049,7 +9073,7 @@ case $host_os in
 #            endif
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "AX_PTHREAD_ZOS_MISSING" >/dev/null 2>&1; then :
   { $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: IBM z/OS requires -D_OPEN_THREADS or -D_UNIX03_THREADS to enable pthreads support." >&5
 $as_echo "$as_me: WARNING: IBM z/OS requires -D_OPEN_THREADS or -D_UNIX03_THREADS to enable pthreads support." >&2;}
@@ -9119,7 +9143,7 @@ else
 #            endif
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "AX_PTHREAD_CC_IS_CLANG" >/dev/null 2>&1; then :
   ax_cv_PTHREAD_CLANG=yes
 fi
diff --git a/binutils/gold/configure.ac b/binutils/gold/configure.ac
index 4f432809b3..1d35baab99 100644
--- a/binutils/gold/configure.ac
+++ b/binutils/gold/configure.ac
@@ -509,7 +509,7 @@ funcptr dispatch (void) __asm__ ("invoke");
 funcptr dispatch (void) { return &func; }]],
 [[invoke();]])
 ], [
-if ${NM} conftest$EXEEXT | grep "__rela\?_iplt_start" >/dev/null 2>&1; then
+if ${NM} conftest$EXEEXT | sed -e 's/\r//g' | grep "__rela\?_iplt_start" >/dev/null 2>&1; then
   gold_cv_lib_glibc_ifunc=both
 else
   gold_cv_lib_glibc_ifunc=dyn
diff --git a/binutils/gprof/configure b/binutils/gprof/configure
index 29025236a6..8a3636bf78 100755
--- a/binutils/gprof/configure
+++ b/binutils/gprof/configure
@@ -1548,9 +1548,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1585,9 +1586,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1710,7 +1712,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -1783,9 +1785,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -3315,9 +3318,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -3368,7 +3372,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3438,7 +3442,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3494,7 +3498,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -3551,7 +3555,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3940,7 +3944,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -3998,6 +4002,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -4342,7 +4351,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -4359,7 +4368,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -4780,9 +4789,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -4824,7 +4833,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -4855,7 +4864,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -5070,10 +5079,12 @@ else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
   (eval echo "\"\$as_me:$LINENO: $ac_compile\"" >&5)
-  (eval "$ac_compile" 2>conftest.err)
+  (eval "($ac_compile | sed -e 's/\r//g')" 2>conftest.err)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: output\"" >&5)
   cat conftest.out >&5
@@ -5494,7 +5505,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -5556,7 +5567,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|_pic\.a)$'
@@ -5574,7 +5585,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
@@ -5650,9 +5661,9 @@ test -z "$deplibs_check_method" && deplibs_check_method=unknown
 plugin_option=
 plugin_names="liblto_plugin.so liblto_plugin-0.dll cyglto_plugin-0.dll"
 for plugin in $plugin_names; do
-  plugin_so=`${CC} ${CFLAGS} --print-prog-name $plugin`
+  plugin_so=`${CC} ${CFLAGS} --print-prog-name $plugin | sed -e 's/\r//g'`
   if test x$plugin_so = x$plugin; then
-    plugin_so=`${CC} ${CFLAGS} --print-file-name $plugin`
+    plugin_so=`${CC} ${CFLAGS} --print-file-name $plugin | sed -e 's/\r//g'`
   fi
   if test x$plugin_so != x$plugin; then
     plugin_option="--plugin $plugin_so"
@@ -6106,7 +6117,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[ABCDGIRSTW]' ;;
 esac
@@ -6114,11 +6125,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -6152,7 +6163,7 @@ for ac_symprfx in "" "_"; do
 "     s[1]~prfx {split(s[1],t,\"@\"); print t[1], substr(t[1],length(prfx))}"\
 "     ' prfx=^$ac_symprfx"
   else
-    lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
+    lt_cv_sys_global_symbol_pipe="sed -n -e 's/\r//g' -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
   fi
 
   # Check to see that the pipe works correctly.
@@ -6173,14 +6184,14 @@ int main(){nm_test_var='a';nm_test_func();return(0);}
 _LT_EOF
 
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist\""; } >&5
-  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) 2>&5
+    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist\""; } >&5
+  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s "$nlist"; then
@@ -6201,7 +6212,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | sed -e '"'"'s/\r//g'"'"' | $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -6214,7 +6225,7 @@ lt__PROGRAM__LTX_preloaded_symbols[] =
 {
   { "@PROGRAM@", (void *) 0 },
 _LT_EOF
-	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | $GREP -v main >> conftest.$ac_ext
+	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | sed -e 's/\r//g' | $GREP -v main >> conftest.$ac_ext
 	  cat <<\_LT_EOF >> conftest.$ac_ext
   {0, (void *) 0}
 };
@@ -6237,7 +6248,7 @@ _LT_EOF
 	  LIBS="conftstm.$ac_objext"
 	  CFLAGS="$CFLAGS$lt_prog_compiler_no_builtin_flag"
 	  if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext}; then
@@ -6316,7 +6327,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6335,7 +6346,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo '#line '$LINENO' "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6373,7 +6384,7 @@ s390*-*linux*|s390*-*tpf*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6485,7 +6496,7 @@ sparc*-*solaris*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7018,6 +7029,7 @@ else
 	if test -f libconftest.dylib && test ! -s conftest.err && test $_lt_result = 0; then
 	  lt_cv_apple_cc_single_mod=yes
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err >&5
 	fi
 	rm -rf libconftest.dylib*
@@ -7080,6 +7092,7 @@ _LT_EOF
       if test -f conftest && test ! -s conftest.err && test $_lt_result = 0 && $GREP forced_load conftest 2>&1 >/dev/null; then
 	lt_cv_ld_force_load=yes
       else
+        dos2unix -q conftest.err
 	cat conftest.err >&5
       fi
         rm -f conftest.err libconftest.a conftest conftest.c
@@ -7571,13 +7584,15 @@ compiler_DEFAULT=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -7617,14 +7632,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -7839,7 +7856,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic='-KPIC'
@@ -7970,14 +7987,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works=yes
@@ -8019,10 +8038,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -8075,8 +8095,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8084,6 +8105,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8130,8 +8152,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8139,6 +8162,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8199,7 +8223,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object=no
   enable_shared_with_static_runtimes=no
   export_dynamic_flag_spec=
-  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic=no
   hardcode_direct=no
   hardcode_direct_absolute=no
@@ -8262,7 +8286,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -8288,13 +8312,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -8338,7 +8362,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -8356,9 +8380,9 @@ _LT_EOF
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -8401,7 +8425,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -8432,7 +8456,7 @@ _LT_EOF
 	  compiler_needs_object=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object=yes
@@ -8470,7 +8494,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -8480,7 +8504,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
 
@@ -8492,7 +8516,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -8501,7 +8525,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
@@ -8520,7 +8544,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
 	    archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -8539,7 +8563,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -8583,10 +8607,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -8933,10 +8957,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS -b"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -9017,7 +9042,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -9043,7 +9068,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct=yes
 	hardcode_shlibpath_var=no
 	hardcode_direct_absolute=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
@@ -9112,7 +9137,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -9305,10 +9330,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -9334,6 +9360,7 @@ else
 	  fi
 	  allow_undefined_flag=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -9516,7 +9543,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([A-Za-z]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -9620,7 +9647,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -9983,7 +10010,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -10028,7 +10055,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -10674,7 +10701,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -10780,7 +10807,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -11872,7 +11899,7 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 __GNUC__
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "(^[0-3]$|^__GNUC__$)" >/dev/null 2>&1; then :
 
 else
@@ -11886,7 +11913,7 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 __GNUC__
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "(^[0-4]$|^__GNUC__$)" >/dev/null 2>&1; then :
 
 else
@@ -11901,7 +11928,7 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 __GNUC__
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "(^[0-3]$|^__GNUC__$)" >/dev/null 2>&1; then :
 
 else
@@ -11917,7 +11944,7 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 __GNUC__
 _ACEOF
-if (eval "$ac_cpp_for_build conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp_for_build conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "(^[0-3]$|^__GNUC__$)" >/dev/null 2>&1; then :
 
 else
@@ -11931,7 +11958,7 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 __GNUC__
 _ACEOF
-if (eval "$ac_cpp_for_build conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp_for_build conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "(^[0-4]$|^__GNUC__$)" >/dev/null 2>&1; then :
 
 else
diff --git a/binutils/gprofng/configure b/binutils/gprofng/configure
index f69f294733..7909ba2282 100755
--- a/binutils/gprofng/configure
+++ b/binutils/gprofng/configure
@@ -1575,9 +1575,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1612,9 +1613,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1737,7 +1739,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -1810,9 +1812,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1848,9 +1851,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1960,9 +1964,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1998,9 +2003,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -3547,9 +3553,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -3600,7 +3607,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3670,7 +3677,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3726,7 +3733,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -3783,7 +3790,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4109,7 +4116,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -4167,6 +4174,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -4511,7 +4523,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -4528,7 +4540,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -4982,9 +4994,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -5294,7 +5307,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -5352,6 +5365,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -5516,9 +5534,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -5679,7 +5698,7 @@ else
 
   am_cv_CXX_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -5737,6 +5756,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -6426,9 +6450,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -6470,7 +6494,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -6501,7 +6525,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -6716,10 +6740,12 @@ else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
   (eval echo "\"\$as_me:$LINENO: $ac_compile\"" >&5)
-  (eval "$ac_compile" 2>conftest.err)
+  (eval "($ac_compile | sed -e 's/\r//g')" 2>conftest.err)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: output\"" >&5)
   cat conftest.out >&5
@@ -7140,7 +7166,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -7202,7 +7228,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|_pic\.a)$'
@@ -7220,7 +7246,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
@@ -7296,9 +7322,9 @@ test -z "$deplibs_check_method" && deplibs_check_method=unknown
 plugin_option=
 plugin_names="liblto_plugin.so liblto_plugin-0.dll cyglto_plugin-0.dll"
 for plugin in $plugin_names; do
-  plugin_so=`${CC} ${CFLAGS} --print-prog-name $plugin`
+  plugin_so=`${CC} ${CFLAGS} --print-prog-name $plugin | sed -e 's/\r//g'`
   if test x$plugin_so = x$plugin; then
-    plugin_so=`${CC} ${CFLAGS} --print-file-name $plugin`
+    plugin_so=`${CC} ${CFLAGS} --print-file-name $plugin | sed -e 's/\r//g'`
   fi
   if test x$plugin_so != x$plugin; then
     plugin_option="--plugin $plugin_so"
@@ -7752,7 +7778,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[ABCDGIRSTW]' ;;
 esac
@@ -7760,11 +7786,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -7798,7 +7824,7 @@ for ac_symprfx in "" "_"; do
 "     s[1]~prfx {split(s[1],t,\"@\"); print t[1], substr(t[1],length(prfx))}"\
 "     ' prfx=^$ac_symprfx"
   else
-    lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
+    lt_cv_sys_global_symbol_pipe="sed -n -e 's/\r//g' -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
   fi
 
   # Check to see that the pipe works correctly.
@@ -7819,14 +7845,14 @@ int main(){nm_test_var='a';nm_test_func();return(0);}
 _LT_EOF
 
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist\""; } >&5
-  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) 2>&5
+    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist\""; } >&5
+  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s "$nlist"; then
@@ -7847,7 +7873,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | sed -e '"'"'s/\r//g'"'"' | $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -7860,7 +7886,7 @@ lt__PROGRAM__LTX_preloaded_symbols[] =
 {
   { "@PROGRAM@", (void *) 0 },
 _LT_EOF
-	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | $GREP -v main >> conftest.$ac_ext
+	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | sed -e 's/\r//g' | $GREP -v main >> conftest.$ac_ext
 	  cat <<\_LT_EOF >> conftest.$ac_ext
   {0, (void *) 0}
 };
@@ -7883,7 +7909,7 @@ _LT_EOF
 	  LIBS="conftstm.$ac_objext"
 	  CFLAGS="$CFLAGS$lt_prog_compiler_no_builtin_flag"
 	  if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext}; then
@@ -7962,7 +7988,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7981,7 +8007,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo '#line '$LINENO' "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -8019,7 +8045,7 @@ s390*-*linux*|s390*-*tpf*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -8131,7 +8157,7 @@ sparc*-*solaris*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -8664,6 +8690,7 @@ else
 	if test -f libconftest.dylib && test ! -s conftest.err && test $_lt_result = 0; then
 	  lt_cv_apple_cc_single_mod=yes
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err >&5
 	fi
 	rm -rf libconftest.dylib*
@@ -8726,6 +8753,7 @@ _LT_EOF
       if test -f conftest && test ! -s conftest.err && test $_lt_result = 0 && $GREP forced_load conftest 2>&1 >/dev/null; then
 	lt_cv_ld_force_load=yes
       else
+        dos2unix -q conftest.err
 	cat conftest.err >&5
       fi
         rm -f conftest.err libconftest.a conftest conftest.c
@@ -9188,13 +9216,15 @@ compiler_DEFAULT=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -9234,14 +9264,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -9456,7 +9488,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic='-KPIC'
@@ -9587,14 +9619,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works=yes
@@ -9636,10 +9670,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -9692,8 +9727,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -9701,6 +9737,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -9747,8 +9784,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -9756,6 +9794,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -9816,7 +9855,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object=no
   enable_shared_with_static_runtimes=no
   export_dynamic_flag_spec=
-  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic=no
   hardcode_direct=no
   hardcode_direct_absolute=no
@@ -9879,7 +9918,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -9905,13 +9944,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -9955,7 +9994,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -9973,9 +10012,9 @@ _LT_EOF
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -10018,7 +10057,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -10049,7 +10088,7 @@ _LT_EOF
 	  compiler_needs_object=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object=yes
@@ -10087,7 +10126,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -10097,7 +10136,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
 
@@ -10109,7 +10148,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -10118,7 +10157,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
@@ -10137,7 +10176,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
 	    archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -10156,7 +10195,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -10200,10 +10239,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -10550,10 +10589,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS -b"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -10634,7 +10674,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -10660,7 +10700,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct=yes
 	hardcode_shlibpath_var=no
 	hardcode_direct_absolute=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
@@ -10729,7 +10769,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -10922,10 +10962,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -10951,6 +10992,7 @@ else
 	  fi
 	  allow_undefined_flag=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -11133,7 +11175,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([A-Za-z]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -11237,7 +11279,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -11600,7 +11642,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -11645,7 +11687,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -12291,7 +12333,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -12397,7 +12439,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -12753,13 +12795,15 @@ compiler=$CC
   # save warnings/boilerplate of simple test code
   ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
   ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -12825,9 +12869,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -12869,7 +12913,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -12900,7 +12944,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -12934,7 +12978,7 @@ with_gnu_ld=$lt_cv_prog_gnu_ld
         wlarc='${wl}'
 
         # ancient GNU ld didn't support --whole-archive et. al.
-        if eval "`$CC -print-prog-name=ld` --help 2>&1" |
+        if eval "`$CC -print-prog-name=ld | sed -e 's/\r//g'` --help 2>&1" | sed -e 's/\r//g' |
 	  $GREP 'no-whole-archive' > /dev/null; then
           whole_archive_flag_spec_CXX="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
         else
@@ -12955,7 +12999,7 @@ with_gnu_ld=$lt_cv_prog_gnu_ld
       # Commands to make compiler produce verbose output that lists
       # what "hidden" libraries, object files and flags are used when
       # linking a shared library.
-      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 
     else
       GXX=no
@@ -13157,7 +13201,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
         ;;
 
       beos*)
-	if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	  allow_undefined_flag_CXX=unsupported
 	  # Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	  # support --undefined.  This deserves some investigation.  FIXME
@@ -13185,7 +13229,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
         always_export_symbols_CXX=no
         enable_shared_with_static_runtimes_CXX=yes
 
-        if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+        if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
           archive_cmds_CXX='$CC -shared -nostdlib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
           # If the export-symbols file already is a .def file (1st line
           # is EXPORTS), use it as is; otherwise, prepend...
@@ -13301,7 +13345,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
             # explicitly linking system object files so we need to strip them
             # from the output so that they don't get included in the library
             # dependencies.
-            output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | $EGREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+            output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | sed -e '"'"'s/\r//g'"'"' | $EGREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
             ;;
           *)
             if test "$GXX" = yes; then
@@ -13366,7 +13410,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | $GREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+	    output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | sed -e '"'"'s/\r//g'"'"' | $GREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
 	    ;;
           *)
 	    if test "$GXX" = yes; then
@@ -13451,7 +13495,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`$CC $CFLAGS -v conftest.$objext -o libconftest$shared_ext 2>&1 | $GREP "ld"`; rm -f libconftest$shared_ext; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+	    output_verbose_link_cmd='templist=`$CC $CFLAGS -v conftest.$objext -o libconftest$shared_ext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP "ld"`; rm -f libconftest$shared_ext; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
 
 	    hardcode_libdir_flag_spec_CXX='${wl}-rpath,$libdir'
 	    export_dynamic_flag_spec_CXX='${wl}--export-dynamic'
@@ -13466,7 +13510,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # version 8.0 and above of icpc choke on multiply defined symbols
 	    # if we add $predep_objects and $postdep_objects, however 7.1 and
 	    # earlier do not add the objects themselves.
-	    case `$CC -V 2>&1` in
+	    case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	      *"Version 7."*)
 	        archive_cmds_CXX='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname -o $lib'
 		archive_expsym_cmds_CXX='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -13487,7 +13531,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    ;;
           pgCC* | pgcpp*)
             # Portland Group C++ compiler
-	    case `$CC -V` in
+	    case `$CC -V | sed -e 's/\r//g'` in
 	    *pgCC\ [1-5].* | *pgcpp\ [1-5].*)
 	      prelink_cmds_CXX='tpldir=Template.dir~
 		rm -rf $tpldir~
@@ -13534,7 +13578,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP "ld"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld .*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "X$list" | $Xsed'
+	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP "ld"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld .*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "X$list" | $Xsed'
 	    ;;
 	  xl* | mpixl* | bgxl*)
 	    # IBM XL 8.0 on PPC, with GNU ld
@@ -13549,7 +13593,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    fi
 	    ;;
 	  *)
-	    case `$CC -V 2>&1 | sed 5q` in
+	    case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	    *Sun\ C*)
 	      # Sun C++ 5.9
 	      no_undefined_flag_CXX=' -zdefs'
@@ -13599,7 +13643,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	;;
 
       netbsd*)
-        if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+        if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	  archive_cmds_CXX='$LD -Bshareable  -o $lib $predep_objects $libobjs $deplibs $postdep_objects $linker_flags'
 	  wlarc=
 	  hardcode_libdir_flag_spec_CXX='-R$libdir'
@@ -13607,7 +13651,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	  hardcode_shlibpath_var_CXX=no
 	fi
 	# Workaround some broken pre-1.5 toolchains
-	output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP conftest.$objext | $SED -e "s:-lgcc -lc -lgcc::"'
+	output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP conftest.$objext | $SED -e "s:-lgcc -lc -lgcc::"'
 	;;
 
       *nto* | *qnx*)
@@ -13626,7 +13670,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	  hardcode_direct_absolute_CXX=yes
 	  archive_cmds_CXX='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $lib'
 	  hardcode_libdir_flag_spec_CXX='${wl}-rpath,$libdir'
-	  if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	    archive_expsym_cmds_CXX='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-retain-symbols-file,$export_symbols -o $lib'
 	    export_dynamic_flag_spec_CXX='${wl}-E'
 	    whole_archive_flag_spec_CXX="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
@@ -13690,7 +13734,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP "ld" | $GREP -v "ld:"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld.*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP "ld" | $GREP -v "ld:"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld.*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
 	    ;;
 	  *)
 	    if test "$GXX" = yes && test "$with_gnu_ld" = no; then
@@ -13710,7 +13754,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	      # Commands to make compiler produce verbose output that lists
 	      # what "hidden" libraries, object files and flags are used when
 	      # linking a shared library.
-	      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+	      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 
 	    else
 	      # FIXME: insert proper C++ library support
@@ -13786,7 +13830,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # GNU C++ compiler with Solaris linker
 	    if test "$GXX" = yes && test "$with_gnu_ld" = no; then
 	      no_undefined_flag_CXX=' ${wl}-z ${wl}defs'
-	      if $CC --version | $GREP -v '^2\.7' > /dev/null; then
+	      if $CC --version | sed -e 's/\r//g' | $GREP -v '^2\.7' > /dev/null; then
 	        archive_cmds_CXX='$CC -shared -nostdlib $LDFLAGS $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-h $wl$soname -o $lib'
 	        archive_expsym_cmds_CXX='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 		  $CC -shared -nostdlib ${wl}-M $wl$lib.exp -o $lib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags~$RM $lib.exp'
@@ -13794,7 +13838,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	        # Commands to make compiler produce verbose output that lists
 	        # what "hidden" libraries, object files and flags are used when
 	        # linking a shared library.
-	        output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+	        output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 	      else
 	        # g++ 2.7 appears to require `-G' NOT `-shared' on this
 	        # platform.
@@ -13805,7 +13849,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	        # Commands to make compiler produce verbose output that lists
 	        # what "hidden" libraries, object files and flags are used when
 	        # linking a shared library.
-	        output_verbose_link_cmd='$CC -G $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+	        output_verbose_link_cmd='$CC -G $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 	      fi
 
 	      hardcode_libdir_flag_spec_CXX='${wl}-R $wl$libdir'
@@ -13925,7 +13969,7 @@ private:
 _LT_EOF
 
 if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -14021,7 +14065,7 @@ interix[3-9]*)
   ;;
 
 linux*)
-  case `$CC -V 2>&1 | sed 5q` in
+  case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
   *Sun\ C*)
     # Sun C++ 5.9
 
@@ -14311,7 +14355,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	    lt_prog_compiler_static_CXX='-qstaticlink'
 	    ;;
 	  *)
-	    case `$CC -V 2>&1 | sed 5q` in
+	    case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	    *Sun\ C*)
 	      # Sun C++ 5.9
 	      lt_prog_compiler_pic_CXX='-KPIC'
@@ -14460,14 +14504,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works_CXX=yes
@@ -14506,10 +14552,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -14559,8 +14606,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -14568,6 +14616,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o_CXX=yes
@@ -14611,8 +14660,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -14620,6 +14670,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o_CXX=yes
@@ -14669,27 +14720,27 @@ fi
     { $as_echo "$as_me:${as_lineno-$LINENO}: checking whether the $compiler linker ($LD) supports shared libraries" >&5
 $as_echo_n "checking whether the $compiler linker ($LD) supports shared libraries... " >&6; }
 
-  export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   case $host_os in
   aix[4-9]*)
     # If we're using GNU nm, then we don't want the "-C" option.
     # -C means demangle to AIX nm, but means don't demangle with GNU nm
     # Also, AIX nm treats weak defined symbols like other global defined
     # symbols, whereas GNU nm marks them as "W".
-    if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-      export_symbols_cmds_CXX='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+    if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+      export_symbols_cmds_CXX='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
     else
-      export_symbols_cmds_CXX='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+      export_symbols_cmds_CXX='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
     fi
     ;;
   pw32*)
     export_symbols_cmds_CXX="$ltdll_cmds"
   ;;
   cygwin* | mingw* | cegcc*)
-    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/;/^.*[ ]__nm__/s/^.*[ ]__nm__\([^ ]*\)[ ][^ ]*/\1 DATA/;/^I[ ]/d;/^[AITW][ ]/s/.* //'\'' | sort | uniq > $export_symbols'
+    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/;/^.*[ ]__nm__/s/^.*[ ]__nm__\([^ ]*\)[ ][^ ]*/\1 DATA/;/^I[ ]/d;/^[AITW][ ]/s/.* //'\'' | sort | uniq > $export_symbols'
   ;;
   *)
-    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   ;;
   esac
   exclude_expsyms_CXX='_GLOBAL_OFFSET_TABLE_|_GLOBAL__F[ID]_.*'
@@ -14731,10 +14782,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -14760,6 +14812,7 @@ else
 	  fi
 	  allow_undefined_flag_CXX=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -14889,7 +14942,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -15250,7 +15303,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -15295,7 +15348,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -15907,7 +15960,7 @@ case $host_os in
 #            endif
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "AX_PTHREAD_ZOS_MISSING" >/dev/null 2>&1; then :
   { $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: IBM z/OS requires -D_OPEN_THREADS or -D_UNIX03_THREADS to enable pthreads support." >&5
 $as_echo "$as_me: WARNING: IBM z/OS requires -D_OPEN_THREADS or -D_UNIX03_THREADS to enable pthreads support." >&2;}
@@ -15977,7 +16030,7 @@ else
 #            endif
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "AX_PTHREAD_CC_IS_CLANG" >/dev/null 2>&1; then :
   ax_cv_PTHREAD_CLANG=yes
 fi
@@ -16615,7 +16668,7 @@ if ${bfd_cv_ld_as_needed+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   bfd_cv_ld_as_needed=no
-	if $LD --help 2>/dev/null | grep as-needed > /dev/null; then
+	if $LD --help 2>/dev/null | sed -e 's/\r//g' | grep as-needed > /dev/null; then
 		bfd_cv_ld_as_needed=yes
 	fi
 
@@ -16763,7 +16816,7 @@ test -n "$MAKEINFO" || MAKEINFO=""@echo makeinfo missing; true""
 $as_echo "$as_me: WARNING: gprofng: makeinfo is missing. Info documentation will not be built." >&2;}
       ;;
     *)
-      case x"`$MAKEINFO --version | grep 'GNU texinfo'`" in
+      case x"`$MAKEINFO --version | sed -e 's/\r//g' | grep 'GNU texinfo'`" in
 	x*\ [1-5].*|x*\ 6.[0-4].* )
 	  { $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: gprofng: $MAKEINFO is too old. Info documentation will not be built." >&5
 $as_echo "$as_me: WARNING: gprofng: $MAKEINFO is too old. Info documentation will not be built." >&2;}
diff --git a/binutils/gprofng/configure.ac b/binutils/gprofng/configure.ac
index e945310960..bf46908a59 100644
--- a/binutils/gprofng/configure.ac
+++ b/binutils/gprofng/configure.ac
@@ -162,7 +162,7 @@ fi
 # Check if linker supports --as-needed and --no-as-needed options.
 AC_CACHE_CHECK(linker --as-needed support, bfd_cv_ld_as_needed,
 	[bfd_cv_ld_as_needed=no
-	if $LD --help 2>/dev/null | grep as-needed > /dev/null; then
+	if $LD --help 2>/dev/null | sed -e 's/\r//g' | grep as-needed > /dev/null; then
 		bfd_cv_ld_as_needed=yes
 	fi
 	])
@@ -193,7 +193,7 @@ if test $cross_compiling = no; then
       AC_MSG_WARN([gprofng: makeinfo is missing. Info documentation will not be built.])
       ;;
     *)
-      case x"`$MAKEINFO --version | grep 'GNU texinfo'`" in
+      case x"`$MAKEINFO --version | sed -e 's/\r//g' | grep 'GNU texinfo'`" in
 	x*\ [[1-5]].*|x*\ 6.[[0-4]].* )
 	  AC_MSG_WARN([gprofng: $MAKEINFO is too old. Info documentation will not be built.])
 	  MAKEINFO="@echo $MAKEINFO is too old, 6.5 or newer required; true"
diff --git a/binutils/gprofng/libcollector/configure b/binutils/gprofng/libcollector/configure
index 69ec84bdcb..8ec3909c74 100755
--- a/binutils/gprofng/libcollector/configure
+++ b/binutils/gprofng/libcollector/configure
@@ -1533,9 +1533,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1570,9 +1571,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1695,7 +1697,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -1768,9 +1770,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1806,9 +1809,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1918,9 +1922,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1956,9 +1961,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -3465,9 +3471,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -3518,7 +3525,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3588,7 +3595,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3644,7 +3651,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -3701,7 +3708,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4027,7 +4034,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -4085,6 +4092,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -4429,7 +4441,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -4446,7 +4458,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -4900,9 +4912,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -5212,7 +5225,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -5270,6 +5283,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -5434,9 +5452,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -5597,7 +5616,7 @@ else
 
   am_cv_CXX_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -5655,6 +5674,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -6239,9 +6263,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -6283,7 +6307,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -6314,7 +6338,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -6529,10 +6553,12 @@ else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
   (eval echo "\"\$as_me:$LINENO: $ac_compile\"" >&5)
-  (eval "$ac_compile" 2>conftest.err)
+  (eval "($ac_compile | sed -e 's/\r//g')" 2>conftest.err)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: output\"" >&5)
   cat conftest.out >&5
@@ -6953,7 +6979,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -7015,7 +7041,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|_pic\.a)$'
@@ -7033,7 +7059,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
@@ -7109,9 +7135,9 @@ test -z "$deplibs_check_method" && deplibs_check_method=unknown
 plugin_option=
 plugin_names="liblto_plugin.so liblto_plugin-0.dll cyglto_plugin-0.dll"
 for plugin in $plugin_names; do
-  plugin_so=`${CC} ${CFLAGS} --print-prog-name $plugin`
+  plugin_so=`${CC} ${CFLAGS} --print-prog-name $plugin | sed -e 's/\r//g'`
   if test x$plugin_so = x$plugin; then
-    plugin_so=`${CC} ${CFLAGS} --print-file-name $plugin`
+    plugin_so=`${CC} ${CFLAGS} --print-file-name $plugin | sed -e 's/\r//g'`
   fi
   if test x$plugin_so != x$plugin; then
     plugin_option="--plugin $plugin_so"
@@ -7565,7 +7591,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[ABCDGIRSTW]' ;;
 esac
@@ -7573,11 +7599,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -7611,7 +7637,7 @@ for ac_symprfx in "" "_"; do
 "     s[1]~prfx {split(s[1],t,\"@\"); print t[1], substr(t[1],length(prfx))}"\
 "     ' prfx=^$ac_symprfx"
   else
-    lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
+    lt_cv_sys_global_symbol_pipe="sed -n -e 's/\r//g' -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
   fi
 
   # Check to see that the pipe works correctly.
@@ -7632,14 +7658,14 @@ int main(){nm_test_var='a';nm_test_func();return(0);}
 _LT_EOF
 
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist\""; } >&5
-  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) 2>&5
+    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist\""; } >&5
+  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s "$nlist"; then
@@ -7660,7 +7686,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | sed -e '"'"'s/\r//g'"'"' | $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -7673,7 +7699,7 @@ lt__PROGRAM__LTX_preloaded_symbols[] =
 {
   { "@PROGRAM@", (void *) 0 },
 _LT_EOF
-	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | $GREP -v main >> conftest.$ac_ext
+	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | sed -e 's/\r//g' | $GREP -v main >> conftest.$ac_ext
 	  cat <<\_LT_EOF >> conftest.$ac_ext
   {0, (void *) 0}
 };
@@ -7696,7 +7722,7 @@ _LT_EOF
 	  LIBS="conftstm.$ac_objext"
 	  CFLAGS="$CFLAGS$lt_prog_compiler_no_builtin_flag"
 	  if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext}; then
@@ -7775,7 +7801,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7794,7 +7820,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo '#line '$LINENO' "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7832,7 +7858,7 @@ s390*-*linux*|s390*-*tpf*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7944,7 +7970,7 @@ sparc*-*solaris*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -8477,6 +8503,7 @@ else
 	if test -f libconftest.dylib && test ! -s conftest.err && test $_lt_result = 0; then
 	  lt_cv_apple_cc_single_mod=yes
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err >&5
 	fi
 	rm -rf libconftest.dylib*
@@ -8539,6 +8566,7 @@ _LT_EOF
       if test -f conftest && test ! -s conftest.err && test $_lt_result = 0 && $GREP forced_load conftest 2>&1 >/dev/null; then
 	lt_cv_ld_force_load=yes
       else
+        dos2unix -q conftest.err
 	cat conftest.err >&5
       fi
         rm -f conftest.err libconftest.a conftest conftest.c
@@ -9031,13 +9059,15 @@ compiler_DEFAULT=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -9077,14 +9107,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -9299,7 +9331,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic='-KPIC'
@@ -9430,14 +9462,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works=yes
@@ -9479,10 +9513,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -9535,8 +9570,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -9544,6 +9580,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -9590,8 +9627,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -9599,6 +9637,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -9659,7 +9698,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object=no
   enable_shared_with_static_runtimes=no
   export_dynamic_flag_spec=
-  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic=no
   hardcode_direct=no
   hardcode_direct_absolute=no
@@ -9722,7 +9761,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -9748,13 +9787,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -9798,7 +9837,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -9816,9 +9855,9 @@ _LT_EOF
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -9861,7 +9900,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -9892,7 +9931,7 @@ _LT_EOF
 	  compiler_needs_object=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object=yes
@@ -9930,7 +9969,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -9940,7 +9979,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
 
@@ -9952,7 +9991,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9961,7 +10000,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
@@ -9980,7 +10019,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
 	    archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -9999,7 +10038,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -10043,10 +10082,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -10393,10 +10432,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS -b"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -10477,7 +10517,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -10503,7 +10543,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct=yes
 	hardcode_shlibpath_var=no
 	hardcode_direct_absolute=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
@@ -10572,7 +10612,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -10765,10 +10805,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -10794,6 +10835,7 @@ else
 	  fi
 	  allow_undefined_flag=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -10976,7 +11018,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([A-Za-z]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -11080,7 +11122,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -11443,7 +11485,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -11488,7 +11530,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -12134,7 +12176,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -12240,7 +12282,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -12596,13 +12638,15 @@ compiler=$CC
   # save warnings/boilerplate of simple test code
   ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
   ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -12668,9 +12712,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -12712,7 +12756,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -12743,7 +12787,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -12777,7 +12821,7 @@ with_gnu_ld=$lt_cv_prog_gnu_ld
         wlarc='${wl}'
 
         # ancient GNU ld didn't support --whole-archive et. al.
-        if eval "`$CC -print-prog-name=ld` --help 2>&1" |
+        if eval "`$CC -print-prog-name=ld | sed -e 's/\r//g'` --help 2>&1" | sed -e 's/\r//g' |
 	  $GREP 'no-whole-archive' > /dev/null; then
           whole_archive_flag_spec_CXX="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
         else
@@ -12798,7 +12842,7 @@ with_gnu_ld=$lt_cv_prog_gnu_ld
       # Commands to make compiler produce verbose output that lists
       # what "hidden" libraries, object files and flags are used when
       # linking a shared library.
-      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 
     else
       GXX=no
@@ -13000,7 +13044,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
         ;;
 
       beos*)
-	if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	  allow_undefined_flag_CXX=unsupported
 	  # Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	  # support --undefined.  This deserves some investigation.  FIXME
@@ -13028,7 +13072,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
         always_export_symbols_CXX=no
         enable_shared_with_static_runtimes_CXX=yes
 
-        if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+        if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
           archive_cmds_CXX='$CC -shared -nostdlib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
           # If the export-symbols file already is a .def file (1st line
           # is EXPORTS), use it as is; otherwise, prepend...
@@ -13144,7 +13188,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
             # explicitly linking system object files so we need to strip them
             # from the output so that they don't get included in the library
             # dependencies.
-            output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | $EGREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+            output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | sed -e '"'"'s/\r//g'"'"' | $EGREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
             ;;
           *)
             if test "$GXX" = yes; then
@@ -13209,7 +13253,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | $GREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+	    output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | sed -e '"'"'s/\r//g'"'"' | $GREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
 	    ;;
           *)
 	    if test "$GXX" = yes; then
@@ -13294,7 +13338,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`$CC $CFLAGS -v conftest.$objext -o libconftest$shared_ext 2>&1 | $GREP "ld"`; rm -f libconftest$shared_ext; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+	    output_verbose_link_cmd='templist=`$CC $CFLAGS -v conftest.$objext -o libconftest$shared_ext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP "ld"`; rm -f libconftest$shared_ext; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
 
 	    hardcode_libdir_flag_spec_CXX='${wl}-rpath,$libdir'
 	    export_dynamic_flag_spec_CXX='${wl}--export-dynamic'
@@ -13309,7 +13353,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # version 8.0 and above of icpc choke on multiply defined symbols
 	    # if we add $predep_objects and $postdep_objects, however 7.1 and
 	    # earlier do not add the objects themselves.
-	    case `$CC -V 2>&1` in
+	    case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	      *"Version 7."*)
 	        archive_cmds_CXX='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname -o $lib'
 		archive_expsym_cmds_CXX='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -13330,7 +13374,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    ;;
           pgCC* | pgcpp*)
             # Portland Group C++ compiler
-	    case `$CC -V` in
+	    case `$CC -V | sed -e 's/\r//g'` in
 	    *pgCC\ [1-5].* | *pgcpp\ [1-5].*)
 	      prelink_cmds_CXX='tpldir=Template.dir~
 		rm -rf $tpldir~
@@ -13377,7 +13421,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP "ld"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld .*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "X$list" | $Xsed'
+	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP "ld"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld .*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "X$list" | $Xsed'
 	    ;;
 	  xl* | mpixl* | bgxl*)
 	    # IBM XL 8.0 on PPC, with GNU ld
@@ -13392,7 +13436,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    fi
 	    ;;
 	  *)
-	    case `$CC -V 2>&1 | sed 5q` in
+	    case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	    *Sun\ C*)
 	      # Sun C++ 5.9
 	      no_undefined_flag_CXX=' -zdefs'
@@ -13442,7 +13486,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	;;
 
       netbsd*)
-        if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+        if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	  archive_cmds_CXX='$LD -Bshareable  -o $lib $predep_objects $libobjs $deplibs $postdep_objects $linker_flags'
 	  wlarc=
 	  hardcode_libdir_flag_spec_CXX='-R$libdir'
@@ -13450,7 +13494,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	  hardcode_shlibpath_var_CXX=no
 	fi
 	# Workaround some broken pre-1.5 toolchains
-	output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP conftest.$objext | $SED -e "s:-lgcc -lc -lgcc::"'
+	output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP conftest.$objext | $SED -e "s:-lgcc -lc -lgcc::"'
 	;;
 
       *nto* | *qnx*)
@@ -13469,7 +13513,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	  hardcode_direct_absolute_CXX=yes
 	  archive_cmds_CXX='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $lib'
 	  hardcode_libdir_flag_spec_CXX='${wl}-rpath,$libdir'
-	  if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	    archive_expsym_cmds_CXX='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-retain-symbols-file,$export_symbols -o $lib'
 	    export_dynamic_flag_spec_CXX='${wl}-E'
 	    whole_archive_flag_spec_CXX="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
@@ -13533,7 +13577,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP "ld" | $GREP -v "ld:"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld.*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP "ld" | $GREP -v "ld:"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld.*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
 	    ;;
 	  *)
 	    if test "$GXX" = yes && test "$with_gnu_ld" = no; then
@@ -13553,7 +13597,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	      # Commands to make compiler produce verbose output that lists
 	      # what "hidden" libraries, object files and flags are used when
 	      # linking a shared library.
-	      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+	      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 
 	    else
 	      # FIXME: insert proper C++ library support
@@ -13629,7 +13673,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # GNU C++ compiler with Solaris linker
 	    if test "$GXX" = yes && test "$with_gnu_ld" = no; then
 	      no_undefined_flag_CXX=' ${wl}-z ${wl}defs'
-	      if $CC --version | $GREP -v '^2\.7' > /dev/null; then
+	      if $CC --version | sed -e 's/\r//g' | $GREP -v '^2\.7' > /dev/null; then
 	        archive_cmds_CXX='$CC -shared -nostdlib $LDFLAGS $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-h $wl$soname -o $lib'
 	        archive_expsym_cmds_CXX='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 		  $CC -shared -nostdlib ${wl}-M $wl$lib.exp -o $lib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags~$RM $lib.exp'
@@ -13637,7 +13681,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	        # Commands to make compiler produce verbose output that lists
 	        # what "hidden" libraries, object files and flags are used when
 	        # linking a shared library.
-	        output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+	        output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 	      else
 	        # g++ 2.7 appears to require `-G' NOT `-shared' on this
 	        # platform.
@@ -13648,7 +13692,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	        # Commands to make compiler produce verbose output that lists
 	        # what "hidden" libraries, object files and flags are used when
 	        # linking a shared library.
-	        output_verbose_link_cmd='$CC -G $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+	        output_verbose_link_cmd='$CC -G $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 	      fi
 
 	      hardcode_libdir_flag_spec_CXX='${wl}-R $wl$libdir'
@@ -13768,7 +13812,7 @@ private:
 _LT_EOF
 
 if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -13864,7 +13908,7 @@ interix[3-9]*)
   ;;
 
 linux*)
-  case `$CC -V 2>&1 | sed 5q` in
+  case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
   *Sun\ C*)
     # Sun C++ 5.9
 
@@ -14154,7 +14198,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	    lt_prog_compiler_static_CXX='-qstaticlink'
 	    ;;
 	  *)
-	    case `$CC -V 2>&1 | sed 5q` in
+	    case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	    *Sun\ C*)
 	      # Sun C++ 5.9
 	      lt_prog_compiler_pic_CXX='-KPIC'
@@ -14303,14 +14347,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works_CXX=yes
@@ -14349,10 +14395,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -14402,8 +14449,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -14411,6 +14459,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o_CXX=yes
@@ -14454,8 +14503,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -14463,6 +14513,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o_CXX=yes
@@ -14512,27 +14563,27 @@ fi
     { $as_echo "$as_me:${as_lineno-$LINENO}: checking whether the $compiler linker ($LD) supports shared libraries" >&5
 $as_echo_n "checking whether the $compiler linker ($LD) supports shared libraries... " >&6; }
 
-  export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   case $host_os in
   aix[4-9]*)
     # If we're using GNU nm, then we don't want the "-C" option.
     # -C means demangle to AIX nm, but means don't demangle with GNU nm
     # Also, AIX nm treats weak defined symbols like other global defined
     # symbols, whereas GNU nm marks them as "W".
-    if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-      export_symbols_cmds_CXX='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+    if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+      export_symbols_cmds_CXX='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
     else
-      export_symbols_cmds_CXX='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+      export_symbols_cmds_CXX='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
     fi
     ;;
   pw32*)
     export_symbols_cmds_CXX="$ltdll_cmds"
   ;;
   cygwin* | mingw* | cegcc*)
-    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/;/^.*[ ]__nm__/s/^.*[ ]__nm__\([^ ]*\)[ ][^ ]*/\1 DATA/;/^I[ ]/d;/^[AITW][ ]/s/.* //'\'' | sort | uniq > $export_symbols'
+    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/;/^.*[ ]__nm__/s/^.*[ ]__nm__\([^ ]*\)[ ][^ ]*/\1 DATA/;/^I[ ]/d;/^[AITW][ ]/s/.* //'\'' | sort | uniq > $export_symbols'
   ;;
   *)
-    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   ;;
   esac
   exclude_expsyms_CXX='_GLOBAL_OFFSET_TABLE_|_GLOBAL__F[ID]_.*'
@@ -14574,10 +14625,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -14603,6 +14655,7 @@ else
 	  fi
 	  allow_undefined_flag_CXX=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -14732,7 +14785,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -15093,7 +15146,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -15138,7 +15191,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -15476,15 +15529,15 @@ $as_echo "$as_me: WARNING: Cannot set --enable-shared for gprofng/libcollector.
 fi
 
 GPROFNG_VARIANT=unknown
-x=`echo | $CC $CFLAGS -dM -E - | grep -w __x86_64`
+x=`echo | $CC $CFLAGS -dM -E - | sed -e 's/\r//g' | grep -w __x86_64`
 if test -n "$x"; then
   GPROFNG_VARIANT=amd64-Linux
 else
-  x=`echo | $CC $CFLAGS -dM -E - | grep -w __i386__`
+  x=`echo | $CC $CFLAGS -dM -E - | sed -e 's/\r//g' | grep -w __i386__`
   if test -n "$x"; then
     GPROFNG_VARIANT=intel-Linux
   else
-    x=`echo | $CC $CFLAGS -dM -E - | grep -w __aarch64__`
+    x=`echo | $CC $CFLAGS -dM -E - | sed -e 's/\r//g' | grep -w __aarch64__`
     if test -n "$x"; then
       GPROFNG_VARIANT=aarch64-Linux
     fi
diff --git a/binutils/gprofng/libcollector/configure.ac b/binutils/gprofng/libcollector/configure.ac
index a19e62068f..b3351d8612 100644
--- a/binutils/gprofng/libcollector/configure.ac
+++ b/binutils/gprofng/libcollector/configure.ac
@@ -42,15 +42,15 @@ if test "$enable_shared" != "yes"; then
 fi
 
 GPROFNG_VARIANT=unknown
-x=`echo | $CC $CFLAGS -dM -E - | grep -w __x86_64`
+x=`echo | $CC $CFLAGS -dM -E - | sed -e 's/\r//g' | grep -w __x86_64`
 if test -n "$x"; then
   GPROFNG_VARIANT=amd64-Linux
 else
-  x=`echo | $CC $CFLAGS -dM -E - | grep -w __i386__`
+  x=`echo | $CC $CFLAGS -dM -E - | sed -e 's/\r//g' | grep -w __i386__`
   if test -n "$x"; then
     GPROFNG_VARIANT=intel-Linux
   else
-    x=`echo | $CC $CFLAGS -dM -E - | grep -w __aarch64__`
+    x=`echo | $CC $CFLAGS -dM -E - | sed -e 's/\r//g' | grep -w __aarch64__`
     if test -n "$x"; then
       GPROFNG_VARIANT=aarch64-Linux
     fi
diff --git a/binutils/intl/configure b/binutils/intl/configure
index 24fd69a97e..2be78613a4 100755
--- a/binutils/intl/configure
+++ b/binutils/intl/configure
@@ -1468,9 +1468,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1505,9 +1506,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1630,7 +1632,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -1703,9 +1705,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2528,9 +2531,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -2581,7 +2585,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -2651,7 +2655,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -2707,7 +2711,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -2764,7 +2768,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3305,7 +3309,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -3322,7 +3326,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -4403,7 +4407,7 @@ wenotbecray
 #endif
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "webecray" >/dev/null 2>&1; then :
   ac_cv_os_cray=yes
 else
@@ -4695,7 +4699,7 @@ else
 #endif
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "Lucky GNU user" >/dev/null 2>&1; then :
   ac_cv_gnu_library_2_1=yes
 else
@@ -5042,9 +5046,9 @@ $as_echo_n "checking for ld used by GCC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -5085,7 +5089,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some GNU ld's only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      if "$acl_cv_path_LD" -v 2>&1 < /dev/null | egrep '(GNU|with BFD)' > /dev/null; then
+      if "$acl_cv_path_LD" -v 2>&1 < /dev/null | sed -e 's/\r//g' | egrep '(GNU|with BFD)' > /dev/null; then
 	test "$with_gnu_ld" != no && break
       else
 	test "$with_gnu_ld" != yes && break
@@ -5113,7 +5117,7 @@ if ${acl_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU ld's only accept -v.
-if $LD -v 2>&1 </dev/null | egrep '(GNU|with BFD)' 1>&5; then
+if $LD -v 2>&1 </dev/null | sed -e 's/\r//g' | egrep '(GNU|with BFD)' 1>&5; then
   acl_cv_prog_gnu_ld=yes
 else
   acl_cv_prog_gnu_ld=no
diff --git a/binutils/ld/configure b/binutils/ld/configure
index 7ab4e9f308..d53e0007b5 100755
--- a/binutils/ld/configure
+++ b/binutils/ld/configure
@@ -1675,9 +1675,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1713,9 +1714,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1750,9 +1752,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1875,7 +1878,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -1948,9 +1951,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2060,9 +2064,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2098,9 +2103,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -3816,9 +3822,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -3869,7 +3876,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3939,7 +3946,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3995,7 +4002,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -4052,7 +4059,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4441,7 +4448,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -4499,6 +4506,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -4663,9 +4675,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -4826,7 +4839,7 @@ else
 
   am_cv_CXX_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -4884,6 +4897,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -5228,7 +5246,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -5245,7 +5263,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -5666,9 +5684,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -5710,7 +5728,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -5741,7 +5759,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -5956,10 +5974,12 @@ else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
   (eval echo "\"\$as_me:$LINENO: $ac_compile\"" >&5)
-  (eval "$ac_compile" 2>conftest.err)
+  (eval "($ac_compile | sed -e 's/\r//g')" 2>conftest.err)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: output\"" >&5)
   cat conftest.out >&5
@@ -6380,7 +6400,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -6442,7 +6462,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|_pic\.a)$'
@@ -6460,7 +6480,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
@@ -6536,9 +6556,9 @@ test -z "$deplibs_check_method" && deplibs_check_method=unknown
 plugin_option=
 plugin_names="liblto_plugin.so liblto_plugin-0.dll cyglto_plugin-0.dll"
 for plugin in $plugin_names; do
-  plugin_so=`${CC} ${CFLAGS} --print-prog-name $plugin`
+  plugin_so=`${CC} ${CFLAGS} --print-prog-name $plugin | sed -e 's/\r//g'`
   if test x$plugin_so = x$plugin; then
-    plugin_so=`${CC} ${CFLAGS} --print-file-name $plugin`
+    plugin_so=`${CC} ${CFLAGS} --print-file-name $plugin | sed -e 's/\r//g'`
   fi
   if test x$plugin_so != x$plugin; then
     plugin_option="--plugin $plugin_so"
@@ -6992,7 +7012,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[ABCDGIRSTW]' ;;
 esac
@@ -7000,11 +7020,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -7038,7 +7058,7 @@ for ac_symprfx in "" "_"; do
 "     s[1]~prfx {split(s[1],t,\"@\"); print t[1], substr(t[1],length(prfx))}"\
 "     ' prfx=^$ac_symprfx"
   else
-    lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
+    lt_cv_sys_global_symbol_pipe="sed -n -e 's/\r//g' -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
   fi
 
   # Check to see that the pipe works correctly.
@@ -7059,14 +7079,14 @@ int main(){nm_test_var='a';nm_test_func();return(0);}
 _LT_EOF
 
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist\""; } >&5
-  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) 2>&5
+    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist\""; } >&5
+  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s "$nlist"; then
@@ -7087,7 +7107,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | sed -e '"'"'s/\r//g'"'"' | $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -7100,7 +7120,7 @@ lt__PROGRAM__LTX_preloaded_symbols[] =
 {
   { "@PROGRAM@", (void *) 0 },
 _LT_EOF
-	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | $GREP -v main >> conftest.$ac_ext
+	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | sed -e 's/\r//g' | $GREP -v main >> conftest.$ac_ext
 	  cat <<\_LT_EOF >> conftest.$ac_ext
   {0, (void *) 0}
 };
@@ -7123,7 +7143,7 @@ _LT_EOF
 	  LIBS="conftstm.$ac_objext"
 	  CFLAGS="$CFLAGS$lt_prog_compiler_no_builtin_flag"
 	  if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext}; then
@@ -7202,7 +7222,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7221,7 +7241,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo '#line '$LINENO' "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7259,7 +7279,7 @@ s390*-*linux*|s390*-*tpf*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7371,7 +7391,7 @@ sparc*-*solaris*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7904,6 +7924,7 @@ else
 	if test -f libconftest.dylib && test ! -s conftest.err && test $_lt_result = 0; then
 	  lt_cv_apple_cc_single_mod=yes
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err >&5
 	fi
 	rm -rf libconftest.dylib*
@@ -7966,6 +7987,7 @@ _LT_EOF
       if test -f conftest && test ! -s conftest.err && test $_lt_result = 0 && $GREP forced_load conftest 2>&1 >/dev/null; then
 	lt_cv_ld_force_load=yes
       else
+        dos2unix -q conftest.err
 	cat conftest.err >&5
       fi
         rm -f conftest.err libconftest.a conftest conftest.c
@@ -8458,13 +8480,15 @@ compiler_DEFAULT=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -8504,14 +8528,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -8726,7 +8752,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic='-KPIC'
@@ -8857,14 +8883,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works=yes
@@ -8906,10 +8934,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -8962,8 +8991,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8971,6 +9001,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -9017,8 +9048,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -9026,6 +9058,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -9086,7 +9119,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object=no
   enable_shared_with_static_runtimes=no
   export_dynamic_flag_spec=
-  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic=no
   hardcode_direct=no
   hardcode_direct_absolute=no
@@ -9149,7 +9182,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -9175,13 +9208,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -9225,7 +9258,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -9243,9 +9276,9 @@ _LT_EOF
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -9288,7 +9321,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -9319,7 +9352,7 @@ _LT_EOF
 	  compiler_needs_object=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object=yes
@@ -9357,7 +9390,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -9367,7 +9400,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
 
@@ -9379,7 +9412,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9388,7 +9421,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
@@ -9407,7 +9440,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
 	    archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -9426,7 +9459,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9470,10 +9503,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -9820,10 +9853,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS -b"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -9904,7 +9938,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -9930,7 +9964,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct=yes
 	hardcode_shlibpath_var=no
 	hardcode_direct_absolute=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
@@ -9999,7 +10033,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -10192,10 +10226,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -10221,6 +10256,7 @@ else
 	  fi
 	  allow_undefined_flag=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -10403,7 +10439,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([A-Za-z]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -10507,7 +10543,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -10870,7 +10906,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -10915,7 +10951,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -11561,7 +11597,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -11667,7 +11703,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -12023,13 +12059,15 @@ compiler=$CC
   # save warnings/boilerplate of simple test code
   ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
   ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -12095,9 +12133,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -12139,7 +12177,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -12170,7 +12208,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -12204,7 +12242,7 @@ with_gnu_ld=$lt_cv_prog_gnu_ld
         wlarc='${wl}'
 
         # ancient GNU ld didn't support --whole-archive et. al.
-        if eval "`$CC -print-prog-name=ld` --help 2>&1" |
+        if eval "`$CC -print-prog-name=ld | sed -e 's/\r//g'` --help 2>&1" | sed -e 's/\r//g' |
 	  $GREP 'no-whole-archive' > /dev/null; then
           whole_archive_flag_spec_CXX="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
         else
@@ -12225,7 +12263,7 @@ with_gnu_ld=$lt_cv_prog_gnu_ld
       # Commands to make compiler produce verbose output that lists
       # what "hidden" libraries, object files and flags are used when
       # linking a shared library.
-      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 
     else
       GXX=no
@@ -12427,7 +12465,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
         ;;
 
       beos*)
-	if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	  allow_undefined_flag_CXX=unsupported
 	  # Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	  # support --undefined.  This deserves some investigation.  FIXME
@@ -12455,7 +12493,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
         always_export_symbols_CXX=no
         enable_shared_with_static_runtimes_CXX=yes
 
-        if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+        if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
           archive_cmds_CXX='$CC -shared -nostdlib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
           # If the export-symbols file already is a .def file (1st line
           # is EXPORTS), use it as is; otherwise, prepend...
@@ -12571,7 +12609,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
             # explicitly linking system object files so we need to strip them
             # from the output so that they don't get included in the library
             # dependencies.
-            output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | $EGREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+            output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | sed -e '"'"'s/\r//g'"'"' | $EGREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
             ;;
           *)
             if test "$GXX" = yes; then
@@ -12636,7 +12674,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | $GREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+	    output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | sed -e '"'"'s/\r//g'"'"' | $GREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
 	    ;;
           *)
 	    if test "$GXX" = yes; then
@@ -12721,7 +12759,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`$CC $CFLAGS -v conftest.$objext -o libconftest$shared_ext 2>&1 | $GREP "ld"`; rm -f libconftest$shared_ext; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+	    output_verbose_link_cmd='templist=`$CC $CFLAGS -v conftest.$objext -o libconftest$shared_ext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP "ld"`; rm -f libconftest$shared_ext; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
 
 	    hardcode_libdir_flag_spec_CXX='${wl}-rpath,$libdir'
 	    export_dynamic_flag_spec_CXX='${wl}--export-dynamic'
@@ -12736,7 +12774,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # version 8.0 and above of icpc choke on multiply defined symbols
 	    # if we add $predep_objects and $postdep_objects, however 7.1 and
 	    # earlier do not add the objects themselves.
-	    case `$CC -V 2>&1` in
+	    case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	      *"Version 7."*)
 	        archive_cmds_CXX='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname -o $lib'
 		archive_expsym_cmds_CXX='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -12757,7 +12795,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    ;;
           pgCC* | pgcpp*)
             # Portland Group C++ compiler
-	    case `$CC -V` in
+	    case `$CC -V | sed -e 's/\r//g'` in
 	    *pgCC\ [1-5].* | *pgcpp\ [1-5].*)
 	      prelink_cmds_CXX='tpldir=Template.dir~
 		rm -rf $tpldir~
@@ -12804,7 +12842,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP "ld"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld .*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "X$list" | $Xsed'
+	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP "ld"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld .*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "X$list" | $Xsed'
 	    ;;
 	  xl* | mpixl* | bgxl*)
 	    # IBM XL 8.0 on PPC, with GNU ld
@@ -12819,7 +12857,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    fi
 	    ;;
 	  *)
-	    case `$CC -V 2>&1 | sed 5q` in
+	    case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	    *Sun\ C*)
 	      # Sun C++ 5.9
 	      no_undefined_flag_CXX=' -zdefs'
@@ -12869,7 +12907,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	;;
 
       netbsd*)
-        if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+        if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	  archive_cmds_CXX='$LD -Bshareable  -o $lib $predep_objects $libobjs $deplibs $postdep_objects $linker_flags'
 	  wlarc=
 	  hardcode_libdir_flag_spec_CXX='-R$libdir'
@@ -12877,7 +12915,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	  hardcode_shlibpath_var_CXX=no
 	fi
 	# Workaround some broken pre-1.5 toolchains
-	output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP conftest.$objext | $SED -e "s:-lgcc -lc -lgcc::"'
+	output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP conftest.$objext | $SED -e "s:-lgcc -lc -lgcc::"'
 	;;
 
       *nto* | *qnx*)
@@ -12896,7 +12934,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	  hardcode_direct_absolute_CXX=yes
 	  archive_cmds_CXX='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $lib'
 	  hardcode_libdir_flag_spec_CXX='${wl}-rpath,$libdir'
-	  if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	    archive_expsym_cmds_CXX='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-retain-symbols-file,$export_symbols -o $lib'
 	    export_dynamic_flag_spec_CXX='${wl}-E'
 	    whole_archive_flag_spec_CXX="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
@@ -12960,7 +12998,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP "ld" | $GREP -v "ld:"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld.*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP "ld" | $GREP -v "ld:"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld.*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
 	    ;;
 	  *)
 	    if test "$GXX" = yes && test "$with_gnu_ld" = no; then
@@ -12980,7 +13018,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	      # Commands to make compiler produce verbose output that lists
 	      # what "hidden" libraries, object files and flags are used when
 	      # linking a shared library.
-	      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+	      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 
 	    else
 	      # FIXME: insert proper C++ library support
@@ -13056,7 +13094,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # GNU C++ compiler with Solaris linker
 	    if test "$GXX" = yes && test "$with_gnu_ld" = no; then
 	      no_undefined_flag_CXX=' ${wl}-z ${wl}defs'
-	      if $CC --version | $GREP -v '^2\.7' > /dev/null; then
+	      if $CC --version | sed -e 's/\r//g' | $GREP -v '^2\.7' > /dev/null; then
 	        archive_cmds_CXX='$CC -shared -nostdlib $LDFLAGS $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-h $wl$soname -o $lib'
 	        archive_expsym_cmds_CXX='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 		  $CC -shared -nostdlib ${wl}-M $wl$lib.exp -o $lib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags~$RM $lib.exp'
@@ -13064,7 +13102,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	        # Commands to make compiler produce verbose output that lists
 	        # what "hidden" libraries, object files and flags are used when
 	        # linking a shared library.
-	        output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+	        output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 	      else
 	        # g++ 2.7 appears to require `-G' NOT `-shared' on this
 	        # platform.
@@ -13075,7 +13113,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	        # Commands to make compiler produce verbose output that lists
 	        # what "hidden" libraries, object files and flags are used when
 	        # linking a shared library.
-	        output_verbose_link_cmd='$CC -G $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+	        output_verbose_link_cmd='$CC -G $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 	      fi
 
 	      hardcode_libdir_flag_spec_CXX='${wl}-R $wl$libdir'
@@ -13195,7 +13233,7 @@ private:
 _LT_EOF
 
 if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -13291,7 +13329,7 @@ interix[3-9]*)
   ;;
 
 linux*)
-  case `$CC -V 2>&1 | sed 5q` in
+  case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
   *Sun\ C*)
     # Sun C++ 5.9
 
@@ -13581,7 +13619,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	    lt_prog_compiler_static_CXX='-qstaticlink'
 	    ;;
 	  *)
-	    case `$CC -V 2>&1 | sed 5q` in
+	    case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	    *Sun\ C*)
 	      # Sun C++ 5.9
 	      lt_prog_compiler_pic_CXX='-KPIC'
@@ -13730,14 +13768,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works_CXX=yes
@@ -13776,10 +13816,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -13829,8 +13870,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -13838,6 +13880,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o_CXX=yes
@@ -13881,8 +13924,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -13890,6 +13934,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o_CXX=yes
@@ -13939,27 +13984,27 @@ fi
     { $as_echo "$as_me:${as_lineno-$LINENO}: checking whether the $compiler linker ($LD) supports shared libraries" >&5
 $as_echo_n "checking whether the $compiler linker ($LD) supports shared libraries... " >&6; }
 
-  export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   case $host_os in
   aix[4-9]*)
     # If we're using GNU nm, then we don't want the "-C" option.
     # -C means demangle to AIX nm, but means don't demangle with GNU nm
     # Also, AIX nm treats weak defined symbols like other global defined
     # symbols, whereas GNU nm marks them as "W".
-    if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-      export_symbols_cmds_CXX='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+    if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+      export_symbols_cmds_CXX='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
     else
-      export_symbols_cmds_CXX='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+      export_symbols_cmds_CXX='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
     fi
     ;;
   pw32*)
     export_symbols_cmds_CXX="$ltdll_cmds"
   ;;
   cygwin* | mingw* | cegcc*)
-    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/;/^.*[ ]__nm__/s/^.*[ ]__nm__\([^ ]*\)[ ][^ ]*/\1 DATA/;/^I[ ]/d;/^[AITW][ ]/s/.* //'\'' | sort | uniq > $export_symbols'
+    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/;/^.*[ ]__nm__/s/^.*[ ]__nm__\([^ ]*\)[ ][^ ]*/\1 DATA/;/^I[ ]/d;/^[AITW][ ]/s/.* //'\'' | sort | uniq > $export_symbols'
   ;;
   *)
-    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   ;;
   esac
   exclude_expsyms_CXX='_GLOBAL_OFFSET_TABLE_|_GLOBAL__F[ID]_.*'
@@ -14001,10 +14046,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -14030,6 +14076,7 @@ else
 	  fi
 	  allow_undefined_flag_CXX=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -14159,7 +14206,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -14520,7 +14567,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -14565,7 +14612,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -15837,7 +15884,7 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 __GNUC__
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "(^[0-3]$|^__GNUC__$)" >/dev/null 2>&1; then :
 
 else
@@ -15851,7 +15898,7 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 __GNUC__
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "(^[0-4]$|^__GNUC__$)" >/dev/null 2>&1; then :
 
 else
@@ -15866,7 +15913,7 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 __GNUC__
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "(^[0-3]$|^__GNUC__$)" >/dev/null 2>&1; then :
 
 else
@@ -15882,7 +15929,7 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 __GNUC__
 _ACEOF
-if (eval "$ac_cpp_for_build conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp_for_build conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "(^[0-3]$|^__GNUC__$)" >/dev/null 2>&1; then :
 
 else
@@ -15896,7 +15943,7 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 __GNUC__
 _ACEOF
-if (eval "$ac_cpp_for_build conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp_for_build conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "(^[0-4]$|^__GNUC__$)" >/dev/null 2>&1; then :
 
 else
diff --git a/binutils/libctf/configure b/binutils/libctf/configure
index 8704bc215f..25799d8ee8 100755
--- a/binutils/libctf/configure
+++ b/binutils/libctf/configure
@@ -1569,9 +1569,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1606,9 +1607,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1731,7 +1733,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -1804,9 +1806,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2768,9 +2771,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -2821,7 +2825,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -2891,7 +2895,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -2947,7 +2951,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -3004,7 +3008,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3604,7 +3608,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -3621,7 +3625,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -4385,7 +4389,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -4443,6 +4447,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -4914,9 +4923,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -5841,9 +5851,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -5885,7 +5895,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -5916,7 +5926,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -6131,10 +6141,12 @@ else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
   (eval echo "\"\$as_me:$LINENO: $ac_compile\"" >&5)
-  (eval "$ac_compile" 2>conftest.err)
+  (eval "($ac_compile | sed -e 's/\r//g')" 2>conftest.err)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: output\"" >&5)
   cat conftest.out >&5
@@ -6555,7 +6567,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -6617,7 +6629,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|_pic\.a)$'
@@ -6635,7 +6647,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
@@ -6711,9 +6723,9 @@ test -z "$deplibs_check_method" && deplibs_check_method=unknown
 plugin_option=
 plugin_names="liblto_plugin.so liblto_plugin-0.dll cyglto_plugin-0.dll"
 for plugin in $plugin_names; do
-  plugin_so=`${CC} ${CFLAGS} --print-prog-name $plugin`
+  plugin_so=`${CC} ${CFLAGS} --print-prog-name $plugin | sed -e 's/\r//g'`
   if test x$plugin_so = x$plugin; then
-    plugin_so=`${CC} ${CFLAGS} --print-file-name $plugin`
+    plugin_so=`${CC} ${CFLAGS} --print-file-name $plugin | sed -e 's/\r//g'`
   fi
   if test x$plugin_so != x$plugin; then
     plugin_option="--plugin $plugin_so"
@@ -7167,7 +7179,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[ABCDGIRSTW]' ;;
 esac
@@ -7175,11 +7187,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -7213,7 +7225,7 @@ for ac_symprfx in "" "_"; do
 "     s[1]~prfx {split(s[1],t,\"@\"); print t[1], substr(t[1],length(prfx))}"\
 "     ' prfx=^$ac_symprfx"
   else
-    lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
+    lt_cv_sys_global_symbol_pipe="sed -n -e 's/\r//g' -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
   fi
 
   # Check to see that the pipe works correctly.
@@ -7234,14 +7246,14 @@ int main(){nm_test_var='a';nm_test_func();return(0);}
 _LT_EOF
 
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist\""; } >&5
-  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) 2>&5
+    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist\""; } >&5
+  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s "$nlist"; then
@@ -7262,7 +7274,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | sed -e '"'"'s/\r//g'"'"' | $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -7275,7 +7287,7 @@ lt__PROGRAM__LTX_preloaded_symbols[] =
 {
   { "@PROGRAM@", (void *) 0 },
 _LT_EOF
-	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | $GREP -v main >> conftest.$ac_ext
+	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | sed -e 's/\r//g' | $GREP -v main >> conftest.$ac_ext
 	  cat <<\_LT_EOF >> conftest.$ac_ext
   {0, (void *) 0}
 };
@@ -7298,7 +7310,7 @@ _LT_EOF
 	  LIBS="conftstm.$ac_objext"
 	  CFLAGS="$CFLAGS$lt_prog_compiler_no_builtin_flag"
 	  if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext}; then
@@ -7377,7 +7389,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7396,7 +7408,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo '#line '$LINENO' "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7434,7 +7446,7 @@ s390*-*linux*|s390*-*tpf*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7546,7 +7558,7 @@ sparc*-*solaris*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -8079,6 +8091,7 @@ else
 	if test -f libconftest.dylib && test ! -s conftest.err && test $_lt_result = 0; then
 	  lt_cv_apple_cc_single_mod=yes
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err >&5
 	fi
 	rm -rf libconftest.dylib*
@@ -8141,6 +8154,7 @@ _LT_EOF
       if test -f conftest && test ! -s conftest.err && test $_lt_result = 0 && $GREP forced_load conftest 2>&1 >/dev/null; then
 	lt_cv_ld_force_load=yes
       else
+        dos2unix -q conftest.err
 	cat conftest.err >&5
       fi
         rm -f conftest.err libconftest.a conftest conftest.c
@@ -8602,13 +8616,15 @@ compiler_DEFAULT=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -8648,14 +8664,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -8870,7 +8888,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic='-KPIC'
@@ -9001,14 +9019,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works=yes
@@ -9050,10 +9070,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -9106,8 +9127,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -9115,6 +9137,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -9161,8 +9184,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -9170,6 +9194,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -9230,7 +9255,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object=no
   enable_shared_with_static_runtimes=no
   export_dynamic_flag_spec=
-  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic=no
   hardcode_direct=no
   hardcode_direct_absolute=no
@@ -9293,7 +9318,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -9319,13 +9344,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -9369,7 +9394,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -9387,9 +9412,9 @@ _LT_EOF
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -9432,7 +9457,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -9463,7 +9488,7 @@ _LT_EOF
 	  compiler_needs_object=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object=yes
@@ -9501,7 +9526,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -9511,7 +9536,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
 
@@ -9523,7 +9548,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9532,7 +9557,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
@@ -9551,7 +9576,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
 	    archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -9570,7 +9595,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9614,10 +9639,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -9964,10 +9989,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS -b"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -10048,7 +10074,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -10074,7 +10100,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct=yes
 	hardcode_shlibpath_var=no
 	hardcode_direct_absolute=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
@@ -10143,7 +10169,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -10336,10 +10362,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -10365,6 +10392,7 @@ else
 	  fi
 	  allow_undefined_flag=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -10547,7 +10575,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([A-Za-z]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -10651,7 +10679,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -11014,7 +11042,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -11059,7 +11087,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -11705,7 +11733,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -11811,7 +11839,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -13506,7 +13534,7 @@ esac
     # We require texinfo to be 6.3 or later, for a working synindex
     # and validatemenus: otherwise we fall back to /bin/true.
     if ${MAKEINFO} --version \
-       | egrep 'texinfo[^0-9]*(6\.[3-9]|[7-9][0-9])' >/dev/null 2>&1; then
+       | sed -e 's/\r//g' | egrep 'texinfo[^0-9]*(6\.[3-9]|[7-9][0-9])' >/dev/null 2>&1; then
       build_info=yes
     else
         build_info=
diff --git a/binutils/libctf/configure.ac b/binutils/libctf/configure.ac
index 4996edd5b7..822999aea3 100644
--- a/binutils/libctf/configure.ac
+++ b/binutils/libctf/configure.ac
@@ -184,7 +184,7 @@ changequote(,)
     # We require texinfo to be 6.3 or later, for a working synindex
     # and validatemenus: otherwise we fall back to /bin/true.
     if ${MAKEINFO} --version \
-       | egrep 'texinfo[^0-9]*(6\.[3-9]|[7-9][0-9])' >/dev/null 2>&1; then
+       | sed -e 's/\r//g' | egrep 'texinfo[^0-9]*(6\.[3-9]|[7-9][0-9])' >/dev/null 2>&1; then
       build_info=yes
     else
         build_info=
diff --git a/binutils/libiberty/configure b/binutils/libiberty/configure
index 306c07bd37..7688faa8c0 100755
--- a/binutils/libiberty/configure
+++ b/binutils/libiberty/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1493,9 +1494,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1618,7 +1620,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -1691,9 +1693,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2620,7 +2623,7 @@ $as_echo "$as_me: WARNING:
 *** Makeinfo is missing. Info documentation will not be built." >&2;}
         ;;
       *)
-	case x"`$MAKEINFO --version | grep 'GNU texinfo'`" in
+	case x"`$MAKEINFO --version | sed -e 's/\r//g' | grep 'GNU texinfo'`" in
 	  x*\ [1-3].* )
 	    MAKEINFO="@echo $MAKEINFO is too old, 4.0 or newer required; true"
 	    BUILD_INFO=
@@ -2944,9 +2947,9 @@ $as_echo_n "checking for -plugin option... " >&6; }
 plugin_names="liblto_plugin.so liblto_plugin-0.dll cyglto_plugin-0.dll"
 plugin_option=
 for plugin in $plugin_names; do
-  plugin_so=`${CC} ${CFLAGS} --print-prog-name $plugin`
+  plugin_so=`${CC} ${CFLAGS} --print-prog-name $plugin | sed -e 's/\r//g'`
   if test x$plugin_so = x$plugin; then
-    plugin_so=`${CC} ${CFLAGS} --print-file-name $plugin`
+    plugin_so=`${CC} ${CFLAGS} --print-file-name $plugin | sed -e 's/\r//g'`
   fi
   if test x$plugin_so != x$plugin; then
     plugin_option="--plugin $plugin_so"
@@ -3442,9 +3445,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -3468,7 +3472,7 @@ printf ("hello world\n");
 _ACEOF
 # FIXME: Cleanup?
 if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3523,7 +3527,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3593,7 +3597,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3649,7 +3653,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -3707,7 +3711,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4248,7 +4252,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -4265,7 +4269,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -6883,7 +6887,7 @@ wenotbecray
 #endif
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "webecray" >/dev/null 2>&1; then :
   ac_cv_os_cray=yes
 else
diff --git a/binutils/libiberty/configure.ac b/binutils/libiberty/configure.ac
index 6c1ff9c609..429ec11567 100644
--- a/binutils/libiberty/configure.ac
+++ b/binutils/libiberty/configure.ac
@@ -82,7 +82,7 @@ else
 *** Makeinfo is missing. Info documentation will not be built.])
         ;;
       *)
-	case x"`$MAKEINFO --version | grep 'GNU texinfo'`" in
+	case x"`$MAKEINFO --version | sed -e 's/\r//g' | grep 'GNU texinfo'`" in
 	  x*\ [[1-3]].* )
 	    MAKEINFO="@echo $MAKEINFO is too old, 4.0 or newer required; true"
 	    BUILD_INFO=
diff --git a/binutils/libtool.m4 b/binutils/libtool.m4
index ad63ebbb38..3ea94311a0 100644
--- a/binutils/libtool.m4
+++ b/binutils/libtool.m4
@@ -1326,9 +1326,9 @@ m4_defun([_LT_CMD_OLD_ARCHIVE],
 [plugin_option=
 plugin_names="liblto_plugin.so liblto_plugin-0.dll cyglto_plugin-0.dll"
 for plugin in $plugin_names; do
-  plugin_so=`${CC} ${CFLAGS} --print-prog-name $plugin`
+  plugin_so=`${CC} ${CFLAGS} --print-prog-name $plugin | sed -e 's/\r//g'`
   if test x$plugin_so = x$plugin; then
-    plugin_so=`${CC} ${CFLAGS} --print-file-name $plugin`
+    plugin_so=`${CC} ${CFLAGS} --print-file-name $plugin | sed -e 's/\r//g'`
   fi
   if test x$plugin_so != x$plugin; then
     plugin_option="--plugin $plugin_so"
@@ -2070,7 +2070,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([[A-Za-z]]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -2174,7 +2174,7 @@ aix[[4-9]]*)
       aix4 | aix4.[[01]] | aix4.[[01]].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -2518,7 +2518,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -2563,7 +2563,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[[89]] | openbsd2.[[89]].*)
 	shlibpath_overrides_runpath=no
@@ -2863,9 +2863,9 @@ if test "$GCC" = yes; then
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -2903,7 +2903,7 @@ AC_CACHE_VAL(lt_cv_path_LD,
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -2943,7 +2943,7 @@ dnl AC_DEFUN([AC_PROG_LD], [])
 m4_defun([_LT_PATH_LD_GNU],
 [AC_CACHE_CHECK([if the linker ($LD) is GNU ld], lt_cv_prog_gnu_ld,
 [# I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -3052,7 +3052,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -3114,7 +3114,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[[^/]]+(\.so\.[[0-9]]+\.[[0-9]]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[[^/]]+(\.so|_pic\.a)$'
@@ -3132,7 +3132,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[[^/]]+(\.so\.[[0-9]]+\.[[0-9]]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[[^/]]+(\.so\.[[0-9]]+\.[[0-9]]+|_pic\.a)$'
@@ -3288,7 +3288,7 @@ AC_CACHE_CHECK([the name lister ($NM) interface], [lt_cv_nm_interface],
   (eval "$ac_compile" 2>conftest.err)
   cat conftest.err >&AS_MESSAGE_LOG_FD
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&AS_MESSAGE_LOG_FD)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
   cat conftest.err >&AS_MESSAGE_LOG_FD
   (eval echo "\"\$as_me:$LINENO: output\"" >&AS_MESSAGE_LOG_FD)
   cat conftest.out >&AS_MESSAGE_LOG_FD
@@ -3420,7 +3420,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[[ABCDGIRSTW]]' ;;
 esac
@@ -3428,11 +3428,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([[^ ]]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([[^ ]]*\) \([[^ ]]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([[^ ]]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([[^ ]]*\) \(lib[[^ ]]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([[^ ]]*\) \([[^ ]]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([[^ ]]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([[^ ]]*\) \([[^ ]]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([[^ ]]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([[^ ]]*\) \(lib[[^ ]]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([[^ ]]*\) \([[^ ]]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -3489,7 +3489,7 @@ _LT_EOF
   if AC_TRY_EVAL(ac_compile); then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if AC_TRY_EVAL(NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) && test -s "$nlist"; then
+    if AC_TRY_EVAL(NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) && test -s "$nlist"; then
       # Try sorting and uniquifying the output.
       if sort "$nlist" | uniq > "$nlist"T; then
 	mv -f "$nlist"T "$nlist"
@@ -3507,7 +3507,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | sed -e '"'"'s/\r//g'"'"' | $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -3802,7 +3802,7 @@ m4_if([$1], [CXX], [
 	    _LT_TAGVAR(lt_prog_compiler_static, $1)='-qstaticlink'
 	    ;;
 	  *)
-	    case `$CC -V 2>&1 | sed 5q` in
+	    case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	    *Sun\ C*)
 	      # Sun C++ 5.9
 	      _LT_TAGVAR(lt_prog_compiler_pic, $1)='-KPIC'
@@ -4100,7 +4100,7 @@ m4_if([$1], [CXX], [
 	_LT_TAGVAR(lt_prog_compiler_static, $1)='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  _LT_TAGVAR(lt_prog_compiler_pic, $1)='-KPIC'
@@ -4248,27 +4248,27 @@ m4_require([_LT_CMD_GLOBAL_SYMBOLS])dnl
 m4_require([_LT_TAG_COMPILER])dnl
 AC_MSG_CHECKING([whether the $compiler linker ($LD) supports shared libraries])
 m4_if([$1], [CXX], [
-  _LT_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  _LT_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   case $host_os in
   aix[[4-9]]*)
     # If we're using GNU nm, then we don't want the "-C" option.
     # -C means demangle to AIX nm, but means don't demangle with GNU nm
     # Also, AIX nm treats weak defined symbols like other global defined
     # symbols, whereas GNU nm marks them as "W".
-    if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-      _LT_TAGVAR(export_symbols_cmds, $1)='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && ([substr](\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+    if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+      _LT_TAGVAR(export_symbols_cmds, $1)='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && ([substr](\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
     else
-      _LT_TAGVAR(export_symbols_cmds, $1)='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && ([substr](\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+      _LT_TAGVAR(export_symbols_cmds, $1)='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && ([substr](\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
     fi
     ;;
   pw32*)
     _LT_TAGVAR(export_symbols_cmds, $1)="$ltdll_cmds"
   ;;
   cygwin* | mingw* | cegcc*)
-    _LT_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[[BCDGRS]][[ ]]/s/.*[[ ]]\([[^ ]]*\)/\1 DATA/;/^.*[[ ]]__nm__/s/^.*[[ ]]__nm__\([[^ ]]*\)[[ ]][[^ ]]*/\1 DATA/;/^I[[ ]]/d;/^[[AITW]][[ ]]/s/.* //'\'' | sort | uniq > $export_symbols'
+    _LT_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[[BCDGRS]][[ ]]/s/.*[[ ]]\([[^ ]]*\)/\1 DATA/;/^.*[[ ]]__nm__/s/^.*[[ ]]__nm__\([[^ ]]*\)[[ ]][[^ ]]*/\1 DATA/;/^I[[ ]]/d;/^[[AITW]][[ ]]/s/.* //'\'' | sort | uniq > $export_symbols'
   ;;
   *)
-    _LT_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+    _LT_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   ;;
   esac
   _LT_TAGVAR(exclude_expsyms, $1)=['_GLOBAL_OFFSET_TABLE_|_GLOBAL__F[ID]_.*']
@@ -4281,7 +4281,7 @@ m4_if([$1], [CXX], [
   _LT_TAGVAR(compiler_needs_object, $1)=no
   _LT_TAGVAR(enable_shared_with_static_runtimes, $1)=no
   _LT_TAGVAR(export_dynamic_flag_spec, $1)=
-  _LT_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  _LT_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   _LT_TAGVAR(hardcode_automatic, $1)=no
   _LT_TAGVAR(hardcode_direct, $1)=no
   _LT_TAGVAR(hardcode_direct_absolute, $1)=no
@@ -4345,7 +4345,7 @@ dnl Note also adjust exclude_expsyms for C++ above.
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[[2-9]]*) ;;
 	  *\ \(GNU\ Binutils\)\ [[3-9]]*) ;;
@@ -4371,13 +4371,13 @@ dnl Note also adjust exclude_expsyms for C++ above.
     _LT_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath ${wl}$libdir'
     _LT_TAGVAR(export_dynamic_flag_spec, $1)='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       _LT_TAGVAR(whole_archive_flag_spec, $1)="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       _LT_TAGVAR(whole_archive_flag_spec, $1)=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [[01]].* | *\ 2.[[0-9]].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -4421,7 +4421,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	_LT_TAGVAR(allow_undefined_flag, $1)=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -4439,9 +4439,9 @@ _LT_EOF
       _LT_TAGVAR(allow_undefined_flag, $1)=unsupported
       _LT_TAGVAR(always_export_symbols, $1)=no
       _LT_TAGVAR(enable_shared_with_static_runtimes, $1)=yes
-      _LT_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[[BCDGRS]][[ ]]/s/.*[[ ]]\([[^ ]]*\)/\1 DATA/'\'' | $SED -e '\''/^[[AITW]][[ ]]/s/.*[[ ]]//'\'' | sort | uniq > $export_symbols'
+      _LT_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[[BCDGRS]][[ ]]/s/.*[[ ]]\([[^ ]]*\)/\1 DATA/'\'' | $SED -e '\''/^[[AITW]][[ ]]/s/.*[[ ]]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         _LT_TAGVAR(archive_cmds, $1)='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -4484,7 +4484,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -4515,7 +4515,7 @@ _LT_EOF
 	  _LT_TAGVAR(compiler_needs_object, $1)=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  _LT_TAGVAR(whole_archive_flag_spec, $1)='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  _LT_TAGVAR(compiler_needs_object, $1)=yes
@@ -4553,7 +4553,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	_LT_TAGVAR(archive_cmds, $1)='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -4563,7 +4563,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	_LT_TAGVAR(ld_shlibs, $1)=no
 	cat <<_LT_EOF 1>&2
 
@@ -4575,7 +4575,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	_LT_TAGVAR(archive_cmds, $1)='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	_LT_TAGVAR(archive_expsym_cmds, $1)='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -4584,7 +4584,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [[01]].* | *\ 2.[[0-9]].* | *\ 2.1[[0-5]].*)
 	_LT_TAGVAR(ld_shlibs, $1)=no
 	cat <<_LT_EOF 1>&2
@@ -4603,7 +4603,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    _LT_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath ${wl}$libdir'
 	    _LT_TAGVAR(archive_cmds, $1)='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    _LT_TAGVAR(archive_expsym_cmds, $1)='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -4622,7 +4622,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	_LT_TAGVAR(archive_cmds, $1)='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	_LT_TAGVAR(archive_expsym_cmds, $1)='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -4666,10 +4666,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  _LT_TAGVAR(export_symbols_cmds, $1)='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && ([substr](\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  _LT_TAGVAR(export_symbols_cmds, $1)='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && ([substr](\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  _LT_TAGVAR(export_symbols_cmds, $1)='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && ([substr](\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  _LT_TAGVAR(export_symbols_cmds, $1)='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && ([substr](\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -4976,7 +4976,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	_LT_TAGVAR(archive_cmds, $1)='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	_LT_TAGVAR(archive_cmds, $1)='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -5002,7 +5002,7 @@ _LT_EOF
 	_LT_TAGVAR(hardcode_direct, $1)=yes
 	_LT_TAGVAR(hardcode_shlibpath_var, $1)=no
 	_LT_TAGVAR(hardcode_direct_absolute, $1)=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  _LT_TAGVAR(archive_cmds, $1)='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  _LT_TAGVAR(archive_expsym_cmds, $1)='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  _LT_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath,$libdir'
@@ -5071,7 +5071,7 @@ _LT_EOF
 	_LT_TAGVAR(archive_expsym_cmds, $1)='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  _LT_TAGVAR(archive_cmds, $1)='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -5565,7 +5565,7 @@ if test "$_lt_caught_CXX_error" != yes; then
         wlarc='${wl}'
 
         # ancient GNU ld didn't support --whole-archive et. al.
-        if eval "`$CC -print-prog-name=ld` --help 2>&1" |
+        if eval "`$CC -print-prog-name=ld | sed -e 's/\r//g'` --help 2>&1" | sed -e 's/\r//g' |
 	  $GREP 'no-whole-archive' > /dev/null; then
           _LT_TAGVAR(whole_archive_flag_spec, $1)="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
         else
@@ -5586,7 +5586,7 @@ if test "$_lt_caught_CXX_error" != yes; then
       # Commands to make compiler produce verbose output that lists
       # what "hidden" libraries, object files and flags are used when
       # linking a shared library.
-      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 
     else
       GXX=no
@@ -5729,7 +5729,7 @@ if test "$_lt_caught_CXX_error" != yes; then
         ;;
 
       beos*)
-	if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	  _LT_TAGVAR(allow_undefined_flag, $1)=unsupported
 	  # Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	  # support --undefined.  This deserves some investigation.  FIXME
@@ -5757,7 +5757,7 @@ if test "$_lt_caught_CXX_error" != yes; then
         _LT_TAGVAR(always_export_symbols, $1)=no
         _LT_TAGVAR(enable_shared_with_static_runtimes, $1)=yes
 
-        if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+        if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
           _LT_TAGVAR(archive_cmds, $1)='$CC -shared -nostdlib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
           # If the export-symbols file already is a .def file (1st line
           # is EXPORTS), use it as is; otherwise, prepend...
@@ -5842,7 +5842,7 @@ if test "$_lt_caught_CXX_error" != yes; then
             # explicitly linking system object files so we need to strip them
             # from the output so that they don't get included in the library
             # dependencies.
-            output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | $EGREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+            output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | sed -e '"'"'s/\r//g'"'"' | $EGREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
             ;;
           *)
             if test "$GXX" = yes; then
@@ -5907,7 +5907,7 @@ if test "$_lt_caught_CXX_error" != yes; then
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | $GREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+	    output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | sed -e '"'"'s/\r//g'"'"' | $GREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
 	    ;;
           *)
 	    if test "$GXX" = yes; then
@@ -5992,7 +5992,7 @@ if test "$_lt_caught_CXX_error" != yes; then
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`$CC $CFLAGS -v conftest.$objext -o libconftest$shared_ext 2>&1 | $GREP "ld"`; rm -f libconftest$shared_ext; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+	    output_verbose_link_cmd='templist=`$CC $CFLAGS -v conftest.$objext -o libconftest$shared_ext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP "ld"`; rm -f libconftest$shared_ext; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
 
 	    _LT_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath,$libdir'
 	    _LT_TAGVAR(export_dynamic_flag_spec, $1)='${wl}--export-dynamic'
@@ -6007,7 +6007,7 @@ if test "$_lt_caught_CXX_error" != yes; then
 	    # version 8.0 and above of icpc choke on multiply defined symbols
 	    # if we add $predep_objects and $postdep_objects, however 7.1 and
 	    # earlier do not add the objects themselves.
-	    case `$CC -V 2>&1` in
+	    case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	      *"Version 7."*)
 	        _LT_TAGVAR(archive_cmds, $1)='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname -o $lib'
 		_LT_TAGVAR(archive_expsym_cmds, $1)='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -6028,7 +6028,7 @@ if test "$_lt_caught_CXX_error" != yes; then
 	    ;;
           pgCC* | pgcpp*)
             # Portland Group C++ compiler
-	    case `$CC -V` in
+	    case `$CC -V | sed -e 's/\r//g'` in
 	    *pgCC\ [[1-5]].* | *pgcpp\ [[1-5]].*)
 	      _LT_TAGVAR(prelink_cmds, $1)='tpldir=Template.dir~
 		rm -rf $tpldir~
@@ -6075,7 +6075,7 @@ if test "$_lt_caught_CXX_error" != yes; then
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP "ld"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld .*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "X$list" | $Xsed'
+	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP "ld"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld .*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "X$list" | $Xsed'
 	    ;;
 	  xl* | mpixl* | bgxl*)
 	    # IBM XL 8.0 on PPC, with GNU ld
@@ -6090,7 +6090,7 @@ if test "$_lt_caught_CXX_error" != yes; then
 	    fi
 	    ;;
 	  *)
-	    case `$CC -V 2>&1 | sed 5q` in
+	    case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	    *Sun\ C*)
 	      # Sun C++ 5.9
 	      _LT_TAGVAR(no_undefined_flag, $1)=' -zdefs'
@@ -6140,7 +6140,7 @@ if test "$_lt_caught_CXX_error" != yes; then
 	;;
 
       netbsd*)
-        if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+        if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	  _LT_TAGVAR(archive_cmds, $1)='$LD -Bshareable  -o $lib $predep_objects $libobjs $deplibs $postdep_objects $linker_flags'
 	  wlarc=
 	  _LT_TAGVAR(hardcode_libdir_flag_spec, $1)='-R$libdir'
@@ -6148,7 +6148,7 @@ if test "$_lt_caught_CXX_error" != yes; then
 	  _LT_TAGVAR(hardcode_shlibpath_var, $1)=no
 	fi
 	# Workaround some broken pre-1.5 toolchains
-	output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP conftest.$objext | $SED -e "s:-lgcc -lc -lgcc::"'
+	output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP conftest.$objext | $SED -e "s:-lgcc -lc -lgcc::"'
 	;;
 
       *nto* | *qnx*)
@@ -6167,7 +6167,7 @@ if test "$_lt_caught_CXX_error" != yes; then
 	  _LT_TAGVAR(hardcode_direct_absolute, $1)=yes
 	  _LT_TAGVAR(archive_cmds, $1)='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $lib'
 	  _LT_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath,$libdir'
-	  if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	    _LT_TAGVAR(archive_expsym_cmds, $1)='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-retain-symbols-file,$export_symbols -o $lib'
 	    _LT_TAGVAR(export_dynamic_flag_spec, $1)='${wl}-E'
 	    _LT_TAGVAR(whole_archive_flag_spec, $1)="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
@@ -6231,7 +6231,7 @@ if test "$_lt_caught_CXX_error" != yes; then
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP "ld" | $GREP -v "ld:"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld.*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP "ld" | $GREP -v "ld:"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld.*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
 	    ;;
 	  *)
 	    if test "$GXX" = yes && test "$with_gnu_ld" = no; then
@@ -6251,7 +6251,7 @@ if test "$_lt_caught_CXX_error" != yes; then
 	      # Commands to make compiler produce verbose output that lists
 	      # what "hidden" libraries, object files and flags are used when
 	      # linking a shared library.
-	      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+	      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 
 	    else
 	      # FIXME: insert proper C++ library support
@@ -6327,7 +6327,7 @@ if test "$_lt_caught_CXX_error" != yes; then
 	    # GNU C++ compiler with Solaris linker
 	    if test "$GXX" = yes && test "$with_gnu_ld" = no; then
 	      _LT_TAGVAR(no_undefined_flag, $1)=' ${wl}-z ${wl}defs'
-	      if $CC --version | $GREP -v '^2\.7' > /dev/null; then
+	      if $CC --version | sed -e 's/\r//g' | $GREP -v '^2\.7' > /dev/null; then
 	        _LT_TAGVAR(archive_cmds, $1)='$CC -shared -nostdlib $LDFLAGS $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-h $wl$soname -o $lib'
 	        _LT_TAGVAR(archive_expsym_cmds, $1)='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 		  $CC -shared -nostdlib ${wl}-M $wl$lib.exp -o $lib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags~$RM $lib.exp'
@@ -6335,7 +6335,7 @@ if test "$_lt_caught_CXX_error" != yes; then
 	        # Commands to make compiler produce verbose output that lists
 	        # what "hidden" libraries, object files and flags are used when
 	        # linking a shared library.
-	        output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+	        output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 	      else
 	        # g++ 2.7 appears to require `-G' NOT `-shared' on this
 	        # platform.
@@ -6346,7 +6346,7 @@ if test "$_lt_caught_CXX_error" != yes; then
 	        # Commands to make compiler produce verbose output that lists
 	        # what "hidden" libraries, object files and flags are used when
 	        # linking a shared library.
-	        output_verbose_link_cmd='$CC -G $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+	        output_verbose_link_cmd='$CC -G $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 	      fi
 
 	      _LT_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-R $wl$libdir'
@@ -6627,7 +6627,7 @@ interix[[3-9]]*)
   ;;
 
 linux*)
-  case `$CC -V 2>&1 | sed 5q` in
+  case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
   *Sun\ C*)
     # Sun C++ 5.9
 
diff --git a/binutils/ltmain.sh b/binutils/ltmain.sh
index 9503ec85d7..1a8ed9dfc8 100644
--- a/binutils/ltmain.sh
+++ b/binutils/ltmain.sh
@@ -2571,7 +2571,7 @@ extern \"C\" {
 	  progfiles=`$ECHO "$objs$old_deplibs" | $SP2NL | $SED "$lo2o" | $NL2SP`
 	  for progfile in $progfiles; do
 	    func_verbose "extracting global C symbols from \`$progfile'"
-	    $opt_dry_run || eval "$NM $progfile | $global_symbol_pipe >> '$nlist'"
+	    $opt_dry_run || eval "$NM $progfile | sed -e 's/\r//g' | $global_symbol_pipe >> '$nlist'"
 	  done
 
 	  if test -n "$exclude_expsyms"; then
@@ -2622,7 +2622,7 @@ extern \"C\" {
 	  name="$func_basename_result"
 	  $opt_dry_run || {
 	    $ECHO ": $name " >> "$nlist"
-	    eval "$NM $dlprefile 2>/dev/null | $global_symbol_pipe >> '$nlist'"
+	    eval "$NM $dlprefile 2>/dev/null | sed -e 's/\r//g' | $global_symbol_pipe >> '$nlist'"
 	  }
 	done
 
@@ -2799,6 +2799,7 @@ func_win32_libid ()
     if $OBJDUMP -f "$1" | $SED -e '10q' 2>/dev/null |
        $EGREP 'file format (pe-i386(.*architecture: i386)?|pe-arm-wince|pe-x86-64)' >/dev/null; then
       win32_nmres=`$NM -f posix -A "$1" |
+	$SED -n -e 's/\r//g' |
 	$SED -n -e '
 	    1,100{
 		/ I /{
diff --git a/binutils/opcodes/Makefile.am b/binutils/opcodes/Makefile.am
index af843fb378..419199ab1b 100644
--- a/binutils/opcodes/Makefile.am
+++ b/binutils/opcodes/Makefile.am
@@ -561,6 +561,7 @@ $(srcdir)/i386-tbl.h: $(srcdir)/i386-init.h
 $(srcdir)/i386-init.h: @MAINT@ i386-gen$(EXEEXT_FOR_BUILD) i386-opc.tbl i386-reg.tbl i386-opc.h
 	$(CPP) -P $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) - \
 		< $(srcdir)/i386-opc.tbl \
+		| sed -e 's/\r//g' \
 		| ./i386-gen$(EXEEXT_FOR_BUILD) --srcdir $(srcdir)
 
 i386-opc.lo: $(srcdir)/i386-tbl.h
diff --git a/binutils/opcodes/Makefile.in b/binutils/opcodes/Makefile.in
index 2257b0872a..dfbe14b31e 100644
--- a/binutils/opcodes/Makefile.in
+++ b/binutils/opcodes/Makefile.in
@@ -1536,6 +1536,7 @@ $(srcdir)/i386-tbl.h: $(srcdir)/i386-init.h
 $(srcdir)/i386-init.h: @MAINT@ i386-gen$(EXEEXT_FOR_BUILD) i386-opc.tbl i386-reg.tbl i386-opc.h
 	$(CPP) -P $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) - \
 		< $(srcdir)/i386-opc.tbl \
+		| sed -e 's/\r//g' \
 		| ./i386-gen$(EXEEXT_FOR_BUILD) --srcdir $(srcdir)
 
 i386-opc.lo: $(srcdir)/i386-tbl.h
diff --git a/binutils/opcodes/configure b/binutils/opcodes/configure
index 2a88987096..26f907f67d 100755
--- a/binutils/opcodes/configure
+++ b/binutils/opcodes/configure
@@ -1573,9 +1573,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1610,9 +1611,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1735,7 +1737,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -1808,9 +1810,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -3566,9 +3569,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -3619,7 +3623,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3689,7 +3693,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3745,7 +3749,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -3802,7 +3806,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4191,7 +4195,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -4249,6 +4253,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -4593,7 +4602,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -4610,7 +4619,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -5247,9 +5256,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -5291,7 +5300,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -5322,7 +5331,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -5537,10 +5546,12 @@ else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
   (eval echo "\"\$as_me:$LINENO: $ac_compile\"" >&5)
-  (eval "$ac_compile" 2>conftest.err)
+  (eval "($ac_compile | sed -e 's/\r//g')" 2>conftest.err)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: output\"" >&5)
   cat conftest.out >&5
@@ -5961,7 +5972,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -6023,7 +6034,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|_pic\.a)$'
@@ -6041,7 +6052,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
@@ -6117,9 +6128,9 @@ test -z "$deplibs_check_method" && deplibs_check_method=unknown
 plugin_option=
 plugin_names="liblto_plugin.so liblto_plugin-0.dll cyglto_plugin-0.dll"
 for plugin in $plugin_names; do
-  plugin_so=`${CC} ${CFLAGS} --print-prog-name $plugin`
+  plugin_so=`${CC} ${CFLAGS} --print-prog-name $plugin | sed -e 's/\r//g'`
   if test x$plugin_so = x$plugin; then
-    plugin_so=`${CC} ${CFLAGS} --print-file-name $plugin`
+    plugin_so=`${CC} ${CFLAGS} --print-file-name $plugin | sed -e 's/\r//g'`
   fi
   if test x$plugin_so != x$plugin; then
     plugin_option="--plugin $plugin_so"
@@ -6573,7 +6584,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[ABCDGIRSTW]' ;;
 esac
@@ -6581,11 +6592,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -6619,7 +6630,7 @@ for ac_symprfx in "" "_"; do
 "     s[1]~prfx {split(s[1],t,\"@\"); print t[1], substr(t[1],length(prfx))}"\
 "     ' prfx=^$ac_symprfx"
   else
-    lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
+    lt_cv_sys_global_symbol_pipe="sed -n -e 's/\r//g' -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
   fi
 
   # Check to see that the pipe works correctly.
@@ -6640,14 +6651,14 @@ int main(){nm_test_var='a';nm_test_func();return(0);}
 _LT_EOF
 
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist\""; } >&5
-  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) 2>&5
+    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist\""; } >&5
+  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s "$nlist"; then
@@ -6668,7 +6679,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | sed -e '"'"'s/\r//g'"'"' | $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -6681,7 +6692,7 @@ lt__PROGRAM__LTX_preloaded_symbols[] =
 {
   { "@PROGRAM@", (void *) 0 },
 _LT_EOF
-	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | $GREP -v main >> conftest.$ac_ext
+	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | sed -e 's/\r//g' | $GREP -v main >> conftest.$ac_ext
 	  cat <<\_LT_EOF >> conftest.$ac_ext
   {0, (void *) 0}
 };
@@ -6704,7 +6715,7 @@ _LT_EOF
 	  LIBS="conftstm.$ac_objext"
 	  CFLAGS="$CFLAGS$lt_prog_compiler_no_builtin_flag"
 	  if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext}; then
@@ -6783,7 +6794,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6802,7 +6813,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo '#line '$LINENO' "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6840,7 +6851,7 @@ s390*-*linux*|s390*-*tpf*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6952,7 +6963,7 @@ sparc*-*solaris*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7485,6 +7496,7 @@ else
 	if test -f libconftest.dylib && test ! -s conftest.err && test $_lt_result = 0; then
 	  lt_cv_apple_cc_single_mod=yes
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err >&5
 	fi
 	rm -rf libconftest.dylib*
@@ -7547,6 +7559,7 @@ _LT_EOF
       if test -f conftest && test ! -s conftest.err && test $_lt_result = 0 && $GREP forced_load conftest 2>&1 >/dev/null; then
 	lt_cv_ld_force_load=yes
       else
+        dos2unix -q conftest.err
 	cat conftest.err >&5
       fi
         rm -f conftest.err libconftest.a conftest conftest.c
@@ -8008,13 +8021,15 @@ compiler_DEFAULT=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -8054,14 +8069,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -8276,7 +8293,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic='-KPIC'
@@ -8407,14 +8424,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works=yes
@@ -8456,10 +8475,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -8512,8 +8532,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8521,6 +8542,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8567,8 +8589,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8576,6 +8599,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8636,7 +8660,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object=no
   enable_shared_with_static_runtimes=no
   export_dynamic_flag_spec=
-  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic=no
   hardcode_direct=no
   hardcode_direct_absolute=no
@@ -8699,7 +8723,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -8725,13 +8749,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -8775,7 +8799,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -8793,9 +8817,9 @@ _LT_EOF
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -8838,7 +8862,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -8869,7 +8893,7 @@ _LT_EOF
 	  compiler_needs_object=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object=yes
@@ -8907,7 +8931,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -8917,7 +8941,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
 
@@ -8929,7 +8953,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -8938,7 +8962,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
@@ -8957,7 +8981,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
 	    archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -8976,7 +9000,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9020,10 +9044,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -9370,10 +9394,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS -b"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -9454,7 +9479,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -9480,7 +9505,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct=yes
 	hardcode_shlibpath_var=no
 	hardcode_direct_absolute=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
@@ -9549,7 +9574,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -9742,10 +9767,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -9771,6 +9797,7 @@ else
 	  fi
 	  allow_undefined_flag=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -9953,7 +9980,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([A-Za-z]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -10057,7 +10084,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -10420,7 +10447,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -10465,7 +10492,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -11111,7 +11138,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -11217,7 +11244,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -11427,7 +11454,7 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 __GNUC__
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "(^[0-3]$|^__GNUC__$)" >/dev/null 2>&1; then :
 
 else
@@ -11441,7 +11468,7 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 __GNUC__
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "(^[0-4]$|^__GNUC__$)" >/dev/null 2>&1; then :
 
 else
@@ -11456,7 +11483,7 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 __GNUC__
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "(^[0-3]$|^__GNUC__$)" >/dev/null 2>&1; then :
 
 else
@@ -11472,7 +11499,7 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 __GNUC__
 _ACEOF
-if (eval "$ac_cpp_for_build conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp_for_build conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "(^[0-3]$|^__GNUC__$)" >/dev/null 2>&1; then :
 
 else
@@ -11486,7 +11513,7 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 __GNUC__
 _ACEOF
-if (eval "$ac_cpp_for_build conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp_for_build conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "(^[0-4]$|^__GNUC__$)" >/dev/null 2>&1; then :
 
 else
@@ -12243,7 +12270,7 @@ if ${bfd_cv_ld_as_needed+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   bfd_cv_ld_as_needed=no
-	if $LD --help 2>/dev/null | grep as-needed > /dev/null; then
+	if $LD --help 2>/dev/null | sed -e 's/\r//g' | grep as-needed > /dev/null; then
 		bfd_cv_ld_as_needed=yes
 	fi
 
diff --git a/binutils/opcodes/configure.ac b/binutils/opcodes/configure.ac
index e998d61343..aed490589f 100644
--- a/binutils/opcodes/configure.ac
+++ b/binutils/opcodes/configure.ac
@@ -141,7 +141,7 @@ using_cgen=no
 # Check if linker supports --as-needed and --no-as-needed options
 AC_CACHE_CHECK(linker --as-needed support, bfd_cv_ld_as_needed,
 	[bfd_cv_ld_as_needed=no
-	if $LD --help 2>/dev/null | grep as-needed > /dev/null; then
+	if $LD --help 2>/dev/null | sed -e 's/\r//g' | grep as-needed > /dev/null; then
 		bfd_cv_ld_as_needed=yes
 	fi
 	])
diff --git a/binutils/zlib/configure b/binutils/zlib/configure
index 0a9ad9e8cc..a41e692bee 100755
--- a/binutils/zlib/configure
+++ b/binutils/zlib/configure
@@ -1536,9 +1536,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1574,9 +1575,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1650,9 +1652,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1688,7 +1691,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -3433,9 +3436,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -3459,7 +3463,7 @@ printf ("hello world\n");
 _ACEOF
 # FIXME: Cleanup?
 if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3514,7 +3518,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3584,7 +3588,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3640,7 +3644,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -3698,7 +3702,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4087,7 +4091,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -4145,6 +4149,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -4598,9 +4607,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -4642,7 +4651,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -4673,7 +4682,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -4888,10 +4897,12 @@ else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
   (eval echo "\"\$as_me:$LINENO: $ac_compile\"" >&5)
-  (eval "$ac_compile" 2>conftest.err)
+  (eval "($ac_compile | sed -e 's/\r//g')" 2>conftest.err)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: output\"" >&5)
   cat conftest.out >&5
@@ -5312,7 +5323,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -5374,7 +5385,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|_pic\.a)$'
@@ -5392,7 +5403,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
@@ -5468,9 +5479,9 @@ test -z "$deplibs_check_method" && deplibs_check_method=unknown
 plugin_option=
 plugin_names="liblto_plugin.so liblto_plugin-0.dll cyglto_plugin-0.dll"
 for plugin in $plugin_names; do
-  plugin_so=`${CC} ${CFLAGS} --print-prog-name $plugin`
+  plugin_so=`${CC} ${CFLAGS} --print-prog-name $plugin | sed -e 's/\r//g'`
   if test x$plugin_so = x$plugin; then
-    plugin_so=`${CC} ${CFLAGS} --print-file-name $plugin`
+    plugin_so=`${CC} ${CFLAGS} --print-file-name $plugin | sed -e 's/\r//g'`
   fi
   if test x$plugin_so != x$plugin; then
     plugin_option="--plugin $plugin_so"
@@ -5924,7 +5935,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[ABCDGIRSTW]' ;;
 esac
@@ -5932,11 +5943,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -5970,7 +5981,7 @@ for ac_symprfx in "" "_"; do
 "     s[1]~prfx {split(s[1],t,\"@\"); print t[1], substr(t[1],length(prfx))}"\
 "     ' prfx=^$ac_symprfx"
   else
-    lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
+    lt_cv_sys_global_symbol_pipe="sed -n -e 's/\r//g' -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
   fi
 
   # Check to see that the pipe works correctly.
@@ -5991,14 +6002,14 @@ int main(){nm_test_var='a';nm_test_func();return(0);}
 _LT_EOF
 
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist\""; } >&5
-  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) 2>&5
+    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist\""; } >&5
+  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s "$nlist"; then
@@ -6019,7 +6030,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | sed -e '"'"'s/\r//g'"'"' | $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -6032,7 +6043,7 @@ lt__PROGRAM__LTX_preloaded_symbols[] =
 {
   { "@PROGRAM@", (void *) 0 },
 _LT_EOF
-	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | $GREP -v main >> conftest.$ac_ext
+	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | sed -e 's/\r//g' | $GREP -v main >> conftest.$ac_ext
 	  cat <<\_LT_EOF >> conftest.$ac_ext
   {0, (void *) 0}
 };
@@ -6055,7 +6066,7 @@ _LT_EOF
 	  LIBS="conftstm.$ac_objext"
 	  CFLAGS="$CFLAGS$lt_prog_compiler_no_builtin_flag"
 	  if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext}; then
@@ -6135,7 +6146,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6154,7 +6165,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo '#line '$LINENO' "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6192,7 +6203,7 @@ s390*-*linux*|s390*-*tpf*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6307,7 +6318,7 @@ sparc*-*solaris*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6840,6 +6851,7 @@ else
 	if test -f libconftest.dylib && test ! -s conftest.err && test $_lt_result = 0; then
 	  lt_cv_apple_cc_single_mod=yes
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err >&5
 	fi
 	rm -rf libconftest.dylib*
@@ -6905,6 +6917,7 @@ _LT_EOF
       if test -f conftest && test ! -s conftest.err && test $_lt_result = 0 && $GREP forced_load conftest 2>&1 >/dev/null; then
 	lt_cv_ld_force_load=yes
       else
+        dos2unix -q conftest.err
 	cat conftest.err >&5
       fi
         rm -f conftest.err libconftest.a conftest conftest.c
@@ -7120,7 +7133,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -7137,7 +7150,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -7663,13 +7676,15 @@ compiler_DEFAULT=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -7709,14 +7724,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -7931,7 +7948,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic='-KPIC'
@@ -8062,14 +8079,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works=yes
@@ -8111,10 +8130,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -8167,8 +8187,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8176,6 +8197,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8222,8 +8244,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8231,6 +8254,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8291,7 +8315,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object=no
   enable_shared_with_static_runtimes=no
   export_dynamic_flag_spec=
-  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic=no
   hardcode_direct=no
   hardcode_direct_absolute=no
@@ -8354,7 +8378,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -8380,13 +8404,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -8430,7 +8454,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -8448,9 +8472,9 @@ _LT_EOF
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -8493,7 +8517,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -8524,7 +8548,7 @@ _LT_EOF
 	  compiler_needs_object=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object=yes
@@ -8562,7 +8586,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -8572,7 +8596,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
 
@@ -8584,7 +8608,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -8593,7 +8617,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
@@ -8612,7 +8636,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
 	    archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -8631,7 +8655,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -8675,10 +8699,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -9031,10 +9055,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS -b"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -9118,7 +9143,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -9144,7 +9169,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct=yes
 	hardcode_shlibpath_var=no
 	hardcode_direct_absolute=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
@@ -9213,7 +9238,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -9406,10 +9431,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -9435,6 +9461,7 @@ else
 	  fi
 	  allow_undefined_flag=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -9617,7 +9644,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([A-Za-z]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -9721,7 +9748,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -10087,7 +10114,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -10132,7 +10159,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -10793,7 +10820,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -10899,7 +10926,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -11518,7 +11545,7 @@ else
   toolexeclibdir='$(libdir)'
 fi
 if test "$GCC" = yes && $CC -print-multi-os-directory > /dev/null 2>&1; then
-  multiosdir=/`$CC -print-multi-os-directory`
+  multiosdir=/`$CC -print-multi-os-directory | sed -e 's/\r//g'`
   case $multiosdir in
     /.) multiosdir= ;; # Avoid trailing /.
   esac
diff --git a/binutils/zlib/configure.ac b/binutils/zlib/configure.ac
index ec73c21922..a237da2004 100644
--- a/binutils/zlib/configure.ac
+++ b/binutils/zlib/configure.ac
@@ -102,7 +102,7 @@ else
   toolexeclibdir='$(libdir)'
 fi
 if test "$GCC" = yes && $CC -print-multi-os-directory > /dev/null 2>&1; then
-  multiosdir=/`$CC -print-multi-os-directory`
+  multiosdir=/`$CC -print-multi-os-directory | sed -e 's/\r//g'`
   case $multiosdir in
     /.) multiosdir= ;; # Avoid trailing /.
   esac
diff --git a/build-toolchain.bash b/build-toolchain.bash
index cc2a8c5685..a4a2157185 100755
--- a/build-toolchain.bash
+++ b/build-toolchain.bash
@@ -42,9 +42,19 @@ BUILD_68K=true
 BUILD_PPC=true
 BUILD_CARBON=true
 CLEAN_AFTER_BUILD=false
+STOP_AFTER_68K_GCC=false
+STOP_AFTER_PPC_GCC=false
+STOP_AFTER_TOOLS=false
+SKIP_68K_GCC=false
+SKIP_PPC_GCC=false
+SKIP_TOOLS=false
 HOST_CMAKE_FLAGS=()
 CMAKE_GENERATOR=
 
+BUILD=
+HOST=
+CROSS_PREFIX=
+
 function usage()
 {
 	echo "Usage: $0 [options]"
@@ -62,6 +72,18 @@ function usage()
     echo "    --universal               use Apple's universal interfaces (default: autodetect)"
     echo "    --multiversal             use the open-source multiversal interfaces (default: autodetect)"
 	echo "    --help                    show this help message"
+	echo "    --build                   configure for building on BUILD [guessed]"
+	echo "    --host                    cross-compile to build programs to run on HOST [BUILD]"
+	echo "    --cross-prefix            cross compiler prefix for cmake"
+	echo "    --boost-rootdir           boost root dir for hfsutils"
+	echo "    --boost-libdir            boost root dir for hfsutils"
+	echo "    --boost-incdir            boost root dir for hfsutils"
+	echo "    --stop-after-68k-gcc      stop build after 68k gcc."
+	echo "    --stop-after-ppc-gcc      stop build after ppc gcc."
+	echo "    --stop-after-tools        stop build after tools."
+	echo "    --skip-68k-gcc-build      skip 68k gcc build."
+	echo "    --skip-ppc-gcc-build      skip ppc gcc build."
+	echo "    --skip-tools-build        skip tools build."
 }
 
 for ARG in $*; do
@@ -79,6 +101,24 @@ for ARG in $*; do
 			BUILD_PPC=false
 			BUILD_CARBON=false
 			;;
+		--stop-after-68k-gcc)
+			STOP_AFTER_68K_GCC=true
+			;;
+		--stop-after-ppc-gcc)
+			STOP_AFTER_PPC_GCC=true
+			;;
+		--stop-after-tools)
+			STOP_AFTER_TOOLS=true
+			;;
+		--skip-68k-gcc-build)
+			SKIP_68K_GCC=true
+			;;
+		--skip-ppc-gcc-build)
+			SKIP_PPC_GCC=true
+			;;
+		--skip-tools-build)
+			SKIP_TOOLS=true
+			;;
 		--no-carbon)
 			BUILD_CARBON=false
 			;;
@@ -93,6 +133,26 @@ for ARG in $*; do
 			HOST_CMAKE_FLAGS[${#HOST_CMAKE_FLAGS[@]}]="-DCMAKE_C_COMPILER=${ARG#*=}"
 			HOST_C_COMPILER="${ARG#*=}"
 			;;
+		--build=*)
+			BUILD="${ARG#*=}"
+			;;
+		--host=*)
+			HOST="${ARG#*=}"
+			;;
+		--cross-prefix=*)
+			CROSS_PREFIX="${ARG#*=}"
+			;;
+		--boost-rootdir=*)
+			Boost_DIR="${ARG#*=}"
+			BOOST_ROOT="${ARG#*=}"
+			;;
+		--boost-libdir=*)
+			BOOST_LIBRARYDIR="${ARG#*=}"
+			Boost_LIBRARIES="${ARG#*=}"
+			;;
+		--boost-incdir=*)
+			BOOST_INCLUDE_DIRS="${ARG#*=}"
+			;;
 		--ninja)
 			CMAKE_GENERATOR=-GNinja
 			;;
@@ -114,6 +174,16 @@ for ARG in $*; do
 	esac
 done
 
+if [ "$BOOST_ROOT" != "" -a "$BOOST_LIBRARYDIR" = "" ]; then
+	BOOST_LIBRARYDIR="$BOOST_ROOT/lib"
+	Boost_LIBRARIES="$BOOST_ROOT/lib"
+fi
+
+if [ "$BOOST_ROOT" != "" -a "$BOOST_INCLUDE_DIRS" = "" ]; then
+	BOOST_INCLUDE_DIRS="$BOOST_ROOT/include"
+	Boost_INCLUDE_DIRS="$BOOST_ROOT/include"
+fi
+
 ##################### Sanity checks
 
 if [ `pwd -P` == "$SRC" ]; then
@@ -196,10 +266,10 @@ locateAndCheckInterfacesAndLibraries
 
 if [ $SKIP_THIRDPARTY != true ]; then
 
-	if [ "$PREFIX" = "$DEFAULT_PREFIX" ]; then
-		# Remove old install tree
-		rm -rf $PREFIX
-	fi
+	#if [ "$PREFIX" = "$DEFAULT_PREFIX" ]; then
+	#	# Remove old install tree
+	#	rm -rf $PREFIX
+	#fi
 	mkdir -p $PREFIX
 
 	if [ `uname` = Darwin ]; then
@@ -221,25 +291,88 @@ if [ $SKIP_THIRDPARTY != true ]; then
 	fi
 		
 	# Components needed for targeting 68K: binutils, gcc
-	if [ $BUILD_68K != false ]; then
+	if [ $BUILD_68K != false -a $SKIP_68K_GCC != true ]; then
 		export CC=$HOST_C_COMPILER
 		export CXX=$HOST_CXX_COMPILER
 
+		export WINEPATH="$(winepath -w gcc-build/gcc);$WINEPATHPOST"
+
 		# Build binutils for 68K
 		mkdir -p binutils-build
 		cd binutils-build
-		$SRC/binutils/configure --target=m68k-apple-macos --prefix=$PREFIX --disable-doc
+		if [ "$BUILD" != "" -a "$HOST" != "" ]; then
+			$SRC/binutils/configure --host=$HOST --build=$BUILD --target=m68k-apple-macos --prefix=$PREFIX --disable-doc
+		elif [ "$BUILD" != "" ]; then
+			$SRC/binutils/configure --build=$BUILD --target=m68k-apple-macos --prefix=$PREFIX --disable-doc
+		elif [ "$HOST" != "" ]; then
+			$SRC/binutils/configure --host=$HOST --target=m68k-apple-macos --prefix=$PREFIX --disable-doc
+		else
+			$SRC/binutils/configure --target=m68k-apple-macos --prefix=$PREFIX --disable-doc
+		fi
 		make -j$BUILD_JOBS
 		make install
 		cd ..
 
 		# Build gcc for 68K
 		mkdir -p gcc-build
+		mkdir -p gcc-build/gcc
 		cd gcc-build
+		cp ../toolchain/m68k-apple-macos/bin/*.exe gcc
 		export target_configargs="--disable-nls --enable-libstdcxx-dual-abi=no --disable-libstdcxx-verbose"
-		$SRC/gcc/configure --target=m68k-apple-macos --prefix=$PREFIX \
-				--enable-languages=c,c++ --with-arch=m68k --with-cpu=m68000 \
-				--disable-libssp MAKEINFO=missing
+		if [ "$BUILD" != "" -a "$HOST" != "" ]; then
+			$SRC/gcc/configure --host=$HOST --build=$BUILD \
+					--target=m68k-apple-macos --prefix=$PREFIX \
+					--enable-languages=c,c++ --with-arch=m68k --with-cpu=m68000 \
+					--disable-libssp MAKEINFO=missing
+		elif [ "$BUILD" != "" ]; then
+			$SRC/gcc/configure --build=$BUILD \
+					--target=m68k-apple-macos --prefix=$PREFIX \
+					--enable-languages=c,c++ --with-arch=m68k --with-cpu=m68000 \
+					--disable-libssp MAKEINFO=missing
+		elif [ "$HOST" != "" ]; then
+			$SRC/gcc/configure --host=$HOST \
+					--target=m68k-apple-macos --prefix=$PREFIX \
+					--enable-languages=c,c++ --with-arch=m68k --with-cpu=m68000 \
+					--disable-libssp MAKEINFO=missing
+		else
+			$SRC/gcc/configure --target=m68k-apple-macos --prefix=$PREFIX \
+					--enable-languages=c,c++ --with-arch=m68k --with-cpu=m68000 \
+					--disable-libssp MAKEINFO=missing
+		fi
+
+                sed -i -e 's#S\["GCC_FOR_TARGET"\]="m68k-apple-macos-gcc"#S["GCC_FOR_TARGET"]="$$r/$(HOST_SUBDIR)/gcc/xgcc.exe -B$$r/$(HOST_SUBDIR)/gcc/"#g' config.status
+                sed -i -e 's#S\["CXX_FOR_TARGET"\]="m68k-apple-macos-c[+][+]"#S["CXX_FOR_TARGET"]="$$r/$(HOST_SUBDIR)/gcc/xg++.exe -B$$r/$(HOST_SUBDIR)/gcc/ -nostdinc++ `if test -f $$r/$(TARGET_SUBDIR)/libstdc++-v3/scripts/testsuite_flags; then $(SHEL"\\\n"L) $$r/$(TARGET_SUBDIR)/libstdc++-v3/scripts/testsuite_flags --build-includes; else echo -funconfigured-libstdc++-v3 ; fi` -L$$r/$(TARGET_SUBDIR)/li"\\\n"bstdc++-v3/src -L$$r/$(TARGET_SUBDIR)/libstdc++-v3/src/.libs -L$$r/$(TARGET_SUBDIR)/libstdc++-v3/libsupc++/.libs"#g' config.status
+                sed -i -e 's#S\["CC_FOR_TARGET"\]="m68k-apple-macos-cc"#S["CC_FOR_TARGET"]="$$r/$(HOST_SUBDIR)/gcc/xgcc.exe -B$$r/$(HOST_SUBDIR)/gcc/"#g' config.status
+                sed -i -e 's#S\["RAW_CXX_FOR_TARGET"\]="m68k-apple-macos-c[+][+]"#S["RAW_CXX_FOR_TARGET"]="$$r/$(HOST_SUBDIR)/gcc/xgcc.exe -shared-libgcc -B$$r/$(HOST_SUBDIR)/gcc -nostdinc++ -L$$r/$(TARGET_SUBDIR)/libstdc++-v3/src -L$$r/$(TARGET_SUBDIR)/libst"\\\n"dc++-v3/src/.libs -L$$r/$(TARGET_SUBDIR)/libstdc++-v3/libsupc++/.libs"#g' config.status
+
+		sed -i -e 's#S\["AS_FOR_TARGET"\]="m68k-apple-macos-as"#S["AS_FOR_TARGET"]="'"$PREFIX"'m68k-apple-macos/bin/as.exe"#g' config.status
+		sed -i -e 's#S\["AR_FOR_TARGET"\]="m68k-apple-macos-ar"#S["AR_FOR_TARGET"]="'"$PREFIX"'m68k-apple-macos/bin/ar.exe"#g' config.status
+		sed -i -e 's#S\["LD_FOR_TARGET"\]="m68k-apple-macos-ld"#S["LD_FOR_TARGET"]="'"$PREFIX"'m68k-apple-macos/bin/ld.exe"#g' config.status
+		sed -i -e 's#S\["NM_FOR_TARGET"\]="m68k-apple-macos-nm"#S["NM_FOR_TARGET"]="'"$PREFIX"'m68k-apple-macos/bin/nm.exe"#g' config.status
+		sed -i -e 's#S\["STRIP_FOR_TARGET"\]="m68k-apple-macos-strip"#S["STRIP_FOR_TARGET"]="'"$PREFIX"'m68k-apple-macos/bin/strip.exe"#g' config.status
+		sed -i -e 's#S\["READELF_FOR_TARGET"\]="m68k-apple-macos-readelf"#S["READELF_FOR_TARGET"]="'"$PREFIX"'m68k-apple-macos/bin/readelf.exe"#g' config.status
+		sed -i -e 's#S\["RANLIB_FOR_TARGET"\]="m68k-apple-macos-ranlib"#S["RANLIB_FOR_TARGET"]="'"$PREFIX"'m68k-apple-macos/bin/ranlib.exe"#g' config.status
+		sed -i -e 's#S\["OBJDUMP_FOR_TARGET"\]="m68k-apple-macos-objdump"#S["OBJDUMP_FOR_TARGET"]="'"$PREFIX"'m68k-apple-macos/bin/objdump.exe"#g' config.status
+		sed -i -e 's#S\["OBJCOPY_FOR_TARGET"\]="m68k-apple-macos-objcopy"#S["OBJCOPY_FOR_TARGET"]="'"$PREFIX"'m68k-apple-macos/bin/objcopy.exe"#g' config.status
+		sed -i -e 's#S\["DSYMUTIL_FOR_TARGET"\]="m68k-apple-macos-dsymutil"#S["DSYMUTIL_FOR_TARGET"]="'"$PREFIX"'m68k-apple-macos/bin/dsymutil.exe"#g' config.status
+
+		sed -i -e 's#GCC_FOR_TARGET=$(STAGE_CC_WRAPPER) m68k-apple-macos-gcc#GCC_FOR_TARGET=$(STAGE_CC_WRAPPER) $$r/$(HOST_SUBDIR)/gcc/xgcc.exe -B$$r/$(HOST_SUBDIR)/gcc/#g' Makefile
+		sed -i -e 's#CXX_FOR_TARGET=$(STAGE_CC_WRAPPER) m68k-apple-macos-c[+][+]#CXX_FOR_TARGET=$(STAGE_CC_WRAPPER) $$r/$(HOST_SUBDIR)/gcc/xg++.exe -B$$r/$(HOST_SUBDIR)/gcc/ -nostdinc++ `if test -f $$r/$(TARGET_SUBDIR)/libstdc++-v3/scripts/testsuite_flags; then $(SHELL) $$r/$(TARGET_SUBDIR)/libstdc++-v3/scripts/testsuite_flags --build-includes; else echo -funconfigured-libstdc++-v3 ; fi` -L$$r/$(TARGET_SUBDIR)/libstdc++-v3/src -L$$r/$(TARGET_SUBDIR)/libstdc++-v3/src/.libs -L$$r/$(TARGET_SUBDIR)/libstdc++-v3/libsupc++/.libs#g' Makefile
+		sed -i -e 's#CC_FOR_TARGET=$(STAGE_CC_WRAPPER) m68k-apple-macos-cc#CC_FOR_TARGET=$(STAGE_CC_WRAPPER) $$r/$(HOST_SUBDIR)/gcc/xgcc.exe -B$$r/$(HOST_SUBDIR)/gcc/#g' Makefile
+		sed -i -e 's#RAW_CXX_FOR_TARGET=$(STAGE_CC_WRAPPER) m68k-apple-macos-c[+][+]#RAW_CXX_FOR_TARGET=$(STAGE_CC_WRAPPER) $$r/$(HOST_SUBDIR)/gcc/xgcc.exe -shared-libgcc -B$$r/$(HOST_SUBDIR)/gcc -nostdinc++ -L$$r/$(TARGET_SUBDIR)/libstdc++-v3/src -L$$r/$(TARGET_SUBDIR)/libstdc++-v3/src/.libs -L$$r/$(TARGET_SUBDIR)/libstdc++-v3/libsupc++/.libs#g' Makefile
+		sed -i -e 's#RAW_CXX_FOR_TARGET=$(STAGE_CC_WRAPPER) $$r/$(HOST_SUBDIR)/gcc/xg[+][+].exe -B$$r/$(HOST_SUBDIR)/gcc/ -nostdinc[+][+] `if test -f $$r/$(TARGET_SUBDIR)/libstdc[+][+]-v3/scripts/testsuite_flags; then $(SHELL) $$r/$(TARGET_SUBDIR)/libstdc[+][+]-v3/scripts/testsuite_flags --build-includes; else echo -funconfigured-libstdc[+][+]-v3 ; fi` -L$$r/$(TARGET_SUBDIR)/libstdc[+][+]-v3/src -L$$r/$(TARGET_SUBDIR)/libstdc[+][+]-v3/src/.libs -L$$r/$(TARGET_SUBDIR)/libstdc[+][+]-v3/libsupc[+][+]/.libs#RAW_CXX_FOR_TARGET=$(STAGE_CC_WRAPPER) $$r/$(HOST_SUBDIR)/gcc/xgcc.exe -shared-libgcc -B$$r/$(HOST_SUBDIR)/gcc -nostdinc++ -L$$r/$(TARGET_SUBDIR)/libstdc++-v3/src -L$$r/$(TARGET_SUBDIR)/libstdc++-v3/src/.libs -L$$r/$(TARGET_SUBDIR)/libstdc++-v3/libsupc++/.libs#g' Makefile
+
+		sed -i -e 's#AS_FOR_TARGET=m68k-apple-macos-as#AS_FOR_TARGET='"$PREFIX"'m68k-apple-macos/bin/as.exe#g' Makefile
+		sed -i -e 's#AR_FOR_TARGET=m68k-apple-macos-ar#AR_FOR_TARGET='"$PREFIX"'m68k-apple-macos/bin/ar.exe#g' Makefile
+		sed -i -e 's#LD_FOR_TARGET=m68k-apple-macos-ld#LD_FOR_TARGET='"$PREFIX"'m68k-apple-macos/bin/ld.exe#g' Makefile
+		sed -i -e 's#NM_FOR_TARGET=m68k-apple-macos-nm#NM_FOR_TARGET='"$PREFIX"'m68k-apple-macos/bin/nm.exe#g' Makefile
+		sed -i -e 's#STRIP_FOR_TARGET=m68k-apple-macos-strip#STRIP_FOR_TARGET='"$PREFIX"'m68k-apple-macos/bin/strip.exe#g' Makefile
+		sed -i -e 's#READELF_FOR_TARGET=m68k-apple-macos-readelf#READELF_FOR_TARGET='"$PREFIX"'m68k-apple-macos/bin/readelf.exe#g' Makefile
+		sed -i -e 's#RANLIB_FOR_TARGET=m68k-apple-macos-ranlib#RANLIB_FOR_TARGET='"$PREFIX"'m68k-apple-macos/bin/ranlib.exe#g' Makefile
+		sed -i -e 's#OBJDUMP_FOR_TARGET=m68k-apple-macos-objdump#OBJDUMP_FOR_TARGET='"$PREFIX"'m68k-apple-macos/bin/objdump.exe#g' Makefile
+		sed -i -e 's#OBJCOPY_FOR_TARGET=m68k-apple-macos-objcopy#OBJCOPY_FOR_TARGET='"$PREFIX"'m68k-apple-macos/bin/objcopy.exe#g' Makefile
+		sed -i -e 's#DSYMUTIL_FOR_TARGET=m68k-apple-macos-dsymutil#DSYMUTIL_FOR_TARGET='"$PREFIX"'m68k-apple-macos/bin/dsymutil.exe#g' Makefile
+
 		# There seems to be a build failure in parallel builds; ignore any errors and try again without -j8.
 		make -j$BUILD_JOBS || make
 		make install
@@ -251,10 +384,12 @@ if [ $SKIP_THIRDPARTY != true ]; then
 
 		# Move the real linker aside and install symlinks to Elf2Mac
 		# (Elf2Mac is built by cmake below)
-		mv $PREFIX/bin/m68k-apple-macos-ld $PREFIX/bin/m68k-apple-macos-ld.real
-		mv $PREFIX/m68k-apple-macos/bin/ld $PREFIX/m68k-apple-macos/bin/ld.real
-		ln -s Elf2Mac $PREFIX/bin/m68k-apple-macos-ld
-		ln -s ../../bin/Elf2Mac $PREFIX/m68k-apple-macos/bin/ld
+		mv $PREFIX/bin/m68k-apple-macos-ld.exe $PREFIX/bin/m68k-apple-macos-ld.real.exe
+		cp $PREFIX/bin/m68k-apple-macos-ld.real.exe $PREFIX/bin/m68k-apple-macos-ld.exe.real.exe
+		mv $PREFIX/m68k-apple-macos/bin/ld.exe $PREFIX/m68k-apple-macos/bin/ld.real.exe
+		cp $PREFIX/m68k-apple-macos/bin/ld.real.exe $PREFIX/m68k-apple-macos/bin/ld.exe.real.exe
+		ln -s Elf2Mac.exe $PREFIX/bin/m68k-apple-macos-ld.exe
+		ln -s ../../bin/Elf2Mac.exe $PREFIX/m68k-apple-macos/bin/ld.exe
 
 		if [ $CLEAN_AFTER_BUILD != false ]; then
 			rm -rf binutils-build
@@ -262,26 +397,91 @@ if [ $SKIP_THIRDPARTY != true ]; then
 		fi
 
 	fi
+	if [ $STOP_AFTER_68K_GCC != false ]; then
+		unset CPPFLAGS
+		unset LDFLAGS
+		exit 0
+	fi
 
 	# Components needed for targeting PPC (including Carbon): binutils, gcc
-	if [ $BUILD_PPC != false ]; then
+	if [ $BUILD_PPC != false -a $SKIP_PPC_GCC != true ]; then
 		export CC=$HOST_C_COMPILER
 		export CXX=$HOST_CXX_COMPILER
 
+		export WINEPATH="$(winepath -w gcc-build-ppc/gcc);$WINEPATHPOST"
+
 		# Build binutils for PPC
 		mkdir -p binutils-build-ppc
 		cd binutils-build-ppc
-		$SRC/binutils/configure --disable-plugins --target=powerpc-apple-macos --prefix=$PREFIX --disable-doc
+		if [ "$BUILD" != "" -a "$HOST" != "" ]; then
+			$SRC/binutils/configure --host=$HOST --build=$BUILD --disable-plugins --target=powerpc-apple-macos --prefix=$PREFIX --disable-doc
+		elif [ "$BUILD" != "" ]; then
+			$SRC/binutils/configure --build=$BUILD --disable-plugins --target=powerpc-apple-macos --prefix=$PREFIX --disable-doc
+		elif [ "$HOST" != "" ]; then
+			$SRC/binutils/configure --host=$HOST --disable-plugins --target=powerpc-apple-macos --prefix=$PREFIX --disable-doc
+		else
+			$SRC/binutils/configure --disable-plugins --target=powerpc-apple-macos --prefix=$PREFIX --disable-doc
+		fi
 		make -j$BUILD_JOBS
 		make install
 		cd ..
 
 		# Build gcc for PPC
 		mkdir -p gcc-build-ppc
+		mkdir -p gcc-build-ppc/gcc
 		cd gcc-build-ppc
+		cp ../toolchain/powerpc-apple-macos/bin/*.exe gcc
 		export target_configargs="--disable-nls --enable-libstdcxx-dual-abi=no --disable-libstdcxx-verbose"
-		$SRC/gcc/configure --target=powerpc-apple-macos --prefix=$PREFIX \
-			--enable-languages=c,c++ --disable-libssp --disable-lto MAKEINFO=missing
+		if [ "$BUILD" != "" -a "$HOST" != "" ]; then
+			$SRC/gcc/configure --host=$HOST --build=$BUILD \
+				--target=powerpc-apple-macos --prefix=$PREFIX \
+				--enable-languages=c,c++ --disable-libssp --disable-lto MAKEINFO=missing
+		elif [ "$BUILD" != "" ]; then
+			$SRC/gcc/configure --build=$BUILD \
+				--target=powerpc-apple-macos --prefix=$PREFIX \
+				--enable-languages=c,c++ --disable-libssp --disable-lto MAKEINFO=missing
+		elif [ "$HOST" != "" ]; then
+			$SRC/gcc/configure --host=$HOST \
+				--target=powerpc-apple-macos --prefix=$PREFIX \
+				--enable-languages=c,c++ --disable-libssp --disable-lto MAKEINFO=missing
+		else
+			$SRC/gcc/configure --target=powerpc-apple-macos --prefix=$PREFIX \
+				--enable-languages=c,c++ --disable-libssp --disable-lto MAKEINFO=missing
+		fi
+
+		sed -i -e 's#S\["GCC_FOR_TARGET"\]="powerpc-apple-macos-gcc"#S["GCC_FOR_TARGET"]="$$r/$(HOST_SUBDIR)/gcc/xgcc.exe -B$$r/$(HOST_SUBDIR)/gcc/"#g' config.status
+		sed -i -e 's#S\["CXX_FOR_TARGET"\]="powerpc-apple-macos-c[+][+]"#S["CXX_FOR_TARGET"]="$$r/$(HOST_SUBDIR)/gcc/xg++.exe -B$$r/$(HOST_SUBDIR)/gcc/ -nostdinc++ `if test -f $$r/$(TARGET_SUBDIR)/libstdc++-v3/scripts/testsuite_flags; then $(SHEL"\\\n"L) $$r/$(TARGET_SUBDIR)/libstdc++-v3/scripts/testsuite_flags --build-includes; else echo -funconfigured-libstdc++-v3 ; fi` -L$$r/$(TARGET_SUBDIR)/li"\\\n"bstdc++-v3/src -L$$r/$(TARGET_SUBDIR)/libstdc++-v3/src/.libs -L$$r/$(TARGET_SUBDIR)/libstdc++-v3/libsupc++/.libs"#g' config.status
+		sed -i -e 's#S\["CC_FOR_TARGET"\]="powerpc-apple-macos-cc"#S["CC_FOR_TARGET"]="$$r/$(HOST_SUBDIR)/gcc/xgcc.exe -B$$r/$(HOST_SUBDIR)/gcc/"#g' config.status
+		sed -i -e 's#S\["RAW_CXX_FOR_TARGET"\]="powerpc-apple-macos-c[+][+]"#S["RAW_CXX_FOR_TARGET"]="$$r/$(HOST_SUBDIR)/gcc/xgcc.exe -shared-libgcc -B$$r/$(HOST_SUBDIR)/gcc -nostdinc++ -L$$r/$(TARGET_SUBDIR)/libstdc++-v3/src -L$$r/$(TARGET_SUBDIR)/libst"\\\n"dc++-v3/src/.libs -L$$r/$(TARGET_SUBDIR)/libstdc++-v3/libsupc++/.libs"#g' config.status
+
+		sed -i -e 's#S\["AS_FOR_TARGET"\]="powerpc-apple-macos-as"#S["AS_FOR_TARGET"]="'"$PREFIX"'powerpc-apple-macos/bin/as.exe"#g' config.status
+		sed -i -e 's#S\["AR_FOR_TARGET"\]="powerpc-apple-macos-ar"#S["AR_FOR_TARGET"]="'"$PREFIX"'powerpc-apple-macos/bin/ar.exe"#g' config.status
+		sed -i -e 's#S\["LD_FOR_TARGET"\]="powerpc-apple-macos-ld"#S["LD_FOR_TARGET"]="'"$PREFIX"'powerpc-apple-macos/bin/ld.exe"#g' config.status
+		sed -i -e 's#S\["NM_FOR_TARGET"\]="powerpc-apple-macos-nm"#S["NM_FOR_TARGET"]="'"$PREFIX"'powerpc-apple-macos/bin/nm.exe"#g' config.status
+		sed -i -e 's#S\["STRIP_FOR_TARGET"\]="powerpc-apple-macos-strip"#S["STRIP_FOR_TARGET"]="'"$PREFIX"'powerpc-apple-macos/bin/strip.exe"#g' config.status
+		sed -i -e 's#S\["READELF_FOR_TARGET"\]="powerpc-apple-macos-readelf"#S["READELF_FOR_TARGET"]="'"$PREFIX"'powerpc-apple-macos/bin/readelf.exe"#g' config.status
+		sed -i -e 's#S\["RANLIB_FOR_TARGET"\]="powerpc-apple-macos-ranlib"#S["RANLIB_FOR_TARGET"]="'"$PREFIX"'powerpc-apple-macos/bin/ranlib.exe"#g' config.status
+		sed -i -e 's#S\["OBJDUMP_FOR_TARGET"\]="powerpc-apple-macos-objdump"#S["OBJDUMP_FOR_TARGET"]="'"$PREFIX"'powerpc-apple-macos/bin/objdump.exe"#g' config.status
+		sed -i -e 's#S\["OBJCOPY_FOR_TARGET"\]="powerpc-apple-macos-objcopy"#S["OBJCOPY_FOR_TARGET"]="'"$PREFIX"'powerpc-apple-macos/bin/objcopy.exe"#g' config.status
+		sed -i -e 's#S\["DSYMUTIL_FOR_TARGET"\]="powerpc-apple-macos-dsymutil"#S["DSYMUTIL_FOR_TARGET"]="'"$PREFIX"'powerpc-apple-macos/bin/dsymutil.exe"#g' config.status
+
+		sed -i -e 's#GCC_FOR_TARGET=$(STAGE_CC_WRAPPER) powerpc-apple-macos-gcc#GCC_FOR_TARGET=$(STAGE_CC_WRAPPER) $$r/$(HOST_SUBDIR)/gcc/xgcc.exe -B$$r/$(HOST_SUBDIR)/gcc/#g' Makefile
+		sed -i -e 's#CXX_FOR_TARGET=$(STAGE_CC_WRAPPER) powerpc-apple-macos-c[+][+]#CXX_FOR_TARGET=$(STAGE_CC_WRAPPER) $$r/$(HOST_SUBDIR)/gcc/xg++.exe -B$$r/$(HOST_SUBDIR)/gcc/ -nostdinc++ `if test -f $$r/$(TARGET_SUBDIR)/libstdc++-v3/scripts/testsuite_flags; then $(SHELL) $$r/$(TARGET_SUBDIR)/libstdc++-v3/scripts/testsuite_flags --build-includes; else echo -funconfigured-libstdc++-v3 ; fi` -L$$r/$(TARGET_SUBDIR)/libstdc++-v3/src -L$$r/$(TARGET_SUBDIR)/libstdc++-v3/src/.libs -L$$r/$(TARGET_SUBDIR)/libstdc++-v3/libsupc++/.libs#g' Makefile
+		sed -i -e 's#CC_FOR_TARGET=$(STAGE_CC_WRAPPER) powerpc-apple-macos-cc#CC_FOR_TARGET=$(STAGE_CC_WRAPPER) $$r/$(HOST_SUBDIR)/gcc/xgcc.exe -B$$r/$(HOST_SUBDIR)/gcc/#g' Makefile
+		sed -i -e 's#RAW_CXX_FOR_TARGET=$(STAGE_CC_WRAPPER) powerpc-apple-macos-c[+][+]#RAW_CXX_FOR_TARGET=$(STAGE_CC_WRAPPER) $$r/$(HOST_SUBDIR)/gcc/xgcc.exe -shared-libgcc -B$$r/$(HOST_SUBDIR)/gcc -nostdinc++ -L$$r/$(TARGET_SUBDIR)/libstdc++-v3/src -L$$r/$(TARGET_SUBDIR)/libstdc++-v3/src/.libs -L$$r/$(TARGET_SUBDIR)/libstdc++-v3/libsupc++/.libs#g' Makefile
+		sed -i -e 's#RAW_CXX_FOR_TARGET=$(STAGE_CC_WRAPPER) $$r/$(HOST_SUBDIR)/gcc/xg[+][+].exe -B$$r/$(HOST_SUBDIR)/gcc/ -nostdinc[+][+] `if test -f $$r/$(TARGET_SUBDIR)/libstdc[+][+]-v3/scripts/testsuite_flags; then $(SHELL) $$r/$(TARGET_SUBDIR)/libstdc[+][+]-v3/scripts/testsuite_flags --build-includes; else echo -funconfigured-libstdc[+][+]-v3 ; fi` -L$$r/$(TARGET_SUBDIR)/libstdc[+][+]-v3/src -L$$r/$(TARGET_SUBDIR)/libstdc[+][+]-v3/src/.libs -L$$r/$(TARGET_SUBDIR)/libstdc[+][+]-v3/libsupc[+][+]/.libs#RAW_CXX_FOR_TARGET=$(STAGE_CC_WRAPPER) $$r/$(HOST_SUBDIR)/gcc/xgcc.exe -shared-libgcc -B$$r/$(HOST_SUBDIR)/gcc -nostdinc++ -L$$r/$(TARGET_SUBDIR)/libstdc++-v3/src -L$$r/$(TARGET_SUBDIR)/libstdc++-v3/src/.libs -L$$r/$(TARGET_SUBDIR)/libstdc++-v3/libsupc++/.libs#g' Makefile
+
+		sed -i -e 's#AS_FOR_TARGET=powerpc-apple-macos-as#AS_FOR_TARGET='"$PREFIX"'powerpc-apple-macos/bin/as.exe#g' Makefile
+		sed -i -e 's#AR_FOR_TARGET=powerpc-apple-macos-ar#AR_FOR_TARGET='"$PREFIX"'powerpc-apple-macos/bin/ar.exe#g' Makefile
+		sed -i -e 's#LD_FOR_TARGET=powerpc-apple-macos-ld#LD_FOR_TARGET='"$PREFIX"'powerpc-apple-macos/bin/ld.exe#g' Makefile
+		sed -i -e 's#NM_FOR_TARGET=powerpc-apple-macos-nm#NM_FOR_TARGET='"$PREFIX"'powerpc-apple-macos/bin/nm.exe#g' Makefile
+		sed -i -e 's#STRIP_FOR_TARGET=powerpc-apple-macos-strip#STRIP_FOR_TARGET='"$PREFIX"'powerpc-apple-macos/bin/strip.exe#g' Makefile
+		sed -i -e 's#READELF_FOR_TARGET=powerpc-apple-macos-readelf#READELF_FOR_TARGET='"$PREFIX"'powerpc-apple-macos/bin/readelf.exe#g' Makefile
+		sed -i -e 's#RANLIB_FOR_TARGET=powerpc-apple-macos-ranlib#RANLIB_FOR_TARGET='"$PREFIX"'powerpc-apple-macos/bin/ranlib.exe#g' Makefile
+		sed -i -e 's#OBJDUMP_FOR_TARGET=powerpc-apple-macos-objdump#OBJDUMP_FOR_TARGET='"$PREFIX"'powerpc-apple-macos/bin/objdump.exe#g' Makefile
+		sed -i -e 's#OBJCOPY_FOR_TARGET=powerpc-apple-macos-objcopy#OBJCOPY_FOR_TARGET='"$PREFIX"'powerpc-apple-macos/bin/objcopy.exe#g' Makefile
+		sed -i -e 's#DSYMUTIL_FOR_TARGET=powerpc-apple-macos-dsymutil#DSYMUTIL_FOR_TARGET='"$PREFIX"'powerpc-apple-macos/bin/dsymutil.exe#g' Makefile
+
 		make -j$BUILD_JOBS
 		make install
 		unset target_configargs
@@ -295,23 +495,38 @@ if [ $SKIP_THIRDPARTY != true ]; then
 			rm -rf gcc-build-ppc
 		fi
 	fi
+	if [ $STOP_AFTER_PPC_GCC != false ]; then
+		unset CPPFLAGS
+		unset LDFLAGS
+		exit 0
+	fi
 
 	unset CPPFLAGS
 	unset LDFLAGS
 
 
+	if [ $SKIP_TOOLS != true ]; then
 	# Build hfsutil
-	mkdir -p $PREFIX/lib
-	mkdir -p $PREFIX/share/man/man1
-	mkdir -p hfsutils
-	cd hfsutils
-	$SRC/hfsutils/configure --prefix=$PREFIX --mandir=$PREFIX/share/man --enable-devlibs
-	make
-	make install
-	cd ..
+		mkdir -p $PREFIX/lib
+		mkdir -p $PREFIX/share/man/man1
+		mkdir -p hfsutils
+		cd hfsutils
+		if [ "$BUILD" != "" -a "$HOST" != "" ]; then
+			$SRC/hfsutils/configure --host=$HOST --build=$BUILD --prefix=$PREFIX --mandir=$PREFIX/share/man --enable-devlibs
+		elif [ "$BUILD" != "" ]; then
+			$SRC/hfsutils/configure --build=$BUILD --prefix=$PREFIX --mandir=$PREFIX/share/man --enable-devlibs
+		elif [ "$HOST" != "" ]; then
+			$SRC/hfsutils/configure --host=$HOST --prefix=$PREFIX --mandir=$PREFIX/share/man --enable-devlibs
+		else
+			$SRC/hfsutils/configure --prefix=$PREFIX --mandir=$PREFIX/share/man --enable-devlibs
+		fi
+		make
+		make install
+		cd ..
 
-	if [ $CLEAN_AFTER_BUILD != false ]; then
-		rm -rf hfsutils
+		if [ $CLEAN_AFTER_BUILD != false ]; then
+			rm -rf hfsutils
+		fi
 	fi
 else # SKIP_THIRDPARTY
     removeInterfacesAndLibraries
@@ -320,25 +535,70 @@ fi # SKIP_THIRDPARTY
 ##################### Build host-based components: MakePEF, MakeImport, ConvertObj, Rez, ...
 
 echo "Building host-based tools..."
+if [ $SKIP_TOOLS != true ]; then
+	echo "Building host-based tools..."
+
+	export WINEPATH="$(winepath -w "$PREFIX/bin");$WINEPATHPOST"
+	echo "WINEPATH: $WINEPATH"
+
+	mkdir -p build-host
+	cd build-host
+	if [ "$CROSS_PREFIX" != "" ]; then
+		if [ "$BOOST_ROOT" != "" ]; then
+			echo 'Boost_DIR="'"$Boost_DIR"'" BOOST_DIR="'"$Boost_DIR"'" BOOST_ROOT="'"$BOOST_ROOT"'" cmake '"${SRC}"' -DCMAKE_SYSTEM_NAME=Windows -DCMAKE_RANLIB='"${CROSS_PREFIX}"'ranlib -DCMAKE_C_COMPILER='"${CROSS_PREFIX}"'gcc -DCMAKE_CXX_COMPILER='"${CROSS_PREFIX}"'g++ -DCMAKE_RC_COMPILER='"${CROSS_PREFIX}"'windres -DCMAKE_INSTALL_PREFIX='"$PREFIX"' -DCMAKE_BUILD_TYPE=Debug -DBoost_USE_STATIC_LIBS:BOOL=ON -DBOOST_ROOT:PATH="'"$BOOST_ROOT"'" -DBOOST_DIR:PATH="'"$Boost_DIR"'" -DBoost_DIR:PATH="'"$Boost_DIR"'" "'"${HOST_CMAKE_FLAGS[@]}"'" '"${CMAKE_GENERATOR}"
+			Boost_DIR="$Boost_DIR" BOOST_DIR="$Boost_DIR" BOOST_ROOT="$BOOST_ROOT" cmake ${SRC} -DCMAKE_SYSTEM_NAME=Windows -DCMAKE_RANLIB=${CROSS_PREFIX}ranlib -DCMAKE_C_COMPILER=${CROSS_PREFIX}gcc -DCMAKE_CXX_COMPILER=${CROSS_PREFIX}g++ -DCMAKE_RC_COMPILER=${CROSS_PREFIX}windres -DCMAKE_INSTALL_PREFIX=$PREFIX -DCMAKE_BUILD_TYPE=Debug -DBoost_USE_STATIC_LIBS:BOOL=ON -DBOOST_ROOT:PATH="$BOOST_ROOT" -DBOOST_DIR:PATH="$Boost_DIR" -DBoost_DIR:PATH="$Boost_DIR" "${HOST_CMAKE_FLAGS[@]}" ${CMAKE_GENERATOR}
+		else
+			echo 'cmake '"${SRC}"' -DCMAKE_SYSTEM_NAME=Windows -DCMAKE_RANLIB='"${CROSS_PREFIX}"'ranlib -DCMAKE_C_COMPILER='"${CROSS_PREFIX}"'gcc -DCMAKE_CXX_COMPILER='"${CROSS_PREFIX}"'g++ -DCMAKE_RC_COMPILER='"${CROSS_PREFIX}"'windres -DCMAKE_INSTALL_PREFIX='"$PREFIX"' -DCMAKE_BUILD_TYPE=Debug "'"${HOST_CMAKE_FLAGS[@]}"'" '"${CMAKE_GENERATOR}"
+			cmake ${SRC} -DCMAKE_SYSTEM_NAME=Windows -DCMAKE_RANLIB=${CROSS_PREFIX}ranlib -DCMAKE_C_COMPILER=${CROSS_PREFIX}gcc -DCMAKE_CXX_COMPILER=${CROSS_PREFIX}g++ -DCMAKE_RC_COMPILER=${CROSS_PREFIX}windres -DCMAKE_INSTALL_PREFIX=$PREFIX -DCMAKE_BUILD_TYPE=Debug "${HOST_CMAKE_FLAGS[@]}" ${CMAKE_GENERATOR}
+		fi
+	else
+		if [ "$BOOST_ROOT" != "" ]; then
+			echo 'Boost_DIR="'"$Boost_DIR"'" BOOST_DIR="'"$Boost_DIR"'" BOOST_ROOT="'"$BOOST_ROOT"'" cmake '"${SRC}"' -DCMAKE_INSTALL_PREFIX='"$PREFIX"' -DCMAKE_BUILD_TYPE=Debug -DBoost_USE_STATIC_LIBS:BOOL=ON -DBOOST_ROOT:PATH="'"$BOOST_ROOT"'" -DBOOST_DIR:PATH="'"$Boost_DIR"'" -DBoost_DIR:PATH="'"$Boost_DIR"'" "'"${HOST_CMAKE_FLAGS[@]}"'" '"${CMAKE_GENERATOR}"
+			Boost_DIR="$Boost_DIR" BOOST_DIR="$Boost_DIR" BOOST_ROOT="$BOOST_ROOT" cmake ${SRC} -DCMAKE_INSTALL_PREFIX=$PREFIX -DCMAKE_BUILD_TYPE=Debug -DBoost_USE_STATIC_LIBS:BOOL=ON -DBOOST_ROOT:PATH="$BOOST_ROOT" -DBOOST_DIR:PATH="$Boost_DIR" -DBoost_DIR:PATH="$Boost_DIR" "${HOST_CMAKE_FLAGS[@]}" ${CMAKE_GENERATOR}
+		else
+			echo 'cmake '"${SRC}"' -DCMAKE_INSTALL_PREFIX='"$PREFIX"' -DCMAKE_BUILD_TYPE=Debug "'"${HOST_CMAKE_FLAGS[@]}"'" '"${CMAKE_GENERATOR}"
+			cmake ${SRC} -DCMAKE_INSTALL_PREFIX=$PREFIX -DCMAKE_BUILD_TYPE=Debug "${HOST_CMAKE_FLAGS[@]}" ${CMAKE_GENERATOR}
+		fi
+	fi
+	make
+	cd ..
 
-mkdir -p build-host
-cd build-host
-cmake ${SRC} -DCMAKE_INSTALL_PREFIX=$PREFIX -DCMAKE_BUILD_TYPE=Debug "${HOST_CMAKE_FLAGS[@]}" ${CMAKE_GENERATOR}
-cd ..
-cmake --build build-host --target install
+	mkdir -p install
+	if [ "$CROSS_PREFIX" != "" ]; then
+		#echo "cmake -DCMAKE_SYSTEM_NAME=Windows -DCMAKE_RANLIB=${CROSS_PREFIX}ranlib -DCMAKE_C_COMPILER=${CROSS_PREFIX}gcc -DCMAKE_CXX_COMPILER=${CROSS_PREFIX}g++ -DCMAKE_RC_COMPILER=${CROSS_PREFIX}windres -DCMAKE_INSTALL_PREFIX=\"$PREFIX\" --target install --build build-host"
+		#cmake -DCMAKE_SYSTEM_NAME=Windows -DCMAKE_RANLIB=${CROSS_PREFIX}ranlib -DCMAKE_C_COMPILER=${CROSS_PREFIX}gcc -DCMAKE_CXX_COMPILER=${CROSS_PREFIX}g++ -DCMAKE_RC_COMPILER=${CROSS_PREFIX}windres -DCMAKE_INSTALL_PREFIX="$PREFIX" --target install --build build-host
+		echo "cmake --build build-host --target install"
+		cmake --build build-host --target install
+	else
+		echo "cmake --build build-host --target install"
+		cmake --build build-host --target install
+	fi
+	cd build-host
+		make install
+	cd ..
 
-echo 'subdirs("build-host")' > CTestTestfile.cmake
+	echo 'subdirs("build-host")' > CTestTestfile.cmake
 
 	# make tools (such as MakeImport and the compilers) available for later commands
-export PATH=$PREFIX/bin:$PATH
+	export PATH=$PREFIX/bin:$PATH
 
 ##################### Set up Interfaces & Libraries
 
-(cd "${SRC}/multiversal" && ruby make-multiverse.rb -G CIncludes -o "${PREFIX}/multiversal")
-mkdir -p "${PREFIX}/multiversal/libppc"
-cp "${SRC}/ImportLibraries"/*.a "${PREFIX}/multiversal/libppc/"
-setUpInterfacesAndLibraries
-linkInterfacesAndLibraries ${INTERFACES_KIND}
+	(cd "${SRC}/multiversal" && ruby make-multiverse.rb -G CIncludes -o "${PREFIX}/multiversal")
+	mkdir -p "${PREFIX}/multiversal/libppc"
+	cp "${SRC}/ImportLibraries"/*.a "${PREFIX}/multiversal/libppc/"
+	setUpInterfacesAndLibraries
+	linkInterfacesAndLibraries ${INTERFACES_KIND}
+
+	if [ $STOP_AFTER_TOOLS != false ]; then
+		exit 0
+	fi
+else
+	export WINEPATH="$(winepath -w "$PREFIX/bin");$WINEPATHPOST"
+	echo "WINEPATH=$WINEPATH"
+	export PATH=$PREFIX/bin:$PATH
+	echo "PATH=$PATH"
+fi
 
 ##################### Build target libraries and samples
 
@@ -348,12 +608,27 @@ if [ $BUILD_68K != false ]; then
 	mkdir -p build-target
 	cd build-target
 
-	cmake ${SRC} -DCMAKE_TOOLCHAIN_FILE=../build-host/cmake/intree.toolchain.cmake \
-				 -DCMAKE_BUILD_TYPE=Release \
-				 -DCMAKE_TRY_COMPILE_TARGET_TYPE=STATIC_LIBRARY \
-				 ${CMAKE_GENERATOR}
+	if [ "$BOOST_ROOT" != "" ]; then
+		Boost_DIR="$Boost_DIR" BOOST_DIR="$Boost_DIR" BOOST_ROOT="$BOOST_ROOT" \
+		cmake ${SRC} -DCMAKE_TOOLCHAIN_FILE=../build-host/cmake/intree.toolchain.cmake \
+					 -DCMAKE_INSTALL_PREFIX='"$PREFIX"' \
+					 -DCMAKE_BUILD_TYPE=Release \
+					 -DCMAKE_TRY_COMPILE_TARGET_TYPE=STATIC_LIBRARY \
+					 -DBOOST_ROOT:PATH="$BOOST_ROOT" \
+					 -DBOOST_DIR:PATH="$Boost_DIR" \
+					 -DBoost_DIR:PATH="$Boost_DIR" \
+					 ${CMAKE_GENERATOR}
+	else
+		cmake ${SRC} -DCMAKE_TOOLCHAIN_FILE=../build-host/cmake/intree.toolchain.cmake \
+					 -DCMAKE_BUILD_TYPE=Release \
+					 -DCMAKE_TRY_COMPILE_TARGET_TYPE=STATIC_LIBRARY \
+					 ${CMAKE_GENERATOR}
+	fi
 	cd ..
 	cmake --build build-target --target install
+	cd build-target
+		make install
+	cd ..
 
 	echo 'subdirs("build-target")' >> CTestTestfile.cmake
 fi
@@ -363,12 +638,26 @@ if [ $BUILD_PPC != false ]; then
 	# Build target-based components for PPC
 	mkdir -p build-target-ppc
 	cd build-target-ppc
-	cmake ${SRC} -DCMAKE_TOOLCHAIN_FILE=../build-host/cmake/intreeppc.toolchain.cmake \
-				 -DCMAKE_BUILD_TYPE=Release \
-				 -DCMAKE_TRY_COMPILE_TARGET_TYPE=STATIC_LIBRARY \
-				 ${CMAKE_GENERATOR}
+	if [ "$BOOST_ROOT" != "" ]; then
+		Boost_DIR="$Boost_DIR" BOOST_DIR="$Boost_DIR" BOOST_ROOT="$BOOST_ROOT" \
+		cmake ${SRC} -DCMAKE_TOOLCHAIN_FILE=../build-host/cmake/intreeppc.toolchain.cmake \
+					 -DCMAKE_BUILD_TYPE=Release \
+					 -DCMAKE_TRY_COMPILE_TARGET_TYPE=STATIC_LIBRARY \
+					 -DBOOST_ROOT:PATH="$BOOST_ROOT" \
+					 -DBOOST_DIR:PATH="$Boost_DIR" \
+					 -DBoost_DIR:PATH="$Boost_DIR" \
+					 ${CMAKE_GENERATOR}
+	else
+		cmake ${SRC} -DCMAKE_TOOLCHAIN_FILE=../build-host/cmake/intreeppc.toolchain.cmake \
+					 -DCMAKE_BUILD_TYPE=Release \
+					 -DCMAKE_TRY_COMPILE_TARGET_TYPE=STATIC_LIBRARY \
+					 ${CMAKE_GENERATOR}
+	fi
 	cd ..
 	cmake --build build-target-ppc --target install
+	cd build-target-ppc
+		make install
+	cd ..
 
 	echo 'subdirs("build-target-ppc")' >> CTestTestfile.cmake
 fi
@@ -378,12 +667,26 @@ if [ $BUILD_CARBON != false ]; then
 	# Build target-based components for Carbon
 	mkdir -p build-target-carbon
 	cd build-target-carbon
-	cmake ${SRC} -DCMAKE_TOOLCHAIN_FILE=../build-host/cmake/intreecarbon.toolchain.cmake \
-				 -DCMAKE_BUILD_TYPE=Release \
-				 -DCMAKE_TRY_COMPILE_TARGET_TYPE=STATIC_LIBRARY \
-				 ${CMAKE_GENERATOR}
+	if [ "$BOOST_ROOT" != "" ]; then
+		Boost_DIR="$Boost_DIR" BOOST_DIR="$Boost_DIR" BOOST_ROOT="$BOOST_ROOT" \
+		cmake ${SRC} -DCMAKE_TOOLCHAIN_FILE=../build-host/cmake/intreecarbon.toolchain.cmake \
+					 -DCMAKE_BUILD_TYPE=Release \
+					 -DCMAKE_TRY_COMPILE_TARGET_TYPE=STATIC_LIBRARY \
+					 -DBOOST_ROOT:PATH="$BOOST_ROOT" \
+					 -DBOOST_DIR:PATH="$Boost_DIR" \
+					 -DBoost_DIR:PATH="$Boost_DIR" \
+					 ${CMAKE_GENERATOR}
+	else
+		cmake ${SRC} -DCMAKE_TOOLCHAIN_FILE=../build-host/cmake/intreecarbon.toolchain.cmake \
+					 -DCMAKE_BUILD_TYPE=Release \
+					 -DCMAKE_TRY_COMPILE_TARGET_TYPE=STATIC_LIBRARY \
+					 ${CMAKE_GENERATOR}
+	fi
 	cd ..
 	cmake --build build-target-carbon --target install
+	cd build-target-carbon
+		make install
+	cd ..
 
 	echo 'subdirs("build-target-carbon")' >> CTestTestfile.cmake
 fi
diff --git a/cmake/intree.toolchain.cmake.in b/cmake/intree.toolchain.cmake.in
index c9d556f479..a056daae63 100644
--- a/cmake/intree.toolchain.cmake.in
+++ b/cmake/intree.toolchain.cmake.in
@@ -22,11 +22,11 @@ set( RETRO68_ROOT "@RETRO68_ROOT@" CACHE PATH "path to root of Retro68 Toolchain
 set( CMAKE_INSTALL_PREFIX "${RETRO68_ROOT}/m68k-apple-macos/" CACHE PATH "installation prefix" )
 set( CMAKE_SYSTEM_PREFIX_PATH "${RETRO68_ROOT}/m68k-apple-macos/" )
 
-set( MAKE_APPL "@CMAKE_BINARY_DIR@/MakeAPPL/MakeAPPL" )
-set( REZ "@CMAKE_BINARY_DIR@/Rez/Rez" )
+set( MAKE_APPL "@CMAKE_BINARY_DIR@/MakeAPPL/MakeAPPL.exe" )
+set( REZ "@CMAKE_BINARY_DIR@/Rez/Rez.exe" )
 set( REZ_INCLUDE_PATH "${CMAKE_INSTALL_PREFIX}/RIncludes" )
 
-set( CMAKE_C_COMPILER "${RETRO68_ROOT}/bin/m68k-apple-macos-gcc" )
-set( CMAKE_CXX_COMPILER "${RETRO68_ROOT}/bin/m68k-apple-macos-g++" )
+set( CMAKE_C_COMPILER "${RETRO68_ROOT}/bin/m68k-apple-macos-gcc.exe" )
+set( CMAKE_CXX_COMPILER "${RETRO68_ROOT}/bin/m68k-apple-macos-g++.exe" )
 
 list( APPEND CMAKE_MODULE_PATH "@CMAKE_SOURCE_DIR@/cmake" )
diff --git a/cmake/intreecarbon.toolchain.cmake.in b/cmake/intreecarbon.toolchain.cmake.in
index cfe74b3dbf..b5d1ed82e9 100644
--- a/cmake/intreecarbon.toolchain.cmake.in
+++ b/cmake/intreecarbon.toolchain.cmake.in
@@ -22,13 +22,13 @@ set( RETRO68_ROOT "@RETRO68_ROOT@" CACHE PATH "path to root of Retro68 Toolchain
 set( CMAKE_INSTALL_PREFIX "${RETRO68_ROOT}/powerpc-apple-macos/" CACHE PATH "installation prefix" )
 set( CMAKE_SYSTEM_PREFIX_PATH "${RETRO68_ROOT}/powerpc-apple-macos/" )
 
-set( MAKE_PEF "@CMAKE_BINARY_DIR@/PEFTools/MakePEF" )
-set( MAKE_IMPORT "@CMAKE_BINARY_DIR@/PEFTools/MakeImport" )
-set( REZ "@CMAKE_BINARY_DIR@/Rez/Rez" )
+set( MAKE_PEF "@CMAKE_BINARY_DIR@/PEFTools/MakePEF.exe" )
+set( MAKE_IMPORT "@CMAKE_BINARY_DIR@/PEFTools/MakeImport.exe" )
+set( REZ "@CMAKE_BINARY_DIR@/Rez/Rez.exe" )
 set( REZ_INCLUDE_PATH "${CMAKE_INSTALL_PREFIX}/RIncludes" )
 
-set( CMAKE_C_COMPILER "${RETRO68_ROOT}/bin/powerpc-apple-macos-gcc" )
-set( CMAKE_CXX_COMPILER "${RETRO68_ROOT}/bin/powerpc-apple-macos-g++" )
+set( CMAKE_C_COMPILER "${RETRO68_ROOT}/bin/powerpc-apple-macos-gcc.exe" )
+set( CMAKE_CXX_COMPILER "${RETRO68_ROOT}/bin/powerpc-apple-macos-g++.exe" )
 set( CMAKE_EXE_LINKER_FLAGS_INIT "-carbon" )
 
 list( APPEND CMAKE_MODULE_PATH "@CMAKE_SOURCE_DIR@/cmake" )
diff --git a/cmake/intreeppc.toolchain.cmake.in b/cmake/intreeppc.toolchain.cmake.in
index f6f510801c..fa5f24db80 100644
--- a/cmake/intreeppc.toolchain.cmake.in
+++ b/cmake/intreeppc.toolchain.cmake.in
@@ -22,12 +22,12 @@ set( RETRO68_ROOT "@RETRO68_ROOT@" CACHE PATH "path to root of Retro68 Toolchain
 set( CMAKE_INSTALL_PREFIX "${RETRO68_ROOT}/powerpc-apple-macos/" CACHE PATH "installation prefix" )
 set( CMAKE_SYSTEM_PREFIX_PATH "${RETRO68_ROOT}/powerpc-apple-macos/" )
 
-set( MAKE_PEF "@CMAKE_BINARY_DIR@/PEFTools/MakePEF" )
-set( MAKE_IMPORT "@CMAKE_BINARY_DIR@/PEFTools/MakeImport" )
-set( REZ "@CMAKE_BINARY_DIR@/Rez/Rez" )
+set( MAKE_PEF "@CMAKE_BINARY_DIR@/PEFTools/MakePEF.exe" )
+set( MAKE_IMPORT "@CMAKE_BINARY_DIR@/PEFTools/MakeImport.exe" )
+set( REZ "@CMAKE_BINARY_DIR@/Rez/Rez.exe" )
 set( REZ_INCLUDE_PATH "${CMAKE_INSTALL_PREFIX}/RIncludes" )
 
-set( CMAKE_C_COMPILER "${RETRO68_ROOT}/bin/powerpc-apple-macos-gcc" )
-set( CMAKE_CXX_COMPILER "${RETRO68_ROOT}/bin/powerpc-apple-macos-g++" )
+set( CMAKE_C_COMPILER "${RETRO68_ROOT}/bin/powerpc-apple-macos-gcc.exe" )
+set( CMAKE_CXX_COMPILER "${RETRO68_ROOT}/bin/powerpc-apple-macos-g++.exe" )
 
 list( APPEND CMAKE_MODULE_PATH "@CMAKE_SOURCE_DIR@/cmake" )
diff --git a/cmake/retro68.toolchain.cmake.in b/cmake/retro68.toolchain.cmake.in
index cfdd0c7819..b2bfabd6dd 100644
--- a/cmake/retro68.toolchain.cmake.in
+++ b/cmake/retro68.toolchain.cmake.in
@@ -22,12 +22,12 @@ set( RETRO68_ROOT "@RETRO68_ROOT@" CACHE PATH "path to root of Retro68 Toolchain
 set( CMAKE_INSTALL_PREFIX "${RETRO68_ROOT}/m68k-apple-macos/" CACHE PATH "installation prefix" )
 set( CMAKE_SYSTEM_PREFIX_PATH "${RETRO68_ROOT}/m68k-apple-macos/" )
 
-set( MAKE_APPL "${RETRO68_ROOT}/bin/MakeAPPL" )
-set( REZ "${RETRO68_ROOT}/bin/Rez" )
+set( MAKE_APPL "${RETRO68_ROOT}/bin/MakeAPPL.exe" )
+set( REZ "${RETRO68_ROOT}/bin/Rez.exe" )
 set( REZ_INCLUDE_PATH "${RETRO68_ROOT}/m68k-apple-macos/RIncludes" )
 
-set( CMAKE_C_COMPILER "${RETRO68_ROOT}/bin/m68k-apple-macos-gcc" )
-set( CMAKE_CXX_COMPILER "${RETRO68_ROOT}/bin/m68k-apple-macos-g++" )
+set( CMAKE_C_COMPILER "${RETRO68_ROOT}/bin/m68k-apple-macos-gcc.exe" )
+set( CMAKE_CXX_COMPILER "${RETRO68_ROOT}/bin/m68k-apple-macos-g++.exe" )
 
 set( REZ_TEMPLATES_PATH ${REZ_INCLUDE_PATH})
 
diff --git a/cmake/retrocarbon.toolchain.cmake.in b/cmake/retrocarbon.toolchain.cmake.in
index a4113fed19..7c6917142f 100644
--- a/cmake/retrocarbon.toolchain.cmake.in
+++ b/cmake/retrocarbon.toolchain.cmake.in
@@ -22,13 +22,13 @@ set( RETRO68_ROOT "@RETRO68_ROOT@" CACHE PATH "path to root of Retro68 Toolchain
 set( CMAKE_INSTALL_PREFIX "${RETRO68_ROOT}/powerpc-apple-macos/" CACHE PATH "installation prefix" )
 set( CMAKE_SYSTEM_PREFIX_PATH "${RETRO68_ROOT}/powerpc-apple-macos/" )
 
-set( MAKE_PEF "${RETRO68_ROOT}/bin/MakePEF" )
-set( MAKE_IMPORT "${RETRO68_ROOT}/bin/MakeImport" )
-set( REZ "${RETRO68_ROOT}/bin/Rez" )
+set( MAKE_PEF "${RETRO68_ROOT}/bin/MakePEF.exe" )
+set( MAKE_IMPORT "${RETRO68_ROOT}/bin/MakeImport.exe" )
+set( REZ "${RETRO68_ROOT}/bin/Rez.exe" )
 set( REZ_INCLUDE_PATH "${RETRO68_ROOT}/powerpc-apple-macos/RIncludes" )
 
-set( CMAKE_C_COMPILER "${RETRO68_ROOT}/bin/powerpc-apple-macos-gcc" )
-set( CMAKE_CXX_COMPILER "${RETRO68_ROOT}/bin/powerpc-apple-macos-g++" )
+set( CMAKE_C_COMPILER "${RETRO68_ROOT}/bin/powerpc-apple-macos-gcc.exe" )
+set( CMAKE_CXX_COMPILER "${RETRO68_ROOT}/bin/powerpc-apple-macos-g++.exe" )
 set( CMAKE_EXE_LINKER_FLAGS_INIT "-carbon" )
 
 set( REZ_TEMPLATES_PATH ${REZ_INCLUDE_PATH})
diff --git a/cmake/retroppc.toolchain.cmake.in b/cmake/retroppc.toolchain.cmake.in
index 3e13ef04f8..e19bd0780d 100644
--- a/cmake/retroppc.toolchain.cmake.in
+++ b/cmake/retroppc.toolchain.cmake.in
@@ -22,13 +22,13 @@ set( RETRO68_ROOT "@RETRO68_ROOT@" CACHE PATH "path to root of Retro68 Toolchain
 set( CMAKE_INSTALL_PREFIX "${RETRO68_ROOT}/powerpc-apple-macos/" CACHE PATH "installation prefix" )
 set( CMAKE_SYSTEM_PREFIX_PATH "${RETRO68_ROOT}/powerpc-apple-macos/" )
 
-set( MAKE_PEF "${RETRO68_ROOT}/bin/MakePEF" )
-set( MAKE_IMPORT "${RETRO68_ROOT}/bin/MakeImport" )
-set( REZ "${RETRO68_ROOT}/bin/Rez" )
+set( MAKE_PEF "${RETRO68_ROOT}/bin/MakePEF.exe" )
+set( MAKE_IMPORT "${RETRO68_ROOT}/bin/MakeImport.exe" )
+set( REZ "${RETRO68_ROOT}/bin/Rez.exe" )
 set( REZ_INCLUDE_PATH "${RETRO68_ROOT}/powerpc-apple-macos/RIncludes" )
 
-set( CMAKE_C_COMPILER "${RETRO68_ROOT}/bin/powerpc-apple-macos-gcc" )
-set( CMAKE_CXX_COMPILER "${RETRO68_ROOT}/bin/powerpc-apple-macos-g++" )
+set( CMAKE_C_COMPILER "${RETRO68_ROOT}/bin/powerpc-apple-macos-gcc.exe" )
+set( CMAKE_CXX_COMPILER "${RETRO68_ROOT}/bin/powerpc-apple-macos-g++.exe" )
 
 set( REZ_TEMPLATES_PATH ${REZ_INCLUDE_PATH})
 
diff --git a/gcc/Makefile.in b/gcc/Makefile.in
index 593495e165..6b5527cc91 100644
--- a/gcc/Makefile.in
+++ b/gcc/Makefile.in
@@ -43589,6 +43589,7 @@ configure-target-libstdc++-v3:
 	echo "Checking multilib configuration for libstdc++-v3..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs $(TARGET_SUBDIR)/libstdc++-v3; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libstdc++-v3/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp $(TARGET_SUBDIR)/libstdc++-v3/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp; \
@@ -43633,6 +43634,7 @@ configure-stage1-target-libstdc++-v3:
 	TFLAGS="$(STAGE1_TFLAGS)"; \
 	echo "Checking multilib configuration for libstdc++-v3..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libstdc++-v3/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp $(TARGET_SUBDIR)/libstdc++-v3/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp; \
@@ -43677,6 +43679,7 @@ configure-stage2-target-libstdc++-v3:
 	TFLAGS="$(STAGE2_TFLAGS)"; \
 	echo "Checking multilib configuration for libstdc++-v3..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libstdc++-v3/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp $(TARGET_SUBDIR)/libstdc++-v3/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp; \
@@ -43722,6 +43725,7 @@ configure-stage3-target-libstdc++-v3:
 	TFLAGS="$(STAGE3_TFLAGS)"; \
 	echo "Checking multilib configuration for libstdc++-v3..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libstdc++-v3/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp $(TARGET_SUBDIR)/libstdc++-v3/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp; \
@@ -43767,6 +43771,7 @@ configure-stage4-target-libstdc++-v3:
 	TFLAGS="$(STAGE4_TFLAGS)"; \
 	echo "Checking multilib configuration for libstdc++-v3..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libstdc++-v3/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp $(TARGET_SUBDIR)/libstdc++-v3/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp; \
@@ -43812,6 +43817,7 @@ configure-stageprofile-target-libstdc++-v3:
 	TFLAGS="$(STAGEprofile_TFLAGS)"; \
 	echo "Checking multilib configuration for libstdc++-v3..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libstdc++-v3/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp $(TARGET_SUBDIR)/libstdc++-v3/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp; \
@@ -43857,6 +43863,7 @@ configure-stagetrain-target-libstdc++-v3:
 	TFLAGS="$(STAGEtrain_TFLAGS)"; \
 	echo "Checking multilib configuration for libstdc++-v3..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libstdc++-v3/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp $(TARGET_SUBDIR)/libstdc++-v3/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp; \
@@ -43902,6 +43909,7 @@ configure-stagefeedback-target-libstdc++-v3:
 	TFLAGS="$(STAGEfeedback_TFLAGS)"; \
 	echo "Checking multilib configuration for libstdc++-v3..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libstdc++-v3/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp $(TARGET_SUBDIR)/libstdc++-v3/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp; \
@@ -43947,6 +43955,7 @@ configure-stageautoprofile-target-libstdc++-v3:
 	TFLAGS="$(STAGEautoprofile_TFLAGS)"; \
 	echo "Checking multilib configuration for libstdc++-v3..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libstdc++-v3/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp $(TARGET_SUBDIR)/libstdc++-v3/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp; \
@@ -43992,6 +44001,7 @@ configure-stageautofeedback-target-libstdc++-v3:
 	TFLAGS="$(STAGEautofeedback_TFLAGS)"; \
 	echo "Checking multilib configuration for libstdc++-v3..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libstdc++-v3/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp $(TARGET_SUBDIR)/libstdc++-v3/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libstdc++-v3/multilib.tmp; \
@@ -44859,6 +44869,7 @@ configure-target-libsanitizer:
 	echo "Checking multilib configuration for libsanitizer..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs $(TARGET_SUBDIR)/libsanitizer; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libsanitizer/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libsanitizer/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libsanitizer/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libsanitizer/multilib.tmp $(TARGET_SUBDIR)/libsanitizer/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libsanitizer/multilib.tmp; \
@@ -44903,6 +44914,7 @@ configure-stage1-target-libsanitizer:
 	TFLAGS="$(STAGE1_TFLAGS)"; \
 	echo "Checking multilib configuration for libsanitizer..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libsanitizer/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libsanitizer/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libsanitizer/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libsanitizer/multilib.tmp $(TARGET_SUBDIR)/libsanitizer/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libsanitizer/multilib.tmp; \
@@ -44947,6 +44959,7 @@ configure-stage2-target-libsanitizer:
 	TFLAGS="$(STAGE2_TFLAGS)"; \
 	echo "Checking multilib configuration for libsanitizer..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libsanitizer/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libsanitizer/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libsanitizer/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libsanitizer/multilib.tmp $(TARGET_SUBDIR)/libsanitizer/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libsanitizer/multilib.tmp; \
@@ -44992,6 +45005,7 @@ configure-stage3-target-libsanitizer:
 	TFLAGS="$(STAGE3_TFLAGS)"; \
 	echo "Checking multilib configuration for libsanitizer..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libsanitizer/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libsanitizer/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libsanitizer/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libsanitizer/multilib.tmp $(TARGET_SUBDIR)/libsanitizer/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libsanitizer/multilib.tmp; \
@@ -45037,6 +45051,7 @@ configure-stage4-target-libsanitizer:
 	TFLAGS="$(STAGE4_TFLAGS)"; \
 	echo "Checking multilib configuration for libsanitizer..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libsanitizer/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libsanitizer/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libsanitizer/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libsanitizer/multilib.tmp $(TARGET_SUBDIR)/libsanitizer/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libsanitizer/multilib.tmp; \
@@ -45082,6 +45097,7 @@ configure-stageprofile-target-libsanitizer:
 	TFLAGS="$(STAGEprofile_TFLAGS)"; \
 	echo "Checking multilib configuration for libsanitizer..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libsanitizer/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libsanitizer/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libsanitizer/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libsanitizer/multilib.tmp $(TARGET_SUBDIR)/libsanitizer/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libsanitizer/multilib.tmp; \
@@ -45127,6 +45143,7 @@ configure-stagetrain-target-libsanitizer:
 	TFLAGS="$(STAGEtrain_TFLAGS)"; \
 	echo "Checking multilib configuration for libsanitizer..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libsanitizer/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libsanitizer/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libsanitizer/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libsanitizer/multilib.tmp $(TARGET_SUBDIR)/libsanitizer/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libsanitizer/multilib.tmp; \
@@ -45172,6 +45189,7 @@ configure-stagefeedback-target-libsanitizer:
 	TFLAGS="$(STAGEfeedback_TFLAGS)"; \
 	echo "Checking multilib configuration for libsanitizer..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libsanitizer/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libsanitizer/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libsanitizer/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libsanitizer/multilib.tmp $(TARGET_SUBDIR)/libsanitizer/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libsanitizer/multilib.tmp; \
@@ -45217,6 +45235,7 @@ configure-stageautoprofile-target-libsanitizer:
 	TFLAGS="$(STAGEautoprofile_TFLAGS)"; \
 	echo "Checking multilib configuration for libsanitizer..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libsanitizer/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libsanitizer/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libsanitizer/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libsanitizer/multilib.tmp $(TARGET_SUBDIR)/libsanitizer/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libsanitizer/multilib.tmp; \
@@ -45262,6 +45281,7 @@ configure-stageautofeedback-target-libsanitizer:
 	TFLAGS="$(STAGEautofeedback_TFLAGS)"; \
 	echo "Checking multilib configuration for libsanitizer..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libsanitizer/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libsanitizer/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libsanitizer/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libsanitizer/multilib.tmp $(TARGET_SUBDIR)/libsanitizer/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libsanitizer/multilib.tmp; \
@@ -46129,6 +46149,7 @@ configure-target-libvtv:
 	echo "Checking multilib configuration for libvtv..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs $(TARGET_SUBDIR)/libvtv; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libvtv/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libvtv/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libvtv/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libvtv/multilib.tmp $(TARGET_SUBDIR)/libvtv/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libvtv/multilib.tmp; \
@@ -46173,6 +46194,7 @@ configure-stage1-target-libvtv:
 	TFLAGS="$(STAGE1_TFLAGS)"; \
 	echo "Checking multilib configuration for libvtv..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libvtv/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libvtv/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libvtv/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libvtv/multilib.tmp $(TARGET_SUBDIR)/libvtv/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libvtv/multilib.tmp; \
@@ -46217,6 +46239,7 @@ configure-stage2-target-libvtv:
 	TFLAGS="$(STAGE2_TFLAGS)"; \
 	echo "Checking multilib configuration for libvtv..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libvtv/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libvtv/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libvtv/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libvtv/multilib.tmp $(TARGET_SUBDIR)/libvtv/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libvtv/multilib.tmp; \
@@ -46262,6 +46285,7 @@ configure-stage3-target-libvtv:
 	TFLAGS="$(STAGE3_TFLAGS)"; \
 	echo "Checking multilib configuration for libvtv..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libvtv/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libvtv/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libvtv/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libvtv/multilib.tmp $(TARGET_SUBDIR)/libvtv/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libvtv/multilib.tmp; \
@@ -46307,6 +46331,7 @@ configure-stage4-target-libvtv:
 	TFLAGS="$(STAGE4_TFLAGS)"; \
 	echo "Checking multilib configuration for libvtv..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libvtv/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libvtv/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libvtv/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libvtv/multilib.tmp $(TARGET_SUBDIR)/libvtv/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libvtv/multilib.tmp; \
@@ -46352,6 +46377,7 @@ configure-stageprofile-target-libvtv:
 	TFLAGS="$(STAGEprofile_TFLAGS)"; \
 	echo "Checking multilib configuration for libvtv..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libvtv/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libvtv/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libvtv/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libvtv/multilib.tmp $(TARGET_SUBDIR)/libvtv/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libvtv/multilib.tmp; \
@@ -46397,6 +46423,7 @@ configure-stagetrain-target-libvtv:
 	TFLAGS="$(STAGEtrain_TFLAGS)"; \
 	echo "Checking multilib configuration for libvtv..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libvtv/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libvtv/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libvtv/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libvtv/multilib.tmp $(TARGET_SUBDIR)/libvtv/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libvtv/multilib.tmp; \
@@ -46442,6 +46469,7 @@ configure-stagefeedback-target-libvtv:
 	TFLAGS="$(STAGEfeedback_TFLAGS)"; \
 	echo "Checking multilib configuration for libvtv..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libvtv/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libvtv/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libvtv/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libvtv/multilib.tmp $(TARGET_SUBDIR)/libvtv/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libvtv/multilib.tmp; \
@@ -46487,6 +46515,7 @@ configure-stageautoprofile-target-libvtv:
 	TFLAGS="$(STAGEautoprofile_TFLAGS)"; \
 	echo "Checking multilib configuration for libvtv..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libvtv/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libvtv/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libvtv/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libvtv/multilib.tmp $(TARGET_SUBDIR)/libvtv/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libvtv/multilib.tmp; \
@@ -46532,6 +46561,7 @@ configure-stageautofeedback-target-libvtv:
 	TFLAGS="$(STAGEautofeedback_TFLAGS)"; \
 	echo "Checking multilib configuration for libvtv..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libvtv/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libvtv/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libvtv/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libvtv/multilib.tmp $(TARGET_SUBDIR)/libvtv/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libvtv/multilib.tmp; \
@@ -47400,6 +47430,7 @@ configure-target-liboffloadmic:
 	echo "Checking multilib configuration for liboffloadmic..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs $(TARGET_SUBDIR)/liboffloadmic; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/liboffloadmic/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/liboffloadmic/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/liboffloadmic/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/liboffloadmic/multilib.tmp $(TARGET_SUBDIR)/liboffloadmic/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/liboffloadmic/multilib.tmp; \
@@ -47885,6 +47916,7 @@ configure-target-libssp:
 	echo "Checking multilib configuration for libssp..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs $(TARGET_SUBDIR)/libssp; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libssp/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libssp/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libssp/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libssp/multilib.tmp $(TARGET_SUBDIR)/libssp/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libssp/multilib.tmp; \
@@ -48370,6 +48402,7 @@ configure-target-newlib:
 	echo "Checking multilib configuration for newlib..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs $(TARGET_SUBDIR)/newlib; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/newlib/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/newlib/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/newlib/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/newlib/multilib.tmp $(TARGET_SUBDIR)/newlib/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/newlib/multilib.tmp; \
@@ -48854,6 +48887,7 @@ configure-target-libgcc:
 	echo "Checking multilib configuration for libgcc..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs $(TARGET_SUBDIR)/libgcc; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libgcc/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libgcc/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libgcc/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libgcc/multilib.tmp $(TARGET_SUBDIR)/libgcc/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libgcc/multilib.tmp; \
@@ -48898,6 +48932,7 @@ configure-stage1-target-libgcc:
 	TFLAGS="$(STAGE1_TFLAGS)"; \
 	echo "Checking multilib configuration for libgcc..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libgcc/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libgcc/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libgcc/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libgcc/multilib.tmp $(TARGET_SUBDIR)/libgcc/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libgcc/multilib.tmp; \
@@ -48941,7 +48976,8 @@ configure-stage2-target-libgcc:
 	s=`cd $(srcdir); ${PWD_COMMAND}`; export s; \
 	TFLAGS="$(STAGE2_TFLAGS)"; \
 	echo "Checking multilib configuration for libgcc..."; \
-	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libgcc/multilib.tmp 2> /dev/null; \
+	$(CC_FOR_TARGET) --enable-bootstrap --print-multi-lib > $(TARGET_SUBDIR)/libgcc/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libgcc/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libgcc/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libgcc/multilib.tmp $(TARGET_SUBDIR)/libgcc/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libgcc/multilib.tmp; \
@@ -48987,6 +49023,7 @@ configure-stage3-target-libgcc:
 	TFLAGS="$(STAGE3_TFLAGS)"; \
 	echo "Checking multilib configuration for libgcc..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libgcc/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libgcc/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libgcc/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libgcc/multilib.tmp $(TARGET_SUBDIR)/libgcc/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libgcc/multilib.tmp; \
@@ -49032,6 +49069,7 @@ configure-stage4-target-libgcc:
 	TFLAGS="$(STAGE4_TFLAGS)"; \
 	echo "Checking multilib configuration for libgcc..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libgcc/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libgcc/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libgcc/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libgcc/multilib.tmp $(TARGET_SUBDIR)/libgcc/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libgcc/multilib.tmp; \
@@ -49077,6 +49115,7 @@ configure-stageprofile-target-libgcc:
 	TFLAGS="$(STAGEprofile_TFLAGS)"; \
 	echo "Checking multilib configuration for libgcc..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libgcc/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libgcc/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libgcc/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libgcc/multilib.tmp $(TARGET_SUBDIR)/libgcc/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libgcc/multilib.tmp; \
@@ -49122,6 +49161,7 @@ configure-stagetrain-target-libgcc:
 	TFLAGS="$(STAGEtrain_TFLAGS)"; \
 	echo "Checking multilib configuration for libgcc..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libgcc/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libgcc/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libgcc/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libgcc/multilib.tmp $(TARGET_SUBDIR)/libgcc/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libgcc/multilib.tmp; \
@@ -49167,6 +49207,7 @@ configure-stagefeedback-target-libgcc:
 	TFLAGS="$(STAGEfeedback_TFLAGS)"; \
 	echo "Checking multilib configuration for libgcc..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libgcc/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libgcc/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libgcc/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libgcc/multilib.tmp $(TARGET_SUBDIR)/libgcc/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libgcc/multilib.tmp; \
@@ -49212,6 +49253,7 @@ configure-stageautoprofile-target-libgcc:
 	TFLAGS="$(STAGEautoprofile_TFLAGS)"; \
 	echo "Checking multilib configuration for libgcc..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libgcc/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libgcc/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libgcc/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libgcc/multilib.tmp $(TARGET_SUBDIR)/libgcc/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libgcc/multilib.tmp; \
@@ -49257,6 +49299,7 @@ configure-stageautofeedback-target-libgcc:
 	TFLAGS="$(STAGEautofeedback_TFLAGS)"; \
 	echo "Checking multilib configuration for libgcc..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libgcc/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libgcc/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libgcc/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libgcc/multilib.tmp $(TARGET_SUBDIR)/libgcc/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libgcc/multilib.tmp; \
@@ -50086,6 +50129,7 @@ configure-target-libbacktrace:
 	echo "Checking multilib configuration for libbacktrace..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs $(TARGET_SUBDIR)/libbacktrace; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libbacktrace/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libbacktrace/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libbacktrace/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libbacktrace/multilib.tmp $(TARGET_SUBDIR)/libbacktrace/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libbacktrace/multilib.tmp; \
@@ -50130,6 +50174,7 @@ configure-stage1-target-libbacktrace:
 	TFLAGS="$(STAGE1_TFLAGS)"; \
 	echo "Checking multilib configuration for libbacktrace..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libbacktrace/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libbacktrace/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libbacktrace/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libbacktrace/multilib.tmp $(TARGET_SUBDIR)/libbacktrace/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libbacktrace/multilib.tmp; \
@@ -50174,6 +50219,7 @@ configure-stage2-target-libbacktrace:
 	TFLAGS="$(STAGE2_TFLAGS)"; \
 	echo "Checking multilib configuration for libbacktrace..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libbacktrace/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libbacktrace/multilib.tmp 2> /dev/null; \
 	if test -r $(TARGET_SUBDIR)/libbacktrace/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libbacktrace/multilib.tmp $(TARGET_SUBDIR)/libbacktrace/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libbacktrace/multilib.tmp; \
@@ -50219,6 +50265,7 @@ configure-stage3-target-libbacktrace:
 	TFLAGS="$(STAGE3_TFLAGS)"; \
 	echo "Checking multilib configuration for libbacktrace..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libbacktrace/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libbacktrace/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libbacktrace/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libbacktrace/multilib.tmp $(TARGET_SUBDIR)/libbacktrace/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libbacktrace/multilib.tmp; \
@@ -50264,6 +50311,7 @@ configure-stage4-target-libbacktrace:
 	TFLAGS="$(STAGE4_TFLAGS)"; \
 	echo "Checking multilib configuration for libbacktrace..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libbacktrace/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libbacktrace/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libbacktrace/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libbacktrace/multilib.tmp $(TARGET_SUBDIR)/libbacktrace/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libbacktrace/multilib.tmp; \
@@ -50309,6 +50357,7 @@ configure-stageprofile-target-libbacktrace:
 	TFLAGS="$(STAGEprofile_TFLAGS)"; \
 	echo "Checking multilib configuration for libbacktrace..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libbacktrace/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libbacktrace/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libbacktrace/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libbacktrace/multilib.tmp $(TARGET_SUBDIR)/libbacktrace/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libbacktrace/multilib.tmp; \
@@ -50354,6 +50403,7 @@ configure-stagetrain-target-libbacktrace:
 	TFLAGS="$(STAGEtrain_TFLAGS)"; \
 	echo "Checking multilib configuration for libbacktrace..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libbacktrace/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libbacktrace/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libbacktrace/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libbacktrace/multilib.tmp $(TARGET_SUBDIR)/libbacktrace/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libbacktrace/multilib.tmp; \
@@ -50399,6 +50449,7 @@ configure-stagefeedback-target-libbacktrace:
 	TFLAGS="$(STAGEfeedback_TFLAGS)"; \
 	echo "Checking multilib configuration for libbacktrace..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libbacktrace/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libbacktrace/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libbacktrace/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libbacktrace/multilib.tmp $(TARGET_SUBDIR)/libbacktrace/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libbacktrace/multilib.tmp; \
@@ -50444,6 +50495,7 @@ configure-stageautoprofile-target-libbacktrace:
 	TFLAGS="$(STAGEautoprofile_TFLAGS)"; \
 	echo "Checking multilib configuration for libbacktrace..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libbacktrace/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libbacktrace/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libbacktrace/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libbacktrace/multilib.tmp $(TARGET_SUBDIR)/libbacktrace/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libbacktrace/multilib.tmp; \
@@ -50489,6 +50541,7 @@ configure-stageautofeedback-target-libbacktrace:
 	TFLAGS="$(STAGEautofeedback_TFLAGS)"; \
 	echo "Checking multilib configuration for libbacktrace..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libbacktrace/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libbacktrace/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libbacktrace/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libbacktrace/multilib.tmp $(TARGET_SUBDIR)/libbacktrace/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libbacktrace/multilib.tmp; \
@@ -51357,6 +51410,7 @@ configure-target-libquadmath:
 	echo "Checking multilib configuration for libquadmath..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs $(TARGET_SUBDIR)/libquadmath; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libquadmath/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libquadmath/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libquadmath/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libquadmath/multilib.tmp $(TARGET_SUBDIR)/libquadmath/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libquadmath/multilib.tmp; \
@@ -51842,6 +51896,7 @@ configure-target-libgfortran:
 	echo "Checking multilib configuration for libgfortran..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs $(TARGET_SUBDIR)/libgfortran; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libgfortran/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libgfortran/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libgfortran/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libgfortran/multilib.tmp $(TARGET_SUBDIR)/libgfortran/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libgfortran/multilib.tmp; \
@@ -52327,6 +52382,7 @@ configure-target-libobjc:
 	echo "Checking multilib configuration for libobjc..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs $(TARGET_SUBDIR)/libobjc; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libobjc/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libobjc/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libobjc/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libobjc/multilib.tmp $(TARGET_SUBDIR)/libobjc/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libobjc/multilib.tmp; \
@@ -52779,6 +52835,7 @@ configure-target-libgo:
 	echo "Checking multilib configuration for libgo..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs $(TARGET_SUBDIR)/libgo; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libgo/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libgo/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libgo/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libgo/multilib.tmp $(TARGET_SUBDIR)/libgo/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libgo/multilib.tmp; \
@@ -53263,6 +53320,7 @@ configure-target-libphobos:
 	echo "Checking multilib configuration for libphobos..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs $(TARGET_SUBDIR)/libphobos; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libphobos/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libphobos/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libphobos/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libphobos/multilib.tmp $(TARGET_SUBDIR)/libphobos/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libphobos/multilib.tmp; \
@@ -53307,6 +53365,7 @@ configure-stage1-target-libphobos:
 	TFLAGS="$(STAGE1_TFLAGS)"; \
 	echo "Checking multilib configuration for libphobos..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libphobos/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libphobos/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libphobos/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libphobos/multilib.tmp $(TARGET_SUBDIR)/libphobos/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libphobos/multilib.tmp; \
@@ -53351,6 +53410,7 @@ configure-stage2-target-libphobos:
 	TFLAGS="$(STAGE2_TFLAGS)"; \
 	echo "Checking multilib configuration for libphobos..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libphobos/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libphobos/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libphobos/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libphobos/multilib.tmp $(TARGET_SUBDIR)/libphobos/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libphobos/multilib.tmp; \
@@ -53396,6 +53456,7 @@ configure-stage3-target-libphobos:
 	TFLAGS="$(STAGE3_TFLAGS)"; \
 	echo "Checking multilib configuration for libphobos..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libphobos/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libphobos/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libphobos/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libphobos/multilib.tmp $(TARGET_SUBDIR)/libphobos/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libphobos/multilib.tmp; \
@@ -53441,6 +53502,7 @@ configure-stage4-target-libphobos:
 	TFLAGS="$(STAGE4_TFLAGS)"; \
 	echo "Checking multilib configuration for libphobos..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libphobos/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libphobos/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libphobos/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libphobos/multilib.tmp $(TARGET_SUBDIR)/libphobos/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libphobos/multilib.tmp; \
@@ -53486,6 +53548,7 @@ configure-stageprofile-target-libphobos:
 	TFLAGS="$(STAGEprofile_TFLAGS)"; \
 	echo "Checking multilib configuration for libphobos..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libphobos/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libphobos/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libphobos/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libphobos/multilib.tmp $(TARGET_SUBDIR)/libphobos/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libphobos/multilib.tmp; \
@@ -53531,6 +53594,7 @@ configure-stagetrain-target-libphobos:
 	TFLAGS="$(STAGEtrain_TFLAGS)"; \
 	echo "Checking multilib configuration for libphobos..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libphobos/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libphobos/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libphobos/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libphobos/multilib.tmp $(TARGET_SUBDIR)/libphobos/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libphobos/multilib.tmp; \
@@ -53576,6 +53640,7 @@ configure-stagefeedback-target-libphobos:
 	TFLAGS="$(STAGEfeedback_TFLAGS)"; \
 	echo "Checking multilib configuration for libphobos..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libphobos/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libphobos/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libphobos/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libphobos/multilib.tmp $(TARGET_SUBDIR)/libphobos/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libphobos/multilib.tmp; \
@@ -53621,6 +53686,7 @@ configure-stageautoprofile-target-libphobos:
 	TFLAGS="$(STAGEautoprofile_TFLAGS)"; \
 	echo "Checking multilib configuration for libphobos..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libphobos/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libphobos/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libphobos/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libphobos/multilib.tmp $(TARGET_SUBDIR)/libphobos/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libphobos/multilib.tmp; \
@@ -53666,6 +53732,7 @@ configure-stageautofeedback-target-libphobos:
 	TFLAGS="$(STAGEautofeedback_TFLAGS)"; \
 	echo "Checking multilib configuration for libphobos..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libphobos/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libphobos/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libphobos/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libphobos/multilib.tmp $(TARGET_SUBDIR)/libphobos/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libphobos/multilib.tmp; \
@@ -54534,6 +54601,7 @@ configure-target-libtermcap:
 	echo "Checking multilib configuration for libtermcap..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs $(TARGET_SUBDIR)/libtermcap; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libtermcap/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libtermcap/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libtermcap/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libtermcap/multilib.tmp $(TARGET_SUBDIR)/libtermcap/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libtermcap/multilib.tmp; \
@@ -54954,6 +55022,7 @@ configure-target-winsup:
 	echo "Checking multilib configuration for winsup..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs $(TARGET_SUBDIR)/winsup; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/winsup/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/winsup/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/winsup/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/winsup/multilib.tmp $(TARGET_SUBDIR)/winsup/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/winsup/multilib.tmp; \
@@ -55439,6 +55508,7 @@ configure-target-libgloss:
 	echo "Checking multilib configuration for libgloss..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs $(TARGET_SUBDIR)/libgloss; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libgloss/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libgloss/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libgloss/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libgloss/multilib.tmp $(TARGET_SUBDIR)/libgloss/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libgloss/multilib.tmp; \
@@ -55919,6 +55989,7 @@ configure-target-libffi:
 	echo "Checking multilib configuration for libffi..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs $(TARGET_SUBDIR)/libffi; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libffi/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libffi/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libffi/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libffi/multilib.tmp $(TARGET_SUBDIR)/libffi/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libffi/multilib.tmp; \
@@ -56393,6 +56464,7 @@ configure-target-zlib:
 	echo "Checking multilib configuration for zlib..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs $(TARGET_SUBDIR)/zlib; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/zlib/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/zlib/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/zlib/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/zlib/multilib.tmp $(TARGET_SUBDIR)/zlib/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/zlib/multilib.tmp; \
@@ -56437,6 +56509,7 @@ configure-stage1-target-zlib:
 	TFLAGS="$(STAGE1_TFLAGS)"; \
 	echo "Checking multilib configuration for zlib..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/zlib/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/zlib/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/zlib/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/zlib/multilib.tmp $(TARGET_SUBDIR)/zlib/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/zlib/multilib.tmp; \
@@ -56481,6 +56554,7 @@ configure-stage2-target-zlib:
 	TFLAGS="$(STAGE2_TFLAGS)"; \
 	echo "Checking multilib configuration for zlib..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/zlib/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/zlib/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/zlib/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/zlib/multilib.tmp $(TARGET_SUBDIR)/zlib/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/zlib/multilib.tmp; \
@@ -56526,6 +56600,7 @@ configure-stage3-target-zlib:
 	TFLAGS="$(STAGE3_TFLAGS)"; \
 	echo "Checking multilib configuration for zlib..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/zlib/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/zlib/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/zlib/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/zlib/multilib.tmp $(TARGET_SUBDIR)/zlib/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/zlib/multilib.tmp; \
@@ -56571,6 +56646,7 @@ configure-stage4-target-zlib:
 	TFLAGS="$(STAGE4_TFLAGS)"; \
 	echo "Checking multilib configuration for zlib..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/zlib/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/zlib/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/zlib/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/zlib/multilib.tmp $(TARGET_SUBDIR)/zlib/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/zlib/multilib.tmp; \
@@ -56616,6 +56692,7 @@ configure-stageprofile-target-zlib:
 	TFLAGS="$(STAGEprofile_TFLAGS)"; \
 	echo "Checking multilib configuration for zlib..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/zlib/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/zlib/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/zlib/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/zlib/multilib.tmp $(TARGET_SUBDIR)/zlib/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/zlib/multilib.tmp; \
@@ -56661,6 +56738,7 @@ configure-stagetrain-target-zlib:
 	TFLAGS="$(STAGEtrain_TFLAGS)"; \
 	echo "Checking multilib configuration for zlib..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/zlib/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/zlib/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/zlib/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/zlib/multilib.tmp $(TARGET_SUBDIR)/zlib/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/zlib/multilib.tmp; \
@@ -56706,6 +56784,7 @@ configure-stagefeedback-target-zlib:
 	TFLAGS="$(STAGEfeedback_TFLAGS)"; \
 	echo "Checking multilib configuration for zlib..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/zlib/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/zlib/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/zlib/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/zlib/multilib.tmp $(TARGET_SUBDIR)/zlib/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/zlib/multilib.tmp; \
@@ -56751,6 +56830,7 @@ configure-stageautoprofile-target-zlib:
 	TFLAGS="$(STAGEautoprofile_TFLAGS)"; \
 	echo "Checking multilib configuration for zlib..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/zlib/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/zlib/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/zlib/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/zlib/multilib.tmp $(TARGET_SUBDIR)/zlib/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/zlib/multilib.tmp; \
@@ -56796,6 +56876,7 @@ configure-stageautofeedback-target-zlib:
 	TFLAGS="$(STAGEautofeedback_TFLAGS)"; \
 	echo "Checking multilib configuration for zlib..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/zlib/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/zlib/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/zlib/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/zlib/multilib.tmp $(TARGET_SUBDIR)/zlib/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/zlib/multilib.tmp; \
@@ -57664,6 +57745,7 @@ configure-target-rda:
 	echo "Checking multilib configuration for rda..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs $(TARGET_SUBDIR)/rda; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/rda/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/rda/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/rda/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/rda/multilib.tmp $(TARGET_SUBDIR)/rda/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/rda/multilib.tmp; \
@@ -58149,6 +58231,7 @@ configure-target-libada:
 	echo "Checking multilib configuration for libada..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs $(TARGET_SUBDIR)/libada; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libada/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libada/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libada/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libada/multilib.tmp $(TARGET_SUBDIR)/libada/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libada/multilib.tmp; \
@@ -58633,6 +58716,7 @@ configure-target-libgomp:
 	echo "Checking multilib configuration for libgomp..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs $(TARGET_SUBDIR)/libgomp; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libgomp/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libgomp/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libgomp/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libgomp/multilib.tmp $(TARGET_SUBDIR)/libgomp/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libgomp/multilib.tmp; \
@@ -58677,6 +58761,7 @@ configure-stage1-target-libgomp:
 	TFLAGS="$(STAGE1_TFLAGS)"; \
 	echo "Checking multilib configuration for libgomp..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libgomp/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libgomp/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libgomp/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libgomp/multilib.tmp $(TARGET_SUBDIR)/libgomp/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libgomp/multilib.tmp; \
@@ -58721,6 +58806,7 @@ configure-stage2-target-libgomp:
 	TFLAGS="$(STAGE2_TFLAGS)"; \
 	echo "Checking multilib configuration for libgomp..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libgomp/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libgomp/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libgomp/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libgomp/multilib.tmp $(TARGET_SUBDIR)/libgomp/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libgomp/multilib.tmp; \
@@ -58766,6 +58852,7 @@ configure-stage3-target-libgomp:
 	TFLAGS="$(STAGE3_TFLAGS)"; \
 	echo "Checking multilib configuration for libgomp..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libgomp/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libgomp/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libgomp/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libgomp/multilib.tmp $(TARGET_SUBDIR)/libgomp/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libgomp/multilib.tmp; \
@@ -58811,6 +58898,7 @@ configure-stage4-target-libgomp:
 	TFLAGS="$(STAGE4_TFLAGS)"; \
 	echo "Checking multilib configuration for libgomp..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libgomp/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libgomp/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libgomp/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libgomp/multilib.tmp $(TARGET_SUBDIR)/libgomp/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libgomp/multilib.tmp; \
@@ -58856,6 +58944,7 @@ configure-stageprofile-target-libgomp:
 	TFLAGS="$(STAGEprofile_TFLAGS)"; \
 	echo "Checking multilib configuration for libgomp..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libgomp/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libgomp/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libgomp/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libgomp/multilib.tmp $(TARGET_SUBDIR)/libgomp/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libgomp/multilib.tmp; \
@@ -58901,6 +58990,7 @@ configure-stagetrain-target-libgomp:
 	TFLAGS="$(STAGEtrain_TFLAGS)"; \
 	echo "Checking multilib configuration for libgomp..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libgomp/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libgomp/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libgomp/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libgomp/multilib.tmp $(TARGET_SUBDIR)/libgomp/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libgomp/multilib.tmp; \
@@ -58946,6 +59036,7 @@ configure-stagefeedback-target-libgomp:
 	TFLAGS="$(STAGEfeedback_TFLAGS)"; \
 	echo "Checking multilib configuration for libgomp..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libgomp/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libgomp/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libgomp/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libgomp/multilib.tmp $(TARGET_SUBDIR)/libgomp/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libgomp/multilib.tmp; \
@@ -58991,6 +59082,7 @@ configure-stageautoprofile-target-libgomp:
 	TFLAGS="$(STAGEautoprofile_TFLAGS)"; \
 	echo "Checking multilib configuration for libgomp..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libgomp/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libgomp/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libgomp/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libgomp/multilib.tmp $(TARGET_SUBDIR)/libgomp/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libgomp/multilib.tmp; \
@@ -59036,6 +59128,7 @@ configure-stageautofeedback-target-libgomp:
 	TFLAGS="$(STAGEautofeedback_TFLAGS)"; \
 	echo "Checking multilib configuration for libgomp..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libgomp/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libgomp/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libgomp/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libgomp/multilib.tmp $(TARGET_SUBDIR)/libgomp/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libgomp/multilib.tmp; \
@@ -59904,6 +59997,7 @@ configure-target-libitm:
 	echo "Checking multilib configuration for libitm..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs $(TARGET_SUBDIR)/libitm; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libitm/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libitm/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libitm/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libitm/multilib.tmp $(TARGET_SUBDIR)/libitm/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libitm/multilib.tmp; \
@@ -60388,6 +60482,7 @@ configure-target-libatomic:
 	echo "Checking multilib configuration for libatomic..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs $(TARGET_SUBDIR)/libatomic; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libatomic/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libatomic/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libatomic/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libatomic/multilib.tmp $(TARGET_SUBDIR)/libatomic/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libatomic/multilib.tmp; \
@@ -60432,6 +60527,7 @@ configure-stage1-target-libatomic:
 	TFLAGS="$(STAGE1_TFLAGS)"; \
 	echo "Checking multilib configuration for libatomic..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libatomic/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libatomic/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libatomic/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libatomic/multilib.tmp $(TARGET_SUBDIR)/libatomic/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libatomic/multilib.tmp; \
@@ -60476,6 +60572,7 @@ configure-stage2-target-libatomic:
 	TFLAGS="$(STAGE2_TFLAGS)"; \
 	echo "Checking multilib configuration for libatomic..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libatomic/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libatomic/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libatomic/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libatomic/multilib.tmp $(TARGET_SUBDIR)/libatomic/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libatomic/multilib.tmp; \
@@ -60521,6 +60618,7 @@ configure-stage3-target-libatomic:
 	TFLAGS="$(STAGE3_TFLAGS)"; \
 	echo "Checking multilib configuration for libatomic..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libatomic/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libatomic/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libatomic/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libatomic/multilib.tmp $(TARGET_SUBDIR)/libatomic/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libatomic/multilib.tmp; \
@@ -60566,6 +60664,7 @@ configure-stage4-target-libatomic:
 	TFLAGS="$(STAGE4_TFLAGS)"; \
 	echo "Checking multilib configuration for libatomic..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libatomic/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libatomic/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libatomic/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libatomic/multilib.tmp $(TARGET_SUBDIR)/libatomic/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libatomic/multilib.tmp; \
@@ -60611,6 +60710,7 @@ configure-stageprofile-target-libatomic:
 	TFLAGS="$(STAGEprofile_TFLAGS)"; \
 	echo "Checking multilib configuration for libatomic..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libatomic/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libatomic/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libatomic/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libatomic/multilib.tmp $(TARGET_SUBDIR)/libatomic/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libatomic/multilib.tmp; \
@@ -60656,6 +60756,7 @@ configure-stagetrain-target-libatomic:
 	TFLAGS="$(STAGEtrain_TFLAGS)"; \
 	echo "Checking multilib configuration for libatomic..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libatomic/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libatomic/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libatomic/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libatomic/multilib.tmp $(TARGET_SUBDIR)/libatomic/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libatomic/multilib.tmp; \
@@ -60701,6 +60802,7 @@ configure-stagefeedback-target-libatomic:
 	TFLAGS="$(STAGEfeedback_TFLAGS)"; \
 	echo "Checking multilib configuration for libatomic..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libatomic/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libatomic/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libatomic/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libatomic/multilib.tmp $(TARGET_SUBDIR)/libatomic/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libatomic/multilib.tmp; \
@@ -60746,6 +60848,7 @@ configure-stageautoprofile-target-libatomic:
 	TFLAGS="$(STAGEautoprofile_TFLAGS)"; \
 	echo "Checking multilib configuration for libatomic..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libatomic/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libatomic/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libatomic/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libatomic/multilib.tmp $(TARGET_SUBDIR)/libatomic/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libatomic/multilib.tmp; \
@@ -60791,6 +60894,7 @@ configure-stageautofeedback-target-libatomic:
 	TFLAGS="$(STAGEautofeedback_TFLAGS)"; \
 	echo "Checking multilib configuration for libatomic..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > $(TARGET_SUBDIR)/libatomic/multilib.tmp 2> /dev/null; \
+	dos2unix -q $(TARGET_SUBDIR)/libatomic/multilib.tmp; \
 	if test -r $(TARGET_SUBDIR)/libatomic/multilib.out; then \
 	  if cmp -s $(TARGET_SUBDIR)/libatomic/multilib.tmp $(TARGET_SUBDIR)/libatomic/multilib.out; then \
 	    rm -f $(TARGET_SUBDIR)/libatomic/multilib.tmp; \
diff --git a/gcc/Makefile.tpl b/gcc/Makefile.tpl
index ef58fac2b9..ae74367fe8 100644
--- a/gcc/Makefile.tpl
+++ b/gcc/Makefile.tpl
@@ -1151,6 +1151,7 @@ configure-[+prefix+][+module+]: [+ IF bootstrap +][+ ELSE +]
 	+]echo "Checking multilib configuration for [+module+]..."; \
 	$(SHELL) $(srcdir)/mkinstalldirs [+subdir+]/[+module+]; \
 	$(CC_FOR_TARGET) --print-multi-lib > [+subdir+]/[+module+]/multilib.tmp 2> /dev/null; \
+	dos2unix -q [+subdir+]/[+module+]/multilib.tmp; \
 	if test -r [+subdir+]/[+module+]/multilib.out; then \
 	  if cmp -s [+subdir+]/[+module+]/multilib.tmp [+subdir+]/[+module+]/multilib.out; then \
 	    rm -f [+subdir+]/[+module+]/multilib.tmp; \
@@ -1196,6 +1197,7 @@ configure-stage[+id+]-[+prefix+][+module+]:
 	[+ IF check_multilibs
 	+]echo "Checking multilib configuration for [+module+]..."; \
 	$(CC_FOR_TARGET) --print-multi-lib > [+subdir+]/[+module+]/multilib.tmp 2> /dev/null; \
+	dos2unix -q [+subdir+]/[+module+]/multilib.tmp; \
 	if test -r [+subdir+]/[+module+]/multilib.out; then \
 	  if cmp -s [+subdir+]/[+module+]/multilib.tmp [+subdir+]/[+module+]/multilib.out; then \
 	    rm -f [+subdir+]/[+module+]/multilib.tmp; \
diff --git a/gcc/c++tools/configure b/gcc/c++tools/configure
index 742816e425..1e3d123467 100755
--- a/gcc/c++tools/configure
+++ b/gcc/c++tools/configure
@@ -1444,9 +1444,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1481,9 +1482,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1606,7 +1608,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -1679,9 +1681,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2443,9 +2446,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -2496,7 +2500,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -2566,7 +2570,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -2622,7 +2626,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -2679,7 +2683,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3331,7 +3335,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -3348,7 +3352,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
diff --git a/gcc/config-ml.in b/gcc/config-ml.in
index 68854a4f16..bf2768cfeb 100644
--- a/gcc/config-ml.in
+++ b/gcc/config-ml.in
@@ -215,7 +215,7 @@ fi
 if [ "${ml_toplevel_p}" = yes ]; then
 
 multidirs=
-for i in `${CC-gcc} --print-multi-lib 2>/dev/null`; do
+for i in `${CC-gcc} --print-multi-lib 2>/dev/null | sed -e 's/\r//g'`; do
   dir=`echo $i | sed -e 's/;.*$//'`
   if [ "${dir}" = "." ]; then
     true
@@ -507,7 +507,7 @@ multi-do:
 	  srcrootpre=`cd $(srcdir); ${PWD_COMMAND}`/; export srcrootpre; \
 	  lib=`echo "$${rootpre}" | sed -e 's,^.*/\([^/][^/]*\)/$$,\1,'`; \
 	  compiler="$(CC)"; \
-	  for i in `$${compiler} --print-multi-lib 2>/dev/null`; do \
+	  for i in `$${compiler} --print-multi-lib 2>/dev/null | sed -e 's/\r//g'`; do \
 	    dir=`echo $$i | sed -e 's/;.*$$//'`; \
 	    if [ "$${dir}" = "." ]; then \
 	      true; \
@@ -748,7 +748,7 @@ if [ -n "${multidirs}" ] && [ -z "${ml_norecursion}" ]; then
     fi
 
     # find compiler flag corresponding to ${ml_dir}
-    for i in `${CC-gcc} --print-multi-lib 2>/dev/null`; do
+    for i in `${CC-gcc} --print-multi-lib 2>/dev/null | sed -e 's/\r//g'`; do
       dir=`echo $i | sed -e 's/;.*$//'`
       if [ "${dir}" = "${ml_dir}" ]; then
         flags=`echo $i | sed -e 's/^[^;]*;//' -e 's/@/ -/g'`
diff --git a/gcc/config.guess b/gcc/config.guess
index 1972fda8eb..9566480598 100755
--- a/gcc/config.guess
+++ b/gcc/config.guess
@@ -157,7 +157,7 @@ Linux|GNU|GNU/*)
 	#endif
 	#endif
 	EOF
-	eval "$($CC_FOR_BUILD -E "$dummy.c" 2>/dev/null | grep '^LIBC' | sed 's, ,,g')"
+	eval "$($CC_FOR_BUILD -E "$dummy.c" 2>/dev/null | sed -e 's/\r//g' | grep '^LIBC' | sed 's, ,,g')"
 
 	# Second heuristic to detect musl libc.
 	if [ "$LIBC" = unknown ] &&
@@ -215,6 +215,7 @@ case "$UNAME_MACHINE:$UNAME_SYSTEM:$UNAME_RELEASE:$UNAME_VERSION" in
 	    arm*|i386|m68k|ns32k|sh3*|sparc|vax)
 		set_cc_for_build
 		if echo __ELF__ | $CC_FOR_BUILD -E - 2>/dev/null \
+			| sed  -e 's/\r//g' \
 			| grep -q __ELF__
 		then
 		    # Once all utilities can be ECOFF (netbsdecoff) or a.out (netbsdaout).
@@ -417,6 +418,7 @@ case "$UNAME_MACHINE:$UNAME_SYSTEM:$UNAME_RELEASE:$UNAME_VERSION" in
 	if test "$CC_FOR_BUILD" != no_compiler_found; then
 	    if (echo '#ifdef __amd64'; echo IS_64BIT_ARCH; echo '#endif') | \
 		(CCOPTS="" $CC_FOR_BUILD -E - 2>/dev/null) | \
+		sed -e 's/\r//g' | \
 		grep IS_64BIT_ARCH >/dev/null
 	    then
 		SUN_ARCH=x86_64
@@ -732,6 +734,7 @@ EOF
 	    # => hppa64-hp-hpux11.23
 
 	    if echo __LP64__ | (CCOPTS="" $CC_FOR_BUILD -E - 2>/dev/null) |
+		sed -e 's/\r//g' |
 		grep -q __LP64__
 	    then
 		HP_ARCH=hppa2.0w
@@ -864,6 +867,7 @@ EOF
 	UNAME_PROCESSOR=$(uname -p)
 	set_cc_for_build
 	if echo __ARM_PCS_VFP | $CC_FOR_BUILD -E - 2>/dev/null \
+	    | sed -e 's/\r//g' \
 	    | grep -q __ARM_PCS_VFP
 	then
 	    echo "${UNAME_PROCESSOR}"-unknown-freebsd"$(echo ${UNAME_RELEASE}|sed -e 's/[-(].*//')"-gnueabi
@@ -955,11 +959,13 @@ EOF
     arm*:Linux:*:*)
 	set_cc_for_build
 	if echo __ARM_EABI__ | $CC_FOR_BUILD -E - 2>/dev/null \
+	    | sed -e 's/\r//g' \
 	    | grep -q __ARM_EABI__
 	then
 	    echo "$UNAME_MACHINE"-unknown-linux-"$LIBC"
 	else
 	    if echo __ARM_PCS_VFP | $CC_FOR_BUILD -E - 2>/dev/null \
+		| sed -e 's/\r//g' \
 		| grep -q __ARM_PCS_VFP
 	    then
 		echo "$UNAME_MACHINE"-unknown-linux-"$LIBC"eabi
@@ -1048,7 +1054,7 @@ EOF
 	#endif
 	#endif
 EOF
-	eval "$($CC_FOR_BUILD -E "$dummy.c" 2>/dev/null | grep '^CPU\|^MIPS_ENDIAN\|^LIBCABI')"
+	eval "$($CC_FOR_BUILD -E "$dummy.c" 2>/dev/null | sed -e 's/\r//g' | grep '^CPU\|^MIPS_ENDIAN\|^LIBCABI')"
 	test "x$CPU" != x && { echo "$CPU${MIPS_ENDIAN}-unknown-linux-$LIBCABI"; exit; }
 	;;
     mips64el:Linux:*:*)
@@ -1113,6 +1119,7 @@ EOF
 	if test "$CC_FOR_BUILD" != no_compiler_found; then
 	    if (echo '#ifdef __ILP32__'; echo IS_X32; echo '#endif') | \
 		(CCOPTS="" $CC_FOR_BUILD -E - 2>/dev/null) | \
+		sed -e 's/\r//g' | \
 		grep IS_X32 >/dev/null
 	    then
 		LIBCABI="$LIBC"x32
@@ -1375,6 +1382,7 @@ EOF
 	if test "$CC_FOR_BUILD" != no_compiler_found; then
 	    if (echo '#ifdef __LP64__'; echo IS_64BIT_ARCH; echo '#endif') | \
 		   (CCOPTS="" $CC_FOR_BUILD -E - 2>/dev/null) | \
+		   sed -e 's/\r//g' | \
 		   grep IS_64BIT_ARCH >/dev/null
 	    then
 		case $UNAME_PROCESSOR in
@@ -1385,6 +1393,7 @@ EOF
 	    # On 10.4-10.6 one might compile for PowerPC via gcc -arch ppc
 	    if (echo '#ifdef __POWERPC__'; echo IS_PPC; echo '#endif') | \
 		   (CCOPTS="" $CC_FOR_BUILD -E - 2>/dev/null) | \
+		   sed -e 's/\r//g' | \
 		   grep IS_PPC >/dev/null
 	    then
 		UNAME_PROCESSOR=powerpc
diff --git a/gcc/config.rpath b/gcc/config.rpath
index 4dea75957c..0a76adc90f 100755
--- a/gcc/config.rpath
+++ b/gcc/config.rpath
@@ -143,7 +143,7 @@ if test "$with_gnu_ld" = yes; then
       ld_shlibs=no
       ;;
     beos*)
-      if $LD --help 2>&1 | egrep ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | egrep ': supported targets:.* elf' > /dev/null; then
         :
       else
         ld_shlibs=no
@@ -153,7 +153,7 @@ if test "$with_gnu_ld" = yes; then
       # hardcode_libdir_flag_spec is actually meaningless, as there is
       # no search path for DLLs.
       hardcode_libdir_flag_spec='-L$libdir'
-      if $LD --help 2>&1 | grep 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | grep 'auto-import' > /dev/null; then
         :
       else
         ld_shlibs=no
@@ -162,9 +162,9 @@ if test "$with_gnu_ld" = yes; then
     netbsd*)
       ;;
     solaris* | sysv5*)
-      if $LD -v 2>&1 | egrep 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | egrep 'BFD 2\.8' > /dev/null; then
         ld_shlibs=no
-      elif $LD --help 2>&1 | egrep ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | egrep ': supported targets:.* elf' > /dev/null; then
         :
       else
         ld_shlibs=no
@@ -174,7 +174,7 @@ if test "$with_gnu_ld" = yes; then
       hardcode_direct=yes
       ;;
     *)
-      if $LD --help 2>&1 | egrep ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | egrep ': supported targets:.* elf' > /dev/null; then
         :
       else
         ld_shlibs=no
@@ -345,7 +345,7 @@ else
       ;;
     openbsd*)
       hardcode_direct=yes
-      if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+      if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
         hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
       else
         case "$host_os" in
diff --git a/gcc/config/acx.m4 b/gcc/config/acx.m4
index b86c4f9e51..c4c5fc72be 100644
--- a/gcc/config/acx.m4
+++ b/gcc/config/acx.m4
@@ -302,7 +302,7 @@ cat > conftest.c << \EOF
   gcc_yay;
 #endif
 EOF
-if ($GCC_FOR_TARGET -E conftest.c | grep gcc_yay) > /dev/null 2>&1; then
+if ($GCC_FOR_TARGET -E conftest.c | sed -e 's/\r//g' | grep gcc_yay) > /dev/null 2>&1; then
   have_gcc_for_target=yes
 else
   GCC_FOR_TARGET=${ncn_target_tool_prefix}gcc
@@ -351,7 +351,7 @@ if test -z "$ac_cv_path_$1" ; then
       AC_MSG_RESULT(no)
     fi
   elif test $build != $host && test $have_gcc_for_target = yes; then
-    $1=`$GCC_FOR_TARGET --print-prog-name=$2`
+    $1=`$GCC_FOR_TARGET --print-prog-name=$2 | sed -e 's/\r//g'`
     test [$]$1 = $2 && $1=
     test -n "[$]$1" && ac_cv_path_$1=[$]$1
   fi
diff --git a/gcc/config/ld-symbolic.m4 b/gcc/config/ld-symbolic.m4
index 16d64f9ad3..14accdfae1 100644
--- a/gcc/config/ld-symbolic.m4
+++ b/gcc/config/ld-symbolic.m4
@@ -13,7 +13,7 @@ acl_cv_prog_gnu_ld_symbolic, [
 acl_cv_prog_gnu_ld_symbolic=no
 AC_REQUIRE([AC_LIB_PROG_LD_GNU])
 if test x"$with_gnu_ld" = x"yes"; then
-  if $LD --help 2>&1 </dev/null | grep Bsymbolic-functions 1>&5; then
+  if $LD --help 2>&1 </dev/null | sed -e 's/\r//g' | grep Bsymbolic-functions 1>&5; then
     acl_cv_prog_gnu_ld_symbolic=yes
   fi
 fi])
@@ -33,7 +33,7 @@ acl_cv_prog_gnu_ld_dynamic_list_cpp_new=no
 AC_REQUIRE([ACX_PROG_LD_GNU_SYMBOLIC])
 if test x"$with_gnu_ld" = x"yes" -a \
 	x"$acl_cv_prog_gnu_ld_symbolic" = x"yes"; then
-  if $LD --help 2>&1 </dev/null | grep dynamic-list-cpp-new 1>&5; then
+  if $LD --help 2>&1 </dev/null | sed -e 's/\r//g' | grep dynamic-list-cpp-new 1>&5; then
     acl_cv_prog_gnu_ld_dynamic_list_cpp_new=yes
   fi
 fi])
diff --git a/gcc/config/lib-ld.m4 b/gcc/config/lib-ld.m4
index 11d0ce7734..9825d98a06 100644
--- a/gcc/config/lib-ld.m4
+++ b/gcc/config/lib-ld.m4
@@ -14,7 +14,7 @@ dnl From libtool-1.4. Sets the variable with_gnu_ld to yes or no.
 AC_DEFUN([AC_LIB_PROG_LD_GNU],
 [AC_CACHE_CHECK([if the linker ($LD) is GNU ld], acl_cv_prog_gnu_ld,
 [# I'd rather use --version here, but apparently some GNU ld's only accept -v.
-if $LD -v 2>&1 </dev/null | egrep '(GNU|with BFD)' 1>&5; then
+if $LD -v 2>&1 </dev/null | sed -e 's/\r//g' | egrep '(GNU|with BFD)' 1>&5; then
   acl_cv_prog_gnu_ld=yes
 else
   acl_cv_prog_gnu_ld=no
@@ -49,9 +49,9 @@ if test "$GCC" = yes; then
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -88,7 +88,7 @@ AC_CACHE_VAL(acl_cv_path_LD,
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some GNU ld's only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      if "$acl_cv_path_LD" -v 2>&1 < /dev/null | egrep '(GNU|with BFD)' > /dev/null; then
+      if "$acl_cv_path_LD" -v 2>&1 < /dev/null | sed -e 's/\r//g' | egrep '(GNU|with BFD)' > /dev/null; then
 	test "$with_gnu_ld" != no && break
       else
 	test "$with_gnu_ld" != yes && break
diff --git a/gcc/config/stdint.m4 b/gcc/config/stdint.m4
index 59f4359544..35ff345266 100644
--- a/gcc/config/stdint.m4
+++ b/gcc/config/stdint.m4
@@ -193,7 +193,7 @@ fi
 # ----------------- done all checks, emit header -------------
 AC_CONFIG_COMMANDS(_GCC_STDINT_H, [
 if test "$GCC" = yes; then
-  echo "/* generated for " `$CC --version | sed 1q` "*/" > tmp-stdint.h
+  echo "/* generated for " `$CC --version | sed -e 's/\r//g' | sed 1q` "*/" > tmp-stdint.h
 else
   echo "/* generated for $CC */" > tmp-stdint.h
 fi
diff --git a/gcc/config/tcl.m4 b/gcc/config/tcl.m4
index 4542a4b23d..c1273a3ed1 100644
--- a/gcc/config/tcl.m4
+++ b/gcc/config/tcl.m4
@@ -1233,7 +1233,7 @@ dnl AC_CHECK_TOOL(AR, ar)
 	    # Check to enable 64-bit flags for compiler/linker
 	    if test "$do64bit" = "yes" ; then
 		if test "$GCC" = "yes" ; then
-		    hpux_arch=`${CC} -dumpmachine`
+		    hpux_arch=`${CC} -dumpmachine | sed -e 's/\r//g'`
 		    case $hpux_arch in
 			hppa64*)
 			    # 64-bit gcc in use.  Fix flags for GNU ld.
diff --git a/gcc/configure b/gcc/configure
index 5dcaab14ae..bb76b016df 100755
--- a/gcc/configure
+++ b/gcc/configure
@@ -1802,9 +1802,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1840,9 +1841,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1878,9 +1880,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1924,9 +1927,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -4448,9 +4452,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -4501,7 +4506,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4571,7 +4576,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4627,7 +4632,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -4684,7 +4689,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -5222,9 +5227,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -5364,9 +5370,9 @@ if test -z "$LD"; then
   if test "$GCC" = yes; then
     case $build in
     *-*-mingw*)
-      gcc_prog_ld=`$CC -print-prog-name=ld 2>&1 | tr -d '\015'` ;;
+      gcc_prog_ld=`$CC -print-prog-name=ld 2>&1 | sed -e 's/\r//g' | tr -d '\015'` ;;
     *)
-      gcc_prog_ld=`$CC -print-prog-name=ld 2>&1` ;;
+      gcc_prog_ld=`$CC -print-prog-name=ld 2>&1 | sed -e 's/\r//g'` ;;
     esac
     case $gcc_prog_ld in
     # Accept absolute paths.
@@ -10620,7 +10626,7 @@ case " $build_configdirs " in
     # For an installed makeinfo, we require it to be from texinfo 4.7 or
     # higher, else we use the "missing" dummy.
     if ${MAKEINFO} --version \
-       | egrep 'texinfo[^0-9]*(4\.([7-9]|[1-9][0-9])|[5-9]|[1-9][0-9])' >/dev/null 2>&1; then
+       | sed -e 's/\r//g' | egrep 'texinfo[^0-9]*(4\.([7-9]|[1-9][0-9])|[5-9]|[1-9][0-9])' >/dev/null 2>&1; then
       :
     else
       MAKEINFO="$MISSING makeinfo"
@@ -13833,7 +13839,7 @@ cat > conftest.c << \EOF
   gcc_yay;
 #endif
 EOF
-if ($GCC_FOR_TARGET -E conftest.c | grep gcc_yay) > /dev/null 2>&1; then
+if ($GCC_FOR_TARGET -E conftest.c | sed -e 's/\r//g' | grep gcc_yay) > /dev/null 2>&1; then
   have_gcc_for_target=yes
 else
   GCC_FOR_TARGET=${ncn_target_tool_prefix}gcc
@@ -13858,7 +13864,7 @@ $as_echo "$ac_cv_path_AR_FOR_TARGET" >&6; }
 $as_echo "no" >&6; }
     fi
   elif test $build != $host && test $have_gcc_for_target = yes; then
-    AR_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=ar`
+    AR_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=ar | sed -e 's/\r//g'`
     test $AR_FOR_TARGET = ar && AR_FOR_TARGET=
     test -n "$AR_FOR_TARGET" && ac_cv_path_AR_FOR_TARGET=$AR_FOR_TARGET
   fi
@@ -14088,7 +14094,7 @@ $as_echo "$ac_cv_path_AS_FOR_TARGET" >&6; }
 $as_echo "no" >&6; }
     fi
   elif test $build != $host && test $have_gcc_for_target = yes; then
-    AS_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=as`
+    AS_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=as | sed -e 's/\r//g'`
     test $AS_FOR_TARGET = as && AS_FOR_TARGET=
     test -n "$AS_FOR_TARGET" && ac_cv_path_AS_FOR_TARGET=$AS_FOR_TARGET
   fi
@@ -14318,7 +14324,7 @@ $as_echo "$ac_cv_path_DLLTOOL_FOR_TARGET" >&6; }
 $as_echo "no" >&6; }
     fi
   elif test $build != $host && test $have_gcc_for_target = yes; then
-    DLLTOOL_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=dlltool`
+    DLLTOOL_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=dlltool | sed -e 's/\r//g'`
     test $DLLTOOL_FOR_TARGET = dlltool && DLLTOOL_FOR_TARGET=
     test -n "$DLLTOOL_FOR_TARGET" && ac_cv_path_DLLTOOL_FOR_TARGET=$DLLTOOL_FOR_TARGET
   fi
@@ -14548,7 +14554,7 @@ $as_echo "$ac_cv_path_DSYMUTIL_FOR_TARGET" >&6; }
 $as_echo "no" >&6; }
     fi
   elif test $build != $host && test $have_gcc_for_target = yes; then
-    DSYMUTIL_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=dsymutil`
+    DSYMUTIL_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=dsymutil | sed -e 's/\r//g'`
     test $DSYMUTIL_FOR_TARGET = dsymutil && DSYMUTIL_FOR_TARGET=
     test -n "$DSYMUTIL_FOR_TARGET" && ac_cv_path_DSYMUTIL_FOR_TARGET=$DSYMUTIL_FOR_TARGET
   fi
@@ -14778,7 +14784,7 @@ $as_echo "$ac_cv_path_LD_FOR_TARGET" >&6; }
 $as_echo "no" >&6; }
     fi
   elif test $build != $host && test $have_gcc_for_target = yes; then
-    LD_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=ld`
+    LD_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=ld | sed -e 's/\r//g'`
     test $LD_FOR_TARGET = ld && LD_FOR_TARGET=
     test -n "$LD_FOR_TARGET" && ac_cv_path_LD_FOR_TARGET=$LD_FOR_TARGET
   fi
@@ -15008,7 +15014,7 @@ $as_echo "$ac_cv_path_LIPO_FOR_TARGET" >&6; }
 $as_echo "no" >&6; }
     fi
   elif test $build != $host && test $have_gcc_for_target = yes; then
-    LIPO_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=lipo`
+    LIPO_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=lipo | sed -e 's/\r//g'`
     test $LIPO_FOR_TARGET = lipo && LIPO_FOR_TARGET=
     test -n "$LIPO_FOR_TARGET" && ac_cv_path_LIPO_FOR_TARGET=$LIPO_FOR_TARGET
   fi
@@ -15238,7 +15244,7 @@ $as_echo "$ac_cv_path_NM_FOR_TARGET" >&6; }
 $as_echo "no" >&6; }
     fi
   elif test $build != $host && test $have_gcc_for_target = yes; then
-    NM_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=nm`
+    NM_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=nm | sed -e 's/\r//g'`
     test $NM_FOR_TARGET = nm && NM_FOR_TARGET=
     test -n "$NM_FOR_TARGET" && ac_cv_path_NM_FOR_TARGET=$NM_FOR_TARGET
   fi
@@ -15468,7 +15474,7 @@ $as_echo "$ac_cv_path_OBJCOPY_FOR_TARGET" >&6; }
 $as_echo "no" >&6; }
     fi
   elif test $build != $host && test $have_gcc_for_target = yes; then
-    OBJCOPY_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=objcopy`
+    OBJCOPY_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=objcopy | sed -e 's/\r//g'`
     test $OBJCOPY_FOR_TARGET = objcopy && OBJCOPY_FOR_TARGET=
     test -n "$OBJCOPY_FOR_TARGET" && ac_cv_path_OBJCOPY_FOR_TARGET=$OBJCOPY_FOR_TARGET
   fi
@@ -15698,7 +15704,7 @@ $as_echo "$ac_cv_path_OBJDUMP_FOR_TARGET" >&6; }
 $as_echo "no" >&6; }
     fi
   elif test $build != $host && test $have_gcc_for_target = yes; then
-    OBJDUMP_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=objdump`
+    OBJDUMP_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=objdump | sed -e 's/\r//g'`
     test $OBJDUMP_FOR_TARGET = objdump && OBJDUMP_FOR_TARGET=
     test -n "$OBJDUMP_FOR_TARGET" && ac_cv_path_OBJDUMP_FOR_TARGET=$OBJDUMP_FOR_TARGET
   fi
@@ -15928,7 +15934,7 @@ $as_echo "$ac_cv_path_OTOOL_FOR_TARGET" >&6; }
 $as_echo "no" >&6; }
     fi
   elif test $build != $host && test $have_gcc_for_target = yes; then
-    OTOOL_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=otool`
+    OTOOL_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=otool | sed -e 's/\r//g'`
     test $OTOOL_FOR_TARGET = otool && OTOOL_FOR_TARGET=
     test -n "$OTOOL_FOR_TARGET" && ac_cv_path_OTOOL_FOR_TARGET=$OTOOL_FOR_TARGET
   fi
@@ -16158,7 +16164,7 @@ $as_echo "$ac_cv_path_RANLIB_FOR_TARGET" >&6; }
 $as_echo "no" >&6; }
     fi
   elif test $build != $host && test $have_gcc_for_target = yes; then
-    RANLIB_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=ranlib`
+    RANLIB_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=ranlib | sed -e 's/\r//g'`
     test $RANLIB_FOR_TARGET = ranlib && RANLIB_FOR_TARGET=
     test -n "$RANLIB_FOR_TARGET" && ac_cv_path_RANLIB_FOR_TARGET=$RANLIB_FOR_TARGET
   fi
@@ -16388,7 +16394,7 @@ $as_echo "$ac_cv_path_READELF_FOR_TARGET" >&6; }
 $as_echo "no" >&6; }
     fi
   elif test $build != $host && test $have_gcc_for_target = yes; then
-    READELF_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=readelf`
+    READELF_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=readelf | sed -e 's/\r//g'`
     test $READELF_FOR_TARGET = readelf && READELF_FOR_TARGET=
     test -n "$READELF_FOR_TARGET" && ac_cv_path_READELF_FOR_TARGET=$READELF_FOR_TARGET
   fi
@@ -16618,7 +16624,7 @@ $as_echo "$ac_cv_path_STRIP_FOR_TARGET" >&6; }
 $as_echo "no" >&6; }
     fi
   elif test $build != $host && test $have_gcc_for_target = yes; then
-    STRIP_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=strip`
+    STRIP_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=strip | sed -e 's/\r//g'`
     test $STRIP_FOR_TARGET = strip && STRIP_FOR_TARGET=
     test -n "$STRIP_FOR_TARGET" && ac_cv_path_STRIP_FOR_TARGET=$STRIP_FOR_TARGET
   fi
@@ -16848,7 +16854,7 @@ $as_echo "$ac_cv_path_WINDRES_FOR_TARGET" >&6; }
 $as_echo "no" >&6; }
     fi
   elif test $build != $host && test $have_gcc_for_target = yes; then
-    WINDRES_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=windres`
+    WINDRES_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=windres | sed -e 's/\r//g'`
     test $WINDRES_FOR_TARGET = windres && WINDRES_FOR_TARGET=
     test -n "$WINDRES_FOR_TARGET" && ac_cv_path_WINDRES_FOR_TARGET=$WINDRES_FOR_TARGET
   fi
@@ -17078,7 +17084,7 @@ $as_echo "$ac_cv_path_WINDMC_FOR_TARGET" >&6; }
 $as_echo "no" >&6; }
     fi
   elif test $build != $host && test $have_gcc_for_target = yes; then
-    WINDMC_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=windmc`
+    WINDMC_FOR_TARGET=`$GCC_FOR_TARGET --print-prog-name=windmc | sed -e 's/\r//g'`
     test $WINDMC_FOR_TARGET = windmc && WINDMC_FOR_TARGET=
     test -n "$WINDMC_FOR_TARGET" && ac_cv_path_WINDMC_FOR_TARGET=$WINDMC_FOR_TARGET
   fi
diff --git a/gcc/configure.ac b/gcc/configure.ac
index 85977482ae..daeda6d7e3 100644
--- a/gcc/configure.ac
+++ b/gcc/configure.ac
@@ -1381,9 +1381,9 @@ if test -z "$LD"; then
   if test "$GCC" = yes; then
     case $build in
     *-*-mingw*)
-      gcc_prog_ld=`$CC -print-prog-name=ld 2>&1 | tr -d '\015'` ;;
+      gcc_prog_ld=`$CC -print-prog-name=ld 2>&1 | sed -e 's/\r//g' | tr -d '\015'` ;;
     *)
-      gcc_prog_ld=`$CC -print-prog-name=ld 2>&1` ;;
+      gcc_prog_ld=`$CC -print-prog-name=ld 2>&1 | sed -e 's/\r//g'` ;;
     esac
     case $gcc_prog_ld in
     # Accept absolute paths.
@@ -3549,7 +3549,7 @@ changequote(,)
     # For an installed makeinfo, we require it to be from texinfo 4.7 or
     # higher, else we use the "missing" dummy.
     if ${MAKEINFO} --version \
-       | egrep 'texinfo[^0-9]*(4\.([7-9]|[1-9][0-9])|[5-9]|[1-9][0-9])' >/dev/null 2>&1; then
+       | sed -e 's/\r//g' | egrep 'texinfo[^0-9]*(4\.([7-9]|[1-9][0-9])|[5-9]|[1-9][0-9])' >/dev/null 2>&1; then
       :
     else
       MAKEINFO="$MISSING makeinfo"
diff --git a/gcc/contrib/check_warning_flags.sh b/gcc/contrib/check_warning_flags.sh
index d9c5735abf..2119a3b595 100755
--- a/gcc/contrib/check_warning_flags.sh
+++ b/gcc/contrib/check_warning_flags.sh
@@ -147,7 +147,7 @@ remove_problematic_help_flags='
   /-$/d
   /=/d'
 help_flags=`
-  $CC --help -v 2>/dev/null | tr ' ' '\012' |
+  $CC --help -v 2>/dev/null | sed -e 's/\r//g' | tr ' ' '\012' |
     sed -n '
       b a
       :a
diff --git a/gcc/depcomp b/gcc/depcomp
index 6b391623c4..fad8f87b9c 100755
--- a/gcc/depcomp
+++ b/gcc/depcomp
@@ -706,6 +706,7 @@ cpp)
   done
 
   "$@" -E \
+    | sed -e 's/\r//g' \
     | sed -n -e '/^# [0-9][0-9]* "\([^"]*\)".*/ s:: \1 \\:p' \
              -e '/^#line [0-9][0-9]* "\([^"]*\)".*/ s:: \1 \\:p' \
     | sed '$ s: \\$::' > "$tmpdepfile"
@@ -752,6 +753,7 @@ msvisualcpp)
     esac
   done
   "$@" -E 2>/dev/null |
+  sed -e 's/\r//g' |
   sed -n '/^#line [0-9][0-9]* "\([^"]*\)"/ s::\1:p' | $cygpath_u | sort -u > "$tmpdepfile"
   rm -f "$depfile"
   echo "$object : \\" > "$depfile"
diff --git a/gcc/fixincludes/configure b/gcc/fixincludes/configure
index 6e2d67b655..69bb49291a 100755
--- a/gcc/fixincludes/configure
+++ b/gcc/fixincludes/configure
@@ -1437,9 +1437,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1474,9 +1475,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1599,7 +1601,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -1672,9 +1674,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -3620,9 +3623,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -3673,7 +3677,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3743,7 +3747,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3799,7 +3803,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -3856,7 +3860,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4397,7 +4401,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -4414,7 +4418,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -4887,7 +4891,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -4904,7 +4908,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
diff --git a/gcc/fixincludes/fixfixes.c b/gcc/fixincludes/fixfixes.c
index 404b420f30..e809c57631 100644
--- a/gcc/fixincludes/fixfixes.c
+++ b/gcc/fixincludes/fixfixes.c
@@ -49,6 +49,9 @@ You should have received a copy of the GNU General Public License
 along with GCC; see the file COPYING3.  If not see
 <http://www.gnu.org/licenses/>.  */
 
+#include "memmem.h"
+#include "memmem.c"
+
 #include "fixlib.h"
 #define    GTYPE_SE_CT 1
 
diff --git a/gcc/gcc/Makefile.in b/gcc/gcc/Makefile.in
index 31ff95500c..f8888bdae6 100644
--- a/gcc/gcc/Makefile.in
+++ b/gcc/gcc/Makefile.in
@@ -2083,7 +2083,7 @@ rest.cross: specs
 # "nul" instead of "/dev/null" if we're building on a mingw machine.
 # Specify the path to gcc/testsuite/selftests within the srcdir
 # as an argument to -fself-test.
-DEVNULL=$(if $(findstring mingw,$(build)),nul,/dev/null)
+DEVNULL=nul
 SELFTEST_FLAGS = -nostdinc $(DEVNULL) -S -o $(DEVNULL) \
 	-fself-test=$(srcdir)/testsuite/selftests
 
@@ -2147,6 +2147,7 @@ cpp$(exeext): $(GCC_OBJS) c-family/cppspec.o libcommon-target.a $(LIBDEPS) \
 # Dump a specs file to make -B./ read these specs over installed ones.
 $(SPECS): xgcc$(exeext)
 	$(GCC_FOR_TARGET) -dumpspecs > tmp-specs
+	dos2unix -q tmp-specs
 	mv tmp-specs $(SPECS)
 
 # We do want to create an executable named `xgcc', so we can use it to
@@ -3178,6 +3179,7 @@ install-gcc-tooldir:
 macro_list: s-macro_list; @true
 s-macro_list : $(GCC_PASSES) cc1$(exeext)
 	echo | $(GCC_FOR_TARGET) -E -dM - | \
+	  sed -e 's/\r//g' | \
 	  sed -n -e 's/^#define \([^_][a-zA-Z0-9_]*\).*/\1/p' \
 		 -e 's/^#define \(_[^_A-Z][a-zA-Z0-9_]*\).*/\1/p' | \
 	  sort -u > tmp-macro_list
@@ -3189,10 +3191,10 @@ s-fixinc_list : $(GCC_PASSES)
 # Build up a list of multilib directories and corresponding sysroot
 # suffixes, in form sysroot;multilib.
 	if $(GCC_FOR_TARGET) -print-sysroot-headers-suffix > /dev/null 2>&1; then \
-	  set -e; for ml in `$(GCC_FOR_TARGET) -print-multi-lib`; do \
+	  set -e; for ml in `$(GCC_FOR_TARGET) -print-multi-lib | sed -e 's/\r//g'`; do \
 	    multi_dir=`echo $${ml} | sed -e 's/;.*$$//'`; \
 	    flags=`echo $${ml} | sed -e 's/^[^;]*;//' -e 's/@/ -/g'`; \
-	    sfx=`$(GCC_FOR_TARGET) $${flags} -print-sysroot-headers-suffix`; \
+	    sfx=`$(GCC_FOR_TARGET) $${flags} -print-sysroot-headers-suffix | sed -e 's/\r//g'`; \
 	    if [ "$${multi_dir}" = "." ]; \
 	      then multi_dir=""; \
 	    else \
diff --git a/gcc/gcc/configure b/gcc/gcc/configure
index 5ce0557719..3aed8d7d1a 100755
--- a/gcc/gcc/configure
+++ b/gcc/gcc/configure
@@ -726,18 +726,25 @@ thin_archive_support
 ld_soname_option
 ld_version_script_option
 libgcc_visibility
+WINE_ORIGINAL_DSYMUTIL_FOR_TARGET
 ORIGINAL_DSYMUTIL_FOR_TARGET
 gcc_cv_dsymutil
 gcc_cv_otool
 gcc_cv_readelf
 gcc_cv_objdump
+WINE_ORIGINAL_NM_FOR_TARGET
 ORIGINAL_NM_FOR_TARGET
 gcc_cv_nm
+WINE_ORIGINAL_LD_GOLD_FOR_TARGET
+WINE_ORIGINAL_LD_BFD_FOR_TARGET
+WINE_ORIGINAL_LD_FOR_TARGET
+WINE_ORIGINAL_PLUGIN_LD_FOR_TARGET
 ORIGINAL_LD_GOLD_FOR_TARGET
 ORIGINAL_LD_BFD_FOR_TARGET
 ORIGINAL_LD_FOR_TARGET
 ORIGINAL_PLUGIN_LD_FOR_TARGET
 gcc_cv_ld
+WINE_ORIGINAL_AS_FOR_TARGET
 ORIGINAL_AS_FOR_TARGET
 gcc_cv_as
 enable_fast_install
@@ -934,7 +941,8 @@ PACKAGE_NAME
 PATH_SEPARATOR
 SHELL'
 ac_subst_files='option_includes
-language_hooks'
+language_hooks
+wine_find_str_workarround'
 ac_user_opts='
 enable_option_checking
 with_build_libsubdir
@@ -1985,9 +1993,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2023,9 +2032,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2060,9 +2070,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2185,7 +2196,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -2257,9 +2268,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2608,9 +2620,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2850,9 +2863,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -4308,9 +4322,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -4361,7 +4376,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4431,7 +4446,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4487,7 +4502,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -4544,7 +4559,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4905,9 +4920,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -5787,7 +5803,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -5804,7 +5820,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -8759,7 +8775,7 @@ $as_echo_n "checking for modern makeinfo... " >&6; }
 if ${gcc_cv_prog_makeinfo_modern+:} false; then :
   $as_echo_n "(cached) " >&6
 else
-  ac_prog_version=`eval $MAKEINFO --version 2>&1 |
+  ac_prog_version=`eval $MAKEINFO --version 2>&1 | sed -e 's/\r//g' |
                                      sed -n 's/^.*GNU texinfo.* \([0-9][0-9.]*\).*$/\1/p'`
 
                     case $ac_prog_version in
@@ -9075,7 +9091,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -9092,7 +9108,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -9275,7 +9291,7 @@ else
 #endif
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "yes" >/dev/null 2>&1; then :
   ac_cv_sys_tiocgwinsz_in_termios_h=yes
 else
@@ -9302,7 +9318,7 @@ else
 #endif
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "yes" >/dev/null 2>&1; then :
   ac_cv_sys_tiocgwinsz_in_sys_ioctl_h=yes
 else
@@ -9368,7 +9384,7 @@ else
 found
 #endif
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "found" >/dev/null 2>&1; then :
   gcc_cv_decl_char_bit=yes
 else
@@ -9873,7 +9889,7 @@ else
 
   am_cv_CXX_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   for depmode in $am_compiler_list; do
     if test $depmode = none; then break; fi
@@ -9904,6 +9920,10 @@ else
        $SHELL ./depcomp $depcc -c -o sub/conftest.${OBJEXT-o} sub/conftest.c"
     echo "| $depcmd" | sed -e 's/  */ /g' >&5
     if env $depcmd > conftest.err 2>&1 &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst6.h sub/conftest.Po >>conftest.err 2>&1 &&
        grep sub/conftest.${OBJEXT-o} sub/conftest.Po >>conftest.err 2>&1 &&
        ${MAKE-make} -s -f confmf >>conftest.err 2>&1; then
@@ -11116,9 +11136,9 @@ $as_echo_n "checking for ld used by GCC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -11159,7 +11179,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some GNU ld's only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      if "$acl_cv_path_LD" -v 2>&1 < /dev/null | egrep '(GNU|with BFD)' > /dev/null; then
+      if "$acl_cv_path_LD" -v 2>&1 < /dev/null | sed -e 's/\r//g' | egrep '(GNU|with BFD)' > /dev/null; then
 	test "$with_gnu_ld" != no && break
       else
 	test "$with_gnu_ld" != yes && break
@@ -11187,7 +11207,7 @@ if ${acl_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU ld's only accept -v.
-if $LD -v 2>&1 </dev/null | egrep '(GNU|with BFD)' 1>&5; then
+if $LD -v 2>&1 </dev/null | sed -e 's/\r//g' | egrep '(GNU|with BFD)' 1>&5; then
   acl_cv_prog_gnu_ld=yes
 else
   acl_cv_prog_gnu_ld=no
@@ -13881,9 +13901,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -13925,7 +13945,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -13956,7 +13976,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -14164,10 +14184,12 @@ else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
   (eval echo "\"\$as_me:$LINENO: $ac_compile\"" >&5)
-  (eval "$ac_compile" 2>conftest.err)
+  (eval "($ac_compile | sed -e 's/\r//g')" 2>conftest.err)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: output\"" >&5)
   cat conftest.out >&5
@@ -14588,7 +14610,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -14650,7 +14672,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu | uclinuxfdpiceabi)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|_pic\.a)$'
@@ -14668,7 +14690,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
@@ -15169,7 +15191,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[ABCDGIRSTW]' ;;
 esac
@@ -15177,11 +15199,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -15215,7 +15237,7 @@ for ac_symprfx in "" "_"; do
 "     s[1]~prfx {split(s[1],t,\"@\"); print t[1], substr(t[1],length(prfx))}"\
 "     ' prfx=^$ac_symprfx"
   else
-    lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
+    lt_cv_sys_global_symbol_pipe="sed -n -e 's/\r//g' -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
   fi
 
   # Check to see that the pipe works correctly.
@@ -15236,14 +15258,14 @@ int main(){nm_test_var='a';nm_test_func();return(0);}
 _LT_EOF
 
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist\""; } >&5
-  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) 2>&5
+    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist\""; } >&5
+  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s "$nlist"; then
@@ -15264,7 +15286,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | sed -e '"'"'s/\r//g'"'"' | $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -15277,7 +15299,7 @@ lt__PROGRAM__LTX_preloaded_symbols[] =
 {
   { "@PROGRAM@", (void *) 0 },
 _LT_EOF
-	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | $GREP -v main >> conftest.$ac_ext
+	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | sed -e 's/\r//g' | $GREP -v main >> conftest.$ac_ext
 	  cat <<\_LT_EOF >> conftest.$ac_ext
   {0, (void *) 0}
 };
@@ -15300,7 +15322,7 @@ _LT_EOF
 	  LIBS="conftstm.$ac_objext"
 	  CFLAGS="$CFLAGS$lt_prog_compiler_no_builtin_flag"
 	  if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext}; then
@@ -15379,7 +15401,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -15398,7 +15420,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo '#line '$LINENO' "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -15436,7 +15458,7 @@ s390*-*linux*|s390*-*tpf*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -15548,7 +15570,7 @@ sparc*-*solaris*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -16081,6 +16103,7 @@ else
 	if test -f libconftest.dylib && test ! -s conftest.err && test $_lt_result = 0; then
 	  lt_cv_apple_cc_single_mod=yes
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err >&5
 	fi
 	rm -rf libconftest.dylib*
@@ -16143,6 +16166,7 @@ _LT_EOF
       if test -f conftest && test ! -s conftest.err && test $_lt_result = 0 && $GREP forced_load conftest 2>&1 >/dev/null; then
 	lt_cv_ld_force_load=yes
       else
+        dos2unix -q conftest.err
 	cat conftest.err >&5
       fi
         rm -f conftest.err libconftest.a conftest conftest.c
@@ -16635,13 +16659,15 @@ compiler_DEFAULT=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -16681,14 +16707,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -16903,7 +16931,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic='-KPIC'
@@ -17034,14 +17062,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works=yes
@@ -17083,10 +17113,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -17139,8 +17170,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -17148,6 +17180,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -17194,8 +17227,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -17203,6 +17237,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -17263,7 +17298,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object=no
   enable_shared_with_static_runtimes=no
   export_dynamic_flag_spec=
-  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic=no
   hardcode_direct=no
   hardcode_direct_absolute=no
@@ -17326,7 +17361,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -17352,13 +17387,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -17402,7 +17437,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -17420,9 +17455,9 @@ _LT_EOF
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -17465,7 +17500,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -17496,7 +17531,7 @@ _LT_EOF
 	  compiler_needs_object=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object=yes
@@ -17534,7 +17569,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -17544,7 +17579,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
 
@@ -17556,7 +17591,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -17565,7 +17600,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
@@ -17584,7 +17619,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
 	    archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -17603,7 +17638,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -17647,10 +17682,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -17997,10 +18032,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS -b"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -18081,7 +18117,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -18107,7 +18143,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct=yes
 	hardcode_shlibpath_var=no
 	hardcode_direct_absolute=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
@@ -18176,7 +18212,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -18369,10 +18405,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -18398,6 +18435,7 @@ else
 	  fi
 	  allow_undefined_flag=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -18580,7 +18618,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([A-Za-z]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -18684,7 +18722,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -19052,7 +19090,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -19097,7 +19135,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -19743,7 +19781,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -19849,7 +19887,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -20205,13 +20243,15 @@ compiler=$CC
   # save warnings/boilerplate of simple test code
   ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
   ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -20277,9 +20317,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -20321,7 +20361,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -20352,7 +20392,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -20386,7 +20426,7 @@ with_gnu_ld=$lt_cv_prog_gnu_ld
         wlarc='${wl}'
 
         # ancient GNU ld didn't support --whole-archive et. al.
-        if eval "`$CC -print-prog-name=ld` --help 2>&1" |
+        if eval "`$CC -print-prog-name=ld | sed -e 's/\r//g'` --help 2>&1" | sed -e 's/\r//g' |
 	  $GREP 'no-whole-archive' > /dev/null; then
           whole_archive_flag_spec_CXX="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
         else
@@ -20407,7 +20447,7 @@ with_gnu_ld=$lt_cv_prog_gnu_ld
       # Commands to make compiler produce verbose output that lists
       # what "hidden" libraries, object files and flags are used when
       # linking a shared library.
-      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 
     else
       GXX=no
@@ -20609,7 +20649,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
         ;;
 
       beos*)
-	if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	  allow_undefined_flag_CXX=unsupported
 	  # Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	  # support --undefined.  This deserves some investigation.  FIXME
@@ -20637,7 +20677,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
         always_export_symbols_CXX=no
         enable_shared_with_static_runtimes_CXX=yes
 
-        if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+        if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
           archive_cmds_CXX='$CC -shared -nostdlib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
           # If the export-symbols file already is a .def file (1st line
           # is EXPORTS), use it as is; otherwise, prepend...
@@ -20753,7 +20793,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
             # explicitly linking system object files so we need to strip them
             # from the output so that they don't get included in the library
             # dependencies.
-            output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | $EGREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+            output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | sed -e '"'"'s/\r//g'"'"' | $EGREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
             ;;
           *)
             if test "$GXX" = yes; then
@@ -20818,7 +20858,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | $GREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+	    output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | sed -e '"'"'s/\r//g'"'"' | $GREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
 	    ;;
           *)
 	    if test "$GXX" = yes; then
@@ -20903,7 +20943,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`$CC $CFLAGS -v conftest.$objext -o libconftest$shared_ext 2>&1 | $GREP "ld"`; rm -f libconftest$shared_ext; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+	    output_verbose_link_cmd='templist=`$CC $CFLAGS -v conftest.$objext -o libconftest$shared_ext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP "ld"`; rm -f libconftest$shared_ext; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
 
 	    hardcode_libdir_flag_spec_CXX='${wl}-rpath,$libdir'
 	    export_dynamic_flag_spec_CXX='${wl}--export-dynamic'
@@ -20918,7 +20958,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # version 8.0 and above of icpc choke on multiply defined symbols
 	    # if we add $predep_objects and $postdep_objects, however 7.1 and
 	    # earlier do not add the objects themselves.
-	    case `$CC -V 2>&1` in
+	    case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	      *"Version 7."*)
 	        archive_cmds_CXX='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname -o $lib'
 		archive_expsym_cmds_CXX='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -20939,7 +20979,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    ;;
           pgCC* | pgcpp*)
             # Portland Group C++ compiler
-	    case `$CC -V` in
+	    case `$CC -V | sed -e 's/\r//g'` in
 	    *pgCC\ [1-5].* | *pgcpp\ [1-5].*)
 	      prelink_cmds_CXX='tpldir=Template.dir~
 		rm -rf $tpldir~
@@ -20986,7 +21026,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP "ld"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld .*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "X$list" | $Xsed'
+	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP "ld"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld .*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "X$list" | $Xsed'
 	    ;;
 	  xl* | mpixl* | bgxl*)
 	    # IBM XL 8.0 on PPC, with GNU ld
@@ -21001,7 +21041,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    fi
 	    ;;
 	  *)
-	    case `$CC -V 2>&1 | sed 5q` in
+	    case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	    *Sun\ C*)
 	      # Sun C++ 5.9
 	      no_undefined_flag_CXX=' -zdefs'
@@ -21051,7 +21091,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	;;
 
       netbsd*)
-        if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+        if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	  archive_cmds_CXX='$LD -Bshareable  -o $lib $predep_objects $libobjs $deplibs $postdep_objects $linker_flags'
 	  wlarc=
 	  hardcode_libdir_flag_spec_CXX='-R$libdir'
@@ -21059,7 +21099,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	  hardcode_shlibpath_var_CXX=no
 	fi
 	# Workaround some broken pre-1.5 toolchains
-	output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP conftest.$objext | $SED -e "s:-lgcc -lc -lgcc::"'
+	output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP conftest.$objext | $SED -e "s:-lgcc -lc -lgcc::"'
 	;;
 
       *nto* | *qnx*)
@@ -21078,7 +21118,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	  hardcode_direct_absolute_CXX=yes
 	  archive_cmds_CXX='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $lib'
 	  hardcode_libdir_flag_spec_CXX='${wl}-rpath,$libdir'
-	  if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	    archive_expsym_cmds_CXX='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-retain-symbols-file,$export_symbols -o $lib'
 	    export_dynamic_flag_spec_CXX='${wl}-E'
 	    whole_archive_flag_spec_CXX="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
@@ -21142,7 +21182,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP "ld" | $GREP -v "ld:"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld.*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP "ld" | $GREP -v "ld:"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld.*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
 	    ;;
 	  *)
 	    if test "$GXX" = yes && test "$with_gnu_ld" = no; then
@@ -21162,7 +21202,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	      # Commands to make compiler produce verbose output that lists
 	      # what "hidden" libraries, object files and flags are used when
 	      # linking a shared library.
-	      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+	      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 
 	    else
 	      # FIXME: insert proper C++ library support
@@ -21238,7 +21278,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # GNU C++ compiler with Solaris linker
 	    if test "$GXX" = yes && test "$with_gnu_ld" = no; then
 	      no_undefined_flag_CXX=' ${wl}-z ${wl}defs'
-	      if $CC --version | $GREP -v '^2\.7' > /dev/null; then
+	      if $CC --version | sed -e 's/\r//g' | $GREP -v '^2\.7' > /dev/null; then
 	        archive_cmds_CXX='$CC -shared -nostdlib $LDFLAGS $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-h $wl$soname -o $lib'
 	        archive_expsym_cmds_CXX='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 		  $CC -shared -nostdlib ${wl}-M $wl$lib.exp -o $lib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags~$RM $lib.exp'
@@ -21246,7 +21286,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	        # Commands to make compiler produce verbose output that lists
 	        # what "hidden" libraries, object files and flags are used when
 	        # linking a shared library.
-	        output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+	        output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 	      else
 	        # g++ 2.7 appears to require `-G' NOT `-shared' on this
 	        # platform.
@@ -21257,7 +21297,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	        # Commands to make compiler produce verbose output that lists
 	        # what "hidden" libraries, object files and flags are used when
 	        # linking a shared library.
-	        output_verbose_link_cmd='$CC -G $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+	        output_verbose_link_cmd='$CC -G $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 	      fi
 
 	      hardcode_libdir_flag_spec_CXX='${wl}-R $wl$libdir'
@@ -21377,7 +21417,7 @@ private:
 _LT_EOF
 
 if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -21473,7 +21513,7 @@ interix[3-9]*)
   ;;
 
 linux*)
-  case `$CC -V 2>&1 | sed 5q` in
+  case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
   *Sun\ C*)
     # Sun C++ 5.9
 
@@ -21763,7 +21803,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	    lt_prog_compiler_static_CXX='-qstaticlink'
 	    ;;
 	  *)
-	    case `$CC -V 2>&1 | sed 5q` in
+	    case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	    *Sun\ C*)
 	      # Sun C++ 5.9
 	      lt_prog_compiler_pic_CXX='-KPIC'
@@ -21912,14 +21952,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works_CXX=yes
@@ -21958,10 +22000,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -22011,8 +22054,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -22020,6 +22064,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o_CXX=yes
@@ -22063,8 +22108,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -22072,6 +22118,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o_CXX=yes
@@ -22121,27 +22168,27 @@ fi
     { $as_echo "$as_me:${as_lineno-$LINENO}: checking whether the $compiler linker ($LD) supports shared libraries" >&5
 $as_echo_n "checking whether the $compiler linker ($LD) supports shared libraries... " >&6; }
 
-  export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   case $host_os in
   aix[4-9]*)
     # If we're using GNU nm, then we don't want the "-C" option.
     # -C means demangle to AIX nm, but means don't demangle with GNU nm
     # Also, AIX nm treats weak defined symbols like other global defined
     # symbols, whereas GNU nm marks them as "W".
-    if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-      export_symbols_cmds_CXX='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+    if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+      export_symbols_cmds_CXX='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
     else
-      export_symbols_cmds_CXX='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+      export_symbols_cmds_CXX='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
     fi
     ;;
   pw32*)
     export_symbols_cmds_CXX="$ltdll_cmds"
   ;;
   cygwin* | mingw* | cegcc*)
-    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/;/^.*[ ]__nm__/s/^.*[ ]__nm__\([^ ]*\)[ ][^ ]*/\1 DATA/;/^I[ ]/d;/^[AITW][ ]/s/.* //'\'' | sort | uniq > $export_symbols'
+    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/;/^.*[ ]__nm__/s/^.*[ ]__nm__\([^ ]*\)[ ][^ ]*/\1 DATA/;/^I[ ]/d;/^[AITW][ ]/s/.* //'\'' | sort | uniq > $export_symbols'
   ;;
   *)
-    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   ;;
   esac
   exclude_expsyms_CXX='_GLOBAL_OFFSET_TABLE_|_GLOBAL__F[ID]_.*'
@@ -22183,10 +22230,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -22212,6 +22260,7 @@ else
 	  fi
 	  allow_undefined_flag_CXX=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -22341,7 +22390,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -22707,7 +22756,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -22752,7 +22801,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -23097,10 +23146,11 @@ fi
 fi
 
 ORIGINAL_AS_FOR_TARGET=$gcc_cv_as
+WINE_ORIGINAL_AS_FOR_TARGET=`winepath -w $gcc_cv_as`
 
 case "$ORIGINAL_AS_FOR_TARGET" in
   ./as | ./as$build_exeext) ;;
-  *) ac_config_files="$ac_config_files as:exec-tool.in"
+  *) ac_config_files="$ac_config_files as.cmd:exec-tool.cmd.in"
  ;;
 esac
 
@@ -23214,6 +23264,7 @@ fi
 fi
 
 ORIGINAL_PLUGIN_LD_FOR_TARGET=$gcc_cv_ld
+WINE_ORIGINAL_PLUGIN_LD_FOR_TARGET=`winepath -w $gcc_cv_ld`
 PLUGIN_LD_SUFFIX=`basename $gcc_cv_ld | sed -e "s,$target_alias-,,"`
 # if the PLUGIN_LD is set ld-new, just have it as ld
 # as that is the installed named.
@@ -23226,6 +23277,7 @@ fi
 if test "${with_plugin_ld+set}" = set; then :
   withval=$with_plugin_ld; if test x"$withval" != x; then
    ORIGINAL_PLUGIN_LD_FOR_TARGET="$withval"
+   WINE_ORIGINAL_PLUGIN_LD_FOR_TARGET=`winepath -w "$withval"`
    PLUGIN_LD_SUFFIX="$withval"
  fi
 fi
@@ -23277,8 +23329,8 @@ if test x$ld_is_gold = xno && which ${gcc_cv_ld}.gold >/dev/null 2>&1; then
   gold_non_default=no
   ld_gold=`which ${gcc_cv_ld}.gold`
 # Make sure this gold has minimal split stack support
-  if $ld_gold --help 2>/dev/null | grep split-stack-adjust-size >/dev/null 2>&1; then
-    ld_vers=`$ld_gold --version | sed 1q`
+  if $ld_gold --help 2>/dev/null | sed -e 's/\r//g' | grep split-stack-adjust-size >/dev/null 2>&1; then
+    ld_vers=`$ld_gold --version | sed -e 's/\r//g' | sed 1q`
     gold_vers=`echo $ld_vers | sed -n \
           -e 's,^[^)]*[  ]\([0-9][0-9]*\.[0-9][0-9]*[^)]*\)) .*$,\1,p'`
     case $target in
@@ -23304,10 +23356,11 @@ fi
 $as_echo "$gold_non_default" >&6; }
 
 ORIGINAL_LD_FOR_TARGET=$gcc_cv_ld
+WINE_ORIGINAL_LD_FOR_TARGET=`winepath -w $gcc_cv_ld`
 
 case "$ORIGINAL_LD_FOR_TARGET" in
   ./collect-ld | ./collect-ld$build_exeext) ;;
-  *) ac_config_files="$ac_config_files collect-ld:exec-tool.in"
+  *) ac_config_files="$ac_config_files collect-ld.cmd:exec-tool.cmd.in"
  ;;
 esac
 
@@ -23344,6 +23397,8 @@ $as_echo "newly built ld" >&6; }
 	gcc_cv_gld_minor_version=`expr "$gcc_cv_gld_version" : "VERSION=[0-9]*\.\([0-9]*\)"`
 	ORIGINAL_LD_BFD_FOR_TARGET=../ld/ld-new$build_exeext
 	ORIGINAL_LD_GOLD_FOR_TARGET=../gold/ld-new$build_exeext
+	WINE_ORIGINAL_LD_BFD_FOR_TARGET=..\\ld\\ld-new$build_exeext
+	WINE_ORIGINAL_LD_GOLD_FOR_TARGET=..\\gold\\ld-new$build_exeext
 else
 	{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $gcc_cv_ld" >&5
 $as_echo "$gcc_cv_ld" >&6; }
@@ -23351,6 +23406,8 @@ $as_echo "$gcc_cv_ld" >&6; }
 	gcc_cvs_ld_program=`dirname $gcc_cv_ld`/`basename $gcc_cv_ld $host_exeext`
 	ORIGINAL_LD_BFD_FOR_TARGET=${gcc_cvs_ld_program}.bfd$host_exeext
 	ORIGINAL_LD_GOLD_FOR_TARGET=${gcc_cvs_ld_program}.gold$host_exeext
+	WINE_ORIGINAL_LD_BFD_FOR_TARGET=`winepath -w ${gcc_cvs_ld_program}.bfd$host_exeext`
+	WINE_ORIGINAL_LD_GOLD_FOR_TARGET=`winepath -w ${gcc_cvs_ld_program}.gold$host_exeext`
 fi
 
 
@@ -23428,10 +23485,11 @@ $as_echo "$gcc_cv_nm" >&6; }
 fi
 
 ORIGINAL_NM_FOR_TARGET=$gcc_cv_nm
+WINE_ORIGINAL_NM_FOR_TARGET=`winepath -w $gcc_cv_nm`
 
 case "$ORIGINAL_NM_FOR_TARGET" in
   ./nm | ./nm$build_exeext) ;;
-  *) ac_config_files="$ac_config_files nm:exec-tool.in"
+  *) ac_config_files="$ac_config_files nm.cmd:exec-tool.cmd.in"
  ;;
 esac
 
@@ -23701,10 +23759,11 @@ fi
 fi
 
 ORIGINAL_DSYMUTIL_FOR_TARGET=$gcc_cv_dsymutil
+WINE_ORIGINAL_DSYMUTIL_FOR_TARGET=`winepath -w $gcc_cv_dsymutil`
 
 case "$ORIGINAL_DSYMUTIL_FOR_TARGET" in
   ./dsymutil | ./dsymutil$build_exeext) ;;
-  *) ac_config_files="$ac_config_files dsymutil:exec-tool.in"
+  *) ac_config_files="$ac_config_files dsymutil.cmd:exec-tool.cmd.in"
  ;;
 esac
 
@@ -24083,7 +24142,7 @@ _ACEOF
 
 
 if test $in_tree_ld != yes ; then
-  ld_ver=`$gcc_cv_ld --version 2>/dev/null | sed 1q`
+  ld_ver=`$gcc_cv_ld --version 2>/dev/null | sed -e 's/\r//g' | sed 1q`
   if echo "$ld_ver" | grep GNU > /dev/null; then
     if test x"$ld_is_gold" = xyes; then
       # GNU gold --version looks like this:
@@ -24119,7 +24178,7 @@ if test $in_tree_ld != yes ; then
 	# ld and ld.so.1 are guaranteed to be updated in lockstep, so ld version
 	# numbers can be used in ld.so.1 feature checks even if a different
 	# linker is configured.
-	ld_ver=`$gcc_cv_ld -V 2>&1`
+	ld_ver=`$gcc_cv_ld -V 2>&1 | sed -e 's/\r//g'`
 	if echo "$ld_ver" | grep 'Solaris Link Editors' > /dev/null; then
 	  ld_vers=`echo $ld_ver | sed -n \
 	    -e 's,^.*: 5\.[0-9][0-9]*-\([0-9]\.[0-9][0-9]*\).*$,\1,p'`
@@ -25897,8 +25956,8 @@ if test $in_tree_ld = yes ; then
   fi
 elif test x$gcc_cv_ld != x; then
   # Check if linker supports -Bstatic/-Bdynamic option
-  if $gcc_cv_ld --help 2>&1 | grep -- -Bstatic > /dev/null \
-     && $gcc_cv_ld --help 2>&1 | grep -- -Bdynamic > /dev/null; then
+  if $gcc_cv_ld --help 2>&1 | sed -e 's/\r//g' | grep -- -Bstatic > /dev/null \
+     && $gcc_cv_ld --help 2>&1 | sed -e 's/\r//g' | grep -- -Bdynamic > /dev/null; then
       gcc_cv_ld_static_dynamic=yes
   else
     case "$target" in
@@ -25999,7 +26058,7 @@ $as_echo_n "checking linker --demangle support... " >&6; }
     fi
   elif test x$gcc_cv_ld != x -a x"$gnu_ld" = xyes; then
     # Check if the GNU linker supports --demangle option
-    if $gcc_cv_ld --help 2>&1 | grep no-demangle > /dev/null; then
+    if $gcc_cv_ld --help 2>&1 | sed -e 's/\r//g' | grep no-demangle > /dev/null; then
       gcc_cv_ld_demangle=yes
     fi
   fi
@@ -26031,7 +26090,7 @@ if test -f liblto_plugin.la; then
   else
     # Determine plugin linker version.
     # FIXME: Partial duplicate from above, generalize.
-    ld_ver=`$ORIGINAL_PLUGIN_LD_FOR_TARGET --version 2>/dev/null | sed 1q`
+    ld_ver=`$ORIGINAL_PLUGIN_LD_FOR_TARGET --version 2>/dev/null | sed -e 's/\r//g' | sed 1q`
     if echo "$ld_ver" | grep GNU > /dev/null; then
       if echo "$ld_ver" | grep "GNU gold" > /dev/null; then
         ld_is_gold=yes
@@ -26486,7 +26545,7 @@ $as_echo "#define HAVE_LD_AVR_AVRXMEGA3_RODATA_IN_FLASH 1" >>confdefs.h
 $as_echo "no: avrxmega3 .rodata located in RAM" >&6; }
 	    echo "$as_me: nm output was" >&5
 	    cat conftest.nm >&5
-	    avr_ld_ver="`$gcc_cv_ld -v | sed -e 's:^.* ::'`"
+	    avr_ld_ver="`$gcc_cv_ld -v | sed -e 's/\r//g' | sed -e 's:^.* ::'`"
 	    { $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: support for avrxmega3 .rodata in flash needs Binutils 2.29 or higher (have $avr_ld_ver)" >&5
 $as_echo "$as_me: WARNING: support for avrxmega3 .rodata in flash needs Binutils 2.29 or higher (have $avr_ld_ver)" >&2;}
 	fi
@@ -27562,7 +27621,7 @@ fi
       as_ix86_gas_32_opt="--32"
     fi
     if echo "$ld_ver" | grep GNU > /dev/null; then
-      if $gcc_cv_ld -V 2>/dev/null | grep elf_i386_sol2 > /dev/null; then
+      if $gcc_cv_ld -V 2>/dev/null | sed -e 's/\r//g' | grep elf_i386_sol2 > /dev/null; then
         ld_ix86_gld_32_opt="-melf_i386_sol2"
       else
         ld_ix86_gld_32_opt="-melf_i386"
@@ -29132,13 +29191,14 @@ else
   gcc_cv_as_gcn_xnack_ecc_fiji=no
   if test x$gcc_cv_as != x; then
     $as_echo '' > conftest.s
-    if { ac_try='$gcc_cv_as $gcc_cv_as_flags -triple=amdgcn--amdhsa -mcpu=fiji -mattr=+xnack 2>conftest.err -o conftest.o conftest.s >&5'
+    if { ac_try='($gcc_cv_as $gcc_cv_as_flags -triple=amdgcn--amdhsa -mcpu=fiji -mattr=+xnack -o conftest.o conftest.s | sed -e '"'"'s/\r//g'"'"') 2>conftest.err >&5'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
   (eval $ac_try) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; }
     then
+        dos2unix -q conftest.err
 	grep "." conftest.err >&5 \
        || gcc_cv_as_gcn_xnack_ecc_fiji=yes
     else
@@ -29165,13 +29225,14 @@ else
   gcc_cv_as_gcn_xnack_ecc_gfx900=no
   if test x$gcc_cv_as != x; then
     $as_echo '' > conftest.s
-    if { ac_try='$gcc_cv_as $gcc_cv_as_flags -triple=amdgcn--amdhsa -mcpu=gfx900 -mattr=+xnack 2>conftest.err -o conftest.o conftest.s >&5'
+    if { ac_try='($gcc_cv_as $gcc_cv_as_flags -triple=amdgcn--amdhsa -mcpu=gfx900 -mattr=+xnack -o conftest.o conftest.s | sed -e '"'"'s/\r//g'"'"') 2>conftest.err >&5'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
   (eval $ac_try) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; }
     then
+        dos2unix -q conftest.err
 	grep "." conftest.err >&5 \
        || gcc_cv_as_gcn_xnack_ecc_gfx900=yes
     else
@@ -29198,13 +29259,14 @@ else
   gcc_cv_as_gcn_xnack_ecc_gfx906=no
   if test x$gcc_cv_as != x; then
     $as_echo '' > conftest.s
-    if { ac_try='$gcc_cv_as $gcc_cv_as_flags -triple=amdgcn--amdhsa -mcpu=gfx906 -mattr=+xnack 2>conftest.err -o conftest.o conftest.s >&5'
+    if { ac_try='($gcc_cv_as $gcc_cv_as_flags -triple=amdgcn--amdhsa -mcpu=gfx906 -mattr=+xnack -o conftest.o conftest.s | sed -e '"'"'s/\r//g'"'"') 2>conftest.err >&5'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
   (eval $ac_try) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; }
     then
+        dos2unix -q conftest.err
 	grep "." conftest.err >&5 \
        || gcc_cv_as_gcn_xnack_ecc_gfx906=yes
     else
@@ -29231,13 +29293,14 @@ else
   gcc_cv_as_gcn_xnack_ecc_gfx908=no
   if test x$gcc_cv_as != x; then
     $as_echo '' > conftest.s
-    if { ac_try='$gcc_cv_as $gcc_cv_as_flags -triple=amdgcn--amdhsa -mcpu=gfx908 -mattr=+xnack 2>conftest.err -o conftest.o conftest.s >&5'
+    if { ac_try='($gcc_cv_as $gcc_cv_as_flags -triple=amdgcn--amdhsa -mcpu=gfx908 -mattr=+xnack -o conftest.o conftest.s | sed -e '"'"'s/\r//g'"'"') 2>conftest.err >&5'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
   (eval $ac_try) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; }
     then
+        dos2unix -q conftest.err
 	grep "." conftest.err >&5 \
        || gcc_cv_as_gcn_xnack_ecc_gfx908=yes
     else
@@ -29269,13 +29332,14 @@ else
   gcc_cv_as_gcn_sram_ecc_fiji=no
   if test x$gcc_cv_as != x; then
     $as_echo '' > conftest.s
-    if { ac_try='$gcc_cv_as $gcc_cv_as_flags -triple=amdgcn--amdhsa -mcpu=fiji -mattr=$sramopt 2>conftest.err -o conftest.o conftest.s >&5'
+    if { ac_try='($gcc_cv_as $gcc_cv_as_flags -triple=amdgcn--amdhsa -mcpu=fiji -mattr=$sramopt -o conftest.o conftest.s | sed -e '"'"'s/\r//g'"'"') 2>conftest.err >&5'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
   (eval $ac_try) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; }
     then
+        dos2unix -q conftest.err
 	grep "." conftest.err >&5 \
        || gcc_cv_as_gcn_sram_ecc_fiji=yes
     else
@@ -29302,13 +29366,14 @@ else
   gcc_cv_as_gcn_sram_ecc_gfx900=no
   if test x$gcc_cv_as != x; then
     $as_echo '' > conftest.s
-    if { ac_try='$gcc_cv_as $gcc_cv_as_flags -triple=amdgcn--amdhsa -mcpu=gfx900 -mattr=$sramopt 2>conftest.err -o conftest.o conftest.s >&5'
+    if { ac_try='($gcc_cv_as $gcc_cv_as_flags -triple=amdgcn--amdhsa -mcpu=gfx900 -mattr=$sramopt -o conftest.o conftest.s | sed -e '"'"'s/\r//g'"'"') 2>conftest.err >&5'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
   (eval $ac_try) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; }
     then
+        dos2unix -q conftest.err
 	grep "." conftest.err >&5 \
        || gcc_cv_as_gcn_sram_ecc_gfx900=yes
     else
@@ -29335,13 +29400,14 @@ else
   gcc_cv_as_gcn_sram_ecc_gfx906=no
   if test x$gcc_cv_as != x; then
     $as_echo '' > conftest.s
-    if { ac_try='$gcc_cv_as $gcc_cv_as_flags -triple=amdgcn--amdhsa -mcpu=gfx906 -mattr=$sramopt 2>conftest.err -o conftest.o conftest.s >&5'
+    if { ac_try='($gcc_cv_as $gcc_cv_as_flags -triple=amdgcn--amdhsa -mcpu=gfx906 -mattr=$sramopt -o conftest.o conftest.s | sed -e '"'"'s/\r//g'"'"') 2>conftest.err >&5'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
   (eval $ac_try) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; }
     then
+        dos2unix -q conftest.err
 	grep "." conftest.err >&5 \
        || gcc_cv_as_gcn_sram_ecc_gfx906=yes
     else
@@ -29368,13 +29434,14 @@ else
   gcc_cv_as_gcn_sram_ecc_gfx908=no
   if test x$gcc_cv_as != x; then
     $as_echo '' > conftest.s
-    if { ac_try='$gcc_cv_as $gcc_cv_as_flags -triple=amdgcn--amdhsa -mcpu=gfx908 -mattr=$sramopt 2>conftest.err -o conftest.o conftest.s >&5'
+    if { ac_try='($gcc_cv_as $gcc_cv_as_flags -triple=amdgcn--amdhsa -mcpu=gfx908 -mattr=$sramopt -o conftest.o conftest.s | sed -e '"'"'s/\r//g'"'"') 2>conftest.err >&5'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
   (eval $ac_try) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; }
     then
+        dos2unix -q conftest.err
 	grep "." conftest.err >&5 \
        || gcc_cv_as_gcn_sram_ecc_gfx908=yes
     else
@@ -30328,7 +30395,7 @@ if test $in_tree_ld = yes ; then
 elif test x$gcc_cv_ld != x; then
   if echo "$ld_ver" | grep GNU > /dev/null; then
     # Check if linker supports --eh-frame-hdr option
-    if $gcc_cv_ld --help 2>&1 | grep eh-frame-hdr > /dev/null; then
+    if $gcc_cv_ld --help 2>&1 | sed -e 's/\r//g' | grep eh-frame-hdr > /dev/null; then
       gcc_cv_ld_eh_frame_hdr=yes
     fi
   else
@@ -30406,7 +30473,7 @@ if test $in_tree_ld = yes ; then
   fi
 elif test x$gcc_cv_ld != x; then
   # Check if linker supports -pie option
-  if $gcc_cv_ld --help 2>&1 | grep -- -pie > /dev/null; then
+  if $gcc_cv_ld --help 2>&1 | sed -e 's/\r//g' | grep -- -pie > /dev/null; then
     gcc_cv_ld_pie=yes
     case "$target" in
       *-*-solaris2*)
@@ -30420,7 +30487,7 @@ elif test x$gcc_cv_ld != x; then
     case "$target" in
       *-*-solaris2.1[1-9]*)
 	# Solaris 11.3 added PIE support.
-	if $gcc_cv_ld -z help 2>&1 | grep -- type.*pie > /dev/null; then
+	if $gcc_cv_ld -z help 2>&1 | sed -e 's/\r//g' | grep -- type.*pie > /dev/null; then
 	  gcc_cv_ld_pie=yes
 	fi
 	;;
@@ -30659,7 +30726,7 @@ else
   case "${target}" in
     *-*-solaris2*)
       # Introduced in Solaris 11.2.
-      if $gcc_cv_ld --help 2>&1 | grep -- '-z compress-sections' > /dev/null; then
+      if $gcc_cv_ld --help 2>&1 | sed -e 's/\r//g' | grep -- '-z compress-sections' > /dev/null; then
         gcc_cv_ld_compress_debug=3
         gcc_cv_ld_compress_debug_option="-z compress-sections"
       else
@@ -30725,7 +30792,7 @@ $as_echo "$gcc_cv_ld64_major" >&6; }
     { $as_echo "$as_me:${as_lineno-$LINENO}: checking linker version" >&5
 $as_echo_n "checking linker version... " >&6; }
     if test x"${gcc_cv_ld64_version}" = x; then
-      gcc_cv_ld64_version=`$gcc_cv_ld -v 2>&1 | grep ld64 | sed s/.*ld64-// | awk '{print $1}'`
+      gcc_cv_ld64_version=`$gcc_cv_ld -v 2>&1 | sed -e 's/\r//g' | grep ld64 | sed s/.*ld64-// | awk '{print $1}'`
     fi
     { $as_echo "$as_me:${as_lineno-$LINENO}: result: $gcc_cv_ld64_version" >&5
 $as_echo "$gcc_cv_ld64_version" >&6; }
@@ -30733,7 +30800,7 @@ $as_echo "$gcc_cv_ld64_version" >&6; }
     { $as_echo "$as_me:${as_lineno-$LINENO}: checking linker for -export_dynamic support" >&5
 $as_echo_n "checking linker for -export_dynamic support... " >&6; }
     gcc_cv_ld64_export_dynamic=1
-    if $gcc_cv_ld -export_dynamic < /dev/null 2>&1 | grep 'unknown option' > /dev/null; then
+    if $gcc_cv_ld -export_dynamic < /dev/null 2>&1 | sed -e 's/\r//g' | grep 'unknown option' > /dev/null; then
       gcc_cv_ld64_export_dynamic=0
     fi
     { $as_echo "$as_me:${as_lineno-$LINENO}: result: $gcc_cv_ld64_export_dynamic" >&5
@@ -30742,7 +30809,7 @@ $as_echo "$gcc_cv_ld64_export_dynamic" >&6; }
     { $as_echo "$as_me:${as_lineno-$LINENO}: checking linker for -platform_version support" >&5
 $as_echo_n "checking linker for -platform_version support... " >&6; }
     gcc_cv_ld64_platform_version=1
-    if $gcc_cv_ld -platform_version macos 10.5 0.0 < /dev/null 2>&1 | grep 'unknown option' > /dev/null; then
+    if $gcc_cv_ld -platform_version macos 10.5 0.0 < /dev/null 2>&1 | sed -e 's/\r//g' | grep 'unknown option' > /dev/null; then
       gcc_cv_ld64_platform_version=0
     fi
     { $as_echo "$as_me:${as_lineno-$LINENO}: result: $gcc_cv_ld64_platform_version" >&5
@@ -30829,8 +30896,8 @@ $as_echo_n "checking broken PE linker dwarf5 support... " >&6; }
 	gcc_cv_ld_broken_pe_dwarf5=no
       fi
     else
-      if $gcc_cv_ld --verbose 2>&1 | grep -q '\.debug_loclists.*BLOCK.*__section_alignment__.*NOLOAD.*:' \
-	 && $gcc_cv_ld --verbose 2>&1 | grep -q '\.debug_rnglists.*BLOCK.*__section_alignment__.*NOLOAD.*:'; then
+      if $gcc_cv_ld --verbose 2>&1 | sed -e 's/\r//g' | grep -q '\.debug_loclists.*BLOCK.*__section_alignment__.*NOLOAD.*:' \
+	 && $gcc_cv_ld --verbose 2>&1 | sed -e 's/\r//g' | grep -q '\.debug_rnglists.*BLOCK.*__section_alignment__.*NOLOAD.*:'; then
 	gcc_cv_ld_broken_pe_dwarf5=no
       fi
     fi
@@ -30850,7 +30917,7 @@ $as_echo_n "checking PE linker --disable-dynamicbase support... " >&6; }
         gcc_cv_ld_disable_dynamicbase=yes
       fi
     else
-      if $gcc_cv_ld --help 2>&1 | grep -q 'disable\-]dynamicbase' > /dev/null; then
+      if $gcc_cv_ld --help 2>&1 | sed -e 's/\r//g' | grep -q 'disable\-]dynamicbase' > /dev/null; then
         gcc_cv_ld_disable_dynamicbase=yes
       fi
     fi
@@ -30887,10 +30954,10 @@ if test $in_tree_ld = yes ; then
   fi
 elif test x$gcc_cv_ld != x; then
   # Check if linker supports --as-needed and --no-as-needed options
-  if $gcc_cv_ld --help 2>&1 | grep as-needed > /dev/null; then
+  if $gcc_cv_ld --help 2>&1 | sed -e 's/\r//g' | grep as-needed > /dev/null; then
     gcc_cv_ld_as_needed=yes
-    if $gcc_cv_ld --help 2>&1 | grep push-state > /dev/null \
-       && $gcc_cv_ld --help 2>&1 | grep pop-state > /dev/null \
+    if $gcc_cv_ld --help 2>&1 | sed -e 's/\r//g' | grep push-state > /dev/null \
+       && $gcc_cv_ld --help 2>&1 | sed -e 's/\r//g' | grep pop-state > /dev/null \
        && echo "$ld_ver" | grep GNU > /dev/null \
        && test "$ld_vers_major" -eq 2 -a "$ld_vers_minor" -ge 28; then
       # Use these options only when both ld.bfd and ld.gold support
@@ -31010,6 +31077,7 @@ EOF
       if $gcc_cv_as -a32 -o conftest1.o conftest1.s > /dev/null 2>&1 \
          && $gcc_cv_as -a32 -o conftest2.o conftest2.s > /dev/null 2>&1 \
          && $gcc_cv_ld $emul_name -r -o conftest.o conftest1.o conftest2.o > /dev/null 2> conftest.err \
+         && dos2unix -q conftest.err \
 	 && test ! -s conftest.err; then
         gcc_cv_ld_ppc_attr=yes
       fi
@@ -31214,7 +31282,7 @@ else
       gcc_cv_ld_buildid=yes
     fi
   elif test x$gcc_cv_ld != x; then
-    if $gcc_cv_ld --help 2>&1 | grep build-id > /dev/null; then
+    if $gcc_cv_ld --help 2>&1 | sed -e 's/\r//g' | grep build-id > /dev/null; then
       gcc_cv_ld_buildid=yes
     fi
   fi
@@ -31262,7 +31330,7 @@ else
       gcc_cv_ld_sol2_emulation=yes
     fi
   elif test x$gcc_cv_ld != x; then
-    if $gcc_cv_ld -V 2>/dev/null | sed -e '1,/Supported emulations/d;q' | \
+    if $gcc_cv_ld -V 2>/dev/null | sed -e 's/\r//g' | sed -e '1,/Supported emulations/d;q' | \
        grep _sol2 > /dev/null; then
       gcc_cv_ld_sol2_emulation=yes
     fi
@@ -31287,7 +31355,7 @@ else
         gcc_cv_ld_sysroot=yes
       fi
   elif test x$gcc_cv_ld != x; then
-    if $gcc_cv_ld --help 2>&1 | grep sysroot > /dev/null; then
+    if $gcc_cv_ld --help 2>&1 | sed -e 's/\r//g' | grep sysroot > /dev/null; then
       gcc_cv_ld_sysroot=yes
     fi
   fi
@@ -32718,7 +32786,7 @@ if test x"$ld_is_gold" = xno; then
     fi
   elif test x$gcc_cv_ld != x; then
     # Check if linker supports -a bndplt option
-    if $gcc_cv_ld --help 2>&1 | grep -- '-z bndplt' > /dev/null; then
+    if $gcc_cv_ld --help 2>&1 | sed -e 's/\r//g' | grep -- '-z bndplt' > /dev/null; then
       ld_bndplt_support=yes
     fi
   fi
@@ -32742,7 +32810,7 @@ if test x"$ld_is_gold" = xno; then
     fi
   elif test x$gcc_cv_ld != x; then
     # Check if linker supports --push-state/--pop-state options
-    if $gcc_cv_ld --help 2>&1 | grep -- '--push-state' > /dev/null; then
+    if $gcc_cv_ld --help 2>&1 | sed -e 's/\r//g' | grep -- '--push-state' > /dev/null; then
       ld_pushpopstate_support=yes
     fi
   fi
@@ -32849,6 +32917,13 @@ esac
 # Configure the subdirectories
 # AC_CONFIG_SUBDIRS($subdirs)
 
+${LN_S} $srcdir/wineFindStrWorkarround.exe wineFindStrWorkarround.exe
+wine_find_str_workarround="wineFindStrWorkarround.exe"
+
+
+ac_config_files="$ac_config_files exec-tool.c:exec-tool.c.in"
+
+
 # Create the Makefile
 # and configure language subdirectories
 ac_config_files="$ac_config_files $all_outputs"
@@ -33565,11 +33640,12 @@ do
     "auto-host.h") CONFIG_HEADERS="$CONFIG_HEADERS auto-host.h:config.in" ;;
     "depdir") CONFIG_COMMANDS="$CONFIG_COMMANDS depdir" ;;
     "gccdepdir") CONFIG_COMMANDS="$CONFIG_COMMANDS gccdepdir" ;;
-    "as") CONFIG_FILES="$CONFIG_FILES as:exec-tool.in" ;;
-    "collect-ld") CONFIG_FILES="$CONFIG_FILES collect-ld:exec-tool.in" ;;
-    "nm") CONFIG_FILES="$CONFIG_FILES nm:exec-tool.in" ;;
-    "dsymutil") CONFIG_FILES="$CONFIG_FILES dsymutil:exec-tool.in" ;;
+    "as.cmd") CONFIG_FILES="$CONFIG_FILES as:exec-tool.cmd.in" ;;
+    "collect-ld.cmd") CONFIG_FILES="$CONFIG_FILES collect-ld:exec-tool.cmd.in" ;;
+    "nm.cmd") CONFIG_FILES="$CONFIG_FILES nm:exec-tool.cmd.in" ;;
+    "dsymutil.cmd") CONFIG_FILES="$CONFIG_FILES dsymutil:exec-tool.cmd.in" ;;
     "clearcap.map") CONFIG_LINKS="$CONFIG_LINKS clearcap.map:${srcdir}/config/$clearcap_map" ;;
+    "exec-tool.c") CONFIG_FILES="$CONFIG_FILES exec-tool.c:exec-tool.c.in" ;;
     "$all_outputs") CONFIG_FILES="$CONFIG_FILES $all_outputs" ;;
     "default") CONFIG_COMMANDS="$CONFIG_COMMANDS default" ;;
 
@@ -34200,10 +34276,10 @@ $as_echo "$as_me: executing $ac_file commands" >&6;}
   do
       ${CONFIG_SHELL-/bin/sh} $ac_aux_dir/mkinstalldirs $lang/$DEPDIR
   done ;;
-    "as":F) chmod +x as ;;
-    "collect-ld":F) chmod +x collect-ld ;;
-    "nm":F) chmod +x nm ;;
-    "dsymutil":F) chmod +x dsymutil ;;
+    "as.cmd":F) chmod +x as.cmd ;;
+    "collect-ld.cmd":F) chmod +x collect-ld.cmd ;;
+    "nm.cmd":F) chmod +x nmc.cmd ;;
+    "dsymutil.cmd":F) chmod +x dsymutil.cmd ;;
     "default":C)
 case ${CONFIG_HEADERS} in
   *auto-host.h:config.in*)
diff --git a/gcc/gcc/configure.ac b/gcc/gcc/configure.ac
index 23bee7010a..673a4d5c0a 100644
--- a/gcc/gcc/configure.ac
+++ b/gcc/gcc/configure.ac
@@ -2586,10 +2586,12 @@ else
 fi])
 
 ORIGINAL_AS_FOR_TARGET=$gcc_cv_as
+WINE_ORIGINAL_AS_FOR_TARGET=`winepath -w $gcc_cv_as`
 AC_SUBST(ORIGINAL_AS_FOR_TARGET)
+AC_SUBST(WINE_ORIGINAL_AS_FOR_TARGET)
 case "$ORIGINAL_AS_FOR_TARGET" in
   ./as | ./as$build_exeext) ;;
-  *) AC_CONFIG_FILES(as:exec-tool.in, [chmod +x as]) ;;
+  *) AC_CONFIG_FILES(as:exec-tool.cmd.in, [chmod +x as.cmd]) ;;
 esac 
 
 default_ld=
@@ -2655,6 +2657,7 @@ else
 fi])
 
 ORIGINAL_PLUGIN_LD_FOR_TARGET=$gcc_cv_ld
+WINE_ORIGINAL_PLUGIN_LD_FOR_TARGET=`winepath -w $gcc_cv_ld`
 PLUGIN_LD_SUFFIX=`basename $gcc_cv_ld | sed -e "s,$target_alias-,,"`
 # if the PLUGIN_LD is set ld-new, just have it as ld
 # as that is the installed named.
@@ -2666,9 +2669,11 @@ AC_ARG_WITH(plugin-ld,
 [AS_HELP_STRING([[--with-plugin-ld=[ARG]]], [specify the plugin linker])],
 [if test x"$withval" != x; then
    ORIGINAL_PLUGIN_LD_FOR_TARGET="$withval"
+   WINE_ORIGINAL_PLUGIN_LD_FOR_TARGET=`winepath -w "$withval"`
    PLUGIN_LD_SUFFIX="$withval"
  fi])
 AC_SUBST(ORIGINAL_PLUGIN_LD_FOR_TARGET)
+AC_SUBST(WINE_ORIGINAL_PLUGIN_LD_FOR_TARGET)
 AC_DEFINE_UNQUOTED(PLUGIN_LD_SUFFIX, "$PLUGIN_LD_SUFFIX", [Specify plugin linker])
 
 # Check to see if we are using gold instead of ld
@@ -2706,8 +2711,8 @@ if test x$ld_is_gold = xno && which ${gcc_cv_ld}.gold >/dev/null 2>&1; then
   gold_non_default=no
   ld_gold=`which ${gcc_cv_ld}.gold`
 # Make sure this gold has minimal split stack support
-  if $ld_gold --help 2>/dev/null | grep split-stack-adjust-size >/dev/null 2>&1; then
-    ld_vers=`$ld_gold --version | sed 1q`
+  if $ld_gold --help 2>/dev/null | sed -e 's/\r//g' | grep split-stack-adjust-size >/dev/null 2>&1; then
+    ld_vers=`$ld_gold --version | sed -e 's/\r//g' | sed 1q`
     gold_vers=`echo $ld_vers | sed -n \
           -e 's,^[[^)]]*[[  ]]\([[0-9]][[0-9]]*\.[[0-9]][[0-9]]*[[^)]]*\)) .*$,\1,p'`
     case $target in
@@ -2731,10 +2736,12 @@ fi
 AC_MSG_RESULT($gold_non_default)
 
 ORIGINAL_LD_FOR_TARGET=$gcc_cv_ld
+WINE_ORIGINAL_LD_FOR_TARGET=`winepath -w $gcc_cv_ld`
 AC_SUBST(ORIGINAL_LD_FOR_TARGET)
+AC_SUBST(WINE_ORIGINAL_LD_FOR_TARGET)
 case "$ORIGINAL_LD_FOR_TARGET" in
   ./collect-ld | ./collect-ld$build_exeext) ;;
-  *) AC_CONFIG_FILES(collect-ld:exec-tool.in, [chmod +x collect-ld]) ;;
+  *) AC_CONFIG_FILES(collect-ld:exec-tool.cmd.in, [chmod +x collect-ld.cmd]) ;;
 esac 
 
 AC_MSG_CHECKING(what linker to use)
@@ -2772,16 +2779,22 @@ changequote(,)dnl
 changequote([,])dnl
 	ORIGINAL_LD_BFD_FOR_TARGET=../ld/ld-new$build_exeext
 	ORIGINAL_LD_GOLD_FOR_TARGET=../gold/ld-new$build_exeext
+	WINE_ORIGINAL_LD_BFD_FOR_TARGET=..\\ld\\ld-new$build_exeext
+	WINE_ORIGINAL_LD_GOLD_FOR_TARGET=..\\gold\\ld-new$build_exeext
 else
 	AC_MSG_RESULT($gcc_cv_ld)
 	in_tree_ld=no
 	gcc_cvs_ld_program=`dirname $gcc_cv_ld`/`basename $gcc_cv_ld $host_exeext`
 	ORIGINAL_LD_BFD_FOR_TARGET=${gcc_cvs_ld_program}.bfd$host_exeext
 	ORIGINAL_LD_GOLD_FOR_TARGET=${gcc_cvs_ld_program}.gold$host_exeext
+	WINE_ORIGINAL_LD_BFD_FOR_TARGET=`winepath -w ${gcc_cvs_ld_program}.bfd$host_exeext`
+	WINE_ORIGINAL_LD_GOLD_FOR_TARGET=`winepath -w ${gcc_cvs_ld_program}.gold$host_exeext`
 fi
 
 AC_SUBST(ORIGINAL_LD_BFD_FOR_TARGET)
 AC_SUBST(ORIGINAL_LD_GOLD_FOR_TARGET)
+AC_SUBST(WINE_ORIGINAL_LD_BFD_FOR_TARGET)
+AC_SUBST(WINE_ORIGINAL_LD_GOLD_FOR_TARGET)
 
 # Figure out what nm we will be using.
 gcc_cv_binutils_srcdir=`echo $srcdir | sed -e 's,/gcc$,,'`/binutils
@@ -2809,10 +2822,12 @@ else
 fi
 
 ORIGINAL_NM_FOR_TARGET=$gcc_cv_nm
+WINE_ORIGINAL_NM_FOR_TARGET=`winepath -w $gcc_cv_nm`
 AC_SUBST(ORIGINAL_NM_FOR_TARGET)
+AC_SUBST(WINE_ORIGINAL_NM_FOR_TARGET)
 case "$ORIGINAL_NM_FOR_TARGET" in
   ./nm | ./nm$build_exeext) ;;
-  *) AC_CONFIG_FILES(nm:exec-tool.in, [chmod +x nm]) ;;
+  *) AC_CONFIG_FILES(nm:exec-tool.cmd.in, [chmod +x nm.cmd]) ;;
 esac
 
 
@@ -2898,10 +2913,12 @@ else
 fi])
 
 ORIGINAL_DSYMUTIL_FOR_TARGET=$gcc_cv_dsymutil
+WINE_ORIGINAL_DSYMUTIL_FOR_TARGET=`winepath -w $gcc_cv_dsymutil`
 AC_SUBST(ORIGINAL_DSYMUTIL_FOR_TARGET)
+AC_SUBST(WINE_ORIGINAL_DSYMUTIL_FOR_TARGET)
 case "$ORIGINAL_DSYMUTIL_FOR_TARGET" in
   ./dsymutil | ./dsymutil$build_exeext) ;;
-  *) AC_CONFIG_FILES(dsymutil:exec-tool.in, [chmod +x dsymutil]) ;;
+  *) AC_CONFIG_FILES(dsymutil:exec-tool.cmd.in, [chmod +x dsymutil.cmd]) ;;
 esac 
 
 # Figure out what assembler alignment features are present.
@@ -3032,7 +3049,7 @@ AC_DEFINE_UNQUOTED(HAVE_GNU_INDIRECT_FUNCTION, $gif,
 
 changequote(,)dnl
 if test $in_tree_ld != yes ; then
-  ld_ver=`$gcc_cv_ld --version 2>/dev/null | sed 1q`
+  ld_ver=`$gcc_cv_ld --version 2>/dev/null | sed -e 's/\r//g' | sed 1q`
   if echo "$ld_ver" | grep GNU > /dev/null; then
     if test x"$ld_is_gold" = xyes; then
       # GNU gold --version looks like this:
@@ -3068,7 +3085,7 @@ if test $in_tree_ld != yes ; then
 	# ld and ld.so.1 are guaranteed to be updated in lockstep, so ld version
 	# numbers can be used in ld.so.1 feature checks even if a different
 	# linker is configured.
-	ld_ver=`$gcc_cv_ld -V 2>&1`
+	ld_ver=`$gcc_cv_ld -V 2>&1 | sed -e 's/\r//g'`
 	if echo "$ld_ver" | grep 'Solaris Link Editors' > /dev/null; then
 	  ld_vers=`echo $ld_ver | sed -n \
 	    -e 's,^.*: 5\.[0-9][0-9]*-\([0-9]\.[0-9][0-9]*\).*$,\1,p'`
@@ -4149,8 +4166,8 @@ if test $in_tree_ld = yes ; then
   fi
 elif test x$gcc_cv_ld != x; then
   # Check if linker supports -Bstatic/-Bdynamic option
-  if $gcc_cv_ld --help 2>&1 | grep -- -Bstatic > /dev/null \
-     && $gcc_cv_ld --help 2>&1 | grep -- -Bdynamic > /dev/null; then
+  if $gcc_cv_ld --help 2>&1 | sed -e 's/\r//g' | grep -- -Bstatic > /dev/null \
+     && $gcc_cv_ld --help 2>&1 | sed -e 's/\r//g' | grep -- -Bdynamic > /dev/null; then
       gcc_cv_ld_static_dynamic=yes
   else
     case "$target" in
@@ -4238,7 +4255,7 @@ if test x"$demangler_in_ld" = xyes; then
     fi
   elif test x$gcc_cv_ld != x -a x"$gnu_ld" = xyes; then
     # Check if the GNU linker supports --demangle option
-    if $gcc_cv_ld --help 2>&1 | grep no-demangle > /dev/null; then
+    if $gcc_cv_ld --help 2>&1 | sed -e 's/\r//g' | grep no-demangle > /dev/null; then
       gcc_cv_ld_demangle=yes
     fi
   fi
@@ -4268,7 +4285,7 @@ if test -f liblto_plugin.la; then
     # Determine plugin linker version.
     # FIXME: Partial duplicate from above, generalize.
 changequote(,)dnl
-    ld_ver=`$ORIGINAL_PLUGIN_LD_FOR_TARGET --version 2>/dev/null | sed 1q`
+    ld_ver=`$ORIGINAL_PLUGIN_LD_FOR_TARGET --version 2>/dev/null | sed -e 's/\r//g' | sed 1q`
     if echo "$ld_ver" | grep GNU > /dev/null; then
       if echo "$ld_ver" | grep "GNU gold" > /dev/null; then
         ld_is_gold=yes
@@ -4501,7 +4518,7 @@ EOF
 	    AC_MSG_RESULT(no: avrxmega3 .rodata located in RAM)
 	    echo "$as_me: nm output was" >&AS_MESSAGE_LOG_FD
 	    cat conftest.nm >&AS_MESSAGE_LOG_FD
-	    avr_ld_ver="`$gcc_cv_ld -v | sed -e 's:^.* ::'`"
+	    avr_ld_ver="`$gcc_cv_ld -v | sed -e 's/\r//g' | sed -e 's:^.* ::'`"
 	    AC_MSG_WARN([[support for avrxmega3 .rodata in flash needs Binutils 2.29 or higher (have $avr_ld_ver)]])
 	fi
     else
@@ -4853,7 +4870,7 @@ foo:	nop
       as_ix86_gas_32_opt="--32"
     fi
     if echo "$ld_ver" | grep GNU > /dev/null; then
-      if $gcc_cv_ld -V 2>/dev/null | grep elf_i386_sol2 > /dev/null; then
+      if $gcc_cv_ld -V 2>/dev/null | sed -e 's/\r//g' | grep elf_i386_sol2 > /dev/null; then
         ld_ix86_gld_32_opt="-melf_i386_sol2"
       else
         ld_ix86_gld_32_opt="-melf_i386"
@@ -5987,7 +6004,7 @@ if test $in_tree_ld = yes ; then
 elif test x$gcc_cv_ld != x; then
   if echo "$ld_ver" | grep GNU > /dev/null; then
     # Check if linker supports --eh-frame-hdr option
-    if $gcc_cv_ld --help 2>&1 | grep eh-frame-hdr > /dev/null; then
+    if $gcc_cv_ld --help 2>&1 | sed -e 's/\r//g' | grep eh-frame-hdr > /dev/null; then
       gcc_cv_ld_eh_frame_hdr=yes
     fi
   else
@@ -6058,7 +6075,7 @@ if test $in_tree_ld = yes ; then
   fi
 elif test x$gcc_cv_ld != x; then
   # Check if linker supports -pie option
-  if $gcc_cv_ld --help 2>&1 | grep -- -pie > /dev/null; then
+  if $gcc_cv_ld --help 2>&1 | sed -e 's/\r//g' | grep -- -pie > /dev/null; then
     gcc_cv_ld_pie=yes
     case "$target" in
       *-*-solaris2*)
@@ -6072,7 +6089,7 @@ elif test x$gcc_cv_ld != x; then
     case "$target" in
       *-*-solaris2.1[[1-9]]*)
 	# Solaris 11.3 added PIE support.
-	if $gcc_cv_ld -z help 2>&1 | grep -- type.*pie > /dev/null; then
+	if $gcc_cv_ld -z help 2>&1 | sed -e 's/\r//g' | grep -- type.*pie > /dev/null; then
 	  gcc_cv_ld_pie=yes
 	fi
 	;;
@@ -6301,7 +6318,7 @@ changequote(,)dnl
   case "${target}" in
     *-*-solaris2*)
       # Introduced in Solaris 11.2.
-      if $gcc_cv_ld --help 2>&1 | grep -- '-z compress-sections' > /dev/null; then
+      if $gcc_cv_ld --help 2>&1 | sed -e 's/\r//g' | grep -- '-z compress-sections' > /dev/null; then
         gcc_cv_ld_compress_debug=3
         gcc_cv_ld_compress_debug_option="-z compress-sections"
       else
@@ -6358,20 +6375,20 @@ if test x"$ld64_flag" = x"yes"; then
     # If the version was not specified, try to find it.
     AC_MSG_CHECKING(linker version)
     if test x"${gcc_cv_ld64_version}" = x; then
-      gcc_cv_ld64_version=`$gcc_cv_ld -v 2>&1 | grep ld64 | sed s/.*ld64-// | awk '{print $1}'`
+      gcc_cv_ld64_version=`$gcc_cv_ld -v 2>&1 | sed -e 's/\r//g' | grep ld64 | sed s/.*ld64-// | awk '{print $1}'`
     fi
     AC_MSG_RESULT($gcc_cv_ld64_version)
 
     AC_MSG_CHECKING(linker for -export_dynamic support)
     gcc_cv_ld64_export_dynamic=1
-    if $gcc_cv_ld -export_dynamic < /dev/null 2>&1 | grep 'unknown option' > /dev/null; then
+    if $gcc_cv_ld -export_dynamic < /dev/null 2>&1 | sed -e 's/\r//g' | grep 'unknown option' > /dev/null; then
       gcc_cv_ld64_export_dynamic=0
     fi
     AC_MSG_RESULT($gcc_cv_ld64_export_dynamic)
 
     AC_MSG_CHECKING(linker for -platform_version support)
     gcc_cv_ld64_platform_version=1
-    if $gcc_cv_ld -platform_version macos 10.5 0.0 < /dev/null 2>&1 | grep 'unknown option' > /dev/null; then
+    if $gcc_cv_ld -platform_version macos 10.5 0.0 < /dev/null 2>&1 | sed -e 's/\r//g' | grep 'unknown option' > /dev/null; then
       gcc_cv_ld64_platform_version=0
     fi
     AC_MSG_RESULT($gcc_cv_ld64_platform_version)
@@ -6441,8 +6458,8 @@ case $target_os in
 	gcc_cv_ld_broken_pe_dwarf5=no
       fi
     else
-      if $gcc_cv_ld --verbose 2>&1 | grep -q '\.debug_loclists.*BLOCK.*__section_alignment__.*NOLOAD.*:' \
-	 && $gcc_cv_ld --verbose 2>&1 | grep -q '\.debug_rnglists.*BLOCK.*__section_alignment__.*NOLOAD.*:'; then
+      if $gcc_cv_ld --verbose 2>&1 | sed -e 's/\r//g' | grep -q '\.debug_loclists.*BLOCK.*__section_alignment__.*NOLOAD.*:' \
+	 && $gcc_cv_ld --verbose 2>&1 | sed -e 's/\r//g' | grep -q '\.debug_rnglists.*BLOCK.*__section_alignment__.*NOLOAD.*:'; then
 	gcc_cv_ld_broken_pe_dwarf5=no
       fi
     fi
@@ -6459,7 +6476,7 @@ case $target_os in
         gcc_cv_ld_disable_dynamicbase=yes
       fi
     else
-      if $gcc_cv_ld --help 2>&1 | grep -q 'disable\-]dynamicbase' > /dev/null; then
+      if $gcc_cv_ld --help 2>&1 | sed -e 's/\r//g' | grep -q 'disable\-]dynamicbase' > /dev/null; then
         gcc_cv_ld_disable_dynamicbase=yes
       fi
     fi
@@ -6491,10 +6508,10 @@ if test $in_tree_ld = yes ; then
   fi
 elif test x$gcc_cv_ld != x; then
   # Check if linker supports --as-needed and --no-as-needed options
-  if $gcc_cv_ld --help 2>&1 | grep as-needed > /dev/null; then
+  if $gcc_cv_ld --help 2>&1 | sed -e 's/\r//g' | grep as-needed > /dev/null; then
     gcc_cv_ld_as_needed=yes
-    if $gcc_cv_ld --help 2>&1 | grep push-state > /dev/null \
-       && $gcc_cv_ld --help 2>&1 | grep pop-state > /dev/null \
+    if $gcc_cv_ld --help 2>&1 | sed -e 's/\r//g' | grep push-state > /dev/null \
+       && $gcc_cv_ld --help 2>&1 | sed -e 's/\r//g' | grep pop-state > /dev/null \
        && echo "$ld_ver" | grep GNU > /dev/null \
        && test "$ld_vers_major" -eq 2 -a "$ld_vers_minor" -ge 28; then
       # Use these options only when both ld.bfd and ld.gold support
@@ -6755,7 +6772,7 @@ AC_CACHE_CHECK(linker --build-id support,
       gcc_cv_ld_buildid=yes
     fi
   elif test x$gcc_cv_ld != x; then
-    if $gcc_cv_ld --help 2>&1 | grep build-id > /dev/null; then
+    if $gcc_cv_ld --help 2>&1 | sed -e 's/\r//g' | grep build-id > /dev/null; then
       gcc_cv_ld_buildid=yes
     fi
   fi])
@@ -6792,7 +6809,7 @@ AC_CACHE_CHECK(linker *_sol2 emulation support,
       gcc_cv_ld_sol2_emulation=yes
     fi
   elif test x$gcc_cv_ld != x; then
-    if $gcc_cv_ld -V 2>/dev/null | sed -e '1,/Supported emulations/d;q' | \
+    if $gcc_cv_ld -V 2>/dev/null | sed -e 's/\r//g' | sed -e '1,/Supported emulations/d;q' | \
        grep _sol2 > /dev/null; then
       gcc_cv_ld_sol2_emulation=yes
     fi
@@ -6810,7 +6827,7 @@ AC_CACHE_CHECK(linker --sysroot support,
         gcc_cv_ld_sysroot=yes
       fi
   elif test x$gcc_cv_ld != x; then 
-    if $gcc_cv_ld --help 2>&1 | grep sysroot > /dev/null; then
+    if $gcc_cv_ld --help 2>&1 | sed -e 's/\r//g' | grep sysroot > /dev/null; then
       gcc_cv_ld_sysroot=yes
     fi
   fi])
@@ -7695,7 +7712,7 @@ if test x"$ld_is_gold" = xno; then
     fi
   elif test x$gcc_cv_ld != x; then
     # Check if linker supports -a bndplt option
-    if $gcc_cv_ld --help 2>&1 | grep -- '-z bndplt' > /dev/null; then
+    if $gcc_cv_ld --help 2>&1 | sed -e 's/\r//g' | grep -- '-z bndplt' > /dev/null; then
       ld_bndplt_support=yes
     fi
   fi
@@ -7716,7 +7733,7 @@ if test x"$ld_is_gold" = xno; then
     fi
   elif test x$gcc_cv_ld != x; then
     # Check if linker supports --push-state/--pop-state options
-    if $gcc_cv_ld --help 2>&1 | grep -- '--push-state' > /dev/null; then
+    if $gcc_cv_ld --help 2>&1 | sed -e 's/\r//g' | grep -- '--push-state' > /dev/null; then
       ld_pushpopstate_support=yes
     fi
   fi
@@ -7798,6 +7815,12 @@ esac
 # Configure the subdirectories
 # AC_CONFIG_SUBDIRS($subdirs)
 
+${LN_S} $srcdir/wineFindStrWorkarround.exe wineFindStrWorkarround.exe
+wine_find_str_workarround="wineFindStrWorkarround.exe"
+AC_SUBST_FILE(wine_find_str_workarround)
+
+AC_CONFIG_FILES(exec-tool.c:exec-tool.c.in)
+
 # Create the Makefile
 # and configure language subdirectories
 AC_CONFIG_FILES($all_outputs)
diff --git a/gcc/gcc/diagnostic-color.cc b/gcc/gcc/diagnostic-color.cc
index 640adfad55..968c0e7a88 100644
--- a/gcc/gcc/diagnostic-color.cc
+++ b/gcc/gcc/diagnostic-color.cc
@@ -22,6 +22,7 @@
 #include "diagnostic-url.h"
 
 #ifdef __MINGW32__
+#  define WIN32_LEAN_AND_MEAN
 #  include <windows.h>
 #endif
 
diff --git a/gcc/gcc/exec-tool.in b/gcc/gcc/exec-tool.in
index cf7222745f..6e318e53ff 100644
--- a/gcc/gcc/exec-tool.in
+++ b/gcc/gcc/exec-tool.in
@@ -81,6 +81,14 @@ case "$invoked" in
     ;;
 esac
 
+args=()
+for i in "${1+"$@"}"; do
+	if echo "$i" | grep -q "^[/\\A-Za-z]:"; then
+		args+=("`winepath --unix \"$i\"`")
+	else
+		args+=("$i")
+	fi
+done
 case "$original" in
   ../*)
     # compute absolute path of the location of this script
@@ -88,29 +96,29 @@ case "$original" in
     scriptdir=`cd "$tdir" && pwd`
 
     if test -x $scriptdir/../$dir/$prog; then
-      test "$fast_install" = yes || exec $scriptdir/../$dir/$prog ${1+"$@"}
+      test "$fast_install" = yes || exec $scriptdir/../$dir/$prog ${args[$@]}
 
       # if libtool did everything it needs to do, there's a fast path
       lt_prog=$scriptdir/../$dir/$objdir/lt-$prog 
-      test -x $lt_prog && exec $lt_prog ${1+"$@"}
+      test -x $lt_prog && exec $lt_prog ${args[$@]}
 
       # libtool has not relinked ld-new yet, but we cannot just use the
       # previous stage (because then the relinking would just never happen!).
       # So we take extra care to use prev-ld/ld-new *on recursive calls*.
       eval LT_RCU="\${LT_RCU_$id}"
-      test x"$LT_RCU" = x"1" && exec $scriptdir/../prev-$dir/$prog ${1+"$@"}
+      test x"$LT_RCU" = x"1" && exec $scriptdir/../prev-$dir/$prog ${args[$@]}
 
       eval LT_RCU_$id=1
       export LT_RCU_$id
-      $scriptdir/../$dir/$prog ${1+"$@"}
+      $scriptdir/../$dir/$prog ${args[$@]}
       result=$?
       exit $result
 
     else
-      exec $scriptdir/../prev-$dir/$prog ${1+"$@"}
+      exec $scriptdir/../prev-$dir/$prog ${args[$@]}
     fi
     ;;
   *)
-    exec $original ${1+"$@"}
+    exec $original ${args[$@]}
     ;;
 esac
diff --git a/gcc/gcc/testsuite/ChangeLog-2021 b/gcc/gcc/testsuite/ChangeLog-2021
index 21b88412ab..7e7e3c2555 100644
--- a/gcc/gcc/testsuite/ChangeLog-2021
+++ b/gcc/gcc/testsuite/ChangeLog-2021
@@ -20525,7 +20525,7 @@
 
 2021-01-04  Martin Liska  <mliska@suse.cz>
 
-	* gcc.target/avr/avr.exp: Run dos2unix on the file.
+	* gcc.target/avr/avr.exp: Run dos2unix -q on the file.
 
 2021-01-04  Richard Biener  <rguenther@suse.de>
 
diff --git a/gcc/gnattools/configure b/gcc/gnattools/configure
index c2d755b723..189f850894 100755
--- a/gcc/gnattools/configure
+++ b/gcc/gnattools/configure
@@ -1385,9 +1385,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2442,9 +2443,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -2495,7 +2497,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -2565,7 +2567,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -2621,7 +2623,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -2678,7 +2680,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
diff --git a/gcc/gotools/Makefile.in b/gcc/gotools/Makefile.in
index 2783b91ef4..963e50b675 100644
--- a/gcc/gotools/Makefile.in
+++ b/gcc/gotools/Makefile.in
@@ -331,7 +331,7 @@ top_build_prefix = @top_build_prefix@
 top_builddir = @top_builddir@
 top_srcdir = @top_srcdir@
 ACLOCAL_AMFLAGS = -I ../config
-gcc_version := $(shell $(GCC_FOR_TARGET) -dumpversion)
+gcc_version := $(shell ($(GCC_FOR_TARGET) -dumpversion | sed -e 's/\r//g'))
 libexecsubdir = $(libexecdir)/gcc/$(target_noncanonical)/$(gcc_version)
 mkinstalldirs = $(SHELL) $(toplevel_srcdir)/mkinstalldirs
 PWD_COMMAND = $${PWDCMD-pwd}
@@ -1022,7 +1022,7 @@ mostlyclean-local:
 @NATIVE_TRUE@	if test "$${untested}" -ne "0"; then \
 @NATIVE_TRUE@	  echo "# of untested testcases		$${untested}" >> gotools.sum; \
 @NATIVE_TRUE@	fi
-@NATIVE_TRUE@	@echo `echo $(GOC_FOR_TARGET) | sed -e 's/ .*//'`  `$(GOC_FOR_TARGET) -v 2>&1 | grep " version" | sed -n -e 's/.* \(version.*$$\)/\1/p'` >> gotools.sum
+@NATIVE_TRUE@	@echo `echo $(GOC_FOR_TARGET) | sed -e 's/ .*//'`  `$(GOC_FOR_TARGET) -v 2>&1 | sed -e 's/\r//g' | grep " version" | sed -n -e 's/.* \(version.*$$\)/\1/p'` >> gotools.sum
 @NATIVE_TRUE@	@echo >> gotools.log
 @NATIVE_TRUE@	@echo "runtest completed at `date`" >> gotools.log
 @NATIVE_TRUE@	@if grep '^FAIL' gotools.sum >/dev/null 2>&1; then exit 1; fi
diff --git a/gcc/gotools/configure b/gcc/gotools/configure
index ff71d2ae88..8b88c952dd 100755
--- a/gcc/gotools/configure
+++ b/gcc/gotools/configure
@@ -1444,9 +1444,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1482,9 +1483,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -3017,9 +3019,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -3070,7 +3073,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3140,7 +3143,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3196,7 +3199,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -3253,7 +3256,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3642,7 +3645,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -3700,6 +3703,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -3947,9 +3955,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler --version >&5") 2>conftest.err
+  (eval "($ac_compiler --version | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
diff --git a/gcc/intl/configure b/gcc/intl/configure
index 03f40487a9..c7940a4ac9 100755
--- a/gcc/intl/configure
+++ b/gcc/intl/configure
@@ -1473,9 +1473,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1510,9 +1511,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1635,7 +1637,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -1708,9 +1710,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2533,9 +2536,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -2586,7 +2590,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -2656,7 +2660,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -2712,7 +2716,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -2769,7 +2773,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3310,7 +3314,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -3327,7 +3331,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -4408,7 +4412,7 @@ wenotbecray
 #endif
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "webecray" >/dev/null 2>&1; then :
   ac_cv_os_cray=yes
 else
@@ -4700,7 +4704,7 @@ else
 #endif
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "Lucky GNU user" >/dev/null 2>&1; then :
   ac_cv_gnu_library_2_1=yes
 else
@@ -5047,9 +5051,9 @@ $as_echo_n "checking for ld used by GCC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -5090,7 +5094,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some GNU ld's only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      if "$acl_cv_path_LD" -v 2>&1 < /dev/null | egrep '(GNU|with BFD)' > /dev/null; then
+      if "$acl_cv_path_LD" -v 2>&1 < /dev/null | sed -e 's/\r//g' | egrep '(GNU|with BFD)' > /dev/null; then
 	test "$with_gnu_ld" != no && break
       else
 	test "$with_gnu_ld" != yes && break
@@ -5118,7 +5122,7 @@ if ${acl_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU ld's only accept -v.
-if $LD -v 2>&1 </dev/null | egrep '(GNU|with BFD)' 1>&5; then
+if $LD -v 2>&1 </dev/null | sed -e 's/\r//g' | egrep '(GNU|with BFD)' 1>&5; then
   acl_cv_prog_gnu_ld=yes
 else
   acl_cv_prog_gnu_ld=no
diff --git a/gcc/libada/configure b/gcc/libada/configure
index 162d9731f2..e77a07cb9f 100755
--- a/gcc/libada/configure
+++ b/gcc/libada/configure
@@ -1451,9 +1451,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1488,9 +1489,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1613,7 +1615,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -2333,7 +2335,7 @@ case ${enable_version_specific_runtime_libs} in
       toolexecdir='$(libdir)/gcc-lib/$(target_alias)'
       toolexeclibdir='$(libdir)'
     fi
-    multi_os_directory=`$CC -print-multi-os-directory`
+    multi_os_directory=`$CC -print-multi-os-directory | sed -e 's/\r//g'`
     case $multi_os_directory in
       .) ;; # Avoid trailing /.
       *) toolexeclibdir=$toolexeclibdir/$multi_os_directory ;;
@@ -2666,9 +2668,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -2719,7 +2722,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -2789,7 +2792,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -2845,7 +2848,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -2902,7 +2905,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3662,7 +3665,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -3679,7 +3682,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
diff --git a/gcc/libada/configure.ac b/gcc/libada/configure.ac
index 160d68c99a..6f21aefdbf 100644
--- a/gcc/libada/configure.ac
+++ b/gcc/libada/configure.ac
@@ -98,7 +98,7 @@ case ${enable_version_specific_runtime_libs} in
       toolexecdir='$(libdir)/gcc-lib/$(target_alias)'
       toolexeclibdir='$(libdir)'
     fi
-    multi_os_directory=`$CC -print-multi-os-directory`
+    multi_os_directory=`$CC -print-multi-os-directory | sed -e 's/\r//g'`
     case $multi_os_directory in
       .) ;; # Avoid trailing /.
       *) toolexeclibdir=$toolexeclibdir/$multi_os_directory ;;
diff --git a/gcc/libatomic/acinclude.m4 b/gcc/libatomic/acinclude.m4
index f35ab5b60a..58e7159758 100644
--- a/gcc/libatomic/acinclude.m4
+++ b/gcc/libatomic/acinclude.m4
@@ -333,13 +333,13 @@ AC_DEFUN([LIBAT_CHECK_LINKER_FEATURES], [
   # does some of this, but throws away the result.
   libat_ld_is_gold=no
   libat_ld_is_mold=no
-  if $LD --version 2>/dev/null | grep 'GNU gold'> /dev/null 2>&1; then
+  if $LD --version 2>/dev/null | sed -e 's/\r//g' | grep 'GNU gold'> /dev/null 2>&1; then
     libat_ld_is_gold=yes
-  elif $LD --version 2>/dev/null | grep 'mold' >/dev/null 2>&1; then
+  elif $LD --version 2>/dev/null | sed -e 's/\r//g' | grep 'mold' >/dev/null 2>&1; then
     libat_ld_is_mold=yes
   fi
   changequote(,)
-  ldver=`$LD --version 2>/dev/null |
+  ldver=`$LD --version 2>/dev/null | sed -e 's/\r//g' |
          sed -e 's/[. ][0-9]\{8\}$//;s/.* \([^ ]\{1,\}\)$/\1/; q'`
   changequote([,])
   libat_gnu_ld_version=`echo $ldver | \
diff --git a/gcc/libatomic/configure b/gcc/libatomic/configure
index 92853dd8a4..26204e27cc 100755
--- a/gcc/libatomic/configure
+++ b/gcc/libatomic/configure
@@ -1580,9 +1580,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1618,9 +1619,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1694,9 +1696,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1732,7 +1735,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -3393,7 +3396,7 @@ case ${enable_version_specific_runtime_libs} in
       toolexecdir='$(libdir)/gcc-lib/$(target_alias)'
       toolexeclibdir='$(libdir)'
     fi
-    multi_os_directory=`$CC -print-multi-os-directory`
+    multi_os_directory=`$CC -print-multi-os-directory | sed -e 's/\r//g'`
     case $multi_os_directory in
       .) ;; # Avoid trailing /.
       *) toolexeclibdir=$toolexeclibdir/$multi_os_directory ;;
@@ -3726,9 +3729,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -3779,7 +3783,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3849,7 +3853,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3905,7 +3909,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -3962,7 +3966,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4351,7 +4355,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -4409,6 +4413,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -4486,7 +4495,7 @@ else
 
   am_cv_CCAS_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
 
@@ -4542,6 +4551,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -5321,9 +5335,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -5365,7 +5379,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -5396,7 +5410,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -5604,10 +5618,12 @@ else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
   (eval echo "\"\$as_me:$LINENO: $ac_compile\"" >&5)
-  (eval "$ac_compile" 2>conftest.err)
+  (eval "($ac_compile | sed -e 's/\r//g')" 2>conftest.err)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: output\"" >&5)
   cat conftest.out >&5
@@ -6028,7 +6044,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -6090,7 +6106,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu | uclinuxfdpiceabi)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|_pic\.a)$'
@@ -6108,7 +6124,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
@@ -6609,7 +6625,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[ABCDGIRSTW]' ;;
 esac
@@ -6617,11 +6633,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -6655,7 +6671,7 @@ for ac_symprfx in "" "_"; do
 "     s[1]~prfx {split(s[1],t,\"@\"); print t[1], substr(t[1],length(prfx))}"\
 "     ' prfx=^$ac_symprfx"
   else
-    lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
+    lt_cv_sys_global_symbol_pipe="sed -n -e 's/\r//g' -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
   fi
 
   # Check to see that the pipe works correctly.
@@ -6676,14 +6692,14 @@ int main(){nm_test_var='a';nm_test_func();return(0);}
 _LT_EOF
 
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist\""; } >&5
-  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) 2>&5
+    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist\""; } >&5
+  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s "$nlist"; then
@@ -6704,7 +6720,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | sed -e '"'"'s/\r//g'"'"' | $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -6717,7 +6733,7 @@ lt__PROGRAM__LTX_preloaded_symbols[] =
 {
   { "@PROGRAM@", (void *) 0 },
 _LT_EOF
-	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | $GREP -v main >> conftest.$ac_ext
+	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | sed -e 's/\r//g' | $GREP -v main >> conftest.$ac_ext
 	  cat <<\_LT_EOF >> conftest.$ac_ext
   {0, (void *) 0}
 };
@@ -6740,7 +6756,7 @@ _LT_EOF
 	  LIBS="conftstm.$ac_objext"
 	  CFLAGS="$CFLAGS$lt_prog_compiler_no_builtin_flag"
 	  if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext}; then
@@ -6820,7 +6836,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6839,7 +6855,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo '#line '$LINENO' "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6877,7 +6893,7 @@ s390*-*linux*|s390*-*tpf*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6989,7 +7005,7 @@ sparc*-*solaris*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7522,6 +7538,7 @@ else
 	if test -f libconftest.dylib && test ! -s conftest.err && test $_lt_result = 0; then
 	  lt_cv_apple_cc_single_mod=yes
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err >&5
 	fi
 	rm -rf libconftest.dylib*
@@ -7584,6 +7601,7 @@ _LT_EOF
       if test -f conftest && test ! -s conftest.err && test $_lt_result = 0 && $GREP forced_load conftest 2>&1 >/dev/null; then
 	lt_cv_ld_force_load=yes
       else
+        dos2unix -q conftest.err
 	cat conftest.err >&5
       fi
         rm -f conftest.err libconftest.a conftest conftest.c
@@ -7801,7 +7819,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -7818,7 +7836,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -8344,13 +8362,15 @@ compiler_DEFAULT=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -8390,14 +8410,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -8612,7 +8634,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic='-KPIC'
@@ -8743,14 +8765,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works=yes
@@ -8792,10 +8816,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -8848,8 +8873,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8857,6 +8883,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8903,8 +8930,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8912,6 +8940,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8972,7 +9001,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object=no
   enable_shared_with_static_runtimes=no
   export_dynamic_flag_spec=
-  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic=no
   hardcode_direct=no
   hardcode_direct_absolute=no
@@ -9035,7 +9064,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -9061,13 +9090,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -9111,7 +9140,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -9129,9 +9158,9 @@ _LT_EOF
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -9174,7 +9203,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -9205,7 +9234,7 @@ _LT_EOF
 	  compiler_needs_object=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object=yes
@@ -9243,7 +9272,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -9253,7 +9282,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
 
@@ -9265,7 +9294,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9274,7 +9303,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
@@ -9293,7 +9322,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
 	    archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -9312,7 +9341,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9356,10 +9385,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -9706,10 +9735,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS -b"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -9790,7 +9820,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -9816,7 +9846,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct=yes
 	hardcode_shlibpath_var=no
 	hardcode_direct_absolute=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
@@ -9885,7 +9915,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -10078,10 +10108,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -10107,6 +10138,7 @@ else
 	  fi
 	  allow_undefined_flag=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -10289,7 +10321,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([A-Za-z]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -10393,7 +10425,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -10761,7 +10793,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -10806,7 +10838,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -11452,7 +11484,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -11558,7 +11590,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -11780,7 +11812,7 @@ libtool_VERSION=3:0:2
 # Check for used threading-model
 { $as_echo "$as_me:${as_lineno-$LINENO}: checking for thread model used by GCC" >&5
 $as_echo_n "checking for thread model used by GCC... " >&6; }
-target_thread_file=`$CC -v 2>&1 | sed -n 's/^Thread model: //p'`
+target_thread_file=`$CC -v 2>&1 | sed -e 's/\r//g' | sed -n 's/^Thread model: //p'`
 { $as_echo "$as_me:${as_lineno-$LINENO}: result: $target_thread_file" >&5
 $as_echo "$target_thread_file" >&6; }
 
@@ -11898,7 +11930,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -11915,7 +11947,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -12619,7 +12651,7 @@ typedef int T __attribute__((mode(QI)));
 _ACEOF
     if test x$atomic_builtins_link_tests = xyes; then
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -12632,7 +12664,7 @@ _ACEOF
       # Compile unoptimized.
       CFLAGS="$CFLAGS -O0 -S"
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -12687,7 +12719,7 @@ typedef int T __attribute__((mode(HI)));
 _ACEOF
     if test x$atomic_builtins_link_tests = xyes; then
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -12700,7 +12732,7 @@ _ACEOF
       # Compile unoptimized.
       CFLAGS="$CFLAGS -O0 -S"
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -12755,7 +12787,7 @@ typedef int T __attribute__((mode(SI)));
 _ACEOF
     if test x$atomic_builtins_link_tests = xyes; then
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -12768,7 +12800,7 @@ _ACEOF
       # Compile unoptimized.
       CFLAGS="$CFLAGS -O0 -S"
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -12823,7 +12855,7 @@ typedef int T __attribute__((mode(DI)));
 _ACEOF
     if test x$atomic_builtins_link_tests = xyes; then
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -12836,7 +12868,7 @@ _ACEOF
       # Compile unoptimized.
       CFLAGS="$CFLAGS -O0 -S"
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -12891,7 +12923,7 @@ typedef int T __attribute__((mode(TI)));
 _ACEOF
     if test x$atomic_builtins_link_tests = xyes; then
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -12904,7 +12936,7 @@ _ACEOF
       # Compile unoptimized.
       CFLAGS="$CFLAGS -O0 -S"
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -12958,7 +12990,7 @@ typedef int T __attribute__((mode(QI))); T *x; asm("" : "=g"(x));
 _ACEOF
     if test x$atomic_builtins_link_tests = xyes; then
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -12971,7 +13003,7 @@ _ACEOF
       # Compile unoptimized.
       CFLAGS="$CFLAGS -O0 -S"
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -13023,7 +13055,7 @@ typedef int T __attribute__((mode(HI))); T *x; asm("" : "=g"(x));
 _ACEOF
     if test x$atomic_builtins_link_tests = xyes; then
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -13036,7 +13068,7 @@ _ACEOF
       # Compile unoptimized.
       CFLAGS="$CFLAGS -O0 -S"
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -13088,7 +13120,7 @@ typedef int T __attribute__((mode(SI))); T *x; asm("" : "=g"(x));
 _ACEOF
     if test x$atomic_builtins_link_tests = xyes; then
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -13101,7 +13133,7 @@ _ACEOF
       # Compile unoptimized.
       CFLAGS="$CFLAGS -O0 -S"
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -13153,7 +13185,7 @@ typedef int T __attribute__((mode(DI))); T *x; asm("" : "=g"(x));
 _ACEOF
     if test x$atomic_builtins_link_tests = xyes; then
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -13166,7 +13198,7 @@ _ACEOF
       # Compile unoptimized.
       CFLAGS="$CFLAGS -O0 -S"
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -13218,7 +13250,7 @@ typedef int T __attribute__((mode(TI))); T *x; asm("" : "=g"(x));
 _ACEOF
     if test x$atomic_builtins_link_tests = xyes; then
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -13231,7 +13263,7 @@ _ACEOF
       # Compile unoptimized.
       CFLAGS="$CFLAGS -O0 -S"
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -13284,7 +13316,7 @@ typedef int T __attribute__((mode(QI))); T *x; asm("" : "=g"(x));
 _ACEOF
     if test x$atomic_builtins_link_tests = xyes; then
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -13297,7 +13329,7 @@ _ACEOF
       # Compile unoptimized.
       CFLAGS="$CFLAGS -O0 -S"
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -13349,7 +13381,7 @@ typedef int T __attribute__((mode(HI))); T *x; asm("" : "=g"(x));
 _ACEOF
     if test x$atomic_builtins_link_tests = xyes; then
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -13362,7 +13394,7 @@ _ACEOF
       # Compile unoptimized.
       CFLAGS="$CFLAGS -O0 -S"
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -13414,7 +13446,7 @@ typedef int T __attribute__((mode(SI))); T *x; asm("" : "=g"(x));
 _ACEOF
     if test x$atomic_builtins_link_tests = xyes; then
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -13427,7 +13459,7 @@ _ACEOF
       # Compile unoptimized.
       CFLAGS="$CFLAGS -O0 -S"
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -13479,7 +13511,7 @@ typedef int T __attribute__((mode(DI))); T *x; asm("" : "=g"(x));
 _ACEOF
     if test x$atomic_builtins_link_tests = xyes; then
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -13492,7 +13524,7 @@ _ACEOF
       # Compile unoptimized.
       CFLAGS="$CFLAGS -O0 -S"
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -13544,7 +13576,7 @@ typedef int T __attribute__((mode(TI))); T *x; asm("" : "=g"(x));
 _ACEOF
     if test x$atomic_builtins_link_tests = xyes; then
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -13557,7 +13589,7 @@ _ACEOF
       # Compile unoptimized.
       CFLAGS="$CFLAGS -O0 -S"
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -13611,7 +13643,7 @@ typedef int T __attribute__((mode(QI))); T *x, *y;
 _ACEOF
     if test x$atomic_builtins_link_tests = xyes; then
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -13624,7 +13656,7 @@ _ACEOF
       # Compile unoptimized.
       CFLAGS="$CFLAGS -O0 -S"
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -13677,7 +13709,7 @@ typedef int T __attribute__((mode(HI))); T *x, *y;
 _ACEOF
     if test x$atomic_builtins_link_tests = xyes; then
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -13690,7 +13722,7 @@ _ACEOF
       # Compile unoptimized.
       CFLAGS="$CFLAGS -O0 -S"
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -13743,7 +13775,7 @@ typedef int T __attribute__((mode(SI))); T *x, *y;
 _ACEOF
     if test x$atomic_builtins_link_tests = xyes; then
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -13756,7 +13788,7 @@ _ACEOF
       # Compile unoptimized.
       CFLAGS="$CFLAGS -O0 -S"
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -13809,7 +13841,7 @@ typedef int T __attribute__((mode(DI))); T *x, *y;
 _ACEOF
     if test x$atomic_builtins_link_tests = xyes; then
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -13822,7 +13854,7 @@ _ACEOF
       # Compile unoptimized.
       CFLAGS="$CFLAGS -O0 -S"
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -13875,7 +13907,7 @@ typedef int T __attribute__((mode(TI))); T *x, *y;
 _ACEOF
     if test x$atomic_builtins_link_tests = xyes; then
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -13888,7 +13920,7 @@ _ACEOF
       # Compile unoptimized.
       CFLAGS="$CFLAGS -O0 -S"
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -13943,7 +13975,7 @@ typedef int T __attribute__((mode(QI))); T *x, y;
 _ACEOF
     if test x$atomic_builtins_link_tests = xyes; then
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -13956,7 +13988,7 @@ _ACEOF
       # Compile unoptimized.
       CFLAGS="$CFLAGS -O0 -S"
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -14010,7 +14042,7 @@ typedef int T __attribute__((mode(HI))); T *x, y;
 _ACEOF
     if test x$atomic_builtins_link_tests = xyes; then
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -14023,7 +14055,7 @@ _ACEOF
       # Compile unoptimized.
       CFLAGS="$CFLAGS -O0 -S"
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -14077,7 +14109,7 @@ typedef int T __attribute__((mode(SI))); T *x, y;
 _ACEOF
     if test x$atomic_builtins_link_tests = xyes; then
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -14090,7 +14122,7 @@ _ACEOF
       # Compile unoptimized.
       CFLAGS="$CFLAGS -O0 -S"
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -14144,7 +14176,7 @@ typedef int T __attribute__((mode(DI))); T *x, y;
 _ACEOF
     if test x$atomic_builtins_link_tests = xyes; then
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -14157,7 +14189,7 @@ _ACEOF
       # Compile unoptimized.
       CFLAGS="$CFLAGS -O0 -S"
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -14211,7 +14243,7 @@ typedef int T __attribute__((mode(TI))); T *x, y;
 _ACEOF
     if test x$atomic_builtins_link_tests = xyes; then
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -14224,7 +14256,7 @@ _ACEOF
       # Compile unoptimized.
       CFLAGS="$CFLAGS -O0 -S"
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -14283,7 +14315,7 @@ typedef int T __attribute__((mode(QI))); T *x, y;
 _ACEOF
     if test x$atomic_builtins_link_tests = xyes; then
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -14296,7 +14328,7 @@ _ACEOF
       # Compile unoptimized.
       CFLAGS="$CFLAGS -O0 -S"
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -14354,7 +14386,7 @@ typedef int T __attribute__((mode(HI))); T *x, y;
 _ACEOF
     if test x$atomic_builtins_link_tests = xyes; then
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -14367,7 +14399,7 @@ _ACEOF
       # Compile unoptimized.
       CFLAGS="$CFLAGS -O0 -S"
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -14425,7 +14457,7 @@ typedef int T __attribute__((mode(SI))); T *x, y;
 _ACEOF
     if test x$atomic_builtins_link_tests = xyes; then
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -14438,7 +14470,7 @@ _ACEOF
       # Compile unoptimized.
       CFLAGS="$CFLAGS -O0 -S"
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -14496,7 +14528,7 @@ typedef int T __attribute__((mode(DI))); T *x, y;
 _ACEOF
     if test x$atomic_builtins_link_tests = xyes; then
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -14509,7 +14541,7 @@ _ACEOF
       # Compile unoptimized.
       CFLAGS="$CFLAGS -O0 -S"
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -14567,7 +14599,7 @@ typedef int T __attribute__((mode(TI))); T *x, y;
 _ACEOF
     if test x$atomic_builtins_link_tests = xyes; then
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -14580,7 +14612,7 @@ _ACEOF
       # Compile unoptimized.
       CFLAGS="$CFLAGS -O0 -S"
       if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -15079,9 +15111,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -15123,7 +15155,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -15154,7 +15186,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -15200,13 +15232,13 @@ with_gnu_ld=$lt_cv_prog_gnu_ld
   # does some of this, but throws away the result.
   libat_ld_is_gold=no
   libat_ld_is_mold=no
-  if $LD --version 2>/dev/null | grep 'GNU gold'> /dev/null 2>&1; then
+  if $LD --version 2>/dev/null | sed -e 's/\r//g' | grep 'GNU gold'> /dev/null 2>&1; then
     libat_ld_is_gold=yes
-  elif $LD --version 2>/dev/null | grep 'mold' >/dev/null 2>&1; then
+  elif $LD --version 2>/dev/null | sed -e 's/\r//g' | grep 'mold' >/dev/null 2>&1; then
     libat_ld_is_mold=yes
   fi
 
-  ldver=`$LD --version 2>/dev/null |
+  ldver=`$LD --version 2>/dev/null | sed -e 's/\r//g' |
          sed -e 's/[. ][0-9]\{8\}$//;s/.* \([^ ]\{1,\}\)$/\1/; q'`
 
   libat_gnu_ld_version=`echo $ldver | \
@@ -15366,6 +15398,7 @@ EOF
     libat_libgcc_s_suffix=`${CC-cc} $CFLAGS $CPPFLAGS $LDFLAGS \
 			     -shared -shared-libgcc -o conftest.so \
 			     conftest.c -v 2>&1 >/dev/null \
+			     | sed -e 's/\r//g' \
 			     | sed -n 's/^.* -lgcc_s\([^ ]*\) .*$/\1/p'`
     rm -f conftest.c conftest.so
     if test x${libat_libgcc_s_suffix+set} = xset; then
@@ -18164,7 +18197,7 @@ _LT_EOF
  ;;
     "gstdint.h":C)
 if test "$GCC" = yes; then
-  echo "/* generated for " `$CC --version | sed 1q` "*/" > tmp-stdint.h
+  echo "/* generated for " `$CC --version | sed -e 's/\r//g' | sed 1q` "*/" > tmp-stdint.h
 else
   echo "/* generated for $CC */" > tmp-stdint.h
 fi
diff --git a/gcc/libatomic/configure.ac b/gcc/libatomic/configure.ac
index 5563551aaa..76030d19fc 100644
--- a/gcc/libatomic/configure.ac
+++ b/gcc/libatomic/configure.ac
@@ -113,7 +113,7 @@ case ${enable_version_specific_runtime_libs} in
       toolexecdir='$(libdir)/gcc-lib/$(target_alias)'
       toolexeclibdir='$(libdir)'
     fi
-    multi_os_directory=`$CC -print-multi-os-directory`
+    multi_os_directory=`$CC -print-multi-os-directory | sed -e 's/\r//g'`
     case $multi_os_directory in
       .) ;; # Avoid trailing /.
       *) toolexeclibdir=$toolexeclibdir/$multi_os_directory ;;
@@ -162,7 +162,7 @@ AC_SUBST(libtool_VERSION)
 
 # Check for used threading-model
 AC_MSG_CHECKING([for thread model used by GCC])
-target_thread_file=`$CC -v 2>&1 | sed -n 's/^Thread model: //p'`
+target_thread_file=`$CC -v 2>&1 | sed -e 's/\r//g' | sed -n 's/^Thread model: //p'`
 AC_MSG_RESULT([$target_thread_file])
 
 case "$target" in
diff --git a/gcc/libbacktrace/Makefile.am b/gcc/libbacktrace/Makefile.am
index bf507b7391..a5e34e63ff 100644
--- a/gcc/libbacktrace/Makefile.am
+++ b/gcc/libbacktrace/Makefile.am
@@ -497,8 +497,8 @@ if HAVE_MINIDEBUG
 TESTS += mtest_minidebug
 
 %_minidebug: %
-	$(NM) -D $< -P --defined-only | $(AWK) '{ print $$1 }' | sort > $<.dsyms
-	$(NM) $< -P --defined-only | $(AWK) '{ if ($$2 == "T" || $$2 == "t" || $$2 == "D") print $$1 }' | sort > $<.fsyms
+	$(NM) -D $< -P --defined-only | sed -e 's/\r//g' | $(AWK) '{ print $$1 }' | sort > $<.dsyms
+	$(NM) $< -P --defined-only | sed -e 's/\r//g' | $(AWK) '{ if ($$2 == "T" || $$2 == "t" || $$2 == "D") print $$1 }' | sort > $<.fsyms
 	$(COMM) -13 $<.dsyms $<.fsyms > $<.keepsyms
 	$(OBJCOPY) --only-keep-debug $< $<.dbg
 	$(OBJCOPY) -S --remove-section .gdb_index --remove-section .comment --keep-symbols=$<.keepsyms $<.dbg $<.mdbg
diff --git a/gcc/libbacktrace/Makefile.in b/gcc/libbacktrace/Makefile.in
index 08cdd21fb4..b6798bff2d 100644
--- a/gcc/libbacktrace/Makefile.in
+++ b/gcc/libbacktrace/Makefile.in
@@ -2458,8 +2458,8 @@ uninstall-am:
 @NATIVE_TRUE@	$(OBJCOPY) --strip-debug $< $@
 
 @HAVE_MINIDEBUG_TRUE@@NATIVE_TRUE@%_minidebug: %
-@HAVE_MINIDEBUG_TRUE@@NATIVE_TRUE@	$(NM) -D $< -P --defined-only | $(AWK) '{ print $$1 }' | sort > $<.dsyms
-@HAVE_MINIDEBUG_TRUE@@NATIVE_TRUE@	$(NM) $< -P --defined-only | $(AWK) '{ if ($$2 == "T" || $$2 == "t" || $$2 == "D") print $$1 }' | sort > $<.fsyms
+@HAVE_MINIDEBUG_TRUE@@NATIVE_TRUE@	$(NM) -D $< -P --defined-only | sed -e 's/\r//g' | $(AWK) '{ print $$1 }' | sort > $<.dsyms
+@HAVE_MINIDEBUG_TRUE@@NATIVE_TRUE@	$(NM) $< -P --defined-only | sed -e 's/\r//g' | $(AWK) '{ if ($$2 == "T" || $$2 == "t" || $$2 == "D") print $$1 }' | sort > $<.fsyms
 @HAVE_MINIDEBUG_TRUE@@NATIVE_TRUE@	$(COMM) -13 $<.dsyms $<.fsyms > $<.keepsyms
 @HAVE_MINIDEBUG_TRUE@@NATIVE_TRUE@	$(OBJCOPY) --only-keep-debug $< $<.dbg
 @HAVE_MINIDEBUG_TRUE@@NATIVE_TRUE@	$(OBJCOPY) -S --remove-section .gdb_index --remove-section .comment --keep-symbols=$<.keepsyms $<.dbg $<.mdbg
diff --git a/gcc/libbacktrace/configure b/gcc/libbacktrace/configure
index 17f470a4be..3de6867a79 100755
--- a/gcc/libbacktrace/configure
+++ b/gcc/libbacktrace/configure
@@ -1569,9 +1569,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1606,9 +1607,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1731,7 +1733,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -1804,9 +1806,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -3044,9 +3047,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -3097,7 +3101,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3167,7 +3171,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3223,7 +3227,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -3280,7 +3284,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3880,7 +3884,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -3897,7 +3901,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -4968,9 +4972,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -5718,9 +5723,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -5762,7 +5767,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -5793,7 +5798,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -6001,10 +6006,12 @@ else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
   (eval echo "\"\$as_me:$LINENO: $ac_compile\"" >&5)
-  (eval "$ac_compile" 2>conftest.err)
+  (eval "($ac_compile | sed -e 's/\r//g')" 2>conftest.err)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: output\"" >&5)
   cat conftest.out >&5
@@ -6425,7 +6432,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -6487,7 +6494,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu | uclinuxfdpiceabi)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|_pic\.a)$'
@@ -6505,7 +6512,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
@@ -7006,7 +7013,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[ABCDGIRSTW]' ;;
 esac
@@ -7014,11 +7021,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -7052,7 +7059,7 @@ for ac_symprfx in "" "_"; do
 "     s[1]~prfx {split(s[1],t,\"@\"); print t[1], substr(t[1],length(prfx))}"\
 "     ' prfx=^$ac_symprfx"
   else
-    lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
+    lt_cv_sys_global_symbol_pipe="sed -n -e 's/\r//g' -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
   fi
 
   # Check to see that the pipe works correctly.
@@ -7073,14 +7080,14 @@ int main(){nm_test_var='a';nm_test_func();return(0);}
 _LT_EOF
 
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist\""; } >&5
-  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) 2>&5
+    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist\""; } >&5
+  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s "$nlist"; then
@@ -7101,7 +7108,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | sed -e '"'"'s/\r//g'"'"' | $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -7114,7 +7121,7 @@ lt__PROGRAM__LTX_preloaded_symbols[] =
 {
   { "@PROGRAM@", (void *) 0 },
 _LT_EOF
-	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | $GREP -v main >> conftest.$ac_ext
+	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | sed -e 's/\r//g' | $GREP -v main >> conftest.$ac_ext
 	  cat <<\_LT_EOF >> conftest.$ac_ext
   {0, (void *) 0}
 };
@@ -7137,7 +7144,7 @@ _LT_EOF
 	  LIBS="conftstm.$ac_objext"
 	  CFLAGS="$CFLAGS$lt_prog_compiler_no_builtin_flag"
 	  if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext}; then
@@ -7216,7 +7223,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7235,7 +7242,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo '#line '$LINENO' "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7273,7 +7280,7 @@ s390*-*linux*|s390*-*tpf*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7385,7 +7392,7 @@ sparc*-*solaris*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7918,6 +7925,7 @@ else
 	if test -f libconftest.dylib && test ! -s conftest.err && test $_lt_result = 0; then
 	  lt_cv_apple_cc_single_mod=yes
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err >&5
 	fi
 	rm -rf libconftest.dylib*
@@ -7980,6 +7988,7 @@ _LT_EOF
       if test -f conftest && test ! -s conftest.err && test $_lt_result = 0 && $GREP forced_load conftest 2>&1 >/dev/null; then
 	lt_cv_ld_force_load=yes
       else
+        dos2unix -q conftest.err
 	cat conftest.err >&5
       fi
         rm -f conftest.err libconftest.a conftest conftest.c
@@ -8473,13 +8482,15 @@ compiler_DEFAULT=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -8519,14 +8530,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -8741,7 +8754,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic='-KPIC'
@@ -8872,14 +8885,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works=yes
@@ -8921,10 +8936,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -8977,8 +8993,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8986,6 +9003,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -9032,8 +9050,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -9041,6 +9060,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -9101,7 +9121,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object=no
   enable_shared_with_static_runtimes=no
   export_dynamic_flag_spec=
-  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic=no
   hardcode_direct=no
   hardcode_direct_absolute=no
@@ -9164,7 +9184,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -9190,13 +9210,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -9240,7 +9260,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -9258,9 +9278,9 @@ _LT_EOF
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -9303,7 +9323,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -9334,7 +9354,7 @@ _LT_EOF
 	  compiler_needs_object=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object=yes
@@ -9372,7 +9392,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -9382,7 +9402,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
 
@@ -9394,7 +9414,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9403,7 +9423,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
@@ -9422,7 +9442,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
 	    archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -9441,7 +9461,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9485,10 +9505,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -9835,10 +9855,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS -b"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -9919,7 +9940,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -9945,7 +9966,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct=yes
 	hardcode_shlibpath_var=no
 	hardcode_direct_absolute=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
@@ -10014,7 +10035,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -10207,10 +10228,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -10236,6 +10258,7 @@ else
 	  fi
 	  allow_undefined_flag=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -10418,7 +10441,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([A-Za-z]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -10522,7 +10545,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -10890,7 +10913,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -10935,7 +10958,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -11581,7 +11604,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -11687,7 +11710,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -13289,7 +13312,7 @@ else
 #include <link.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "dl_iterate_phdr" >/dev/null 2>&1; then :
   have_dl_iterate_phdr=yes
 else
@@ -13350,7 +13373,7 @@ else
 #include <sys/ldr.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "loadquery" >/dev/null 2>&1; then :
   have_loadquery=yes
 else
@@ -16461,7 +16484,7 @@ _LT_EOF
  ;;
     "gstdint.h":C)
 if test "$GCC" = yes; then
-  echo "/* generated for " `$CC --version | sed 1q` "*/" > tmp-stdint.h
+  echo "/* generated for " `$CC --version | sed -e 's/\r//g' | sed 1q` "*/" > tmp-stdint.h
 else
   echo "/* generated for $CC */" > tmp-stdint.h
 fi
diff --git a/gcc/libcc1/configure b/gcc/libcc1/configure
index 01cfb2806d..cbcf5dba0d 100755
--- a/gcc/libcc1/configure
+++ b/gcc/libcc1/configure
@@ -1561,9 +1561,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1598,9 +1599,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1723,7 +1725,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -1796,9 +1798,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1909,9 +1912,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1946,9 +1950,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1984,9 +1989,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2878,9 +2884,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -2931,7 +2938,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3001,7 +3008,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3057,7 +3064,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -3114,7 +3121,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3714,7 +3721,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -3731,7 +3738,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -4541,7 +4548,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -4599,6 +4606,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -4985,9 +4997,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -5029,7 +5041,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -5060,7 +5072,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -5268,10 +5280,12 @@ else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
   (eval echo "\"\$as_me:$LINENO: $ac_compile\"" >&5)
-  (eval "$ac_compile" 2>conftest.err)
+  (eval "($ac_compile | sed -e 's/\r//g')" 2>conftest.err)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: output\"" >&5)
   cat conftest.out >&5
@@ -5692,7 +5706,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -5754,7 +5768,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu | uclinuxfdpiceabi)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|_pic\.a)$'
@@ -5772,7 +5786,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
@@ -6273,7 +6287,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[ABCDGIRSTW]' ;;
 esac
@@ -6281,11 +6295,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -6319,7 +6333,7 @@ for ac_symprfx in "" "_"; do
 "     s[1]~prfx {split(s[1],t,\"@\"); print t[1], substr(t[1],length(prfx))}"\
 "     ' prfx=^$ac_symprfx"
   else
-    lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
+    lt_cv_sys_global_symbol_pipe="sed -n -e 's/\r//g' -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
   fi
 
   # Check to see that the pipe works correctly.
@@ -6340,14 +6354,14 @@ int main(){nm_test_var='a';nm_test_func();return(0);}
 _LT_EOF
 
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist\""; } >&5
-  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) 2>&5
+    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist\""; } >&5
+  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s "$nlist"; then
@@ -6368,7 +6382,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | sed -e '"'"'s/\r//g'"'"' | $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -6381,7 +6395,7 @@ lt__PROGRAM__LTX_preloaded_symbols[] =
 {
   { "@PROGRAM@", (void *) 0 },
 _LT_EOF
-	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | $GREP -v main >> conftest.$ac_ext
+	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | sed -e 's/\r//g' | $GREP -v main >> conftest.$ac_ext
 	  cat <<\_LT_EOF >> conftest.$ac_ext
   {0, (void *) 0}
 };
@@ -6404,7 +6418,7 @@ _LT_EOF
 	  LIBS="conftstm.$ac_objext"
 	  CFLAGS="$CFLAGS$lt_prog_compiler_no_builtin_flag"
 	  if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext}; then
@@ -6483,7 +6497,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6502,7 +6516,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo '#line '$LINENO' "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6540,7 +6554,7 @@ s390*-*linux*|s390*-*tpf*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6652,7 +6666,7 @@ sparc*-*solaris*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7185,6 +7199,7 @@ else
 	if test -f libconftest.dylib && test ! -s conftest.err && test $_lt_result = 0; then
 	  lt_cv_apple_cc_single_mod=yes
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err >&5
 	fi
 	rm -rf libconftest.dylib*
@@ -7247,6 +7262,7 @@ _LT_EOF
       if test -f conftest && test ! -s conftest.err && test $_lt_result = 0 && $GREP forced_load conftest 2>&1 >/dev/null; then
 	lt_cv_ld_force_load=yes
       else
+        dos2unix -q conftest.err
 	cat conftest.err >&5
       fi
         rm -f conftest.err libconftest.a conftest conftest.c
@@ -7739,13 +7755,15 @@ compiler_DEFAULT=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -7785,14 +7803,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -8007,7 +8027,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic='-KPIC'
@@ -8138,14 +8158,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works=yes
@@ -8187,10 +8209,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -8243,8 +8266,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8252,6 +8276,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8298,8 +8323,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8307,6 +8333,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8367,7 +8394,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object=no
   enable_shared_with_static_runtimes=no
   export_dynamic_flag_spec=
-  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic=no
   hardcode_direct=no
   hardcode_direct_absolute=no
@@ -8430,7 +8457,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -8456,13 +8483,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -8506,7 +8533,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -8524,9 +8551,9 @@ _LT_EOF
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -8569,7 +8596,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -8600,7 +8627,7 @@ _LT_EOF
 	  compiler_needs_object=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object=yes
@@ -8638,7 +8665,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -8648,7 +8675,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
 
@@ -8660,7 +8687,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -8669,7 +8696,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
@@ -8688,7 +8715,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
 	    archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -8707,7 +8734,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -8751,10 +8778,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -9101,10 +9128,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS -b"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -9185,7 +9213,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -9211,7 +9239,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct=yes
 	hardcode_shlibpath_var=no
 	hardcode_direct_absolute=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
@@ -9280,7 +9308,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -9473,10 +9501,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -9502,6 +9531,7 @@ else
 	  fi
 	  allow_undefined_flag=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -9684,7 +9714,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([A-Za-z]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -9788,7 +9818,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -10156,7 +10186,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -10201,7 +10231,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -10847,7 +10877,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -10953,7 +10983,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -11244,9 +11274,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -11407,7 +11438,7 @@ else
 
   am_cv_CXX_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -11465,6 +11496,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -11715,13 +11751,15 @@ compiler=$CC
   # save warnings/boilerplate of simple test code
   ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
   ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -11787,9 +11825,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -11831,7 +11869,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -11862,7 +11900,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -11896,7 +11934,7 @@ with_gnu_ld=$lt_cv_prog_gnu_ld
         wlarc='${wl}'
 
         # ancient GNU ld didn't support --whole-archive et. al.
-        if eval "`$CC -print-prog-name=ld` --help 2>&1" |
+        if eval "`$CC -print-prog-name=ld | sed -e 's/\r//g'` --help 2>&1" | sed -e 's/\r//g' |
 	  $GREP 'no-whole-archive' > /dev/null; then
           whole_archive_flag_spec_CXX="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
         else
@@ -11917,7 +11955,7 @@ with_gnu_ld=$lt_cv_prog_gnu_ld
       # Commands to make compiler produce verbose output that lists
       # what "hidden" libraries, object files and flags are used when
       # linking a shared library.
-      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 
     else
       GXX=no
@@ -12119,7 +12157,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
         ;;
 
       beos*)
-	if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	  allow_undefined_flag_CXX=unsupported
 	  # Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	  # support --undefined.  This deserves some investigation.  FIXME
@@ -12147,7 +12185,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
         always_export_symbols_CXX=no
         enable_shared_with_static_runtimes_CXX=yes
 
-        if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+        if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
           archive_cmds_CXX='$CC -shared -nostdlib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
           # If the export-symbols file already is a .def file (1st line
           # is EXPORTS), use it as is; otherwise, prepend...
@@ -12263,7 +12301,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
             # explicitly linking system object files so we need to strip them
             # from the output so that they don't get included in the library
             # dependencies.
-            output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | $EGREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+            output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | sed -e '"'"'s/\r//g'"'"' | $EGREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
             ;;
           *)
             if test "$GXX" = yes; then
@@ -12328,7 +12366,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | $GREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+	    output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | sed -e '"'"'s/\r//g'"'"' | $GREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
 	    ;;
           *)
 	    if test "$GXX" = yes; then
@@ -12413,7 +12451,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`$CC $CFLAGS -v conftest.$objext -o libconftest$shared_ext 2>&1 | $GREP "ld"`; rm -f libconftest$shared_ext; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+	    output_verbose_link_cmd='templist=`$CC $CFLAGS -v conftest.$objext -o libconftest$shared_ext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP "ld"`; rm -f libconftest$shared_ext; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
 
 	    hardcode_libdir_flag_spec_CXX='${wl}-rpath,$libdir'
 	    export_dynamic_flag_spec_CXX='${wl}--export-dynamic'
@@ -12428,7 +12466,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # version 8.0 and above of icpc choke on multiply defined symbols
 	    # if we add $predep_objects and $postdep_objects, however 7.1 and
 	    # earlier do not add the objects themselves.
-	    case `$CC -V 2>&1` in
+	    case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	      *"Version 7."*)
 	        archive_cmds_CXX='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname -o $lib'
 		archive_expsym_cmds_CXX='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -12449,7 +12487,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    ;;
           pgCC* | pgcpp*)
             # Portland Group C++ compiler
-	    case `$CC -V` in
+	    case `$CC -V | sed -e 's/\r//g'` in
 	    *pgCC\ [1-5].* | *pgcpp\ [1-5].*)
 	      prelink_cmds_CXX='tpldir=Template.dir~
 		rm -rf $tpldir~
@@ -12496,7 +12534,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP "ld"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld .*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "X$list" | $Xsed'
+	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP "ld"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld .*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "X$list" | $Xsed'
 	    ;;
 	  xl* | mpixl* | bgxl*)
 	    # IBM XL 8.0 on PPC, with GNU ld
@@ -12511,7 +12549,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    fi
 	    ;;
 	  *)
-	    case `$CC -V 2>&1 | sed 5q` in
+	    case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	    *Sun\ C*)
 	      # Sun C++ 5.9
 	      no_undefined_flag_CXX=' -zdefs'
@@ -12561,7 +12599,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	;;
 
       netbsd*)
-        if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+        if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	  archive_cmds_CXX='$LD -Bshareable  -o $lib $predep_objects $libobjs $deplibs $postdep_objects $linker_flags'
 	  wlarc=
 	  hardcode_libdir_flag_spec_CXX='-R$libdir'
@@ -12569,7 +12607,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	  hardcode_shlibpath_var_CXX=no
 	fi
 	# Workaround some broken pre-1.5 toolchains
-	output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP conftest.$objext | $SED -e "s:-lgcc -lc -lgcc::"'
+	output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP conftest.$objext | $SED -e "s:-lgcc -lc -lgcc::"'
 	;;
 
       *nto* | *qnx*)
@@ -12588,7 +12626,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	  hardcode_direct_absolute_CXX=yes
 	  archive_cmds_CXX='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $lib'
 	  hardcode_libdir_flag_spec_CXX='${wl}-rpath,$libdir'
-	  if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	    archive_expsym_cmds_CXX='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-retain-symbols-file,$export_symbols -o $lib'
 	    export_dynamic_flag_spec_CXX='${wl}-E'
 	    whole_archive_flag_spec_CXX="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
@@ -12652,7 +12690,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP "ld" | $GREP -v "ld:"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld.*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP "ld" | $GREP -v "ld:"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld.*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
 	    ;;
 	  *)
 	    if test "$GXX" = yes && test "$with_gnu_ld" = no; then
@@ -12672,7 +12710,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	      # Commands to make compiler produce verbose output that lists
 	      # what "hidden" libraries, object files and flags are used when
 	      # linking a shared library.
-	      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+	      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 
 	    else
 	      # FIXME: insert proper C++ library support
@@ -12748,7 +12786,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # GNU C++ compiler with Solaris linker
 	    if test "$GXX" = yes && test "$with_gnu_ld" = no; then
 	      no_undefined_flag_CXX=' ${wl}-z ${wl}defs'
-	      if $CC --version | $GREP -v '^2\.7' > /dev/null; then
+	      if $CC --version | sed -e 's/\r//g' | $GREP -v '^2\.7' > /dev/null; then
 	        archive_cmds_CXX='$CC -shared -nostdlib $LDFLAGS $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-h $wl$soname -o $lib'
 	        archive_expsym_cmds_CXX='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 		  $CC -shared -nostdlib ${wl}-M $wl$lib.exp -o $lib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags~$RM $lib.exp'
@@ -12756,7 +12794,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	        # Commands to make compiler produce verbose output that lists
 	        # what "hidden" libraries, object files and flags are used when
 	        # linking a shared library.
-	        output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+	        output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 	      else
 	        # g++ 2.7 appears to require `-G' NOT `-shared' on this
 	        # platform.
@@ -12767,7 +12805,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	        # Commands to make compiler produce verbose output that lists
 	        # what "hidden" libraries, object files and flags are used when
 	        # linking a shared library.
-	        output_verbose_link_cmd='$CC -G $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+	        output_verbose_link_cmd='$CC -G $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 	      fi
 
 	      hardcode_libdir_flag_spec_CXX='${wl}-R $wl$libdir'
@@ -12887,7 +12925,7 @@ private:
 _LT_EOF
 
 if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -12983,7 +13021,7 @@ interix[3-9]*)
   ;;
 
 linux*)
-  case `$CC -V 2>&1 | sed 5q` in
+  case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
   *Sun\ C*)
     # Sun C++ 5.9
 
@@ -13273,7 +13311,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	    lt_prog_compiler_static_CXX='-qstaticlink'
 	    ;;
 	  *)
-	    case `$CC -V 2>&1 | sed 5q` in
+	    case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	    *Sun\ C*)
 	      # Sun C++ 5.9
 	      lt_prog_compiler_pic_CXX='-KPIC'
@@ -13422,14 +13460,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works_CXX=yes
@@ -13468,10 +13508,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -13521,8 +13562,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -13530,6 +13572,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o_CXX=yes
@@ -13573,8 +13616,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -13582,6 +13626,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o_CXX=yes
@@ -13631,27 +13676,27 @@ fi
     { $as_echo "$as_me:${as_lineno-$LINENO}: checking whether the $compiler linker ($LD) supports shared libraries" >&5
 $as_echo_n "checking whether the $compiler linker ($LD) supports shared libraries... " >&6; }
 
-  export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   case $host_os in
   aix[4-9]*)
     # If we're using GNU nm, then we don't want the "-C" option.
     # -C means demangle to AIX nm, but means don't demangle with GNU nm
     # Also, AIX nm treats weak defined symbols like other global defined
     # symbols, whereas GNU nm marks them as "W".
-    if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-      export_symbols_cmds_CXX='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+    if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+      export_symbols_cmds_CXX='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
     else
-      export_symbols_cmds_CXX='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+      export_symbols_cmds_CXX='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
     fi
     ;;
   pw32*)
     export_symbols_cmds_CXX="$ltdll_cmds"
   ;;
   cygwin* | mingw* | cegcc*)
-    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/;/^.*[ ]__nm__/s/^.*[ ]__nm__\([^ ]*\)[ ][^ ]*/\1 DATA/;/^I[ ]/d;/^[AITW][ ]/s/.* //'\'' | sort | uniq > $export_symbols'
+    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/;/^.*[ ]__nm__/s/^.*[ ]__nm__\([^ ]*\)[ ][^ ]*/\1 DATA/;/^I[ ]/d;/^[AITW][ ]/s/.* //'\'' | sort | uniq > $export_symbols'
   ;;
   *)
-    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   ;;
   esac
   exclude_expsyms_CXX='_GLOBAL_OFFSET_TABLE_|_GLOBAL__F[ID]_.*'
@@ -13693,10 +13738,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -13722,6 +13768,7 @@ else
 	  fi
 	  allow_undefined_flag_CXX=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -13851,7 +13898,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -14217,7 +14264,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -14262,7 +14309,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
diff --git a/gcc/libcody/configure b/gcc/libcody/configure
index da52a5cfca..35cd28e757 100755
--- a/gcc/libcody/configure
+++ b/gcc/libcody/configure
@@ -1396,9 +1396,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1434,9 +1435,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2106,9 +2108,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -2159,7 +2162,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -2229,7 +2232,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -2285,7 +2288,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -2342,7 +2345,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
diff --git a/gcc/libcpp/configure b/gcc/libcpp/configure
index 7514539021..19f2f1266f 100755
--- a/gcc/libcpp/configure
+++ b/gcc/libcpp/configure
@@ -1497,9 +1497,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1535,9 +1536,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1572,9 +1574,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1701,7 +1704,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -1774,9 +1777,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2224,9 +2228,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -3190,9 +3195,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -3243,7 +3249,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3313,7 +3319,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3369,7 +3375,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -3426,7 +3432,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3787,9 +3793,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -4409,7 +4416,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -4426,7 +4433,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -5226,7 +5233,7 @@ else
 
   am_cv_CXX_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   for depmode in $am_compiler_list; do
     if test $depmode = none; then break; fi
@@ -5257,6 +5264,10 @@ else
        $SHELL ./depcomp $depcc -c -o sub/conftest.${OBJEXT-o} sub/conftest.c"
     echo "| $depcmd" | sed -e 's/  */ /g' >&5
     if env $depcmd > conftest.err 2>&1 &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst6.h sub/conftest.Po >>conftest.err 2>&1 &&
        grep sub/conftest.${OBJEXT-o} sub/conftest.Po >>conftest.err 2>&1 &&
        ${MAKE-make} -s -f confmf >>conftest.err 2>&1; then
@@ -6319,7 +6330,7 @@ wenotbecray
 #endif
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "webecray" >/dev/null 2>&1; then :
   ac_cv_os_cray=yes
 else
@@ -6427,7 +6438,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -6444,7 +6455,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -6764,9 +6775,9 @@ $as_echo_n "checking for ld used by GCC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -6807,7 +6818,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some GNU ld's only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      if "$acl_cv_path_LD" -v 2>&1 < /dev/null | egrep '(GNU|with BFD)' > /dev/null; then
+      if "$acl_cv_path_LD" -v 2>&1 < /dev/null | sed -e 's/\r//g' | egrep '(GNU|with BFD)' > /dev/null; then
 	test "$with_gnu_ld" != no && break
       else
 	test "$with_gnu_ld" != yes && break
@@ -6835,7 +6846,7 @@ if ${acl_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU ld's only accept -v.
-if $LD -v 2>&1 </dev/null | egrep '(GNU|with BFD)' 1>&5; then
+if $LD -v 2>&1 </dev/null | sed -e 's/\r//g' | egrep '(GNU|with BFD)' 1>&5; then
   acl_cv_prog_gnu_ld=yes
 else
   acl_cv_prog_gnu_ld=no
diff --git a/gcc/libdecnumber/configure b/gcc/libdecnumber/configure
index da5302f931..3cb7c58c88 100755
--- a/gcc/libdecnumber/configure
+++ b/gcc/libdecnumber/configure
@@ -1444,9 +1444,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1481,9 +1482,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1610,7 +1612,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -1920,9 +1922,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2682,9 +2685,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -2735,7 +2739,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -2805,7 +2809,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -2861,7 +2865,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -2918,7 +2922,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3975,7 +3979,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -3992,7 +3996,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -4680,7 +4684,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -4697,7 +4701,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -6693,7 +6697,7 @@ $as_echo "$as_me: executing $ac_file commands" >&6;}
   case $ac_file$ac_mode in
     "gstdint.h":C)
 if test "$GCC" = yes; then
-  echo "/* generated for " `$CC --version | sed 1q` "*/" > tmp-stdint.h
+  echo "/* generated for " `$CC --version | sed -e 's/\r//g' | sed 1q` "*/" > tmp-stdint.h
 else
   echo "/* generated for $CC */" > tmp-stdint.h
 fi
diff --git a/gcc/libffi/Makefile.am b/gcc/libffi/Makefile.am
index c6d6f849c5..104ca34aee 100644
--- a/gcc/libffi/Makefile.am
+++ b/gcc/libffi/Makefile.am
@@ -213,6 +213,7 @@ libffi_version_info = -version-info `grep -v '^\#' $(srcdir)/libtool-version`
 libffi.map: $(top_srcdir)/libffi.map.in
 	$(COMPILE) -D$(TARGET) -DGENERATE_LIBFFI_MAP \
 	 -E -x assembler-with-cpp -o $@ $(top_srcdir)/libffi.map.in
+	dos2unix -q $@
 
 libffi_la_LDFLAGS = -no-undefined $(libffi_version_info) $(libffi_version_script) $(LTLDFLAGS) $(AM_LTLDFLAGS)
 libffi_la_DEPENDENCIES = $(libffi_la_LIBADD) $(libffi_version_dep)
diff --git a/gcc/libffi/Makefile.in b/gcc/libffi/Makefile.in
index 5524a6a571..8e09de4d85 100644
--- a/gcc/libffi/Makefile.in
+++ b/gcc/libffi/Makefile.in
@@ -1925,6 +1925,7 @@ stamp-build-info: doc/libffi.texi $(srcdir)/doc/version.texi doc/$(am__dirstamp)
 libffi.map: $(top_srcdir)/libffi.map.in
 	$(COMPILE) -D$(TARGET) -DGENERATE_LIBFFI_MAP \
 	 -E -x assembler-with-cpp -o $@ $(top_srcdir)/libffi.map.in
+	dos2unix -q $(top_srcdir)/libffi.map.in
 
 # Multilib support.  Automake should provide these on its own.
 all-recursive: all-multi
diff --git a/gcc/libffi/acinclude.m4 b/gcc/libffi/acinclude.m4
index 1a70efb010..f2bacc4c62 100644
--- a/gcc/libffi/acinclude.m4
+++ b/gcc/libffi/acinclude.m4
@@ -173,11 +173,11 @@ AC_DEFUN([LIBFFI_CHECK_LINKER_FEATURES], [
   # Start by getting the version number.  I think the libtool test already
   # does some of this, but throws away the result.
   libat_ld_is_gold=no
-  if $LD --version 2>/dev/null | grep 'GNU gold'> /dev/null 2>&1; then
+  if $LD --version 2>/dev/null | sed -e 's/\r//g' | grep 'GNU gold'> /dev/null 2>&1; then
     libat_ld_is_gold=yes
   fi
   changequote(,)
-  ldver=`$LD --version 2>/dev/null |
+  ldver=`$LD --version 2>/dev/null | sed -e 's/\r//g' |
          sed -e 's/GNU gold /GNU ld /;s/GNU ld version /GNU ld /;s/GNU ld ([^)]*) /GNU ld /;s/GNU ld \([0-9.][0-9.]*\).*/\1/; q'`
   changequote([,])
   libat_gnu_ld_version=`echo $ldver | \
@@ -275,15 +275,15 @@ AC_DEFUN([LIBFFI_CHECK_LINKER_FEATURES], [
   # Start by getting the version number.  I think the libtool test already
   # does some of this, but throws away the result.
   libat_ld_is_gold=no
-  if $LD --version 2>/dev/null | grep 'GNU gold'> /dev/null 2>&1; then
+  if $LD --version 2>/dev/null | sed -e 's/\r//g' | grep 'GNU gold'> /dev/null 2>&1; then
     libat_ld_is_gold=yes
   fi
   libat_ld_is_lld=no
-  if $LD --version 2>/dev/null | grep 'LLD '> /dev/null 2>&1; then
+  if $LD --version 2>/dev/null | sed -e 's/\r//g' | grep 'LLD '> /dev/null 2>&1; then
     libat_ld_is_lld=yes
   fi
   changequote(,)
-  ldver=`$LD --version 2>/dev/null |
+  ldver=`$LD --version 2>/dev/null | sed -e 's/\r//g' |
          sed -e 's/GNU gold /GNU ld /;s/GNU ld version /GNU ld /;s/GNU ld ([^)]*) /GNU ld /;s/GNU ld \([0-9.][0-9.]*\).*/\1/; q'`
   changequote([,])
   libat_gnu_ld_version=`echo $ldver | \
diff --git a/gcc/libffi/configure b/gcc/libffi/configure
index 575641cca1..79a47204ae 100755
--- a/gcc/libffi/configure
+++ b/gcc/libffi/configure
@@ -1598,9 +1598,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1636,9 +1637,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1674,9 +1676,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1750,9 +1753,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1788,7 +1792,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -1896,9 +1900,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1934,9 +1939,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -3765,9 +3771,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -3818,7 +3825,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3888,7 +3895,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3944,7 +3951,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -4001,7 +4008,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4390,7 +4397,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -4448,6 +4455,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -4612,9 +4624,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -4775,7 +4788,7 @@ else
 
   am_cv_CXX_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -4833,6 +4846,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -5005,7 +5023,7 @@ else
 
   am_cv_CCAS_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
 
@@ -5061,6 +5079,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -5511,9 +5534,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -5555,7 +5578,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -5586,7 +5609,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -5794,10 +5817,12 @@ else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
   (eval echo "\"\$as_me:$LINENO: $ac_compile\"" >&5)
-  (eval "$ac_compile" 2>conftest.err)
+  (eval "($ac_compile | sed -e 's/\r//g')" 2>conftest.err)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: output\"" >&5)
   cat conftest.out >&5
@@ -6218,7 +6243,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -6280,7 +6305,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu | uclinuxfdpiceabi)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|_pic\.a)$'
@@ -6298,7 +6323,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
@@ -6799,7 +6824,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[ABCDGIRSTW]' ;;
 esac
@@ -6807,11 +6832,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -6845,7 +6870,7 @@ for ac_symprfx in "" "_"; do
 "     s[1]~prfx {split(s[1],t,\"@\"); print t[1], substr(t[1],length(prfx))}"\
 "     ' prfx=^$ac_symprfx"
   else
-    lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
+    lt_cv_sys_global_symbol_pipe="sed -n -e 's/\r//g' -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
   fi
 
   # Check to see that the pipe works correctly.
@@ -6866,14 +6891,14 @@ int main(){nm_test_var='a';nm_test_func();return(0);}
 _LT_EOF
 
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist\""; } >&5
-  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) 2>&5
+    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist\""; } >&5
+  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s "$nlist"; then
@@ -6894,7 +6919,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | sed -e '"'"'s/\r//g'"'"' | $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -6907,7 +6932,7 @@ lt__PROGRAM__LTX_preloaded_symbols[] =
 {
   { "@PROGRAM@", (void *) 0 },
 _LT_EOF
-	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | $GREP -v main >> conftest.$ac_ext
+	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | sed -e 's/\r//g' | $GREP -v main >> conftest.$ac_ext
 	  cat <<\_LT_EOF >> conftest.$ac_ext
   {0, (void *) 0}
 };
@@ -6930,7 +6955,7 @@ _LT_EOF
 	  LIBS="conftstm.$ac_objext"
 	  CFLAGS="$CFLAGS$lt_prog_compiler_no_builtin_flag"
 	  if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext}; then
@@ -7009,7 +7034,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7028,7 +7053,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo '#line '$LINENO' "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7066,7 +7091,7 @@ s390*-*linux*|s390*-*tpf*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7178,7 +7203,7 @@ sparc*-*solaris*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7711,6 +7736,7 @@ else
 	if test -f libconftest.dylib && test ! -s conftest.err && test $_lt_result = 0; then
 	  lt_cv_apple_cc_single_mod=yes
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err >&5
 	fi
 	rm -rf libconftest.dylib*
@@ -7773,6 +7799,7 @@ _LT_EOF
       if test -f conftest && test ! -s conftest.err && test $_lt_result = 0 && $GREP forced_load conftest 2>&1 >/dev/null; then
 	lt_cv_ld_force_load=yes
       else
+        dos2unix -q conftest.err
 	cat conftest.err >&5
       fi
         rm -f conftest.err libconftest.a conftest conftest.c
@@ -7990,7 +8017,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -8007,7 +8034,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -8534,13 +8561,15 @@ compiler_DEFAULT=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -8580,14 +8609,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -8802,7 +8833,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic='-KPIC'
@@ -8933,14 +8964,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works=yes
@@ -8982,10 +9015,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -9038,8 +9072,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -9047,6 +9082,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -9093,8 +9129,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -9102,6 +9139,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -9162,7 +9200,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object=no
   enable_shared_with_static_runtimes=no
   export_dynamic_flag_spec=
-  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic=no
   hardcode_direct=no
   hardcode_direct_absolute=no
@@ -9225,7 +9263,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -9251,13 +9289,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -9301,7 +9339,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -9319,9 +9357,9 @@ _LT_EOF
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -9364,7 +9402,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -9395,7 +9433,7 @@ _LT_EOF
 	  compiler_needs_object=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object=yes
@@ -9433,7 +9471,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -9443,7 +9481,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
 
@@ -9455,7 +9493,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9464,7 +9502,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
@@ -9483,7 +9521,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
 	    archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -9502,7 +9540,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9546,10 +9584,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -9896,10 +9934,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS -b"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -9980,7 +10019,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -10006,7 +10045,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct=yes
 	hardcode_shlibpath_var=no
 	hardcode_direct_absolute=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
@@ -10075,7 +10114,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -10268,10 +10307,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -10297,6 +10337,7 @@ else
 	  fi
 	  allow_undefined_flag=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -10479,7 +10520,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([A-Za-z]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -10583,7 +10624,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -10951,7 +10992,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -10996,7 +11037,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -11642,7 +11683,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -11748,7 +11789,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -12104,13 +12145,15 @@ compiler=$CC
   # save warnings/boilerplate of simple test code
   ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
   ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -12176,9 +12219,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -12220,7 +12263,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -12251,7 +12294,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -12285,7 +12328,7 @@ with_gnu_ld=$lt_cv_prog_gnu_ld
         wlarc='${wl}'
 
         # ancient GNU ld didn't support --whole-archive et. al.
-        if eval "`$CC -print-prog-name=ld` --help 2>&1" |
+        if eval "`$CC -print-prog-name=ld | sed -e 's/\r//g'` --help 2>&1" | sed -e 's/\r//g' |
 	  $GREP 'no-whole-archive' > /dev/null; then
           whole_archive_flag_spec_CXX="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
         else
@@ -12306,7 +12349,7 @@ with_gnu_ld=$lt_cv_prog_gnu_ld
       # Commands to make compiler produce verbose output that lists
       # what "hidden" libraries, object files and flags are used when
       # linking a shared library.
-      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 
     else
       GXX=no
@@ -12508,7 +12551,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
         ;;
 
       beos*)
-	if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	  allow_undefined_flag_CXX=unsupported
 	  # Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	  # support --undefined.  This deserves some investigation.  FIXME
@@ -12536,7 +12579,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
         always_export_symbols_CXX=no
         enable_shared_with_static_runtimes_CXX=yes
 
-        if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+        if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
           archive_cmds_CXX='$CC -shared -nostdlib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
           # If the export-symbols file already is a .def file (1st line
           # is EXPORTS), use it as is; otherwise, prepend...
@@ -12652,7 +12695,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
             # explicitly linking system object files so we need to strip them
             # from the output so that they don't get included in the library
             # dependencies.
-            output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | $EGREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+            output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | sed -e '"'"'s/\r//g'"'"' | $EGREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
             ;;
           *)
             if test "$GXX" = yes; then
@@ -12717,7 +12760,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | $GREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+	    output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | sed -e '"'"'s/\r//g'"'"' | $GREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
 	    ;;
           *)
 	    if test "$GXX" = yes; then
@@ -12802,7 +12845,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`$CC $CFLAGS -v conftest.$objext -o libconftest$shared_ext 2>&1 | $GREP "ld"`; rm -f libconftest$shared_ext; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+	    output_verbose_link_cmd='templist=`$CC $CFLAGS -v conftest.$objext -o libconftest$shared_ext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP "ld"`; rm -f libconftest$shared_ext; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
 
 	    hardcode_libdir_flag_spec_CXX='${wl}-rpath,$libdir'
 	    export_dynamic_flag_spec_CXX='${wl}--export-dynamic'
@@ -12817,7 +12860,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # version 8.0 and above of icpc choke on multiply defined symbols
 	    # if we add $predep_objects and $postdep_objects, however 7.1 and
 	    # earlier do not add the objects themselves.
-	    case `$CC -V 2>&1` in
+	    case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	      *"Version 7."*)
 	        archive_cmds_CXX='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname -o $lib'
 		archive_expsym_cmds_CXX='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -12838,7 +12881,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    ;;
           pgCC* | pgcpp*)
             # Portland Group C++ compiler
-	    case `$CC -V` in
+	    case `$CC -V | sed -e 's/\r//g'` in
 	    *pgCC\ [1-5].* | *pgcpp\ [1-5].*)
 	      prelink_cmds_CXX='tpldir=Template.dir~
 		rm -rf $tpldir~
@@ -12885,7 +12928,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP "ld"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld .*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "X$list" | $Xsed'
+	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP "ld"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld .*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "X$list" | $Xsed'
 	    ;;
 	  xl* | mpixl* | bgxl*)
 	    # IBM XL 8.0 on PPC, with GNU ld
@@ -12900,7 +12943,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    fi
 	    ;;
 	  *)
-	    case `$CC -V 2>&1 | sed 5q` in
+	    case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	    *Sun\ C*)
 	      # Sun C++ 5.9
 	      no_undefined_flag_CXX=' -zdefs'
@@ -12950,7 +12993,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	;;
 
       netbsd*)
-        if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+        if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	  archive_cmds_CXX='$LD -Bshareable  -o $lib $predep_objects $libobjs $deplibs $postdep_objects $linker_flags'
 	  wlarc=
 	  hardcode_libdir_flag_spec_CXX='-R$libdir'
@@ -12958,7 +13001,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	  hardcode_shlibpath_var_CXX=no
 	fi
 	# Workaround some broken pre-1.5 toolchains
-	output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP conftest.$objext | $SED -e "s:-lgcc -lc -lgcc::"'
+	output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP conftest.$objext | $SED -e "s:-lgcc -lc -lgcc::"'
 	;;
 
       *nto* | *qnx*)
@@ -12977,7 +13020,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	  hardcode_direct_absolute_CXX=yes
 	  archive_cmds_CXX='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $lib'
 	  hardcode_libdir_flag_spec_CXX='${wl}-rpath,$libdir'
-	  if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	    archive_expsym_cmds_CXX='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-retain-symbols-file,$export_symbols -o $lib'
 	    export_dynamic_flag_spec_CXX='${wl}-E'
 	    whole_archive_flag_spec_CXX="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
@@ -13041,7 +13084,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP "ld" | $GREP -v "ld:"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld.*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP "ld" | $GREP -v "ld:"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld.*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
 	    ;;
 	  *)
 	    if test "$GXX" = yes && test "$with_gnu_ld" = no; then
@@ -13061,7 +13104,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	      # Commands to make compiler produce verbose output that lists
 	      # what "hidden" libraries, object files and flags are used when
 	      # linking a shared library.
-	      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+	      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 
 	    else
 	      # FIXME: insert proper C++ library support
@@ -13137,7 +13180,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # GNU C++ compiler with Solaris linker
 	    if test "$GXX" = yes && test "$with_gnu_ld" = no; then
 	      no_undefined_flag_CXX=' ${wl}-z ${wl}defs'
-	      if $CC --version | $GREP -v '^2\.7' > /dev/null; then
+	      if $CC --version | sed -e 's/\r//g' | $GREP -v '^2\.7' > /dev/null; then
 	        archive_cmds_CXX='$CC -shared -nostdlib $LDFLAGS $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-h $wl$soname -o $lib'
 	        archive_expsym_cmds_CXX='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 		  $CC -shared -nostdlib ${wl}-M $wl$lib.exp -o $lib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags~$RM $lib.exp'
@@ -13145,7 +13188,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	        # Commands to make compiler produce verbose output that lists
 	        # what "hidden" libraries, object files and flags are used when
 	        # linking a shared library.
-	        output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+	        output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 	      else
 	        # g++ 2.7 appears to require `-G' NOT `-shared' on this
 	        # platform.
@@ -13156,7 +13199,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	        # Commands to make compiler produce verbose output that lists
 	        # what "hidden" libraries, object files and flags are used when
 	        # linking a shared library.
-	        output_verbose_link_cmd='$CC -G $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+	        output_verbose_link_cmd='$CC -G $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 	      fi
 
 	      hardcode_libdir_flag_spec_CXX='${wl}-R $wl$libdir'
@@ -13276,7 +13319,7 @@ private:
 _LT_EOF
 
 if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -13372,7 +13415,7 @@ interix[3-9]*)
   ;;
 
 linux*)
-  case `$CC -V 2>&1 | sed 5q` in
+  case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
   *Sun\ C*)
     # Sun C++ 5.9
 
@@ -13662,7 +13705,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	    lt_prog_compiler_static_CXX='-qstaticlink'
 	    ;;
 	  *)
-	    case `$CC -V 2>&1 | sed 5q` in
+	    case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	    *Sun\ C*)
 	      # Sun C++ 5.9
 	      lt_prog_compiler_pic_CXX='-KPIC'
@@ -13811,14 +13854,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works_CXX=yes
@@ -13857,10 +13902,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -13910,8 +13956,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -13919,6 +13966,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o_CXX=yes
@@ -13962,8 +14010,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -13971,6 +14020,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o_CXX=yes
@@ -14020,27 +14070,27 @@ fi
     { $as_echo "$as_me:${as_lineno-$LINENO}: checking whether the $compiler linker ($LD) supports shared libraries" >&5
 $as_echo_n "checking whether the $compiler linker ($LD) supports shared libraries... " >&6; }
 
-  export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   case $host_os in
   aix[4-9]*)
     # If we're using GNU nm, then we don't want the "-C" option.
     # -C means demangle to AIX nm, but means don't demangle with GNU nm
     # Also, AIX nm treats weak defined symbols like other global defined
     # symbols, whereas GNU nm marks them as "W".
-    if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-      export_symbols_cmds_CXX='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+    if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+      export_symbols_cmds_CXX='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
     else
-      export_symbols_cmds_CXX='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+      export_symbols_cmds_CXX='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
     fi
     ;;
   pw32*)
     export_symbols_cmds_CXX="$ltdll_cmds"
   ;;
   cygwin* | mingw* | cegcc*)
-    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/;/^.*[ ]__nm__/s/^.*[ ]__nm__\([^ ]*\)[ ][^ ]*/\1 DATA/;/^I[ ]/d;/^[AITW][ ]/s/.* //'\'' | sort | uniq > $export_symbols'
+    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/;/^.*[ ]__nm__/s/^.*[ ]__nm__\([^ ]*\)[ ][^ ]*/\1 DATA/;/^I[ ]/d;/^[AITW][ ]/s/.* //'\'' | sort | uniq > $export_symbols'
   ;;
   *)
-    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   ;;
   esac
   exclude_expsyms_CXX='_GLOBAL_OFFSET_TABLE_|_GLOBAL__F[ID]_.*'
@@ -14082,10 +14132,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -14240,7 +14291,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -14606,7 +14657,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -14651,7 +14702,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -15330,7 +15381,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -15347,7 +15398,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -15542,7 +15593,7 @@ wenotbecray
 #endif
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "webecray" >/dev/null 2>&1; then :
   ac_cv_os_cray=yes
 else
@@ -16319,7 +16370,7 @@ $as_echo_n "checking for modern makeinfo... " >&6; }
 if ${gcc_cv_prog_makeinfo_modern+:} false; then :
   $as_echo_n "(cached) " >&6
 else
-  ac_prog_version=`eval $MAKEINFO --version 2>&1 |
+  ac_prog_version=`eval $MAKEINFO --version 2>&1 | sed -e 's/\r//g' |
                                      sed -n 's/^.*GNU texinfo.* \([0-9][0-9.]*\).*$/\1/p'`
 
                     case $ac_prog_version in
@@ -16467,7 +16518,7 @@ else
   toolexecdir='$(libdir)/gcc-lib/$(target_alias)'
   toolexeclibdir='$(libdir)'
 fi
-multi_os_directory=`$CC -print-multi-os-directory`
+multi_os_directory=`$CC -print-multi-os-directory | sed -e 's/\r//g'`
 case $multi_os_directory in
   .) ;; # Avoid trailing /.
   *) toolexeclibdir=$toolexeclibdir/$multi_os_directory ;;
@@ -16499,9 +16550,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -16543,7 +16594,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -16574,7 +16625,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -16619,15 +16670,15 @@ with_gnu_ld=$lt_cv_prog_gnu_ld
   # Start by getting the version number.  I think the libtool test already
   # does some of this, but throws away the result.
   libat_ld_is_gold=no
-  if $LD --version 2>/dev/null | grep 'GNU gold'> /dev/null 2>&1; then
+  if $LD --version 2>/dev/null | sed -e 's/\r//g' | grep 'GNU gold'> /dev/null 2>&1; then
     libat_ld_is_gold=yes
   fi
   libat_ld_is_lld=no
-  if $LD --version 2>/dev/null | grep 'LLD '> /dev/null 2>&1; then
+  if $LD --version 2>/dev/null | sed -e 's/\r//g' | grep 'LLD '> /dev/null 2>&1; then
     libat_ld_is_lld=yes
   fi
 
-  ldver=`$LD --version 2>/dev/null |
+  ldver=`$LD --version 2>/dev/null | sed -e 's/\r//g' |
          sed -e 's/GNU gold /GNU ld /;s/GNU ld version /GNU ld /;s/GNU ld ([^)]*) /GNU ld /;s/GNU ld \([0-9.][0-9.]*\).*/\1/; q'`
 
   libat_gnu_ld_version=`echo $ldver | \
@@ -16787,6 +16838,7 @@ EOF
     libat_libgcc_s_suffix=`${CC-cc} $CFLAGS $CPPFLAGS $LDFLAGS \
 			     -shared -shared-libgcc -o conftest.so \
 			     conftest.c -v 2>&1 >/dev/null \
+			     | sed -e 's/\r//g' \
 			     | sed -n 's/^.* -lgcc_s\([^ ]*\) .*$/\1/p'`
     rm -f conftest.c conftest.so
     if test x${libat_libgcc_s_suffix+set} = xset; then
diff --git a/gcc/libffi/configure.ac b/gcc/libffi/configure.ac
index 014d89d042..62af833536 100644
--- a/gcc/libffi/configure.ac
+++ b/gcc/libffi/configure.ac
@@ -399,7 +399,7 @@ else
   toolexecdir='$(libdir)/gcc-lib/$(target_alias)'
   toolexeclibdir='$(libdir)'
 fi
-multi_os_directory=`$CC -print-multi-os-directory`
+multi_os_directory=`$CC -print-multi-os-directory | sed -e 's/\r//g'`
 case $multi_os_directory in
   .) ;; # Avoid trailing /.
   *) toolexeclibdir=$toolexeclibdir/$multi_os_directory ;;
diff --git a/gcc/libgcc/Makefile.in b/gcc/libgcc/Makefile.in
index ff3a44f6bd..626e8eda3c 100644
--- a/gcc/libgcc/Makefile.in
+++ b/gcc/libgcc/Makefile.in
@@ -316,7 +316,8 @@ inst_libdir = $(libsubdir)$(MULTISUBDIR)
 inst_slibdir = $(slibdir)$(MULTIOSSUBDIR)
 
 gcc_compile_bare = $(CC) $(INTERNAL_CFLAGS) $(CFLAGS-$(<F))
-compile_deps = -MT $@ -MD -MP -MF $(basename $@).dep
+dep_filename = $(basename $@).dep
+compile_deps = -MT $@ -MD -MP -MF $(dep_filename)
 gcc_compile = $(gcc_compile_bare) -o $@ $(compile_deps)
 gcc_s_compile = $(gcc_compile) -DSHARED
 
@@ -482,14 +483,24 @@ LIB2FUNCS_ST := $(filter-out $(LIB2FUNCS_EXCLUDE),$(LIB2FUNCS_ST))
 
 lib1asmfuncs-o = $(patsubst %,%$(objext),$(LIB1ASMFUNCS))
 $(lib1asmfuncs-o): %$(objext): $(srcdir)/config/$(LIB1ASMSRC) %.vis
-	$(gcc_compile) -DL$* -xassembler-with-cpp -c $< -include $*.vis
+	$(gcc_compile) -DL$* -xassembler-with-cpp -c $< -include $*.vis && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 $(patsubst %,%.vis,$(LIB1ASMFUNCS)): %.vis: %_s$(objext)
 	$(gen-hide-list)
 libgcc-objects += $(lib1asmfuncs-o)
 
 lib1asmfuncs-s-o = $(patsubst %,%_s$(objext),$(LIB1ASMFUNCS))
 $(lib1asmfuncs-s-o): %_s$(objext): $(srcdir)/config/$(LIB1ASMSRC)
-	$(gcc_s_compile) -DL$* -xassembler-with-cpp -c $<
+	$(gcc_s_compile) -DL$* -xassembler-with-cpp -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 ifeq ($(enable_shared),yes)
 
 libgcc-s-objects += $(lib1asmfuncs-s-o)
@@ -499,13 +510,23 @@ endif
 # Build lib2funcs.  For the static library also include LIB2FUNCS_ST.
 lib2funcs-o = $(patsubst %,%$(objext),$(lib2funcs) $(LIB2FUNCS_ST))
 $(lib2funcs-o): %$(objext): $(srcdir)/libgcc2.c
-	$(gcc_compile) -DL$* -c $< $(vis_hide)
+	$(gcc_compile) -DL$* -c $< $(vis_hide) && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 libgcc-objects += $(lib2funcs-o)
 
 ifeq ($(enable_shared),yes)
 lib2funcs-s-o = $(patsubst %,%_s$(objext),$(lib2funcs))
 $(lib2funcs-s-o): %_s$(objext): $(srcdir)/libgcc2.c
-	$(gcc_s_compile) -DL$* -c $<
+	$(gcc_s_compile) -DL$* -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 libgcc-s-objects += $(lib2funcs-s-o)
 endif
 
@@ -541,14 +562,24 @@ endif
 lib2-divmod-o = $(patsubst %,%$(objext),$(LIB2_DIVMOD_FUNCS))
 $(lib2-divmod-o): %$(objext): $(srcdir)/libgcc2.c
 	$(gcc_compile) -DL$* -c $< \
-	  $(LIB2_DIVMOD_EXCEPTION_FLAGS) $(vis_hide)
+	  $(LIB2_DIVMOD_EXCEPTION_FLAGS) $(vis_hide) && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 libgcc-objects += $(lib2-divmod-o)
 
 ifeq ($(enable_shared),yes)
 lib2-divmod-s-o = $(patsubst %,%_s$(objext),$(LIB2_DIVMOD_FUNCS))
 $(lib2-divmod-s-o): %_s$(objext): $(srcdir)/libgcc2.c
 	$(gcc_s_compile) -DL$* -c $< \
-	  $(LIB2_DIVMOD_EXCEPTION_FLAGS)
+	  $(LIB2_DIVMOD_EXCEPTION_FLAGS) && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 libgcc-s-objects += $(lib2-divmod-s-o)
 endif
 
@@ -568,13 +599,23 @@ fpbit-src := $(srcdir)/fp-bit.c
 ifneq ($(FPBIT),)
 fpbit-o = $(patsubst %,%$(objext),$(FPBIT_FUNCS))
 $(fpbit-o): %$(objext): $(fpbit-src)
-	$(gcc_compile) -DFINE_GRAINED_LIBRARIES -DL$* -DFLOAT $(FPBIT_CFLAGS) -c $< $(vis_hide)
+	$(gcc_compile) -DFINE_GRAINED_LIBRARIES -DL$* -DFLOAT $(FPBIT_CFLAGS) -c $< $(vis_hide) && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 libgcc-objects += $(fpbit-o)
 
 ifeq ($(enable_shared),yes)
 fpbit-s-o = $(patsubst %,%_s$(objext),$(FPBIT_FUNCS))
 $(fpbit-s-o): %_s$(objext): $(fpbit-src)
-	$(gcc_s_compile) -DFINE_GRAINED_LIBRARIES -DL$* -DFLOAT $(FPBIT_CFLAGS)  -c $<
+	$(gcc_s_compile) -DFINE_GRAINED_LIBRARIES -DL$* -DFLOAT $(FPBIT_CFLAGS)  -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 libgcc-s-objects += $(fpbit-s-o)
 endif
 endif
@@ -583,13 +624,23 @@ endif
 ifneq ($(DPBIT),)
 dpbit-o = $(patsubst %,%$(objext),$(DPBIT_FUNCS))
 $(dpbit-o): %$(objext): $(fpbit-src)
-	$(gcc_compile) -DFINE_GRAINED_LIBRARIES -DL$* $(DPBIT_CFLAGS) -c $< $(vis_hide)
+	$(gcc_compile) -DFINE_GRAINED_LIBRARIES -DL$* $(DPBIT_CFLAGS) -c $< $(vis_hide) && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 libgcc-objects += $(dpbit-o)
 
 ifeq ($(enable_shared),yes)
 dpbit-s-o = $(patsubst %,%_s$(objext),$(DPBIT_FUNCS))
 $(dpbit-s-o): %_s$(objext): $(fpbit-src)
-	$(gcc_s_compile) -DFINE_GRAINED_LIBRARIES -DL$* $(DPBIT_CFLAGS) -c $<
+	$(gcc_s_compile) -DFINE_GRAINED_LIBRARIES -DL$* $(DPBIT_CFLAGS) -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 libgcc-s-objects += $(dpbit-s-o)
 endif
 endif
@@ -598,13 +649,23 @@ endif
 ifneq ($(TPBIT),)
 tpbit-o = $(patsubst %,%$(objext),$(TPBIT_FUNCS))
 $(tpbit-o): %$(objext): $(fpbit-src)
-	$(gcc_compile) -DFINE_GRAINED_LIBRARIES -DL$* -DTFLOAT $(TPBIT_CFLAGS) -c $< $(vis_hide)
+	$(gcc_compile) -DFINE_GRAINED_LIBRARIES -DL$* -DTFLOAT $(TPBIT_CFLAGS) -c $< $(vis_hide) && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 libgcc-objects += $(tpbit-o)
 
 ifeq ($(enable_shared),yes)
 tpbit-s-o = $(patsubst %,%_s$(objext),$(TPBIT_FUNCS))
 $(tpbit-s-o): %_s$(objext): $(fpbit-src)
-	$(gcc_s_compile) -DFINE_GRAINED_LIBRARIES -DL$* -DTFLOAT $(TPBIT_CFLAGS) -c $<
+	$(gcc_s_compile) -DFINE_GRAINED_LIBRARIES -DL$* -DTFLOAT $(TPBIT_CFLAGS) -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 libgcc-s-objects += $(tpbit-s-o)
 endif
 endif
@@ -644,7 +705,12 @@ $(dfp-objects): %$(objext): $(srcdir)/config/libbid/%.c
 else
 $(dfp-objects): %$(objext): $(srcdir)/../libdecnumber/%.c
 endif
-	$(gcc_compile) -c $<
+	$(gcc_compile) -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 libgcc-objects += $(dfp-objects)
 
 decbits-filenames =
@@ -668,7 +734,12 @@ $(decbits-objects): %$(objext): $(srcdir)/config/libbid/%.c
 else
 $(decbits-objects): %$(objext): $(srcdir)/../libdecnumber/$(enable_decimal_float)/%.c
 endif
-	$(gcc_compile) -c $<
+	$(gcc_compile) -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 libgcc-objects += $(decbits-objects)
 
 # Next build individual support functions.
@@ -717,7 +788,12 @@ $(d32pbit-o): %$(objext): $(srcdir)/config/libbid/%.c
 else
 $(d32pbit-o): %$(objext): $(srcdir)/dfp-bit.c
 endif
-	$(gcc_compile) -DFINE_GRAINED_LIBRARIES -DL$* -DWIDTH=32 -c $<
+	$(gcc_compile) -DFINE_GRAINED_LIBRARIES -DL$* -DWIDTH=32 -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 libgcc-objects += $(d32pbit-o)
 endif
 
@@ -728,7 +804,12 @@ $(d64pbit-o): %$(objext): $(srcdir)/config/libbid/%.c
 else
 $(d64pbit-o): %$(objext): $(srcdir)/dfp-bit.c
 endif
-	$(gcc_compile) -DFINE_GRAINED_LIBRARIES -DL$* -DWIDTH=64 -c $<
+	$(gcc_compile) -DFINE_GRAINED_LIBRARIES -DL$* -DWIDTH=64 -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 libgcc-objects += $(d64pbit-o)
 endif
 
@@ -739,7 +820,12 @@ $(d128pbit-o): %$(objext): $(srcdir)/config/libbid/%.c
 else
 $(d128pbit-o): %$(objext): $(srcdir)/dfp-bit.c
 endif
-	$(gcc_compile) -DFINE_GRAINED_LIBRARIES -DL$* -DWIDTH=128 -c $<
+	$(gcc_compile) -DFINE_GRAINED_LIBRARIES -DL$* -DWIDTH=128 -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 libgcc-objects += $(d128pbit-o)
 endif
 
@@ -762,7 +848,12 @@ $(libgcc-sync-size-funcs-o): %$(objext): $(srcdir)/sync.c
 	$(gcc_compile) $(SYNC_CFLAGS) \
 	  -DFN=`echo "$*" | sed 's/_[^_]*$$//'` \
 	  -DSIZE=`echo "$*" | sed 's/.*_//'` \
-	  -c $< $(vis_hide)
+	  -c $< $(vis_hide) && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 libgcc-objects += $(libgcc-sync-size-funcs-o)
 
 libgcc-sync-funcs := sync_synchronize
@@ -771,7 +862,12 @@ libgcc-sync-funcs-o = $(patsubst %,%$(objext),$(libgcc-sync-funcs))
 $(libgcc-sync-funcs-o): %$(objext): $(srcdir)/sync.c
 	$(gcc_compile) $(SYNC_CFLAGS) \
 	  -DL$* \
-	  -c $< $(vis_hide)
+	  -c $< $(vis_hide) && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 libgcc-objects += $(libgcc-sync-funcs-o)
 
 ifeq ($(enable_shared),yes)
@@ -781,14 +877,24 @@ $(libgcc-sync-size-funcs-s-o): %_s$(objext): $(srcdir)/sync.c
 	$(gcc_s_compile) $(SYNC_CFLAGS) \
 	  -DFN=`echo "$*" | sed 's/_[^_]*$$//'` \
 	  -DSIZE=`echo "$*" | sed 's/.*_//'` \
-	  -c $<
+	  -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 libgcc-s-objects += $(libgcc-sync-size-funcs-s-o)
 
 libgcc-sync-funcs-s-o = $(patsubst %,%_s$(objext),$(libgcc-sync-funcs))
 $(libgcc-sync-funcs-s-o): %_s$(objext): $(srcdir)/sync.c
 	$(gcc_s_compile) $(SYNC_CFLAGS) \
 	  -DL$*	\
-	  -c $<
+	  -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 libgcc-s-objects += $(libgcc-sync-funcs-s-o)
 endif
 endif
@@ -919,14 +1025,34 @@ libgcov-objects = $(libgcov-merge-objects) $(libgcov-profiler-objects) \
                  $(libgcov-interface-objects) $(libgcov-driver-objects)
 
 $(libgcov-merge-objects): %$(objext): $(srcdir)/libgcov-merge.c $(srcdir)/gcov.h $(srcdir)/libgcov.h
-	$(gcc_compile) -DL$* -c $(srcdir)/libgcov-merge.c
+	$(gcc_compile) -DL$* -c $(srcdir)/libgcov-merge.c && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 $(libgcov-profiler-objects): %$(objext): $(srcdir)/libgcov-profiler.c $(srcdir)/gcov.h $(srcdir)/libgcov.h
-	$(gcc_compile) -DL$* -c $(srcdir)/libgcov-profiler.c
+	$(gcc_compile) -DL$* -c $(srcdir)/libgcov-profiler.c && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 $(libgcov-interface-objects): %$(objext): $(srcdir)/libgcov-interface.c $(srcdir)/gcov.h $(srcdir)/libgcov.h
-	$(gcc_compile) -DL$* -c $(srcdir)/libgcov-interface.c
+	$(gcc_compile) -DL$* -c $(srcdir)/libgcov-interface.c && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 $(libgcov-driver-objects): %$(objext): $(srcdir)/libgcov-driver.c \
   $(srcdir)/libgcov-driver-system.c $(srcdir)/gcov.h $(srcdir)/libgcov.h
-	$(gcc_compile) -DL$* -c $(srcdir)/libgcov-driver.c
+	$(gcc_compile) -DL$* -c $(srcdir)/libgcov-driver.c && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 
 # Static libraries.
@@ -943,6 +1069,7 @@ libgcc.a libgcov.a libunwind.a libgcc_eh.a:
 	  echo 'int __libgcc_eh_dummy;' > eh_dummy.c;		\
 	  $(gcc_compile_bare) $(vis_hide) -c eh_dummy.c		\
 	     -o eh_dummy$(objext);				\
+	  dos2unix -q eh_dummy$(objext);                           \
 	  objects=eh_dummy$(objext);				\
 	fi;							\
 	$(AR_CREATE_FOR_TARGET) $@ $$objects
@@ -973,6 +1100,7 @@ libgcc.map.in: $(SHLIB_MAPFILES)
 		  -e 's/^%\(if\|else\|elif\|endif\|define\)/#\1/' \
 	    | $(gcc_compile_bare) -E -xassembler-with-cpp -; \
 	} > tmp-$@
+	dos2unix -q tmp-$@
 	mv tmp-$@ $@
 libgcc.map: $(SHLIB_MKMAP) libgcc.map.in $(libgcc-s-objects)
 	{ $(NM) $(SHLIB_NM_FLAGS) $(libgcc-s-objects); echo %%; \
@@ -1024,33 +1152,73 @@ ifeq ($(CUSTOM_CRTSTUFF),)
 # linked using GCC on systems using COFF or ELF, for the sake of C++
 # constructors.
 crtbegin$(objext): $(srcdir)/crtstuff.c
-	$(crt_compile) $(CRTSTUFF_T_CFLAGS) -c $< -DCRT_BEGIN
+	$(crt_compile) $(CRTSTUFF_T_CFLAGS) -c $< -DCRT_BEGIN && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 crtend$(objext): $(srcdir)/crtstuff.c
-	$(crt_compile) $(CRTSTUFF_T_CFLAGS) -c $< -DCRT_END
+	$(crt_compile) $(CRTSTUFF_T_CFLAGS) -c $< -DCRT_END && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 # These are versions of crtbegin and crtend for shared libraries.
 crtbeginS$(objext): $(srcdir)/crtstuff.c
-	$(crt_compile) $(CRTSTUFF_T_CFLAGS_S) -c $< -DCRT_BEGIN -DCRTSTUFFS_O
+	$(crt_compile) $(CRTSTUFF_T_CFLAGS_S) -c $< -DCRT_BEGIN -DCRTSTUFFS_O && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 crtendS$(objext): $(srcdir)/crtstuff.c
-	$(crt_compile) $(CRTSTUFF_T_CFLAGS_S) -c $< -DCRT_END -DCRTSTUFFS_O
+	$(crt_compile) $(CRTSTUFF_T_CFLAGS_S) -c $< -DCRT_END -DCRTSTUFFS_O && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 # This is a version of crtbegin for -static links.
 crtbeginT$(objext): $(srcdir)/crtstuff.c
-	$(crt_compile) $(CRTSTUFF_T_CFLAGS) -c $< -DCRT_BEGIN -DCRTSTUFFT_O
+	$(crt_compile) $(CRTSTUFF_T_CFLAGS) -c $< -DCRT_BEGIN -DCRTSTUFFT_O && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 # crtoffloadbegin and crtoffloadend contain symbols, that mark the begin and
 # the end of tables with addresses, required for offloading.  crtoffloadtable
 # contains the array with addresses of those symbols.
 crtoffloadbegin$(objext): $(srcdir)/offloadstuff.c
-	$(crt_compile) $(CRTSTUFF_T_CFLAGS) -c $< -DCRT_BEGIN
+	$(crt_compile) $(CRTSTUFF_T_CFLAGS) -c $< -DCRT_BEGIN && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 crtoffloadend$(objext): $(srcdir)/offloadstuff.c
-	$(crt_compile) $(CRTSTUFF_T_CFLAGS) -c $< -DCRT_END
+	$(crt_compile) $(CRTSTUFF_T_CFLAGS) -c $< -DCRT_END && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 crtoffloadtable$(objext): $(srcdir)/offloadstuff.c
-	$(crt_compile) $(CRTSTUFF_T_CFLAGS) -c $< -DCRT_TABLE
+	$(crt_compile) $(CRTSTUFF_T_CFLAGS) -c $< -DCRT_TABLE && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 endif
 
 ifeq ($(enable_vtable_verify),yes)
@@ -1062,25 +1230,55 @@ ifeq ($(enable_vtable_verify),yes)
 VTV_CFLAGS = $(CRTSTUFF_T_CFLAGS_S) -fno-inhibit-size-directive
 
 vtv_start$(objext): $(srcdir)/vtv_start.c
-	$(crt_compile) $(VTV_CFLAGS) -c $(srcdir)/vtv_start.c
+	$(crt_compile) $(VTV_CFLAGS) -c $(srcdir)/vtv_start.c && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 vtv_end$(objext): $(srcdir)/vtv_end.c
-	$(crt_compile) $(VTV_CFLAGS) -c $(srcdir)/vtv_end.c
+	$(crt_compile) $(VTV_CFLAGS) -c $(srcdir)/vtv_end.c && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 vtv_start_preinit$(objext): $(srcdir)/vtv_start_preinit.c
-	$(crt_compile) $(VTV_CFLAGS) -c $(srcdir)/vtv_start_preinit.c
+	$(crt_compile) $(VTV_CFLAGS) -c $(srcdir)/vtv_start_preinit.c && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 vtv_end_preinit$(objext): $(srcdir)/vtv_end_preinit.c
-	$(crt_compile) $(VTV_CFLAGS) -c $(srcdir)/vtv_end_preinit.c
+	$(crt_compile) $(VTV_CFLAGS) -c $(srcdir)/vtv_end_preinit.c && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 endif
 
 ifeq ($(CUSTOM_CRTIN),)
 # -x assembler-with-cpp is only needed on case-insensitive filesystem.
 crti$(objext): $(srcdir)/config/$(cpu_type)/crti.S
-	$(crt_compile) -c -x assembler-with-cpp $<
+	$(crt_compile) -c -x assembler-with-cpp $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 crtn$(objext): $(srcdir)/config/$(cpu_type)/crtn.S
-	$(crt_compile) -c -x assembler-with-cpp $<
+	$(crt_compile) -c -x assembler-with-cpp $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 endif
 
 # Build extra startfiles in the libgcc directory.
diff --git a/gcc/libgcc/config/aarch64/t-lse b/gcc/libgcc/config/aarch64/t-lse
index 624daf7edd..7a488c7b92 100644
--- a/gcc/libgcc/config/aarch64/t-lse
+++ b/gcc/libgcc/config/aarch64/t-lse
@@ -38,7 +38,17 @@ PAT_N      = $(word 2,$(PAT_SPLIT))
 PAT_M      = $(word 3,$(PAT_SPLIT))
 
 lse-init$(objext): $(srcdir)/config/aarch64/lse-init.c
-	$(gcc_compile) -c $<
+	$(gcc_compile) -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 $(LSE_OBJS): $(srcdir)/config/aarch64/lse.S
-	$(gcc_compile) -DL_$(PAT_BASE) -DSIZE=$(PAT_N) -DMODEL=$(PAT_M) -c $<
+	$(gcc_compile) -DL_$(PAT_BASE) -DSIZE=$(PAT_N) -DMODEL=$(PAT_M) -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
diff --git a/gcc/libgcc/config/alpha/t-vms b/gcc/libgcc/config/alpha/t-vms
index 870e44c8dd..c030804d7a 100644
--- a/gcc/libgcc/config/alpha/t-vms
+++ b/gcc/libgcc/config/alpha/t-vms
@@ -1,10 +1,20 @@
 # This object must be linked with in order to make the executable debuggable.
 # vms-ld handles it automatically when passed -g.
 vms-dwarf2.o: $(srcdir)/config/alpha/vms-dwarf2.S
-	$(gcc_compile) -c -x assembler-with-cpp $<
+	$(gcc_compile) -c -x assembler-with-cpp $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 vms-dwarf2eh.o: $(srcdir)/config/alpha/vms-dwarf2eh.S
-	$(gcc_compile) -c -x assembler-with-cpp $<
+	$(gcc_compile) -c -x assembler-with-cpp $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 LIB2ADD += $(srcdir)/config/alpha/vms-gcc_shell_handler.c
 
diff --git a/gcc/libgcc/config/arc/t-arc b/gcc/libgcc/config/arc/t-arc
index f9e463a3d8..a98946291b 100644
--- a/gcc/libgcc/config/arc/t-arc
+++ b/gcc/libgcc/config/arc/t-arc
@@ -62,4 +62,9 @@ fp-bit.c: $(srcdir)/fp-bit.c
 # .init/.fini section routines
 
 crttls.o: $(srcdir)/config/arc/crttls.S
-	$(crt_compile) -c -x assembler-with-cpp $<
+	$(crt_compile) -c -x assembler-with-cpp $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
diff --git a/gcc/libgcc/config/arm/t-arm b/gcc/libgcc/config/arm/t-arm
index c1553d4e5d..82fae155d2 100644
--- a/gcc/libgcc/config/arm/t-arm
+++ b/gcc/libgcc/config/arm/t-arm
@@ -12,8 +12,18 @@ ifdef HAVE_CMSE
 libgcc-objects += cmse.o cmse_nonsecure_call.o
 
 cmse.o: $(srcdir)/config/arm/cmse.c
-	$(gcc_compile) -c $(CMSE_OPTS) $<
+	$(gcc_compile) -c $(CMSE_OPTS) $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 cmse_nonsecure_call.o: $(srcdir)/config/arm/cmse_nonsecure_call.S
-		       $(gcc_compile) -c $<
+		       $(gcc_compile) -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+		       | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+		         while IFS= read -r line; \
+		         do \
+		           sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+		         done) && mv $(dep_filename).bak $(dep_filename)
 endif
diff --git a/gcc/libgcc/config/avr/lib2-object.mk b/gcc/libgcc/config/avr/lib2-object.mk
index 6a9e04de0f..54e5dfbbc4 100644
--- a/gcc/libgcc/config/avr/lib2-object.mk
+++ b/gcc/libgcc/config/avr/lib2-object.mk
@@ -14,10 +14,20 @@ iter-flags := $(wordlist 2,$(words $(iter-flags)),$(iter-flags))
 
 $o$(objext): %$(objext): $(srcdir)/config/avr/lib2funcs.c
 	$(gcc_compile) -DL_$($*-label) -DL_LABEL=$($*-label) $($*-flag) \
-		-c $< $(vis_hide)
+		-c $< $(vis_hide) && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+		| egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+			while IFS= read -r line; \
+			do \
+				sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+			done) && mv $(dep_filename).bak $(dep_filename)
 
 ifeq ($(enable_shared),yes)
 $(o)_s$(objext): %_s$(objext): $(srcdir)/config/avr/lib2funcs.c
 	$(gcc_s_compile) -DL_$($*-label) -DL_LABEL=$($*-label) $($*-flag) \
-		-c $<
+		-c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+		| egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+			while IFS= read -r line; \
+			do \
+				sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+			done) && mv $(dep_filename).bak $(dep_filename)
 endif
diff --git a/gcc/libgcc/config/avr/libf7/libf7-asm-object.mk b/gcc/libgcc/config/avr/libf7/libf7-asm-object.mk
index c577512a26..587da20b27 100644
--- a/gcc/libgcc/config/avr/libf7/libf7-asm-object.mk
+++ b/gcc/libgcc/config/avr/libf7/libf7-asm-object.mk
@@ -11,10 +11,20 @@ iter-labels := $(wordlist 2,$(words $(iter-labels)),$(iter-labels))
 
 f7_asm_$o$(objext): f7_asm_%$(objext): $(libf7)/libf7-asm.sx
 	$(gcc_compile) -DF7MOD_$($*-label)_ $(F7_ASM_FLAGS) \
-		-c $<
+		-c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+			| egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+			while IFS= read -r line; \
+			do \
+				sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+			done) && mv $(dep_filename).bak $(dep_filename)
 
 ifeq ($(enable_shared),yes)
 f7_asm_$(o)_s$(objext): f7_asm_%_s$(objext): $(libf7)/libf7-asm.sx
 	$(gcc_s_compile) -DF7MOD_$($*-label)_ $(F7_ASM_FLAGS) \
-		-c $<
+		-c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+		| egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+			while IFS= read -r line; \
+			do \
+				sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+			done) && mv $(dep_filename).bak $(dep_filename)
 endif
diff --git a/gcc/libgcc/config/avr/libf7/libf7-c-object.mk b/gcc/libgcc/config/avr/libf7/libf7-c-object.mk
index 0424cba95f..e20f661135 100644
--- a/gcc/libgcc/config/avr/libf7/libf7-c-object.mk
+++ b/gcc/libgcc/config/avr/libf7/libf7-c-object.mk
@@ -11,10 +11,20 @@ iter-labels := $(wordlist 2,$(words $(iter-labels)),$(iter-labels))
 
 f7_c_$o$(objext): f7_c_%$(objext): $(libf7)/libf7.c
 	$(gcc_compile) -DF7MOD_$($*-label)_ $(F7_C_FLAGS) \
-		-c $<
+		-c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+		| egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+			while IFS= read -r line; \
+			do \
+				sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+			done) && mv $(dep_filename).bak $(dep_filename)
 
 ifeq ($(enable_shared),yes)
 f7_c_$(o)_s$(objext): %_s$(objext): $(libf7)/libf7.c
 	$(gcc_s_compile) -DF7MOD_$($*-label)_ $(F7_C_FLAGS) \
-		-c $<
+		-c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+		| egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+			while IFS= read -r line; \
+			do \
+				sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+			done) && mv $(dep_filename).bak $(dep_filename)
 endif
diff --git a/gcc/libgcc/config/bfin/t-crtlibid b/gcc/libgcc/config/bfin/t-crtlibid
index b0c93e71eb..10345aa00e 100644
--- a/gcc/libgcc/config/bfin/t-crtlibid
+++ b/gcc/libgcc/config/bfin/t-crtlibid
@@ -1,3 +1,8 @@
 # Assemble startup files.
 crtlibid.o: $(srcdir)/config/bfin/crtlibid.S
-	$(gcc_compile) -c -x assembler-with-cpp $<
+	$(gcc_compile) -c -x assembler-with-cpp $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
diff --git a/gcc/libgcc/config/bpf/t-bpf b/gcc/libgcc/config/bpf/t-bpf
index 88129a78f6..f46f6ec7b9 100644
--- a/gcc/libgcc/config/bpf/t-bpf
+++ b/gcc/libgcc/config/bpf/t-bpf
@@ -1,10 +1,20 @@
 LIB2ADDEH = 
 
 crti.o: $(srcdir)/config/bpf/crti.S
-	$(crt_compile) $(CRTSTUFF_T_CFLAGS) -c $<
+	$(crt_compile) $(CRTSTUFF_T_CFLAGS) -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 crtn.o: $(srcdir)/config/bpf/crtn.S
-	$(crt_compile) $(CRTSTUFF_T_CFLAGS) -c $<
+	$(crt_compile) $(CRTSTUFF_T_CFLAGS) -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 # Some of the functions defined in libgcc2 exceed the eBPF stack
 # limit, or other restrictions imposed by this peculiar target.
diff --git a/gcc/libgcc/config/c6x/t-elf b/gcc/libgcc/config/c6x/t-elf
index 338571d1b6..a20d6bb4b9 100644
--- a/gcc/libgcc/config/c6x/t-elf
+++ b/gcc/libgcc/config/c6x/t-elf
@@ -28,10 +28,20 @@ LIB2ADDEH = $(srcdir)/config/c6x/unwind-c6x.c \
 
 # Assemble startup files.
 crti.o: $(srcdir)/config/c6x/crti.S
-	$(crt_compile) -c $(CRTSTUFF_T_CFLAGS) $<
+	$(crt_compile) -c $(CRTSTUFF_T_CFLAGS) $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 crtn.o: $(srcdir)/config/c6x/crtn.S
-	$(crt_compile) -c $(CRTSTUFF_T_CFLAGS) $<
+	$(crt_compile) -c $(CRTSTUFF_T_CFLAGS) $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 # Avoid failures when the user's GOT becomes too large.
 CRTSTUFF_T_CFLAGS = -msdata=none
diff --git a/gcc/libgcc/config/cr16/t-crtlibid b/gcc/libgcc/config/cr16/t-crtlibid
index 86cc5c6340..08d8940a43 100644
--- a/gcc/libgcc/config/cr16/t-crtlibid
+++ b/gcc/libgcc/config/cr16/t-crtlibid
@@ -19,4 +19,9 @@
 
 # Assemble startup files.
 crtlibid.o: $(srcdir)/config/cr16/crtlibid.S
-	$(gcc_compile) -c -x assembler-with-cpp $<
+	$(gcc_compile) -c -x assembler-with-cpp $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
diff --git a/gcc/libgcc/config/epiphany/t-epiphany b/gcc/libgcc/config/epiphany/t-epiphany
index 1232cdc857..56b536194d 100644
--- a/gcc/libgcc/config/epiphany/t-epiphany
+++ b/gcc/libgcc/config/epiphany/t-epiphany
@@ -31,4 +31,9 @@ LIB2ADD_ST = $(srcdir)/config/epiphany/modsi3-float.S \
 
 crtint.o crtrunc.o crtm1reg-r43.o crtm1reg-r63.o : \
   %.o: $(srcdir)/config/epiphany/%.S $(GCC_PASSES) $(CONFIG_H)
-	$(crt_compile) -c -x assembler-with-cpp $<
+	$(crt_compile) -c -x assembler-with-cpp $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
diff --git a/gcc/libgcc/config/frv/t-frv b/gcc/libgcc/config/frv/t-frv
index a4ff058518..ad1d7fec94 100644
--- a/gcc/libgcc/config/frv/t-frv
+++ b/gcc/libgcc/config/frv/t-frv
@@ -16,7 +16,17 @@ LIB2ADD	= $(srcdir)/config/frv/cmovh.c \
 # constructors.
 
 frvbegin$(objext): $(srcdir)/config/frv/frvbegin.c
-	$(gcc_compile) -c $<
+	$(gcc_compile) -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 frvend$(objext): $(srcdir)/config/frv/frvend.c
-	$(gcc_compile) -c $<
+	$(gcc_compile) -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
diff --git a/gcc/libgcc/config/ft32/t-ft32 b/gcc/libgcc/config/ft32/t-ft32
index 33f26dbdc7..537520822d 100644
--- a/gcc/libgcc/config/ft32/t-ft32
+++ b/gcc/libgcc/config/ft32/t-ft32
@@ -5,4 +5,9 @@ LIB1ASMFUNCS = \
 LIB2ADD = $(srcdir)/config/ft32/epilog.S $(srcdir)/config/ft32/prolog.S
 
 crti-hw.o: $(srcdir)/config/ft32/crti-hw.S
-	$(crt_compile) -c -x assembler-with-cpp $<
+	$(crt_compile) -c -x assembler-with-cpp $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
diff --git a/gcc/libgcc/config/gcn/t-amdgcn b/gcc/libgcc/config/gcn/t-amdgcn
index 38bde54a09..94b3de5a31 100644
--- a/gcc/libgcc/config/gcn/t-amdgcn
+++ b/gcc/libgcc/config/gcn/t-amdgcn
@@ -14,7 +14,12 @@ override LIB2FUNCS_ST := $(filter-out __gcc_bcmp,$(LIB2FUNCS_ST))
 LIBGCC2_DEBUG_CFLAGS = -g0
 
 crt0.o: $(srcdir)/config/gcn/crt0.c
-	$(crt_compile) -c $<
+	$(crt_compile) -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 # Prevent building "advanced" stuff (for example, gcov support).
 INHIBIT_LIBC_CFLAGS = -Dinhibit_libc
diff --git a/gcc/libgcc/config/i386/t-crtpc b/gcc/libgcc/config/i386/t-crtpc
index b605f6f793..7cc0e32844 100644
--- a/gcc/libgcc/config/i386/t-crtpc
+++ b/gcc/libgcc/config/i386/t-crtpc
@@ -1,8 +1,23 @@
 crtprec32.o: $(srcdir)/config/i386/crtprec.c
-	$(gcc_compile) -D__PREC=32 -c $<
+	$(gcc_compile) -D__PREC=32 -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 crtprec64.o: $(srcdir)/config/i386/crtprec.c
-	$(gcc_compile) -D__PREC=64 -c $<
+	$(gcc_compile) -D__PREC=64 -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 crtprec80.o: $(srcdir)/config/i386/crtprec.c
-	$(gcc_compile) -D__PREC=80 -c $<
+	$(gcc_compile) -D__PREC=80 -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
diff --git a/gcc/libgcc/config/i386/t-cygming b/gcc/libgcc/config/i386/t-cygming
index 4713b7f696..09579eda4f 100644
--- a/gcc/libgcc/config/i386/t-cygming
+++ b/gcc/libgcc/config/i386/t-cygming
@@ -6,12 +6,27 @@ LIBGCC2_INCLUDES = -I$(srcdir)/../winsup/w32api/include
 CUSTOM_CRTSTUFF = yes
 
 crtbegin.o: $(srcdir)/config/i386/cygming-crtbegin.c
-	$(crt_compile) -fno-omit-frame-pointer  -c $<
+	$(crt_compile) -fno-omit-frame-pointer  -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 crtbeginS.o: $(srcdir)/config/i386/cygming-crtbegin.c
-	$(crt_compile) -fno-omit-frame-pointer  -c $< -DCRTSTUFFS_O
+	$(crt_compile) -fno-omit-frame-pointer  -c $< -DCRTSTUFFS_O && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 # We intentionally use a implementation-reserved init priority of 0,
 # so allow the warning.
 crtend.o: $(srcdir)/config/i386/cygming-crtend.c
-	$(crt_compile) -fno-omit-frame-pointer -Wno-error -c $<
+	$(crt_compile) -fno-omit-frame-pointer -Wno-error -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
diff --git a/gcc/libgcc/config/ia64/t-vms b/gcc/libgcc/config/ia64/t-vms
index e95c58d8b5..da3e0b7970 100644
--- a/gcc/libgcc/config/ia64/t-vms
+++ b/gcc/libgcc/config/ia64/t-vms
@@ -2,7 +2,12 @@ CRTSTUFF_T_CFLAGS = -O0
 CRTSTUFF_T_CFLAGS_S = -O0
 
 crtinitS.o: $(srcdir)/config/ia64/vms-crtinit.S
-	$(gcc_compile) -c -x assembler-with-cpp $<
+	$(gcc_compile) -c -x assembler-with-cpp $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 LIB2ADDEH += $(srcdir)/config/ia64/fde-vms.c
 
diff --git a/gcc/libgcc/config/m32r/t-m32r b/gcc/libgcc/config/m32r/t-m32r
index 861044b15b..8196fbe3ed 100644
--- a/gcc/libgcc/config/m32r/t-m32r
+++ b/gcc/libgcc/config/m32r/t-m32r
@@ -15,9 +15,19 @@ CRTSTUFF_T_CFLAGS =
 crtinit.o: $(srcdir)/config/m32r/initfini.c
 	$(crt_compile) $(CRTSTUFF_T_CFLAGS) -DCRT_INIT \
 	-finhibit-size-directive -fno-inline-functions -g0 \
-	-mmodel=medium -c $<
+	-mmodel=medium -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 crtfini.o: $(srcdir)/config/m32r/initfini.c
 	$(crt_compile) $(CRTSTUFF_T_CFLAGS) -DCRT_FINI \
 	-finhibit-size-directive -fno-inline-functions -g0 \
-	-mmodel=medium -c $<
+	-mmodel=medium -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
diff --git a/gcc/libgcc/config/mmix/t-mmix b/gcc/libgcc/config/mmix/t-mmix
index 2ee4f001ad..ee64712f1b 100644
--- a/gcc/libgcc/config/mmix/t-mmix
+++ b/gcc/libgcc/config/mmix/t-mmix
@@ -16,7 +16,17 @@ CRTSTUFF_T_CFLAGS = -Wa,--no-stubs
 CUSTOM_CRTIN = yes
 
 crti.o: $(srcdir)/config/mmix/crti.S
-	$(crt_compile) $(CRTSTUFF_T_CFLAGS) -c $<
+	$(crt_compile) $(CRTSTUFF_T_CFLAGS) -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 crtn.o: $(srcdir)/config/mmix/crtn.S
-	$(crt_compile) $(CRTSTUFF_T_CFLAGS) -c $<
+	$(crt_compile) $(CRTSTUFF_T_CFLAGS) -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
diff --git a/gcc/libgcc/config/msp430/t-msp430 b/gcc/libgcc/config/msp430/t-msp430
index 599997b2b9..134458fcf8 100644
--- a/gcc/libgcc/config/msp430/t-msp430
+++ b/gcc/libgcc/config/msp430/t-msp430
@@ -48,28 +48,68 @@ LIB2FUNCS_EXCLUDE += _muldi3
 HOST_LIBGCC2_CFLAGS += -Os -ffunction-sections -fdata-sections -mhwmult=none
 
 crtbegin_no_eh.o: $(srcdir)/crtstuff.c
-	$(crt_compile) -U__LIBGCC_EH_FRAME_SECTION_NAME__ -c $< -DCRT_BEGIN
+	$(crt_compile) -U__LIBGCC_EH_FRAME_SECTION_NAME__ -c $< -DCRT_BEGIN && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 crtend_no_eh.o: $(srcdir)/crtstuff.c
-	$(crt_compile) -U__LIBGCC_EH_FRAME_SECTION_NAME__ -c $< -DCRT_END
+	$(crt_compile) -U__LIBGCC_EH_FRAME_SECTION_NAME__ -c $< -DCRT_END && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 mpy.o: $(srcdir)/config/msp430/mpy.c
-	$(gcc_compile) $< -c
+	$(gcc_compile) $< -c && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 lib2_mul_none.o: $(srcdir)/config/msp430/lib2mul.c
-	$(gcc_compile) $< -c -DMUL_NONE
+	$(gcc_compile) $< -c -DMUL_NONE && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 lib2_mul_16bit.o: $(srcdir)/config/msp430/lib2mul.c
-	$(gcc_compile) $< -c -DMUL_16
+	$(gcc_compile) $< -c -DMUL_16 && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 lib2hw_mul_16.o: $(srcdir)/config/msp430/lib2hw_mul.S
-	$(gcc_compile) $< -c -DMUL_16
+	$(gcc_compile) $< -c -DMUL_16 && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 lib2hw_mul_32.o: $(srcdir)/config/msp430/lib2hw_mul.S
-	$(gcc_compile) $< -c -DMUL_32
+	$(gcc_compile) $< -c -DMUL_32 && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 lib2hw_mul_f5.o: $(srcdir)/config/msp430/lib2hw_mul.S
-	$(gcc_compile) $< -c -DMUL_F5
+	$(gcc_compile) $< -c -DMUL_F5 && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 libmul_none.a: lib2_mul_none.o mpy.o
 	$(AR_CREATE_FOR_TARGET) $@ $(filter %.o,$^)
diff --git a/gcc/libgcc/config/nvptx/t-nvptx b/gcc/libgcc/config/nvptx/t-nvptx
index ede0bf0f87..5610230294 100644
--- a/gcc/libgcc/config/nvptx/t-nvptx
+++ b/gcc/libgcc/config/nvptx/t-nvptx
@@ -6,7 +6,12 @@ LIB2ADDEH=
 LIB2FUNCS_EXCLUDE=__main
 
 crt0.o: $(srcdir)/config/nvptx/crt0.c
-	$(crt_compile) -c $<
+	$(crt_compile) -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 # Prevent building "advanced" stuff (for example, gcov support).  We don't
 # support it, and it may cause the build to fail, because of alloca usage, for
diff --git a/gcc/libgcc/config/pa/t-dimode b/gcc/libgcc/config/pa/t-dimode
index 19252a6e6b..31742235bb 100644
--- a/gcc/libgcc/config/pa/t-dimode
+++ b/gcc/libgcc/config/pa/t-dimode
@@ -4,13 +4,23 @@ lib2difuncs = _muldi3 _negdi2 _lshrdi3 _ashldi3 _ashrdi3 _cmpdi2 _ucmpdi2
 # Build lib2difuncs.
 lib2difuncs-o = $(patsubst %,%_di$(objext),$(lib2difuncs))
 $(lib2difuncs-o): %_di$(objext): $(srcdir)/libgcc2.c
-	$(gcc_compile) -DLIBGCC2_UNITS_PER_WORD=4 -DL$* -c $< $(vis_hide)
+	$(gcc_compile) -DLIBGCC2_UNITS_PER_WORD=4 -DL$* -c $< $(vis_hide) && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 libgcc-objects += $(lib2difuncs-o)
 
 ifeq ($(enable_shared),yes)
 lib2difuncs-s-o = $(patsubst %,%_di_s$(objext),$(lib2difuncs))
 $(lib2difuncs-s-o): %_di_s$(objext): $(srcdir)/libgcc2.c
-	$(gcc_s_compile) -DLIBGCC2_UNITS_PER_WORD=4 -DL$* -c $<
+	$(gcc_s_compile) -DLIBGCC2_UNITS_PER_WORD=4 -DL$* -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 libgcc-s-objects += $(lib2difuncs-s-o)
 endif
 
@@ -21,13 +31,23 @@ lib2didivmodfuncs = _divdi3 _moddi3 _udivdi3 _umoddi3
 lib2didivmod-o = $(patsubst %,%_di$(objext),$(lib2didivmodfuncs))
 $(lib2didivmod-o): %_di$(objext): $(srcdir)/libgcc2.c
 	$(gcc_compile) -DLIBGCC2_UNITS_PER_WORD=4 -DL$* -c $< \
-	  $(LIB2_DIVMOD_EXCEPTION_FLAGS) $(vis_hide)
+	  $(LIB2_DIVMOD_EXCEPTION_FLAGS) $(vis_hide) && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 libgcc-objects += $(lib2didivmod-o)
 
 ifeq ($(enable_shared),yes)
 lib2didivmod-s-o = $(patsubst %,%_di_s$(objext),$(lib2didivmodfuncs))
 $(lib2didivmod-s-o): %_di_s$(objext): $(srcdir)/libgcc2.c
 	$(gcc_s_compile) -DLIBGCC2_UNITS_PER_WORD=4 -DL$* -c $< \
-	  $(LIB2_DIVMOD_EXCEPTION_FLAGS)
+	  $(LIB2_DIVMOD_EXCEPTION_FLAGS) && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 libgcc-s-objects += $(lib2didivmod-s-o)
 endif
diff --git a/gcc/libgcc/config/pa/t-stublib b/gcc/libgcc/config/pa/t-stublib
index 8004c1e46a..e571c729fe 100644
--- a/gcc/libgcc/config/pa/t-stublib
+++ b/gcc/libgcc/config/pa/t-stublib
@@ -6,34 +6,84 @@ LIBGCCSTUB_OBJS = rfi-stub.o dfi-stub.o ritm-stub.o ditm-stub.o \
 	pthread_once-stub.o
 
 rfi-stub.o: $(srcdir)/config/pa/stublib.c
-	$(gcc_compile) -c -O2 -DL_register_frame_info $<
+	$(gcc_compile) -c -O2 -DL_register_frame_info $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 dfi-stub.o: $(srcdir)/config/pa/stublib.c
-	$(gcc_compile) -c -O2 -DL_deregister_frame_info $<
+	$(gcc_compile) -c -O2 -DL_deregister_frame_info $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 ritm-stub.o: $(srcdir)/config/pa/stublib.c
-	$(gcc_compile) -c -O2 -DL_ITM_registerTMCloneTable $<
+	$(gcc_compile) -c -O2 -DL_ITM_registerTMCloneTable $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 ditm-stub.o: $(srcdir)/config/pa/stublib.c
-	$(gcc_compile) -c -O2 -DL_ITM_deregisterTMCloneTable $<
+	$(gcc_compile) -c -O2 -DL_ITM_deregisterTMCloneTable $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 cxaf-stub.o: $(srcdir)/config/pa/stublib.c
-	$(gcc_compile) -c -O2 -DL_cxa_finalize $<
+	$(gcc_compile) -c -O2 -DL_cxa_finalize $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 jvrc-stub.o: $(srcdir)/config/pa/stublib.c
-	$(gcc_compile) -c -O2 -DL_Jv_RegisterClasses $<
+	$(gcc_compile) -c -O2 -DL_Jv_RegisterClasses $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 pthread_default_stacksize_np-stub.o: $(srcdir)/config/pa/stublib.c
-	$(gcc_compile) -c -O2 -DL_pthread_default_stacksize_np $<
+	$(gcc_compile) -c -O2 -DL_pthread_default_stacksize_np $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 pthread_mutex_lock-stub.o: $(srcdir)/config/pa/stublib.c
-	$(gcc_compile) -c -O2 -DL_pthread_mutex_lock $<
+	$(gcc_compile) -c -O2 -DL_pthread_mutex_lock $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 pthread_mutex_unlock-stub.o: $(srcdir)/config/pa/stublib.c
-	$(gcc_compile) -c -O2 -DL_pthread_mutex_unlock $<
+	$(gcc_compile) -c -O2 -DL_pthread_mutex_unlock $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 pthread_once-stub.o: $(srcdir)/config/pa/stublib.c
-	$(gcc_compile) -c -O2 -DL_pthread_once $<
+	$(gcc_compile) -c -O2 -DL_pthread_once $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 libgcc_stub.a: $(LIBGCCSTUB_OBJS)
 	-rm -rf $@
diff --git a/gcc/libgcc/config/rs6000/t-aix-cxa b/gcc/libgcc/config/rs6000/t-aix-cxa
index 0e1bccb152..8f7e744457 100644
--- a/gcc/libgcc/config/rs6000/t-aix-cxa
+++ b/gcc/libgcc/config/rs6000/t-aix-cxa
@@ -8,19 +8,49 @@ LIB2ADD_ST += $(srcdir)/config/rs6000/aixinitfini.c
 SHLIB_MAPFILES += $(srcdir)/config/rs6000/libgcc-aix-cxa.ver
 
 crtdbase.o: $(srcdir)/config/rs6000/crtdbase.S
-	$(crt_compile) -maix32 -c $<
+	$(crt_compile) -maix32 -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 crtcxa.o: $(srcdir)/config/rs6000/crtcxa.c
-	$(crt_compile) -maix32 -c $<
+	$(crt_compile) -maix32 -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 crtcxa_s.o: $(srcdir)/config/rs6000/crtcxa.c
-	$(crt_compile) -maix32 -DSHARED -c $<
+	$(crt_compile) -maix32 -DSHARED -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 crtdbase_64.o: $(srcdir)/config/rs6000/crtdbase.S
-	$(crt_compile) -maix64 -c $<
+	$(crt_compile) -maix64 -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 crtcxa_64.o: $(srcdir)/config/rs6000/crtcxa.c
-	$(crt_compile) -maix64 -c $<
+	$(crt_compile) -maix64 -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 crtcxa_64_s.o: $(srcdir)/config/rs6000/crtcxa.c
-	$(crt_compile) -maix64 -DSHARED -c $<
+	$(crt_compile) -maix64 -DSHARED -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
diff --git a/gcc/libgcc/config/rs6000/t-darwin b/gcc/libgcc/config/rs6000/t-darwin
index 183d0df92c..f82260f987 100644
--- a/gcc/libgcc/config/rs6000/t-darwin
+++ b/gcc/libgcc/config/rs6000/t-darwin
@@ -1,11 +1,21 @@
 
 crt2.o: $(srcdir)/config/rs6000/darwin-crt2.c
-	$(crt_compile) -mmacosx-version-min=10.1 -c $<
+	$(crt_compile) -mmacosx-version-min=10.1 -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 # The sources for this indicate that there are some parts that
 # don't apply >= 10.4
 crt3_2.o: $(srcdir)/config/darwin-crt3.c
-	$(crt_compile) -mmacosx-version-min=10.1 -c $<
+	$(crt_compile) -mmacosx-version-min=10.1 -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 # The outlined register save/restore functions need to run anywhere, and
 # they must be leaf functions suitable for use in an endfile.
@@ -21,13 +31,28 @@ PPC_ENDFILE_OBJS = \
  darwin-vecsave.o
 
 darwin-gpsave.o: $(srcdir)/config/rs6000/darwin-gpsave.S
-	$(crt_compile) -mmacosx-version-min=10.1 -c $<
+	$(crt_compile) -mmacosx-version-min=10.1 -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 darwin-fpsave.o: $(srcdir)/config/rs6000/darwin-fpsave.S
-	$(crt_compile) -mmacosx-version-min=10.1 -c $<
+	$(crt_compile) -mmacosx-version-min=10.1 -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 darwin-vecsave.o: $(srcdir)/config/rs6000/darwin-vecsave.S
-	$(crt_compile) -mmacosx-version-min=10.1 -c $<
+	$(crt_compile) -mmacosx-version-min=10.1 -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 # We build these into a library, so that they are only linked as needed and not
 # forced into every object.
@@ -37,7 +62,12 @@ libef_ppc.a: $(PPC_ENDFILE_OBJS)
 	$(RANLIB_FOR_TARGET) $@
 
 dw_ppc.o: $(srcdir)/config/rs6000/darwin-world.S
-	$(crt_compile) -mmacosx-version-min=10.1 -c $<
+	$(crt_compile) -mmacosx-version-min=10.1 -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 LIB2ADD = $(srcdir)/config/rs6000/darwin-tramp.S \
 	  $(srcdir)/config/darwin-64.c \
diff --git a/gcc/libgcc/config/rs6000/t-ppccomm b/gcc/libgcc/config/rs6000/t-ppccomm
index fb812d3801..397b354d89 100644
--- a/gcc/libgcc/config/rs6000/t-ppccomm
+++ b/gcc/libgcc/config/rs6000/t-ppccomm
@@ -10,13 +10,33 @@ LIB2ADD_ST += \
 
 # Assemble startup files.
 ecrti$(objext): $(srcdir)/config/rs6000/eabi-ci.S
-	$(crt_compile) -c $<
+	$(crt_compile) -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 ecrtn$(objext): $(srcdir)/config/rs6000/eabi-cn.S
-	$(crt_compile) -c $<
+	$(crt_compile) -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 ncrti$(objext): $(srcdir)/config/rs6000/sol-ci.S
-	$(crt_compile) -c $<
+	$(crt_compile) -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 ncrtn$(objext): $(srcdir)/config/rs6000/sol-cn.S
-	$(crt_compile) -c $<
+	$(crt_compile) -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
diff --git a/gcc/libgcc/config/rs6000/t-slibgcc-aix b/gcc/libgcc/config/rs6000/t-slibgcc-aix
index 81b53a075a..e6ea8976da 100644
--- a/gcc/libgcc/config/rs6000/t-slibgcc-aix
+++ b/gcc/libgcc/config/rs6000/t-slibgcc-aix
@@ -90,7 +90,7 @@ AR_FLAGS_FOR_TARGET = -X32_64
 
 # Build and install AIX-style FAT libraries
 ifeq ($(MULTIBUILDTOP),)
-BITS=$(shell if test -z "`$(CC) -x c -E /dev/null -g3 -o - | grep 64BIT`" ; then \
+BITS=$(shell if test -z "`$(CC) -x c -E /dev/null -g3 -o - | sed -e 's/\r//g' | grep 64BIT`" ; then \
     echo '64'; else echo '32'; fi)
 ARX=$(shell echo $(AR) | sed -e 's/-X[^ ]*//g')
 all: all-multi
diff --git a/gcc/libgcc/config/sh/t-sh b/gcc/libgcc/config/sh/t-sh
index 910b9c23b2..3762f5753c 100644
--- a/gcc/libgcc/config/sh/t-sh
+++ b/gcc/libgcc/config/sh/t-sh
@@ -24,36 +24,76 @@ LIB1ASMFUNCS = _ashiftrt _ashiftrt_n _ashiftlt _lshiftrt _movmem \
 LIB1ASMFUNCS_CACHE = _ic_invalidate _ic_invalidate_array
 
 crt1.o: $(srcdir)/config/sh/crt1.S
-	$(gcc_compile) -c $<
+	$(gcc_compile) -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 ic_invalidate_array_4-100.o: $(srcdir)/config/sh/lib1funcs.S
-	$(gcc_compile) -c -DL_ic_invalidate_array -DWAYS=1 -DWAY_SIZE=0x2000 $<
+	$(gcc_compile) -c -DL_ic_invalidate_array -DWAYS=1 -DWAY_SIZE=0x2000 $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 libic_invalidate_array_4-100.a: ic_invalidate_array_4-100.o
 	$(AR_CREATE_FOR_TARGET) $@ $<
 
 ic_invalidate_array_4-200.o: $(srcdir)/config/sh/lib1funcs.S
-	$(gcc_compile) -c -DL_ic_invalidate_array -DWAYS=2 -DWAY_SIZE=0x2000 $<
+	$(gcc_compile) -c -DL_ic_invalidate_array -DWAYS=2 -DWAY_SIZE=0x2000 $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 libic_invalidate_array_4-200.a: ic_invalidate_array_4-200.o
 	$(AR_CREATE_FOR_TARGET) $@ $<
 
 ic_invalidate_array_4a.o: $(srcdir)/config/sh/lib1funcs.S
-	$(gcc_compile) -c -DL_ic_invalidate_array -D__FORCE_SH4A__ $<
+	$(gcc_compile) -c -DL_ic_invalidate_array -D__FORCE_SH4A__ $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 libic_invalidate_array_4a.a: ic_invalidate_array_4a.o
 	$(AR_CREATE_FOR_TARGET) $@ $<
 
 sdivsi3_i4i-Os-4-200.o: $(srcdir)/config/sh/lib1funcs-Os-4-200.S
-	$(gcc_compile) -c -DL_sdivsi3_i4i $<
+	$(gcc_compile) -c -DL_sdivsi3_i4i $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 udivsi3_i4i-Os-4-200.o: $(srcdir)/config/sh/lib1funcs-Os-4-200.S
-	$(gcc_compile) -c -DL_udivsi3_i4i $<
+	$(gcc_compile) -c -DL_udivsi3_i4i $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 unwind-dw2-Os-4-200.o: $(srcdir)/unwind-dw2.c $(LIBGCC_LINKS)
-	$(gcc_compile) $(LIBGCC2_CFLAGS) $(vis_hide) -fexceptions -Os -c $<
+	$(gcc_compile) $(LIBGCC2_CFLAGS) $(vis_hide) -fexceptions -Os -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 OBJS_Os_4_200=sdivsi3_i4i-Os-4-200.o udivsi3_i4i-Os-4-200.o unwind-dw2-Os-4-200.o
 libgcc-Os-4-200.a: $(OBJS_Os_4_200)
 	$(AR_CREATE_FOR_TARGET) $@ $(OBJS_Os_4_200)
 
 div_table-4-300.o: $(srcdir)/config/sh/lib1funcs-4-300.S
-	$(gcc_compile) -c -DL_div_table $<
+	$(gcc_compile) -c -DL_div_table $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 libgcc-4-300.a: div_table-4-300.o
 	$(AR_CREATE_FOR_TARGET) $@ div_table-4-300.o
diff --git a/gcc/libgcc/config/sh/t-superh b/gcc/libgcc/config/sh/t-superh
index b87aa5a316..669441b878 100644
--- a/gcc/libgcc/config/sh/t-superh
+++ b/gcc/libgcc/config/sh/t-superh
@@ -1,11 +1,26 @@
 # Compile crt1-mmu.o as crt1.o with -DMMU_SUPPORT
 crt1-mmu.o: $(srcdir)/config/sh/crt1.S
-	$(gcc_compile) -c -DMMU_SUPPORT $<
+	$(gcc_compile) -c -DMMU_SUPPORT $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 # Compile gcrt1-mmu.o as crt1-mmu.o with -DPROFILE
 gcrt1-mmu.o: $(srcdir)/config/sh/crt1.S
-	$(gcc_compile) -c -DPROFILE -DMMU_SUPPORT $<
+	$(gcc_compile) -c -DPROFILE -DMMU_SUPPORT $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 # For sh4-400: Compile gcrt1.o as crt1.o with -DPROFILE
 gcrt1.o: $(srcdir)/config/sh/crt1.S
-	$(gcc_compile) -c -DPROFILE $<
+	$(gcc_compile) -c -DPROFILE $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
diff --git a/gcc/libgcc/config/sol2/t-sol2 b/gcc/libgcc/config/sol2/t-sol2
index b2ab11583b..a8c5a9f1eb 100644
--- a/gcc/libgcc/config/sol2/t-sol2
+++ b/gcc/libgcc/config/sol2/t-sol2
@@ -18,16 +18,41 @@
 
 # crtp, crtpg build rules
 crtp.o: $(srcdir)/config/sol2/crtp.c
-	$(crt_compile) $(CRTSTUFF_T_CFLAGS_S) -c $<
+	$(crt_compile) $(CRTSTUFF_T_CFLAGS_S) -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 crtpg.o: $(srcdir)/config/sol2/crtpg.c
-	$(crt_compile) $(CRTSTUFF_T_CFLAGS_S) -c $<
+	$(crt_compile) $(CRTSTUFF_T_CFLAGS_S) -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 # gmon build rule
 gmon.o:	$(srcdir)/config/sol2/gmon.c
-	$(crt_compile) $(CRTSTUFF_T_CFLAGS_S) -c $<
+	$(crt_compile) $(CRTSTUFF_T_CFLAGS_S) -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 # Assemble startup files.
 crt1.o: $(srcdir)/config/$(cpu_type)/sol2-c1.S
-	$(crt_compile) -c $<
+	$(crt_compile) -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 gcrt1.o: $(srcdir)/config/$(cpu_type)/sol2-c1.S
-	$(crt_compile) -c -DGCRT1 $<
+	$(crt_compile) -c -DGCRT1 $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
diff --git a/gcc/libgcc/config/t-crtfm b/gcc/libgcc/config/t-crtfm
index 61e62696bf..e2f077a0e6 100644
--- a/gcc/libgcc/config/t-crtfm
+++ b/gcc/libgcc/config/t-crtfm
@@ -1,2 +1,7 @@
 crtfastmath.o: $(srcdir)/config/$(cpu_type)/crtfastmath.c
-	$(gcc_compile) -c $<
+	$(gcc_compile) -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
diff --git a/gcc/libgcc/config/t-darwin b/gcc/libgcc/config/t-darwin
index 299d26c2c9..2738429ad2 100644
--- a/gcc/libgcc/config/t-darwin
+++ b/gcc/libgcc/config/t-darwin
@@ -3,13 +3,28 @@
 HOST_LIBGCC2_CFLAGS += -mmacosx-version-min=10.4
 
 crt3.o: $(srcdir)/config/darwin-crt3.c
-	$(crt_compile) -mmacosx-version-min=10.4 -c $<
+	$(crt_compile) -mmacosx-version-min=10.4 -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 crttms.o: $(srcdir)/config/darwin-crt-tm.c
-	$(crt_compile) -mmacosx-version-min=10.4 -DSTART -c $<
+	$(crt_compile) -mmacosx-version-min=10.4 -DSTART -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 crttme.o: $(srcdir)/config/darwin-crt-tm.c
-	$(crt_compile) -mmacosx-version-min=10.4 -DEND -c $<
+	$(crt_compile) -mmacosx-version-min=10.4 -DEND -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 # Make emutls weak so that we can deal with -static-libgcc, override the
 #hidden visibility when this is present in libgcc_eh.
@@ -26,7 +41,12 @@ libemutls_w.a: emutls_s.o
 
 # Patch to __Unwind_Find_Enclosing_Function for Darwin10.
 d10-uwfef.o: $(srcdir)/config/darwin10-unwind-find-enc-func.c libgcc_tm.h
-	$(crt_compile) -mmacosx-version-min=10.6 -c $<
+	$(crt_compile) -mmacosx-version-min=10.6 -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 # Using this crt as a library means that it will not be added to an exe
 #(or module) unless needed.
diff --git a/gcc/libgcc/config/t-hardfp b/gcc/libgcc/config/t-hardfp
index c4ba28b0a7..3f7de9e58a 100644
--- a/gcc/libgcc/config/t-hardfp
+++ b/gcc/libgcc/config/t-hardfp
@@ -79,12 +79,22 @@ hardfp-o = $(patsubst %,%$(objext),$(hardfp_func_list))
 $(hardfp-o): %$(objext): $(srcdir)/config/hardfp.c
 	@echo "Mode = $(hardfp_mode_regexp)"
 	@echo "Suffix = $(hardfp_suffix_regexp)"
-	$(gcc_compile) $(call hardfp_defines_for, $*) -c $< $(vis_hide) -Wno-missing-prototypes
+	$(gcc_compile) $(call hardfp_defines_for, $*) -c $< $(vis_hide) -Wno-missing-prototypes && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 libgcc-objects += $(hardfp-o)
 
 ifeq ($(enable_shared),yes)
 hardfp-s-o = $(patsubst %,%_s$(objext),$(hardfp_func_list))
 $(hardfp-s-o): %_s$(objext): $(srcdir)/config/hardfp.c
-	$(gcc_s_compile) $(call hardfp_defines_for, $*) -c $< -Wno-missing-prototypes
+	$(gcc_s_compile) $(call hardfp_defines_for, $*) -c $< -Wno-missing-prototypes && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 libgcc-s-objects += $(hardfp-s-o)
 endif
diff --git a/gcc/libgcc/config/t-slibgcc-darwin b/gcc/libgcc/config/t-slibgcc-darwin
index a8f69666a8..0d303f40b3 100644
--- a/gcc/libgcc/config/t-slibgcc-darwin
+++ b/gcc/libgcc/config/t-slibgcc-darwin
@@ -89,7 +89,7 @@ install-leaf: install-darwin-libgcc-stubs
 endif
 
 libgcc_s.$(SHLIB_SOVERSION)$(SHLIB_EXT): all-multi libgcc_s$(SHLIB_EXT)
-	MLIBS=`$(CC) --print-multi-lib | sed -e 's/;.*$$//'` ; \
+	MLIBS=`$(CC) --print-multi-lib | sed -e 's/\r//g' | sed -e 's/;.*$$//'` ; \
 	for mlib in $$MLIBS ; do \
 	  cp ../$${mlib}/libgcc/$${mlib}/libgcc_s$(SHLIB_EXT)  \
 	    ./libgcc_s.$(SHLIB_SOVERSION)$(SHLIB_EXT)_T_$${mlib} || exit 1 ; \
@@ -102,7 +102,7 @@ ifeq ($(BUILD_LIBGCCS1),YES)
 ifneq ($(LIBEHSOBJS),)
 
 libgcc_ehs.$(SHLIB_SOVERSION)$(SHLIB_EXT): all-multi libgcc_ehs$(SHLIB_EXT)
-	MLIBS=`$(CC) --print-multi-lib | sed -e 's/;.*$$//'` ; \
+	MLIBS=`$(CC) --print-multi-lib | sed -e 's/\r//g' | sed -e 's/;.*$$//'` ; \
 	for mlib in $$MLIBS ; do \
 	  cp ../$${mlib}/libgcc/$${mlib}/libgcc_ehs$(SHLIB_EXT)  \
 	    ./libgcc_ehs.$(SHLIB_SOVERSION)$(SHLIB_EXT)_T_$${mlib} || exit 1 ; \
@@ -114,7 +114,7 @@ libgcc_ehs.$(SHLIB_SOVERSION)$(SHLIB_EXT): all-multi libgcc_ehs$(SHLIB_EXT)
 
 libgcc_s.1.dylib: all-multi libgcc_s.$(SHLIB_SOVERSION)$(SHLIB_EXT) \
 		  libgcc_ehs.$(SHLIB_SOVERSION)$(SHLIB_EXT)
-	MLIBS=`$(CC) --print-multi-lib | sed -e 's/;.*$$//'` ; \
+	MLIBS=`$(CC) --print-multi-lib | sed -e 's/\r//g' | sed -e 's/;.*$$//'` ; \
 	for mlib in $$MLIBS ; do \
 	  cp ../$${mlib}/libgcc/$${mlib}/libgcc_s$(SHLIB_EXT)  \
 	    ./libgcc_s.$(SHLIB_SOVERSION)$(SHLIB_EXT)_T_$${mlib} || exit 1 ; \
@@ -135,7 +135,7 @@ libgcc_s.1.dylib: all-multi libgcc_s.$(SHLIB_SOVERSION)$(SHLIB_EXT) \
 else
 
 libgcc_s.1.dylib: all-multi libgcc_s.$(SHLIB_SOVERSION)$(SHLIB_EXT)
-	MLIBS=`$(CC) --print-multi-lib | sed -e 's/;.*$$//'` ; \
+	MLIBS=`$(CC) --print-multi-lib | sed -e 's/\r//g' | sed -e 's/;.*$$//'` ; \
 	for mlib in $$MLIBS ; do \
 	  cp ../$${mlib}/libgcc/$${mlib}/libgcc_s$(SHLIB_EXT)  \
 	    ./libgcc_s.$(SHLIB_SOVERSION)$(SHLIB_EXT)_T_$${mlib} || exit 1 ; \
diff --git a/gcc/libgcc/config/t-vxcrtstuff b/gcc/libgcc/config/t-vxcrtstuff
index ef64951c90..c6fcdd3892 100644
--- a/gcc/libgcc/config/t-vxcrtstuff
+++ b/gcc/libgcc/config/t-vxcrtstuff
@@ -1,10 +1,20 @@
 # crtbegin/crtend for VxWorks
 
 vx_crtbegin.o: $(srcdir)/config/vxcrtstuff.c
-	$(crt_compile) $(CRTSTUFF_T_CFLAGS) -DCRT_BEGIN -c $<
+	$(crt_compile) $(CRTSTUFF_T_CFLAGS) -DCRT_BEGIN -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 vx_crtend.o: $(srcdir)/config/vxcrtstuff.c
-	$(crt_compile) $(CRTSTUFF_T_CFLAGS) -DCRT_END -c $<
+	$(crt_compile) $(CRTSTUFF_T_CFLAGS) -DCRT_END -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 # We do pretty different things for kernel vs rtp modes, all
 # controlled thanks to __RTP__ and (optional) multilibs.
diff --git a/gcc/libgcc/config/t-vxcrtstuffS b/gcc/libgcc/config/t-vxcrtstuffS
index 6b65b0005b..174dd851d9 100644
--- a/gcc/libgcc/config/t-vxcrtstuffS
+++ b/gcc/libgcc/config/t-vxcrtstuffS
@@ -2,8 +2,18 @@
 # when the shared libraries are available
 
 vx_crtbeginS.o: $(srcdir)/config/vxcrtstuff.c
-	$(crt_compile) $(CRTSTUFF_T_CFLAGS_S) -DCRT_BEGIN -c $< -DCRTSTUFFS_O
+	$(crt_compile) $(CRTSTUFF_T_CFLAGS_S) -DCRT_BEGIN -c $< -DCRTSTUFFS_O && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 vx_crtendS.o: $(srcdir)/config/vxcrtstuff.c
-	$(crt_compile) $(CRTSTUFF_T_CFLAGS_S) -DCRT_END -c $< -DCRTSTUFFS_O
+	$(crt_compile) $(CRTSTUFF_T_CFLAGS_S) -DCRT_END -c $< -DCRTSTUFFS_O && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 EXTRA_PARTS += vx_crtbeginS.o vx_crtendS.o
diff --git a/gcc/libgcc/config/tilegx/t-tilegx b/gcc/libgcc/config/tilegx/t-tilegx
index 2fb64454c3..30fb0efbe4 100644
--- a/gcc/libgcc/config/tilegx/t-tilegx
+++ b/gcc/libgcc/config/tilegx/t-tilegx
@@ -14,13 +14,23 @@ SOFTDIVIDE_FUNCS := \
 softdivide-o = $(patsubst %,%$(objext),$(SOFTDIVIDE_FUNCS))
 $(softdivide-o): %$(objext): $(srcdir)/config/tilepro/softdivide.c
 	$(gcc_compile) -ffunction-sections -DMAYBE_STATIC= -DL$* -c $< \
-	  $(vis_hide)
+	  $(vis_hide) && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	    | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	      while IFS= read -r line; \
+	      do \
+	        sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	      done) && mv $(dep_filename).bak $(dep_filename)
 libgcc-objects += $(softdivide-o)
 
 ifeq ($(enable_shared),yes)
 softdivide-s-o = $(patsubst %,%_s$(objext),$(SOFTDIVIDE_FUNCS))
 $(softdivide-s-o): %_s$(objext): $(srcdir)/config/tilepro/softdivide.c
-	$(gcc_s_compile) -ffunction-sections -DMAYBE_STATIC= -DL$* -c $<
+	$(gcc_s_compile) -ffunction-sections -DMAYBE_STATIC= -DL$* -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 libgcc-s-objects += $(softdivide-s-o)
 libgcc-eh-objects += _tile_divdi3.o _tile_umoddi3.o
 endif
diff --git a/gcc/libgcc/config/tilepro/t-tilepro b/gcc/libgcc/config/tilepro/t-tilepro
index eb6894ce11..05c934ef32 100644
--- a/gcc/libgcc/config/tilepro/t-tilepro
+++ b/gcc/libgcc/config/tilepro/t-tilepro
@@ -22,12 +22,22 @@ SOFTDIVIDE_FUNCS := \
 softdivide-o = $(patsubst %,%$(objext),$(SOFTDIVIDE_FUNCS))
 $(softdivide-o): %$(objext): $(srcdir)/config/tilepro/softdivide.c
 	$(gcc_compile) -ffunction-sections -DMAYBE_STATIC= -DL$* -c $< \
-	  $(vis_hide)
+	  $(vis_hide) && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 libgcc-objects += $(softdivide-o)
 
 ifeq ($(enable_shared),yes)
 softdivide-s-o = $(patsubst %,%_s$(objext),$(SOFTDIVIDE_FUNCS))
 $(softdivide-s-o): %_s$(objext): $(srcdir)/config/tilepro/softdivide.c
-	$(gcc_s_compile) -ffunction-sections -DMAYBE_STATIC= -DL$* -c $<
+	$(gcc_s_compile) -ffunction-sections -DMAYBE_STATIC= -DL$* -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 libgcc-s-objects += $(softdivide-s-o)
 endif
diff --git a/gcc/libgcc/config/vms/t-vms b/gcc/libgcc/config/vms/t-vms
index 21e09ff4ac..0eb366ec7f 100644
--- a/gcc/libgcc/config/vms/t-vms
+++ b/gcc/libgcc/config/vms/t-vms
@@ -1,3 +1,8 @@
 # Assemble startup file.
 crt0.o: $(srcdir)/config/vms/vms-ucrt0.c
-	$(gcc_compile) -mpointer-size=64 -c $<
+	$(gcc_compile) -mpointer-size=64 -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
diff --git a/gcc/libgcc/configure b/gcc/libgcc/configure
index 1f9b2ac578..9f7a22956d 100755
--- a/gcc/libgcc/configure
+++ b/gcc/libgcc/configure
@@ -1347,6 +1347,7 @@ Optional Features:
   --enable-maintainer-mode
                           enable make rules and dependencies not useful (and
                           sometimes confusing) to the casual installer
+  --enable-bootstrap      use when bootstrapping libgcc
   --disable-gcov          don't provide libgcov and related host tools
   --disable-largefile     omit support for large files
   --enable-decimal-float={no,yes,bid,dpd}
@@ -1487,9 +1488,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1524,9 +1526,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1562,7 +1565,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -2750,7 +2753,7 @@ case ${version_specific_libs} in
       toolexecdir='$(libdir)/gcc-lib/$(target_noncanonical)'
       toolexeclibdir='$(libdir)'
     fi
-    multi_os_directory=`$CC -print-multi-os-directory`
+    multi_os_directory=`$CC -print-multi-os-directory | sed -e 's/\r//g'`
     case $multi_os_directory in
       .) ;; # Avoid trailing /.
       *) toolexeclibdir=$toolexeclibdir/$multi_os_directory ;;
@@ -3540,26 +3543,27 @@ See \`config.log' for more details" "$LINENO" 5; }
 $as_echo "$as_me:${as_lineno-$LINENO}: checking for C compiler version" >&5
 set X $ac_compile
 ac_compiler=$2
-for ac_option in --version -v -V -qversion; do
-  { { ac_try="$ac_compiler $ac_option >&5"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
-$as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
-  ac_status=$?
-  if test -s conftest.err; then
-    sed '10a\
-... rest of stderr output deleted ...
-         10q' conftest.err >conftest.er1
-    cat conftest.er1 >&5
-  fi
-  rm -f conftest.er1 conftest.err
-  $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
-  test $ac_status = 0; }
-done
+#for ac_option in --version -v -V -qversion; do
+#  { { ac_try="$ac_compiler $ac_option >&5"
+#case "(($ac_try" in
+#  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+#  *) ac_try_echo=$ac_try;;
+#esac
+#eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
+#$as_echo "$ac_try_echo"; } >&5
+#  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
+#  ac_status=$?
+#  if test -s conftest.err; then
+#    dos2unix -q conftest.err
+#    sed '10a\
+#... rest of stderr output deleted ...
+#         10q' conftest.err >conftest.er1
+#    cat conftest.er1 >&5
+#  fi
+#  rm -f conftest.er1 conftest.err
+#  $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
+#  test $ac_status = 0; }
+#done
 
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -3574,7 +3578,7 @@ printf ("hello world\n");
 _ACEOF
 # FIXME: Cleanup?
 if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3629,7 +3633,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3668,24 +3672,25 @@ test "$ac_cv_exeext" = no && ac_cv_exeext=
 else
   ac_file=''
 fi
-if test -z "$ac_file"; then :
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
-$as_echo "no" >&6; }
-$as_echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-{ { $as_echo "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
-$as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
-as_fn_error 77 "C compiler cannot create executables
-See \`config.log' for more details" "$LINENO" 5; }
-else
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: yes" >&5
-$as_echo "yes" >&6; }
-fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for C compiler default output file name" >&5
-$as_echo_n "checking for C compiler default output file name... " >&6; }
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_file" >&5
-$as_echo "$ac_file" >&6; }
+#if test -z "$ac_file"; then :
+#  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+#$as_echo "no" >&6; }
+#$as_echo "$as_me: failed program was:" >&5
+#sed 's/^/| /' conftest.$ac_ext >&5
+#
+#{ { $as_echo "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
+#$as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
+#as_fn_error 77 "C compiler cannot create executables
+#See \`config.log' for more details" "$LINENO" 5; }
+#else
+#  { $as_echo "$as_me:${as_lineno-$LINENO}: result: yes" >&5
+#$as_echo "yes" >&6; }
+#fi
+#{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for C compiler default output file name" >&5
+#$as_echo_n "checking for C compiler default output file name... " >&6; }
+#{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_file" >&5
+#$as_echo "$ac_file" >&6; }
+ac_file='a.out'
 ac_exeext=$ac_cv_exeext
 
 rm -f -r a.out a.out.dSYM a.exe conftest$ac_cv_exeext b.out
@@ -3699,7 +3704,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3755,7 +3760,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -3813,7 +3818,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4466,6 +4471,7 @@ as_fn_arith $ac_cv_sizeof_long_double \* 8 && long_double_type_size=$as_val
 
 
 
+if eval "x$enable_bootstrap" != "yes"; then
 for ac_header in inttypes.h stdint.h stdlib.h ftw.h \
 	unistd.h sys/stat.h sys/types.h \
 	string.h strings.h memory.h sys/auxv.h sys/mman.h
@@ -4479,6 +4485,21 @@ _ACEOF
 
 fi
 done
+else
+for ac_header in inttypes.h stdint.h stdlib.h ftw.h \
+	unistd.h sys/stat.h sys/types.h \
+	string.h strings.h memory.h sys/auxv.h
+do :
+  as_ac_Header=`$as_echo "ac_cv_header_$ac_header" | $as_tr_sh`
+ac_fn_c_check_header_preproc "$LINENO" "$ac_header" "$as_ac_Header"
+if eval test \"x\$"$as_ac_Header"\" = x"yes"; then :
+  cat >>confdefs.h <<_ACEOF
+#define `$as_echo "HAVE_$ac_header" | $as_tr_cpp` 1
+_ACEOF
+
+fi
+done
+fi
 
 { $as_echo "$as_me:${as_lineno-$LINENO}: checking for grep that handles long lines and -e" >&5
 $as_echo_n "checking for grep that handles long lines and -e... " >&6; }
@@ -4644,7 +4665,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -4661,7 +4682,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -4913,6 +4934,18 @@ else
   enable_cet=auto
 fi
 
+ # Check whether --enable-bootstrap was given.
+if test "${enable_bootstrap+set}" = set; then :
+  enableval=$enable_bootstrap;
+      case "$enableval" in
+       yes|no|auto) ;;
+       *) as_fn_error $? "Unknown argument to enable/disable bootstrap" "$LINENO" 5 ;;
+                          esac
+
+else
+  enable_bootstrap=no
+fi
+
 
 { $as_echo "$as_me:${as_lineno-$LINENO}: checking for CET support" >&5
 $as_echo_n "checking for CET support... " >&6; }
@@ -5031,7 +5064,7 @@ if ${acl_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU ld's only accept -v.
-if $LD -v 2>&1 </dev/null | egrep '(GNU|with BFD)' 1>&5; then
+if $LD -v 2>&1 </dev/null | sed -e 's/\r//g' | egrep '(GNU|with BFD)' 1>&5; then
   acl_cv_prog_gnu_ld=yes
 else
   acl_cv_prog_gnu_ld=no
@@ -5044,7 +5077,7 @@ with_gnu_ld=$acl_cv_prog_gnu_ld
 
 { $as_echo "$as_me:${as_lineno-$LINENO}: checking for thread model used by GCC" >&5
 $as_echo_n "checking for thread model used by GCC... " >&6; }
-target_thread_file=`$CC -v 2>&1 | sed -n 's/^Thread model: //p'`
+target_thread_file=`$CC -v 2>&1 | sed -e 's/\r//g' | sed -n 's/^Thread model: //p'`
 { $as_echo "$as_me:${as_lineno-$LINENO}: result: $target_thread_file" >&5
 $as_echo "$target_thread_file" >&6; }
 
@@ -5082,7 +5115,7 @@ host_address=64
 host_address=32
 #endif
 EOF
-eval `${CC-cc} -E conftest.c | grep host_address=`
+eval `${CC-cc} -E conftest.c | sed -e 's/\r//g' | grep host_address=`
 rm -f conftest.c
 
 case ${host} in
@@ -5192,7 +5225,7 @@ ppc_fp_type=e500v2
 ppc_fp_type=hard
 #endif
 EOF
-eval `${CC-cc} -E conftest.c | grep ppc_fp_type=`
+eval `${CC-cc} -E conftest.c | sed -e 's/\r//g' | grep ppc_fp_type=`
 rm -f conftest.c
 # glibc 2.19 and later provide all the soft-fp functions, with proper
 # interactions with <fenv.h> exception and rounding mode handling, so
diff --git a/gcc/libgcc/configure.ac b/gcc/libgcc/configure.ac
index 2fc9d5d7c9..c0f245ea94 100644
--- a/gcc/libgcc/configure.ac
+++ b/gcc/libgcc/configure.ac
@@ -197,7 +197,7 @@ case ${version_specific_libs} in
       toolexecdir='$(libdir)/gcc-lib/$(target_noncanonical)'
       toolexeclibdir='$(libdir)'
     fi
-    multi_os_directory=`$CC -print-multi-os-directory`
+    multi_os_directory=`$CC -print-multi-os-directory | sed -e 's/\r//g'`
     case $multi_os_directory in
       .) ;; # Avoid trailing /.
       *) toolexeclibdir=$toolexeclibdir/$multi_os_directory ;;
@@ -306,7 +306,7 @@ AC_SUBST([use_tm_clone_registry])
 AC_LIB_PROG_LD_GNU
 
 AC_MSG_CHECKING([for thread model used by GCC])
-target_thread_file=`$CC -v 2>&1 | sed -n 's/^Thread model: //p'`
+target_thread_file=`$CC -v 2>&1 | sed -e 's/\r//g' | sed -n 's/^Thread model: //p'`
 AC_MSG_RESULT([$target_thread_file]) 
 
 # Check for assembler CFI support.
@@ -330,7 +330,7 @@ host_address=64
 host_address=32
 #endif
 EOF
-eval `${CC-cc} -E conftest.c | grep host_address=`
+eval `${CC-cc} -E conftest.c | sed -e 's/\r//g' | grep host_address=`
 rm -f conftest.c
 
 case ${host} in
@@ -408,7 +408,7 @@ ppc_fp_type=e500v2
 ppc_fp_type=hard
 #endif
 EOF
-eval `${CC-cc} -E conftest.c | grep ppc_fp_type=`
+eval `${CC-cc} -E conftest.c | sed -e 's/\r//g' | grep ppc_fp_type=`
 rm -f conftest.c
 # glibc 2.19 and later provide all the soft-fp functions, with proper
 # interactions with <fenv.h> exception and rounding mode handling, so
diff --git a/gcc/libgcc/fixed-obj.mk b/gcc/libgcc/fixed-obj.mk
index 4db7a5792c..61b31257f3 100644
--- a/gcc/libgcc/fixed-obj.mk
+++ b/gcc/libgcc/fixed-obj.mk
@@ -24,10 +24,20 @@ endif
 
 ifneq ($o,$(filter $o,$(LIB2FUNCS_EXCLUDE)))
 $o$(objext): %$(objext): $(srcdir)/fixed-bit.c
-	$(gcc_compile) -DL$($*-label) $($*-opt) -c $(srcdir)/fixed-bit.c $(vis_hide)
+	$(gcc_compile) -DL$($*-label) $($*-opt) -c $(srcdir)/fixed-bit.c $(vis_hide) && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 ifeq ($(enable_shared),yes)
 $(o)_s$(objext): %_s$(objext): $(srcdir)/fixed-bit.c
-	$(gcc_s_compile) -DL$($*-label) $($*-opt) -c $(srcdir)/fixed-bit.c
+	$(gcc_s_compile) -DL$($*-label) $($*-opt) -c $(srcdir)/fixed-bit.c && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 endif
 endif
diff --git a/gcc/libgcc/shared-object.mk b/gcc/libgcc/shared-object.mk
index efac7973b2..9233901ec3 100644
--- a/gcc/libgcc/shared-object.mk
+++ b/gcc/libgcc/shared-object.mk
@@ -11,10 +11,20 @@ c_flags-$o := $(c_flags)
 ifeq ($(suffix $o),.c)
 
 $(base)$(objext): $o
-	$(gcc_compile) $(c_flags-$<) -c $< $(vis_hide)
+	$(gcc_compile) $(c_flags-$<) -c $< $(vis_hide) && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 $(base)_s$(objext): $o
-	$(gcc_s_compile) $(c_flags-$<) -c $<
+	$(gcc_s_compile) $(c_flags-$<) -c $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 else
 
@@ -27,12 +37,22 @@ endif
 as_flags-$o := -xassembler$(if $(filter .S,$(suffix $o)),-with-cpp)
 
 $(base)$(objext): $o $(base).vis
-	$(gcc_compile) -c $(as_flags-$<) -include $*.vis $<
+	$(gcc_compile) -c $(as_flags-$<) -include $*.vis $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 $(base).vis: $(base)_s$(objext)
 	$(gen-hide-list)
 
 $(base)_s$(objext): $o
-	$(gcc_s_compile) -c $(as_flags-$<) $<
+	$(gcc_s_compile) -c $(as_flags-$<) $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 endif
diff --git a/gcc/libgcc/siditi-object.mk b/gcc/libgcc/siditi-object.mk
index 77699cb79e..e8c7cae5b9 100644
--- a/gcc/libgcc/siditi-object.mk
+++ b/gcc/libgcc/siditi-object.mk
@@ -13,10 +13,20 @@ iter-sizes := $(wordlist 2,$(words $(iter-sizes)),$(iter-sizes))
 
 $o$(objext): %$(objext): $(srcdir)/libgcc2.c
 	$(gcc_compile) -DL$($*-label) -c $< $(vis_hide) \
-		-DLIBGCC2_UNITS_PER_WORD=$($*-size)
+		-DLIBGCC2_UNITS_PER_WORD=$($*-size) && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+		| egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+			while IFS= read -r line; \
+			do \
+				sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+			done) && mv $(dep_filename).bak $(dep_filename)
 
 ifeq ($(enable_shared),yes)
 $(o)_s$(objext): %_s$(objext): $(srcdir)/libgcc2.c
 	$(gcc_s_compile) -DL$($*-label) -c $< \
-		-DLIBGCC2_UNITS_PER_WORD=$($*-size)
+		-DLIBGCC2_UNITS_PER_WORD=$($*-size) && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+		| egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+			while IFS= read -r line; \
+			do \
+				sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+			done) && mv $(dep_filename).bak $(dep_filename)
 endif
diff --git a/gcc/libgcc/static-object.mk b/gcc/libgcc/static-object.mk
index 891787e85a..2b758273f2 100644
--- a/gcc/libgcc/static-object.mk
+++ b/gcc/libgcc/static-object.mk
@@ -14,7 +14,12 @@ c_flags-$o := $(c_flags)
 ifeq ($(suffix $o),.c)
 
 $(base)$(objext): $o
-	$(gcc_compile) $(c_flags-$<) -c $< $(vis_hide)
+	$(gcc_compile) $(c_flags-$<) -c $< $(vis_hide) && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 else
 
@@ -27,12 +32,22 @@ endif
 as_flags-$o := -xassembler$(if $(filter .S,$(suffix $o)),-with-cpp)
 
 $(base)$(objext): $o $(base).vis
-	$(gcc_compile) -c $(as_flags-$<) -include $*.vis $<
+	$(gcc_compile) -c $(as_flags-$<) -include $*.vis $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 $(base).vis: $(base)_s$(objext)
 	$(gen-hide-list)
 
 $(base)_s$(objext): $o
-	$(gcc_s_compile) -c $(as_flags-$<) $<
+	$(gcc_s_compile) -c $(as_flags-$<) $< && cp $(dep_filename) $(dep_filename).bak && (cat $(dep_filename) \
+	  | egrep '^\s*[A-Za-z]:' | sed -e 's/^\s*//g' -e 's/:\s*$$//g' -e 's/\s*\\\s*$$//g' | sort -u | sed -e 's/\\/\\\\/g' | \
+	    while IFS= read -r line; \
+	    do \
+	      sed -ie 's#'"$$line"'#'$$(winepath -u "$$line" | sed -e 's#:#\\\\:#g')'#g' $(dep_filename).bak; \
+	    done) && mv $(dep_filename).bak $(dep_filename)
 
 endif
diff --git a/gcc/libgfortran/configure b/gcc/libgfortran/configure
index ae64dca311..d1a3fb2dc7 100755
--- a/gcc/libgfortran/configure
+++ b/gcc/libgfortran/configure
@@ -1604,9 +1604,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1641,9 +1642,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1766,7 +1768,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -1839,9 +1841,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1955,9 +1958,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1993,9 +1997,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -4033,9 +4038,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -4059,7 +4065,7 @@ printf ("hello world\n");
 _ACEOF
 # FIXME: Cleanup?
 if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4114,7 +4120,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4184,7 +4190,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4240,7 +4246,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -4298,7 +4304,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4624,7 +4630,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -4682,6 +4688,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -5026,7 +5037,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -5043,7 +5054,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -5226,7 +5237,7 @@ case ${version_specific_libs} in
       toolexecdir='$(libdir)/gcc-lib/$(target_alias)'
       toolexeclibdir='$(libdir)'
     fi
-    multi_os_directory=`$CC -print-multi-os-directory`
+    multi_os_directory=`$CC -print-multi-os-directory | sed -e 's/\r//g'`
     case $multi_os_directory in
       .) ;; # Avoid trailing /.
       *) toolexeclibdir=$toolexeclibdir/$multi_os_directory ;;
@@ -5568,9 +5579,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -5880,7 +5892,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -5938,6 +5950,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -6534,9 +6551,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -6578,7 +6595,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -6609,7 +6626,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -7225,10 +7242,12 @@ else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
   (eval echo "\"\$as_me:$LINENO: $ac_compile\"" >&5)
-  (eval "$ac_compile" 2>conftest.err)
+  (eval "($ac_compile | sed -e 's/\r//g')" 2>conftest.err)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: output\"" >&5)
   cat conftest.out >&5
@@ -7649,7 +7668,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -7711,7 +7730,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu | uclinuxfdpiceabi)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|_pic\.a)$'
@@ -7729,7 +7748,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
@@ -8230,7 +8249,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[ABCDGIRSTW]' ;;
 esac
@@ -8238,11 +8257,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -8276,7 +8295,7 @@ for ac_symprfx in "" "_"; do
 "     s[1]~prfx {split(s[1],t,\"@\"); print t[1], substr(t[1],length(prfx))}"\
 "     ' prfx=^$ac_symprfx"
   else
-    lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
+    lt_cv_sys_global_symbol_pipe="sed -n -e 's/\r//g' -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
   fi
 
   # Check to see that the pipe works correctly.
@@ -8297,14 +8316,14 @@ int main(){nm_test_var='a';nm_test_func();return(0);}
 _LT_EOF
 
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist\""; } >&5
-  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) 2>&5
+    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist\""; } >&5
+  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s "$nlist"; then
@@ -8325,7 +8344,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist"  | sed -e '"'"'s/\r//g'"'"'| $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -8338,7 +8357,7 @@ lt__PROGRAM__LTX_preloaded_symbols[] =
 {
   { "@PROGRAM@", (void *) 0 },
 _LT_EOF
-	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | $GREP -v main >> conftest.$ac_ext
+	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | sed -e 's/\r//g' | $GREP -v main >> conftest.$ac_ext
 	  cat <<\_LT_EOF >> conftest.$ac_ext
   {0, (void *) 0}
 };
@@ -8361,7 +8380,7 @@ _LT_EOF
 	  LIBS="conftstm.$ac_objext"
 	  CFLAGS="$CFLAGS$lt_prog_compiler_no_builtin_flag"
 	  if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext}; then
@@ -8440,7 +8459,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -8459,7 +8478,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo '#line '$LINENO' "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -8497,7 +8516,7 @@ s390*-*linux*|s390*-*tpf*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -8612,7 +8631,7 @@ sparc*-*solaris*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -9145,6 +9164,7 @@ else
 	if test -f libconftest.dylib && test ! -s conftest.err && test $_lt_result = 0; then
 	  lt_cv_apple_cc_single_mod=yes
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err >&5
 	fi
 	rm -rf libconftest.dylib*
@@ -9210,6 +9230,7 @@ _LT_EOF
       if test -f conftest && test ! -s conftest.err && test $_lt_result = 0 && $GREP forced_load conftest 2>&1 >/dev/null; then
 	lt_cv_ld_force_load=yes
       else
+        dos2unix -q conftest.err
 	cat conftest.err >&5
       fi
         rm -f conftest.err libconftest.a conftest conftest.c
@@ -9701,13 +9722,15 @@ compiler_DEFAULT=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -9747,14 +9770,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -9969,7 +9994,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic='-KPIC'
@@ -10100,14 +10125,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works=yes
@@ -10149,10 +10176,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -10205,8 +10233,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -10214,6 +10243,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -10260,8 +10290,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -10269,6 +10300,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -10329,7 +10361,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object=no
   enable_shared_with_static_runtimes=no
   export_dynamic_flag_spec=
-  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic=no
   hardcode_direct=no
   hardcode_direct_absolute=no
@@ -10392,7 +10424,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -10418,13 +10450,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -10468,7 +10500,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -10486,9 +10518,9 @@ _LT_EOF
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -10531,7 +10563,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -10562,7 +10594,7 @@ _LT_EOF
 	  compiler_needs_object=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object=yes
@@ -10600,7 +10632,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -10610,7 +10642,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
 
@@ -10622,7 +10654,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -10631,7 +10663,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
@@ -10650,7 +10682,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
 	    archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -10669,7 +10701,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -10713,10 +10745,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -11069,10 +11101,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS -b"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -11156,7 +11189,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -11182,7 +11215,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct=yes
 	hardcode_shlibpath_var=no
 	hardcode_direct_absolute=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
@@ -11251,7 +11284,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -11444,10 +11477,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -11473,6 +11507,7 @@ else
 	  fi
 	  allow_undefined_flag=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -11655,7 +11690,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([A-Za-z]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -11759,7 +11794,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -12130,7 +12165,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -12175,7 +12210,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -12836,7 +12871,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -12942,7 +12977,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -13396,9 +13431,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -13568,13 +13604,15 @@ compiler=$CC
   # save warnings/boilerplate of simple test code
   ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
   ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -13658,7 +13696,7 @@ cat > conftest.$ac_ext <<_LT_EOF
 _LT_EOF
 
 if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -13974,7 +14012,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static_FC='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic_FC='-KPIC'
@@ -14102,14 +14140,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works_FC=yes
@@ -14148,10 +14188,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -14201,8 +14242,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -14210,6 +14252,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o_FC=yes
@@ -14253,8 +14296,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -14262,6 +14306,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o_FC=yes
@@ -14319,7 +14364,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object_FC=no
   enable_shared_with_static_runtimes_FC=no
   export_dynamic_flag_spec_FC=
-  export_symbols_cmds_FC='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds_FC='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic_FC=no
   hardcode_direct_FC=no
   hardcode_direct_absolute_FC=no
@@ -14382,7 +14427,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -14408,13 +14453,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec_FC='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec_FC='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec_FC="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec_FC=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -14458,7 +14503,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag_FC=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -14476,9 +14521,9 @@ _LT_EOF
       allow_undefined_flag_FC=unsupported
       always_export_symbols_FC=no
       enable_shared_with_static_runtimes_FC=yes
-      export_symbols_cmds_FC='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds_FC='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds_FC='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -14521,7 +14566,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -14552,7 +14597,7 @@ _LT_EOF
 	  compiler_needs_object_FC=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec_FC='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object_FC=yes
@@ -14590,7 +14635,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds_FC='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -14600,7 +14645,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs_FC=no
 	cat <<_LT_EOF 1>&2
 
@@ -14612,7 +14657,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds_FC='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds_FC='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -14621,7 +14666,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs_FC=no
 	cat <<_LT_EOF 1>&2
@@ -14640,7 +14685,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec_FC='${wl}-rpath ${wl}$libdir'
 	    archive_cmds_FC='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds_FC='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -14659,7 +14704,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds_FC='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds_FC='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -14703,10 +14748,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds_FC='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds_FC='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds_FC='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds_FC='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -15094,7 +15139,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds_FC='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds_FC='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -15120,7 +15165,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct_FC=yes
 	hardcode_shlibpath_var_FC=no
 	hardcode_direct_absolute_FC=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds_FC='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds_FC='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec_FC='${wl}-rpath,$libdir'
@@ -15189,7 +15234,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds_FC='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds_FC='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -15373,10 +15418,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -15402,6 +15448,7 @@ else
 	  fi
 	  allow_undefined_flag_FC=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -15531,7 +15578,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -15894,7 +15941,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -15939,7 +15986,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -31036,7 +31083,7 @@ _LT_EOF
  ;;
     "gstdint.h":C)
 if test "$GCC" = yes; then
-  echo "/* generated for " `$CC --version | sed 1q` "*/" > tmp-stdint.h
+  echo "/* generated for " `$CC --version | sed -e 's/\r//g' | sed 1q` "*/" > tmp-stdint.h
 else
   echo "/* generated for $CC */" > tmp-stdint.h
 fi
diff --git a/gcc/libgfortran/configure.ac b/gcc/libgfortran/configure.ac
index 97cc490cb5..738000234e 100644
--- a/gcc/libgfortran/configure.ac
+++ b/gcc/libgfortran/configure.ac
@@ -115,7 +115,7 @@ case ${version_specific_libs} in
       toolexecdir='$(libdir)/gcc-lib/$(target_alias)'
       toolexeclibdir='$(libdir)'
     fi
-    multi_os_directory=`$CC -print-multi-os-directory`
+    multi_os_directory=`$CC -print-multi-os-directory | sed -e 's/\r//g'`
     case $multi_os_directory in
       .) ;; # Avoid trailing /.
       *) toolexeclibdir=$toolexeclibdir/$multi_os_directory ;;
diff --git a/gcc/libgo/Makefile.am b/gcc/libgo/Makefile.am
index a5d4b6a352..7faf70b5f1 100644
--- a/gcc/libgo/Makefile.am
+++ b/gcc/libgo/Makefile.am
@@ -758,6 +758,7 @@ s-gen-sysinfo: $(srcdir)/sysinfo.c config.h
 errno.i: s-errno; @true
 s-errno:
 	echo '#include <errno.h>' | $(CC) $(SYSINFO_FLAGS) -x c - -E -dM > tmp-errno.i
+	dos2unix -q tmp-errno.i
 	$(SHELL) $(srcdir)/mvifdiff.sh tmp-errno.i errno.i
 	$(STAMP) $@
 
diff --git a/gcc/libgo/Makefile.in b/gcc/libgo/Makefile.in
index 22f48a5293..8adbd491fd 100644
--- a/gcc/libgo/Makefile.in
+++ b/gcc/libgo/Makefile.in
@@ -2954,6 +2954,7 @@ s-gen-sysinfo: $(srcdir)/sysinfo.c config.h
 errno.i: s-errno; @true
 s-errno:
 	echo '#include <errno.h>' | $(CC) $(SYSINFO_FLAGS) -x c - -E -dM > tmp-errno.i
+	dos2unix -q tmp-errno.i
 	$(SHELL) $(srcdir)/mvifdiff.sh tmp-errno.i errno.i
 	$(STAMP) $@
 
diff --git a/gcc/libgo/config/libtool.m4 b/gcc/libgo/config/libtool.m4
index 4ca90ee71b..ea3e3df50e 100644
--- a/gcc/libgo/config/libtool.m4
+++ b/gcc/libgo/config/libtool.m4
@@ -2045,7 +2045,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([[A-Za-z]]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -2149,7 +2149,7 @@ aix[[4-9]]*)
       aix4 | aix4.[[01]] | aix4.[[01]].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -2493,7 +2493,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -2538,7 +2538,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[[89]] | openbsd2.[[89]].*)
 	shlibpath_overrides_runpath=no
@@ -2838,9 +2838,9 @@ if test "$GCC" = yes; then
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -2878,7 +2878,7 @@ AC_CACHE_VAL(lt_cv_path_LD,
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -2918,7 +2918,7 @@ dnl AC_DEFUN([AC_PROG_LD], [])
 m4_defun([_LT_PATH_LD_GNU],
 [AC_CACHE_CHECK([if the linker ($LD) is GNU ld], lt_cv_prog_gnu_ld,
 [# I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -3027,7 +3027,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -3089,7 +3089,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[[^/]]+(\.so\.[[0-9]]+\.[[0-9]]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[[^/]]+(\.so|_pic\.a)$'
@@ -3107,7 +3107,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[[^/]]+(\.so\.[[0-9]]+\.[[0-9]]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[[^/]]+(\.so\.[[0-9]]+\.[[0-9]]+|_pic\.a)$'
@@ -3255,7 +3255,7 @@ AC_CACHE_CHECK([the name lister ($NM) interface], [lt_cv_nm_interface],
   (eval "$ac_compile" 2>conftest.err)
   cat conftest.err >&AS_MESSAGE_LOG_FD
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&AS_MESSAGE_LOG_FD)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
   cat conftest.err >&AS_MESSAGE_LOG_FD
   (eval echo "\"\$as_me:$LINENO: output\"" >&AS_MESSAGE_LOG_FD)
   cat conftest.out >&AS_MESSAGE_LOG_FD
@@ -3387,7 +3387,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[[ABCDGIRSTW]]' ;;
 esac
@@ -3395,11 +3395,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([[^ ]]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([[^ ]]*\) \([[^ ]]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([[^ ]]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([[^ ]]*\) \(lib[[^ ]]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([[^ ]]*\) \([[^ ]]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([[^ ]]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([[^ ]]*\) \([[^ ]]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([[^ ]]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([[^ ]]*\) \(lib[[^ ]]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([[^ ]]*\) \([[^ ]]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -3456,7 +3456,7 @@ _LT_EOF
   if AC_TRY_EVAL(ac_compile); then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if AC_TRY_EVAL(NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) && test -s "$nlist"; then
+    if AC_TRY_EVAL(NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) && test -s "$nlist"; then
       # Try sorting and uniquifying the output.
       if sort "$nlist" | uniq > "$nlist"T; then
 	mv -f "$nlist"T "$nlist"
@@ -3474,7 +3474,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | sed -e '"'"'s/\r//g'"'"' | $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -3769,7 +3769,7 @@ m4_if([$1], [CXX], [
 	    _LT_TAGVAR(lt_prog_compiler_static, $1)='-qstaticlink'
 	    ;;
 	  *)
-	    case `$CC -V 2>&1 | sed 5q` in
+	    case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	    *Sun\ C*)
 	      # Sun C++ 5.9
 	      _LT_TAGVAR(lt_prog_compiler_pic, $1)='-KPIC'
@@ -4067,7 +4067,7 @@ m4_if([$1], [CXX], [
 	_LT_TAGVAR(lt_prog_compiler_static, $1)='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  _LT_TAGVAR(lt_prog_compiler_pic, $1)='-KPIC'
@@ -4215,27 +4215,27 @@ m4_require([_LT_CMD_GLOBAL_SYMBOLS])dnl
 m4_require([_LT_TAG_COMPILER])dnl
 AC_MSG_CHECKING([whether the $compiler linker ($LD) supports shared libraries])
 m4_if([$1], [CXX], [
-  _LT_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  _LT_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   case $host_os in
   aix[[4-9]]*)
     # If we're using GNU nm, then we don't want the "-C" option.
     # -C means demangle to AIX nm, but means don't demangle with GNU nm
     # Also, AIX nm treats weak defined symbols like other global defined
     # symbols, whereas GNU nm marks them as "W".
-    if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-      _LT_TAGVAR(export_symbols_cmds, $1)='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && ([substr](\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+    if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+      _LT_TAGVAR(export_symbols_cmds, $1)='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && ([substr](\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
     else
-      _LT_TAGVAR(export_symbols_cmds, $1)='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B")) && ([substr](\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+      _LT_TAGVAR(export_symbols_cmds, $1)='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B")) && ([substr](\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
     fi
     ;;
   pw32*)
     _LT_TAGVAR(export_symbols_cmds, $1)="$ltdll_cmds"
   ;;
   cygwin* | mingw* | cegcc*)
-    _LT_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[[BCDGRS]][[ ]]/s/.*[[ ]]\([[^ ]]*\)/\1 DATA/;/^.*[[ ]]__nm__/s/^.*[[ ]]__nm__\([[^ ]]*\)[[ ]][[^ ]]*/\1 DATA/;/^I[[ ]]/d;/^[[AITW]][[ ]]/s/.* //'\'' | sort | uniq > $export_symbols'
+    _LT_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[[BCDGRS]][[ ]]/s/.*[[ ]]\([[^ ]]*\)/\1 DATA/;/^.*[[ ]]__nm__/s/^.*[[ ]]__nm__\([[^ ]]*\)[[ ]][[^ ]]*/\1 DATA/;/^I[[ ]]/d;/^[[AITW]][[ ]]/s/.* //'\'' | sort | uniq > $export_symbols'
   ;;
   *)
-    _LT_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+    _LT_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   ;;
   esac
   _LT_TAGVAR(exclude_expsyms, $1)=['_GLOBAL_OFFSET_TABLE_|_GLOBAL__F[ID]_.*']
@@ -4248,7 +4248,7 @@ m4_if([$1], [CXX], [
   _LT_TAGVAR(compiler_needs_object, $1)=no
   _LT_TAGVAR(enable_shared_with_static_runtimes, $1)=no
   _LT_TAGVAR(export_dynamic_flag_spec, $1)=
-  _LT_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  _LT_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   _LT_TAGVAR(hardcode_automatic, $1)=no
   _LT_TAGVAR(hardcode_direct, $1)=no
   _LT_TAGVAR(hardcode_direct_absolute, $1)=no
@@ -4312,7 +4312,7 @@ dnl Note also adjust exclude_expsyms for C++ above.
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[[2-9]]*) ;;
 	  *\ \(GNU\ Binutils\)\ [[3-9]]*) ;;
@@ -4338,13 +4338,13 @@ dnl Note also adjust exclude_expsyms for C++ above.
     _LT_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath ${wl}$libdir'
     _LT_TAGVAR(export_dynamic_flag_spec, $1)='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       _LT_TAGVAR(whole_archive_flag_spec, $1)="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       _LT_TAGVAR(whole_archive_flag_spec, $1)=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [[01]].* | *\ 2.[[0-9]].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -4388,7 +4388,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	_LT_TAGVAR(allow_undefined_flag, $1)=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -4406,9 +4406,9 @@ _LT_EOF
       _LT_TAGVAR(allow_undefined_flag, $1)=unsupported
       _LT_TAGVAR(always_export_symbols, $1)=no
       _LT_TAGVAR(enable_shared_with_static_runtimes, $1)=yes
-      _LT_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[[BCDGRS]][[ ]]/s/.*[[ ]]\([[^ ]]*\)/\1 DATA/'\'' | $SED -e '\''/^[[AITW]][[ ]]/s/.*[[ ]]//'\'' | sort | uniq > $export_symbols'
+      _LT_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[[BCDGRS]][[ ]]/s/.*[[ ]]\([[^ ]]*\)/\1 DATA/'\'' | $SED -e '\''/^[[AITW]][[ ]]/s/.*[[ ]]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         _LT_TAGVAR(archive_cmds, $1)='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -4451,7 +4451,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=
@@ -4482,7 +4482,7 @@ _LT_EOF
 	  _LT_TAGVAR(compiler_needs_object, $1)=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  _LT_TAGVAR(whole_archive_flag_spec, $1)='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  _LT_TAGVAR(compiler_needs_object, $1)=yes
@@ -4520,7 +4520,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	_LT_TAGVAR(archive_cmds, $1)='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -4530,7 +4530,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	_LT_TAGVAR(ld_shlibs, $1)=no
 	cat <<_LT_EOF 1>&2
 
@@ -4542,7 +4542,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	_LT_TAGVAR(archive_cmds, $1)='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	_LT_TAGVAR(archive_expsym_cmds, $1)='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -4551,7 +4551,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [[01]].* | *\ 2.[[0-9]].* | *\ 2.1[[0-5]].*)
 	_LT_TAGVAR(ld_shlibs, $1)=no
 	cat <<_LT_EOF 1>&2
@@ -4570,7 +4570,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    _LT_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath ${wl}$libdir'
 	    _LT_TAGVAR(archive_cmds, $1)='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    _LT_TAGVAR(archive_expsym_cmds, $1)='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -4589,7 +4589,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	_LT_TAGVAR(archive_cmds, $1)='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	_LT_TAGVAR(archive_expsym_cmds, $1)='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -4633,10 +4633,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  _LT_TAGVAR(export_symbols_cmds, $1)='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && ([substr](\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  _LT_TAGVAR(export_symbols_cmds, $1)='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && ([substr](\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  _LT_TAGVAR(export_symbols_cmds, $1)='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B")) && ([substr](\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  _LT_TAGVAR(export_symbols_cmds, $1)='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B")) && ([substr](\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -4943,7 +4943,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	_LT_TAGVAR(archive_cmds, $1)='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	_LT_TAGVAR(archive_cmds, $1)='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -4969,7 +4969,7 @@ _LT_EOF
 	_LT_TAGVAR(hardcode_direct, $1)=yes
 	_LT_TAGVAR(hardcode_shlibpath_var, $1)=no
 	_LT_TAGVAR(hardcode_direct_absolute, $1)=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  _LT_TAGVAR(archive_cmds, $1)='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  _LT_TAGVAR(archive_expsym_cmds, $1)='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  _LT_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath,$libdir'
@@ -5038,7 +5038,7 @@ _LT_EOF
 	_LT_TAGVAR(archive_expsym_cmds, $1)='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  _LT_TAGVAR(archive_cmds, $1)='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -5532,7 +5532,7 @@ if test "$_lt_caught_CXX_error" != yes; then
         wlarc='${wl}'
 
         # ancient GNU ld didn't support --whole-archive et. al.
-        if eval "`$CC -print-prog-name=ld` --help 2>&1" |
+        if eval "`$CC -print-prog-name=ld | sed -e 's/\r//g'` --help 2>&1" | sed -e 's/\r//g' |
 	  $GREP 'no-whole-archive' > /dev/null; then
           _LT_TAGVAR(whole_archive_flag_spec, $1)="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
         else
@@ -5553,7 +5553,7 @@ if test "$_lt_caught_CXX_error" != yes; then
       # Commands to make compiler produce verbose output that lists
       # what "hidden" libraries, object files and flags are used when
       # linking a shared library.
-      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 
     else
       GXX=no
@@ -5696,7 +5696,7 @@ if test "$_lt_caught_CXX_error" != yes; then
         ;;
 
       beos*)
-	if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	if $LD --help 2>& | sed -e 's/\r//g'1 | $GREP ': supported targets:.* elf' > /dev/null; then
 	  _LT_TAGVAR(allow_undefined_flag, $1)=unsupported
 	  # Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	  # support --undefined.  This deserves some investigation.  FIXME
@@ -5724,7 +5724,7 @@ if test "$_lt_caught_CXX_error" != yes; then
         _LT_TAGVAR(always_export_symbols, $1)=no
         _LT_TAGVAR(enable_shared_with_static_runtimes, $1)=yes
 
-        if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+        if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
           _LT_TAGVAR(archive_cmds, $1)='$CC -shared -nostdlib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
           # If the export-symbols file already is a .def file (1st line
           # is EXPORTS), use it as is; otherwise, prepend...
@@ -5809,7 +5809,7 @@ if test "$_lt_caught_CXX_error" != yes; then
             # explicitly linking system object files so we need to strip them
             # from the output so that they don't get included in the library
             # dependencies.
-            output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | $EGREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+            output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | sed -e '"'"'s/\r//g'"'"' | $EGREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
             ;;
           *)
             if test "$GXX" = yes; then
@@ -5874,7 +5874,7 @@ if test "$_lt_caught_CXX_error" != yes; then
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | $GREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+	    output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | sed -e '"'"'s/\r//g'"'"' | $GREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
 	    ;;
           *)
 	    if test "$GXX" = yes; then
@@ -5959,7 +5959,7 @@ if test "$_lt_caught_CXX_error" != yes; then
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`$CC $CFLAGS -v conftest.$objext -o libconftest$shared_ext 2>&1 | $GREP "ld"`; rm -f libconftest$shared_ext; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+	    output_verbose_link_cmd='templist=`$CC $CFLAGS -v conftest.$objext -o libconftest$shared_ext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP "ld"`; rm -f libconftest$shared_ext; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
 
 	    _LT_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath,$libdir'
 	    _LT_TAGVAR(export_dynamic_flag_spec, $1)='${wl}--export-dynamic'
@@ -5974,7 +5974,7 @@ if test "$_lt_caught_CXX_error" != yes; then
 	    # version 8.0 and above of icpc choke on multiply defined symbols
 	    # if we add $predep_objects and $postdep_objects, however 7.1 and
 	    # earlier do not add the objects themselves.
-	    case `$CC -V 2>&1` in
+	    case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	      *"Version 7."*)
 	        _LT_TAGVAR(archive_cmds, $1)='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname -o $lib'
 		_LT_TAGVAR(archive_expsym_cmds, $1)='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -5995,7 +5995,7 @@ if test "$_lt_caught_CXX_error" != yes; then
 	    ;;
           pgCC* | pgcpp*)
             # Portland Group C++ compiler
-	    case `$CC -V` in
+	    case `$CC -V | sed -e 's/\r//g'` in
 	    *pgCC\ [[1-5]].* | *pgcpp\ [[1-5]].*)
 	      _LT_TAGVAR(prelink_cmds, $1)='tpldir=Template.dir~
 		rm -rf $tpldir~
@@ -6042,7 +6042,7 @@ if test "$_lt_caught_CXX_error" != yes; then
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP "ld"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld .*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "X$list" | $Xsed'
+	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP "ld"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld .*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "X$list" | $Xsed'
 	    ;;
 	  xl* | mpixl* | bgxl*)
 	    # IBM XL 8.0 on PPC, with GNU ld
@@ -6057,7 +6057,7 @@ if test "$_lt_caught_CXX_error" != yes; then
 	    fi
 	    ;;
 	  *)
-	    case `$CC -V 2>&1 | sed 5q` in
+	    case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	    *Sun\ C*)
 	      # Sun C++ 5.9
 	      _LT_TAGVAR(no_undefined_flag, $1)=' -zdefs'
@@ -6107,7 +6107,7 @@ if test "$_lt_caught_CXX_error" != yes; then
 	;;
 
       netbsd*)
-        if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+        if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	  _LT_TAGVAR(archive_cmds, $1)='$LD -Bshareable  -o $lib $predep_objects $libobjs $deplibs $postdep_objects $linker_flags'
 	  wlarc=
 	  _LT_TAGVAR(hardcode_libdir_flag_spec, $1)='-R$libdir'
@@ -6115,7 +6115,7 @@ if test "$_lt_caught_CXX_error" != yes; then
 	  _LT_TAGVAR(hardcode_shlibpath_var, $1)=no
 	fi
 	# Workaround some broken pre-1.5 toolchains
-	output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP conftest.$objext | $SED -e "s:-lgcc -lc -lgcc::"'
+	output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP conftest.$objext | $SED -e "s:-lgcc -lc -lgcc::"'
 	;;
 
       *nto* | *qnx*)
@@ -6134,7 +6134,7 @@ if test "$_lt_caught_CXX_error" != yes; then
 	  _LT_TAGVAR(hardcode_direct_absolute, $1)=yes
 	  _LT_TAGVAR(archive_cmds, $1)='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $lib'
 	  _LT_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath,$libdir'
-	  if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	    _LT_TAGVAR(archive_expsym_cmds, $1)='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-retain-symbols-file,$export_symbols -o $lib'
 	    _LT_TAGVAR(export_dynamic_flag_spec, $1)='${wl}-E'
 	    _LT_TAGVAR(whole_archive_flag_spec, $1)="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
@@ -6198,7 +6198,7 @@ if test "$_lt_caught_CXX_error" != yes; then
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP "ld" | $GREP -v "ld:"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld.*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP "ld" | $GREP -v "ld:"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld.*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
 	    ;;
 	  *)
 	    if test "$GXX" = yes && test "$with_gnu_ld" = no; then
@@ -6218,7 +6218,7 @@ if test "$_lt_caught_CXX_error" != yes; then
 	      # Commands to make compiler produce verbose output that lists
 	      # what "hidden" libraries, object files and flags are used when
 	      # linking a shared library.
-	      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+	      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 
 	    else
 	      # FIXME: insert proper C++ library support
@@ -6294,7 +6294,7 @@ if test "$_lt_caught_CXX_error" != yes; then
 	    # GNU C++ compiler with Solaris linker
 	    if test "$GXX" = yes && test "$with_gnu_ld" = no; then
 	      _LT_TAGVAR(no_undefined_flag, $1)=' ${wl}-z ${wl}defs'
-	      if $CC --version | $GREP -v '^2\.7' > /dev/null; then
+	      if $CC --version | sed -e 's/\r//g' | $GREP -v '^2\.7' > /dev/null; then
 	        _LT_TAGVAR(archive_cmds, $1)='$CC -shared -nostdlib $LDFLAGS $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-h $wl$soname -o $lib'
 	        _LT_TAGVAR(archive_expsym_cmds, $1)='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 		  $CC -shared -nostdlib ${wl}-M $wl$lib.exp -o $lib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags~$RM $lib.exp'
@@ -6302,7 +6302,7 @@ if test "$_lt_caught_CXX_error" != yes; then
 	        # Commands to make compiler produce verbose output that lists
 	        # what "hidden" libraries, object files and flags are used when
 	        # linking a shared library.
-	        output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+	        output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 	      else
 	        # g++ 2.7 appears to require `-G' NOT `-shared' on this
 	        # platform.
@@ -6313,7 +6313,7 @@ if test "$_lt_caught_CXX_error" != yes; then
 	        # Commands to make compiler produce verbose output that lists
 	        # what "hidden" libraries, object files and flags are used when
 	        # linking a shared library.
-	        output_verbose_link_cmd='$CC -G $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+	        output_verbose_link_cmd='$CC -G $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 	      fi
 
 	      _LT_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-R $wl$libdir'
@@ -6598,7 +6598,7 @@ interix[[3-9]]*)
   ;;
 
 linux*)
-  case `$CC -V 2>&1 | sed 5q` in
+  case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
   *Sun\ C*)
     # Sun C++ 5.9
 
diff --git a/gcc/libgo/config/ltmain.sh b/gcc/libgo/config/ltmain.sh
index ce66b44906..9a7b779cdc 100644
--- a/gcc/libgo/config/ltmain.sh
+++ b/gcc/libgo/config/ltmain.sh
@@ -2571,7 +2571,7 @@ extern \"C\" {
 	  progfiles=`$ECHO "$objs$old_deplibs" | $SP2NL | $SED "$lo2o" | $NL2SP`
 	  for progfile in $progfiles; do
 	    func_verbose "extracting global C symbols from \`$progfile'"
-	    $opt_dry_run || eval "$NM $progfile | $global_symbol_pipe >> '$nlist'"
+	    $opt_dry_run || eval "$NM $progfile | sed -e 's/\r//g' | $global_symbol_pipe >> '$nlist'"
 	  done
 
 	  if test -n "$exclude_expsyms"; then
@@ -2622,7 +2622,7 @@ extern \"C\" {
 	  name="$func_basename_result"
 	  $opt_dry_run || {
 	    $ECHO ": $name " >> "$nlist"
-	    eval "$NM $dlprefile 2>/dev/null | $global_symbol_pipe >> '$nlist'"
+	    eval "$NM $dlprefile 2>/dev/null | sed -e 's/\r//g' | $global_symbol_pipe >> '$nlist'"
 	  }
 	done
 
@@ -2799,6 +2799,7 @@ func_win32_libid ()
     if $OBJDUMP -f "$1" | $SED -e '10q' 2>/dev/null |
        $EGREP 'file format (pe-i386(.*architecture: i386)?|pe-arm-wince|pe-x86-64)' >/dev/null; then
       win32_nmres=`$NM -f posix -A "$1" |
+	$SED -n -e 's/\r//g' |
 	$SED -n -e '
 	    1,100{
 		/ I /{
diff --git a/gcc/libgo/configure b/gcc/libgo/configure
index ffe17c9be5..e3c1dfa657 100755
--- a/gcc/libgo/configure
+++ b/gcc/libgo/configure
@@ -1622,9 +1622,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1660,9 +1661,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1736,9 +1738,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1774,7 +1777,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -3681,9 +3684,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -3734,7 +3738,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3804,7 +3808,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3860,7 +3864,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -3917,7 +3921,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4306,7 +4310,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -4364,6 +4368,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -4611,9 +4620,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler --version >&5") 2>conftest.err
+  (eval "($ac_compiler --version | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -4665,7 +4675,7 @@ else
 
   am_cv_CCAS_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
 
@@ -4721,6 +4731,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -4769,7 +4784,7 @@ fi
 case ${host} in
   *-*-aix*)
     # Check default architecture for FAT library creation
-    if test -z "`$CC -x c -E /dev/null -g3 -o - | grep 64BIT`" ; then
+    if test -z "`$CC -x c -E /dev/null -g3 -o - | sed -e 's/\r//g' | grep 64BIT`" ; then
         AIX_EXTRA_ARCH='64'
     else
         AIX_EXTRA_ARCH='32'
@@ -5168,9 +5183,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -5212,7 +5227,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -5243,7 +5258,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -5682,10 +5697,12 @@ else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
   (eval echo "\"\$as_me:$LINENO: $ac_compile\"" >&5)
-  (eval "$ac_compile" 2>conftest.err)
+  (eval "($ac_compile | sed -e 's/\r//g')" 2>conftest.err)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: output\"" >&5)
   cat conftest.out >&5
@@ -6106,7 +6123,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -6168,7 +6185,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|_pic\.a)$'
@@ -6186,7 +6203,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
@@ -6687,7 +6704,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[ABCDGIRSTW]' ;;
 esac
@@ -6695,11 +6712,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -6733,7 +6750,7 @@ for ac_symprfx in "" "_"; do
 "     s[1]~prfx {split(s[1],t,\"@\"); print t[1], substr(t[1],length(prfx))}"\
 "     ' prfx=^$ac_symprfx"
   else
-    lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
+    lt_cv_sys_global_symbol_pipe="sed -n -e 's/\r//g' -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
   fi
 
   # Check to see that the pipe works correctly.
@@ -6754,14 +6771,14 @@ int main(){nm_test_var='a';nm_test_func();return(0);}
 _LT_EOF
 
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist\""; } >&5
-  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) 2>&5
+    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist\""; } >&5
+  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s "$nlist"; then
@@ -6782,7 +6799,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | sed -e '"'"'s/\r//g'"'"' | $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -6795,7 +6812,7 @@ lt__PROGRAM__LTX_preloaded_symbols[] =
 {
   { "@PROGRAM@", (void *) 0 },
 _LT_EOF
-	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | $GREP -v main >> conftest.$ac_ext
+	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | sed -e 's/\r//g' | $GREP -v main >> conftest.$ac_ext
 	  cat <<\_LT_EOF >> conftest.$ac_ext
   {0, (void *) 0}
 };
@@ -6818,7 +6835,7 @@ _LT_EOF
 	  LIBS="conftstm.$ac_objext"
 	  CFLAGS="$CFLAGS$lt_prog_compiler_no_builtin_flag"
 	  if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext}; then
@@ -6898,7 +6915,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6917,7 +6934,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo '#line '$LINENO' "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6955,7 +6972,7 @@ s390*-*linux*|s390*-*tpf*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7067,7 +7084,7 @@ sparc*-*solaris*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7600,6 +7617,7 @@ else
 	if test -f libconftest.dylib && test ! -s conftest.err && test $_lt_result = 0; then
 	  lt_cv_apple_cc_single_mod=yes
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err >&5
 	fi
 	rm -rf libconftest.dylib*
@@ -7662,6 +7680,7 @@ _LT_EOF
       if test -f conftest && test ! -s conftest.err && test $_lt_result = 0 && $GREP forced_load conftest 2>&1 >/dev/null; then
 	lt_cv_ld_force_load=yes
       else
+        dos2unix -q conftest.err
 	cat conftest.err >&5
       fi
         rm -f conftest.err libconftest.a conftest conftest.c
@@ -7877,7 +7896,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -7894,7 +7913,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -8511,13 +8530,15 @@ compiler_DEFAULT=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -8557,14 +8578,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -8779,7 +8802,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic='-KPIC'
@@ -8910,14 +8933,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works=yes
@@ -8959,10 +8984,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -9015,8 +9041,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -9024,6 +9051,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -9070,8 +9098,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -9079,6 +9108,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -9139,7 +9169,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object=no
   enable_shared_with_static_runtimes=no
   export_dynamic_flag_spec=
-  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic=no
   hardcode_direct=no
   hardcode_direct_absolute=no
@@ -9202,7 +9232,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -9228,13 +9258,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -9278,7 +9308,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -9296,9 +9326,9 @@ _LT_EOF
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -9341,7 +9371,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=
@@ -9372,7 +9402,7 @@ _LT_EOF
 	  compiler_needs_object=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object=yes
@@ -9410,7 +9440,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -9420,7 +9450,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
 
@@ -9432,7 +9462,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9441,7 +9471,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
@@ -9460,7 +9490,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
 	    archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -9479,7 +9509,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9523,10 +9553,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -9873,10 +9903,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS -b"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -9957,7 +9988,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -9983,7 +10014,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct=yes
 	hardcode_shlibpath_var=no
 	hardcode_direct_absolute=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
@@ -10052,7 +10083,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -10245,10 +10276,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -10274,6 +10306,7 @@ else
 	  fi
 	  allow_undefined_flag=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -10456,7 +10489,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([A-Za-z]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -10560,7 +10593,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -10923,7 +10956,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -10968,7 +11001,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -11614,7 +11647,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -11720,7 +11753,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -11912,13 +11945,15 @@ compiler=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -11982,14 +12017,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -12201,7 +12238,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static_GO='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic_GO='-KPIC'
@@ -12329,14 +12366,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works_GO=yes
@@ -12375,10 +12414,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -12428,8 +12468,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -12437,6 +12478,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o_GO=yes
@@ -12480,8 +12522,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -12489,6 +12532,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o_GO=yes
@@ -12546,7 +12590,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object_GO=no
   enable_shared_with_static_runtimes_GO=no
   export_dynamic_flag_spec_GO=
-  export_symbols_cmds_GO='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds_GO='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic_GO=no
   hardcode_direct_GO=no
   hardcode_direct_absolute_GO=no
@@ -12609,7 +12653,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -12635,13 +12679,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec_GO='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec_GO='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec_GO="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec_GO=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -12685,7 +12729,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag_GO=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -12703,9 +12747,9 @@ _LT_EOF
       allow_undefined_flag_GO=unsupported
       always_export_symbols_GO=no
       enable_shared_with_static_runtimes_GO=yes
-      export_symbols_cmds_GO='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds_GO='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds_GO='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -12748,7 +12792,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=
@@ -12779,7 +12823,7 @@ _LT_EOF
 	  compiler_needs_object_GO=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec_GO='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object_GO=yes
@@ -12817,7 +12861,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds_GO='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -12827,7 +12871,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs_GO=no
 	cat <<_LT_EOF 1>&2
 
@@ -12839,7 +12883,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds_GO='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds_GO='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -12848,7 +12892,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs_GO=no
 	cat <<_LT_EOF 1>&2
@@ -12867,7 +12911,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec_GO='${wl}-rpath ${wl}$libdir'
 	    archive_cmds_GO='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds_GO='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -12886,7 +12930,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds_GO='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds_GO='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -12930,10 +12974,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds_GO='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds_GO='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds_GO='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds_GO='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -13325,7 +13369,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds_GO='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds_GO='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -13351,7 +13395,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct_GO=yes
 	hardcode_shlibpath_var_GO=no
 	hardcode_direct_absolute_GO=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds_GO='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds_GO='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec_GO='${wl}-rpath,$libdir'
@@ -13420,7 +13464,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds_GO='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds_GO='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -13604,10 +13648,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -13633,6 +13678,7 @@ else
 	  fi
 	  allow_undefined_flag_GO=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -15715,7 +15761,7 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 #include <sys/stat.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "timespec_t.*st_atim" >/dev/null 2>&1; then :
   have_stat_timespec=yes
 else
diff --git a/gcc/libgo/configure.ac b/gcc/libgo/configure.ac
index 7e2b98ba67..955f62b0e8 100644
--- a/gcc/libgo/configure.ac
+++ b/gcc/libgo/configure.ac
@@ -34,7 +34,7 @@ AC_SUBST(CFLAGS)
 case ${host} in
   *-*-aix*)
     # Check default architecture for FAT library creation
-    if test -z "`$CC -x c -E /dev/null -g3 -o - | grep 64BIT`" ; then
+    if test -z "`$CC -x c -E /dev/null -g3 -o - | sed -e 's/\r//g' | grep 64BIT`" ; then
         AIX_EXTRA_ARCH='64'
     else
         AIX_EXTRA_ARCH='32'
diff --git a/gcc/libgo/testsuite/gotest b/gcc/libgo/testsuite/gotest
index 04e4267fbb..8be531a8d0 100755
--- a/gcc/libgo/testsuite/gotest
+++ b/gcc/libgo/testsuite/gotest
@@ -578,9 +578,9 @@ symtogo() {
 # The argument is the function name prefix.
 findfuncs() {
 	pattern='$1([^a-z].*)?'
-	syms=$($NM -p -v _gotest_.o | egrep " $text .*\."$pattern'$' | fgrep -v ' __go_' | egrep -v '\.\.\w+$' | sed 's/.* //')
+	syms=$($NM -p -v _gotest_.o | sed -e 's/\r//g' | egrep " $text .*\."$pattern'$' | fgrep -v ' __go_' | egrep -v '\.\.\w+$' | sed 's/.* //')
 	if $havex; then
-	    xsyms=$($NM -p -v $xofile | egrep " $text .*\."$pattern'$' | fgrep -v ' __go_' | egrep -v '\.\.\w+$' | sed 's/.* //')
+	    xsyms=$($NM -p -v $xofile | sed -e 's/\r//g' | egrep " $text .*\."$pattern'$' | fgrep -v ' __go_' | egrep -v '\.\.\w+$' | sed 's/.* //')
 	    syms="$syms $xsyms"
 	fi
         $(symtogo "$benchmarksyms")
@@ -618,10 +618,10 @@ exampleoutput() {
 	pattern='Test([^a-z].*)?'
 	# The -p option tells GNU nm not to sort.
 	# The -v option tells Solaris nm to sort by value.
-        testsyms=$($NM -p -v _gotest_.o | egrep " $text .*\."$pattern'$' | fgrep -v ' __go_' | egrep -v '\.\.\w+$' | sed 's/.* //')
+        testsyms=$($NM -p -v _gotest_.o | sed -e 's/\r//g' | egrep " $text .*\."$pattern'$' | fgrep -v ' __go_' | egrep -v '\.\.\w+$' | sed 's/.* //')
 	testxsyms=
 	if $havex; then
-	    testxsyms=$($NM -p -v $xofile | egrep " $text .*\."$pattern'$' | fgrep -v ' __go_' | egrep -v '\.\.\w+$' | sed 's/.* //')
+	    testxsyms=$($NM -p -v $xofile | sed -e 's/\r//g' | egrep " $text .*\."$pattern'$' | fgrep -v ' __go_' | egrep -v '\.\.\w+$' | sed 's/.* //')
 	    testsyms="$testsyms $testxsyms"
 	fi
         tests=$(symtogo "$testsyms")
diff --git a/gcc/libgomp/acinclude.m4 b/gcc/libgomp/acinclude.m4
index 12fbb20066..769065155f 100644
--- a/gcc/libgomp/acinclude.m4
+++ b/gcc/libgomp/acinclude.m4
@@ -151,13 +151,13 @@ AC_DEFUN([LIBGOMP_CHECK_LINKER_FEATURES], [
   # does some of this, but throws away the result.
   libgomp_ld_is_gold=no
   libgomp_ld_is_mold=no
-  if $LD --version 2>/dev/null | grep 'GNU gold'> /dev/null 2>&1; then
+  if $LD --version 2>/dev/null | sed -e 's/\r//g' | grep 'GNU gold'> /dev/null 2>&1; then
     libgomp_ld_is_gold=yes
-  elif $LD --version 2>/dev/null | grep 'mold'> /dev/null 2>&1; then
+  elif $LD --version 2>/dev/null | sed -e 's/\r//g' | grep 'mold'> /dev/null 2>&1; then
     libgomp_ld_is_mold=yes
   fi
   changequote(,)
-  ldver=`$LD --version 2>/dev/null |
+  ldver=`$LD --version 2>/dev/null | sed -e 's/\r//g' |
          sed -e 's/[. ][0-9]\{8\}$//;s/.* \([^ ]\{1,\}\)$/\1/; q'`
   changequote([,])
   libgomp_gnu_ld_version=`echo $ldver | \
diff --git a/gcc/libgomp/configure b/gcc/libgomp/configure
index 85fdb4d3f4..4a70eeb6d8 100755
--- a/gcc/libgomp/configure
+++ b/gcc/libgomp/configure
@@ -1642,9 +1642,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1680,9 +1681,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1756,9 +1758,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1794,7 +1797,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -1903,9 +1906,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1941,9 +1945,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -3547,7 +3552,7 @@ case ${enable_version_specific_runtime_libs} in
       toolexecdir='$(libdir)/gcc-lib/$(target_alias)'
       toolexeclibdir='$(libdir)'
     fi
-    multi_os_directory=`$CC -print-multi-os-directory`
+    multi_os_directory=`$CC -print-multi-os-directory | sed -e 's/\r//g'`
     case $multi_os_directory in
       .) ;; # Avoid trailing /.
       *) toolexeclibdir=$toolexeclibdir/$multi_os_directory ;;
@@ -3880,9 +3885,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -3933,7 +3939,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4003,7 +4009,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4059,7 +4065,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -4116,7 +4122,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4505,7 +4511,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -4563,6 +4569,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -4932,7 +4943,7 @@ $as_echo_n "checking for modern makeinfo... " >&6; }
 if ${gcc_cv_prog_makeinfo_modern+:} false; then :
   $as_echo_n "(cached) " >&6
 else
-  ac_prog_version=`eval $MAKEINFO --version 2>&1 |
+  ac_prog_version=`eval $MAKEINFO --version 2>&1 | sed -e 's/\r//g' |
                                      sed -n 's/^.*GNU texinfo.* \([0-9][0-9.]*\).*$/\1/p'`
 
                     case $ac_prog_version in
@@ -5370,9 +5381,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -5414,7 +5425,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -5445,7 +5456,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -5653,10 +5664,12 @@ else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
   (eval echo "\"\$as_me:$LINENO: $ac_compile\"" >&5)
-  (eval "$ac_compile" 2>conftest.err)
+  (eval "($ac_compile | sed -e 's/\r//g')" 2>conftest.err)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: output\"" >&5)
   cat conftest.out >&5
@@ -6077,7 +6090,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -6139,7 +6152,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu | uclinuxfdpiceabi)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|_pic\.a)$'
@@ -6157,7 +6170,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
@@ -6658,7 +6671,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[ABCDGIRSTW]' ;;
 esac
@@ -6666,11 +6679,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -6704,7 +6717,7 @@ for ac_symprfx in "" "_"; do
 "     s[1]~prfx {split(s[1],t,\"@\"); print t[1], substr(t[1],length(prfx))}"\
 "     ' prfx=^$ac_symprfx"
   else
-    lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
+    lt_cv_sys_global_symbol_pipe="sed -n -e 's/\r//g' -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
   fi
 
   # Check to see that the pipe works correctly.
@@ -6725,14 +6738,14 @@ int main(){nm_test_var='a';nm_test_func();return(0);}
 _LT_EOF
 
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist\""; } >&5
-  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) 2>&5
+    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist\""; } >&5
+  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s "$nlist"; then
@@ -6753,7 +6766,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | sed -e '"'"'s/\r//g'"'"' | $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -6766,7 +6779,7 @@ lt__PROGRAM__LTX_preloaded_symbols[] =
 {
   { "@PROGRAM@", (void *) 0 },
 _LT_EOF
-	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | $GREP -v main >> conftest.$ac_ext
+	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | sed -e 's/\r//g' | $GREP -v main >> conftest.$ac_ext
 	  cat <<\_LT_EOF >> conftest.$ac_ext
   {0, (void *) 0}
 };
@@ -6789,7 +6802,7 @@ _LT_EOF
 	  LIBS="conftstm.$ac_objext"
 	  CFLAGS="$CFLAGS$lt_prog_compiler_no_builtin_flag"
 	  if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext}; then
@@ -6869,7 +6882,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6888,7 +6901,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo '#line '$LINENO' "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6926,7 +6939,7 @@ s390*-*linux*|s390*-*tpf*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7038,7 +7051,7 @@ sparc*-*solaris*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7571,6 +7584,7 @@ else
 	if test -f libconftest.dylib && test ! -s conftest.err && test $_lt_result = 0; then
 	  lt_cv_apple_cc_single_mod=yes
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err >&5
 	fi
 	rm -rf libconftest.dylib*
@@ -7633,6 +7647,7 @@ _LT_EOF
       if test -f conftest && test ! -s conftest.err && test $_lt_result = 0 && $GREP forced_load conftest 2>&1 >/dev/null; then
 	lt_cv_ld_force_load=yes
       else
+        dos2unix -q conftest.err
 	cat conftest.err >&5
       fi
         rm -f conftest.err libconftest.a conftest conftest.c
@@ -7850,7 +7865,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -7867,7 +7882,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -8393,13 +8408,15 @@ compiler_DEFAULT=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -8439,14 +8456,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -8661,7 +8680,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic='-KPIC'
@@ -8792,14 +8811,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works=yes
@@ -8841,10 +8862,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -8897,8 +8919,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8906,6 +8929,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8952,8 +8976,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8961,6 +8986,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -9021,7 +9047,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object=no
   enable_shared_with_static_runtimes=no
   export_dynamic_flag_spec=
-  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic=no
   hardcode_direct=no
   hardcode_direct_absolute=no
@@ -9084,7 +9110,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -9110,13 +9136,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -9160,7 +9186,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -9178,9 +9204,9 @@ _LT_EOF
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -9223,7 +9249,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -9254,7 +9280,7 @@ _LT_EOF
 	  compiler_needs_object=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object=yes
@@ -9292,7 +9318,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -9302,7 +9328,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
 
@@ -9314,7 +9340,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9323,7 +9349,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
@@ -9342,7 +9368,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
 	    archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -9361,7 +9387,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9405,10 +9431,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -9755,10 +9781,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS -b"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -9839,7 +9866,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -9865,7 +9892,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct=yes
 	hardcode_shlibpath_var=no
 	hardcode_direct_absolute=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
@@ -9934,7 +9961,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -10127,10 +10154,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -10156,6 +10184,7 @@ else
 	  fi
 	  allow_undefined_flag=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -10338,7 +10367,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([A-Za-z]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -10442,7 +10471,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -10810,7 +10839,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -10855,7 +10884,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -11501,7 +11530,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -11607,7 +11636,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -11958,9 +11987,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -12130,13 +12160,15 @@ compiler=$CC
   # save warnings/boilerplate of simple test code
   ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
   ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -12220,7 +12252,7 @@ cat > conftest.$ac_ext <<_LT_EOF
 _LT_EOF
 
 if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -12536,7 +12568,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static_FC='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic_FC='-KPIC'
@@ -12664,14 +12696,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works_FC=yes
@@ -12710,10 +12744,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -12763,8 +12798,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -12772,6 +12808,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o_FC=yes
@@ -12815,8 +12852,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -12824,6 +12862,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o_FC=yes
@@ -12881,7 +12920,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object_FC=no
   enable_shared_with_static_runtimes_FC=no
   export_dynamic_flag_spec_FC=
-  export_symbols_cmds_FC='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds_FC='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic_FC=no
   hardcode_direct_FC=no
   hardcode_direct_absolute_FC=no
@@ -12944,7 +12983,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -12970,13 +13009,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec_FC='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec_FC='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec_FC="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec_FC=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -13020,7 +13059,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag_FC=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -13038,9 +13077,9 @@ _LT_EOF
       allow_undefined_flag_FC=unsupported
       always_export_symbols_FC=no
       enable_shared_with_static_runtimes_FC=yes
-      export_symbols_cmds_FC='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds_FC='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds_FC='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -13083,7 +13122,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -13114,7 +13153,7 @@ _LT_EOF
 	  compiler_needs_object_FC=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec_FC='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object_FC=yes
@@ -13152,7 +13191,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds_FC='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -13162,7 +13201,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs_FC=no
 	cat <<_LT_EOF 1>&2
 
@@ -13174,7 +13213,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds_FC='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds_FC='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -13183,7 +13222,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs_FC=no
 	cat <<_LT_EOF 1>&2
@@ -13202,7 +13241,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec_FC='${wl}-rpath ${wl}$libdir'
 	    archive_cmds_FC='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds_FC='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -13221,7 +13260,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds_FC='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds_FC='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -13265,10 +13304,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds_FC='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds_FC='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds_FC='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds_FC='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -13647,7 +13686,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds_FC='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds_FC='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -13673,7 +13712,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct_FC=yes
 	hardcode_shlibpath_var_FC=no
 	hardcode_direct_absolute_FC=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds_FC='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds_FC='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec_FC='${wl}-rpath,$libdir'
@@ -13742,7 +13781,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds_FC='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds_FC='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -13926,10 +13965,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -13955,6 +13995,7 @@ else
 	  fi
 	  allow_undefined_flag_FC=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -14084,7 +14125,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -14444,7 +14485,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -14489,7 +14530,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -14779,7 +14820,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -14796,7 +14837,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -16120,9 +16161,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -16164,7 +16205,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -16195,7 +16236,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -16241,13 +16282,13 @@ with_gnu_ld=$lt_cv_prog_gnu_ld
   # does some of this, but throws away the result.
   libgomp_ld_is_gold=no
   libgomp_ld_is_mold=no
-  if $LD --version 2>/dev/null | grep 'GNU gold'> /dev/null 2>&1; then
+  if $LD --version 2>/dev/null | sed -e 's/\r//g' | grep 'GNU gold'> /dev/null 2>&1; then
     libgomp_ld_is_gold=yes
-  elif $LD --version 2>/dev/null | grep 'mold'> /dev/null 2>&1; then
+  elif $LD --version 2>/dev/null | sed -e 's/\r//g' | grep 'mold'> /dev/null 2>&1; then
     libgomp_ld_is_mold=yes
   fi
 
-  ldver=`$LD --version 2>/dev/null |
+  ldver=`$LD --version 2>/dev/null | sed -e 's/\r//g' |
          sed -e 's/[. ][0-9]\{8\}$//;s/.* \([^ ]\{1,\}\)$/\1/; q'`
 
   libgomp_gnu_ld_version=`echo $ldver | \
@@ -16407,6 +16448,7 @@ EOF
     libgomp_libgcc_s_suffix=`${CC-cc} $CFLAGS $CPPFLAGS $LDFLAGS \
 			     -shared -shared-libgcc -o conftest.so \
 			     conftest.c -v 2>&1 >/dev/null \
+			     | sed -e 's/\r//g' \
 			     | sed -n 's/^.* -lgcc_s\([^ ]*\) .*$/\1/p'`
     rm -f conftest.c conftest.so
     if test x${libgomp_libgcc_s_suffix+set} = xset; then
diff --git a/gcc/libgomp/configure.ac b/gcc/libgomp/configure.ac
index a9b1f3973f..003d66ee30 100644
--- a/gcc/libgomp/configure.ac
+++ b/gcc/libgomp/configure.ac
@@ -93,7 +93,7 @@ case ${enable_version_specific_runtime_libs} in
       toolexecdir='$(libdir)/gcc-lib/$(target_alias)'
       toolexeclibdir='$(libdir)'
     fi
-    multi_os_directory=`$CC -print-multi-os-directory`
+    multi_os_directory=`$CC -print-multi-os-directory | sed -e 's/\r//g'`
     case $multi_os_directory in
       .) ;; # Avoid trailing /.
       *) toolexeclibdir=$toolexeclibdir/$multi_os_directory ;;
diff --git a/gcc/libiberty/configure b/gcc/libiberty/configure
index 0a797255c7..1e1e470803 100755
--- a/gcc/libiberty/configure
+++ b/gcc/libiberty/configure
@@ -1454,9 +1454,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1491,9 +1492,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1616,7 +1618,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -1689,9 +1691,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2617,7 +2620,7 @@ $as_echo "$as_me: WARNING:
 *** Makeinfo is missing. Info documentation will not be built." >&2;}
         ;;
       *)
-	case x"`$MAKEINFO --version | grep 'GNU texinfo'`" in
+	case x"`$MAKEINFO --version | sed -e 's/\r//g' | grep 'GNU texinfo'`" in
 	  x*\ [1-3].* )
 	    MAKEINFO="@echo $MAKEINFO is too old, 4.0 or newer required; true"
 	    BUILD_INFO=
@@ -3301,9 +3304,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -3327,7 +3331,7 @@ printf ("hello world\n");
 _ACEOF
 # FIXME: Cleanup?
 if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3382,7 +3386,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3452,7 +3456,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3508,7 +3512,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -3566,7 +3570,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4107,7 +4111,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -4124,7 +4128,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -6744,7 +6748,7 @@ wenotbecray
 #endif
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "webecray" >/dev/null 2>&1; then :
   ac_cv_os_cray=yes
 else
diff --git a/gcc/libiberty/configure.ac b/gcc/libiberty/configure.ac
index 84a7b378fa..d47e7c1abd 100644
--- a/gcc/libiberty/configure.ac
+++ b/gcc/libiberty/configure.ac
@@ -81,7 +81,7 @@ else
 *** Makeinfo is missing. Info documentation will not be built.])
         ;;
       *)
-	case x"`$MAKEINFO --version | grep 'GNU texinfo'`" in
+	case x"`$MAKEINFO --version | sed -e 's/\r//g' | grep 'GNU texinfo'`" in
 	  x*\ [[1-3]].* )
 	    MAKEINFO="@echo $MAKEINFO is too old, 4.0 or newer required; true"
 	    BUILD_INFO=
diff --git a/gcc/libitm/acinclude.m4 b/gcc/libitm/acinclude.m4
index 9fd12e6ee7..308baee727 100644
--- a/gcc/libitm/acinclude.m4
+++ b/gcc/libitm/acinclude.m4
@@ -244,13 +244,13 @@ AC_DEFUN([LIBITM_CHECK_LINKER_FEATURES], [
   # does some of this, but throws away the result.
   libitm_ld_is_gold=no
   libitm_ld_is_mold=no
-  if $LD --version 2>/dev/null | grep 'GNU gold'> /dev/null 2>&1; then
+  if $LD --version 2>/dev/null | sed -e 's/\r//g' | grep 'GNU gold'> /dev/null 2>&1; then
     libitm_ld_is_gold=yes
-  elif $LD --version 2>/dev/null | grep 'mold' >/dev/null 2>&1; then
+  elif $LD --version 2>/dev/null | sed -e 's/\r//g' | grep 'mold' >/dev/null 2>&1; then
     libitm_ld_is_mold=yes
   fi
   changequote(,)
-  ldver=`$LD --version 2>/dev/null |
+  ldver=`$LD --version 2>/dev/null | sed -e 's/\r//g' |
          sed -e 's/[. ][0-9]\{8\}$//;s/.* \([^ ]\{1,\}\)$/\1/; q'`
   changequote([,])
   libitm_gnu_ld_version=`echo $ldver | \
diff --git a/gcc/libitm/configure b/gcc/libitm/configure
index 18fc2d3a10..b9b36b4fa7 100755
--- a/gcc/libitm/configure
+++ b/gcc/libitm/configure
@@ -1595,9 +1595,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1633,9 +1634,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1671,9 +1673,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1747,9 +1750,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1785,7 +1789,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -1893,9 +1897,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1931,9 +1936,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -3576,7 +3582,7 @@ case ${enable_version_specific_runtime_libs} in
       toolexecdir='$(libdir)/gcc-lib/$(target_alias)'
       toolexeclibdir='$(libdir)'
     fi
-    multi_os_directory=`$CC -print-multi-os-directory`
+    multi_os_directory=`$CC -print-multi-os-directory | sed -e 's/\r//g'`
     case $multi_os_directory in
       .) ;; # Avoid trailing /.
       *) toolexeclibdir=$toolexeclibdir/$multi_os_directory ;;
@@ -3909,9 +3915,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -3962,7 +3969,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4032,7 +4039,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4088,7 +4095,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -4145,7 +4152,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4534,7 +4541,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -4592,6 +4599,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -4756,9 +4768,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -4919,7 +4932,7 @@ else
 
   am_cv_CXX_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -4977,6 +4990,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -5054,7 +5072,7 @@ else
 
   am_cv_CCAS_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
 
@@ -5110,6 +5128,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -5558,7 +5581,7 @@ $as_echo_n "checking for modern makeinfo... " >&6; }
 if ${gcc_cv_prog_makeinfo_modern+:} false; then :
   $as_echo_n "(cached) " >&6
 else
-  ac_prog_version=`eval $MAKEINFO --version 2>&1 |
+  ac_prog_version=`eval $MAKEINFO --version 2>&1 | sed -e 's/\r//g' |
                                      sed -n 's/^.*GNU texinfo.* \([0-9][0-9.]*\).*$/\1/p'`
 
                     case $ac_prog_version in
@@ -5996,9 +6019,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -6040,7 +6063,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -6071,7 +6094,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -6279,10 +6302,12 @@ else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
   (eval echo "\"\$as_me:$LINENO: $ac_compile\"" >&5)
-  (eval "$ac_compile" 2>conftest.err)
+  (eval "($ac_compile | sed -e 's/\r//g')" 2>conftest.err)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: output\"" >&5)
   cat conftest.out >&5
@@ -6703,7 +6728,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -6765,7 +6790,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu | uclinuxfdpiceabi)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|_pic\.a)$'
@@ -6783,7 +6808,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
@@ -7284,7 +7309,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[ABCDGIRSTW]' ;;
 esac
@@ -7292,11 +7317,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -7330,7 +7355,7 @@ for ac_symprfx in "" "_"; do
 "     s[1]~prfx {split(s[1],t,\"@\"); print t[1], substr(t[1],length(prfx))}"\
 "     ' prfx=^$ac_symprfx"
   else
-    lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
+    lt_cv_sys_global_symbol_pipe="sed -n -e 's/\r//g' -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
   fi
 
   # Check to see that the pipe works correctly.
@@ -7351,14 +7376,14 @@ int main(){nm_test_var='a';nm_test_func();return(0);}
 _LT_EOF
 
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist\""; } >&5
-  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) 2>&5
+    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist\""; } >&5
+  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s "$nlist"; then
@@ -7379,7 +7404,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist"  | sed -e '"'"'s/\r//g'"'"'| $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -7392,7 +7417,7 @@ lt__PROGRAM__LTX_preloaded_symbols[] =
 {
   { "@PROGRAM@", (void *) 0 },
 _LT_EOF
-	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | $GREP -v main >> conftest.$ac_ext
+	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | sed -e 's/\r//g' | $GREP -v main >> conftest.$ac_ext
 	  cat <<\_LT_EOF >> conftest.$ac_ext
   {0, (void *) 0}
 };
@@ -7415,7 +7440,7 @@ _LT_EOF
 	  LIBS="conftstm.$ac_objext"
 	  CFLAGS="$CFLAGS$lt_prog_compiler_no_builtin_flag"
 	  if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext}; then
@@ -7495,7 +7520,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7514,7 +7539,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo '#line '$LINENO' "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7552,7 +7577,7 @@ s390*-*linux*|s390*-*tpf*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7664,7 +7689,7 @@ sparc*-*solaris*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -8197,6 +8222,7 @@ else
 	if test -f libconftest.dylib && test ! -s conftest.err && test $_lt_result = 0; then
 	  lt_cv_apple_cc_single_mod=yes
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err >&5
 	fi
 	rm -rf libconftest.dylib*
@@ -8259,6 +8285,7 @@ _LT_EOF
       if test -f conftest && test ! -s conftest.err && test $_lt_result = 0 && $GREP forced_load conftest 2>&1 >/dev/null; then
 	lt_cv_ld_force_load=yes
       else
+        dos2unix -q conftest.err
 	cat conftest.err >&5
       fi
         rm -f conftest.err libconftest.a conftest conftest.c
@@ -8476,7 +8503,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -8493,7 +8520,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -9020,13 +9047,15 @@ compiler_DEFAULT=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -9066,14 +9095,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -9288,7 +9319,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic='-KPIC'
@@ -9419,14 +9450,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works=yes
@@ -9468,10 +9501,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -9524,8 +9558,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -9533,6 +9568,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -9579,8 +9615,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -9588,6 +9625,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -9648,7 +9686,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object=no
   enable_shared_with_static_runtimes=no
   export_dynamic_flag_spec=
-  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic=no
   hardcode_direct=no
   hardcode_direct_absolute=no
@@ -9711,7 +9749,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -9737,13 +9775,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -9787,7 +9825,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -9805,9 +9843,9 @@ _LT_EOF
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -9850,7 +9888,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -9881,7 +9919,7 @@ _LT_EOF
 	  compiler_needs_object=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object=yes
@@ -9919,7 +9957,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -9929,7 +9967,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
 
@@ -9941,7 +9979,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9950,7 +9988,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
@@ -9969,7 +10007,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
 	    archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -9988,7 +10026,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -10032,10 +10070,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -10382,10 +10420,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS -b"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -10466,7 +10505,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -10492,7 +10531,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct=yes
 	hardcode_shlibpath_var=no
 	hardcode_direct_absolute=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
@@ -10561,7 +10600,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -10754,10 +10793,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -10783,6 +10823,7 @@ else
 	  fi
 	  allow_undefined_flag=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -10965,7 +11006,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([A-Za-z]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -11069,7 +11110,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -11437,7 +11478,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -11482,7 +11523,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -12128,7 +12169,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -12234,7 +12275,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -12590,13 +12631,15 @@ compiler=$CC
   # save warnings/boilerplate of simple test code
   ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
   ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -12662,9 +12705,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -12706,7 +12749,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -12737,7 +12780,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -12771,7 +12814,7 @@ with_gnu_ld=$lt_cv_prog_gnu_ld
         wlarc='${wl}'
 
         # ancient GNU ld didn't support --whole-archive et. al.
-        if eval "`$CC -print-prog-name=ld` --help 2>&1" |
+        if eval "`$CC -print-prog-name=ld | sed -e 's/\r//g'` --help 2>&1" | sed -e 's/\r//g' |
 	  $GREP 'no-whole-archive' > /dev/null; then
           whole_archive_flag_spec_CXX="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
         else
@@ -12792,7 +12835,7 @@ with_gnu_ld=$lt_cv_prog_gnu_ld
       # Commands to make compiler produce verbose output that lists
       # what "hidden" libraries, object files and flags are used when
       # linking a shared library.
-      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 
     else
       GXX=no
@@ -12994,7 +13037,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
         ;;
 
       beos*)
-	if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	  allow_undefined_flag_CXX=unsupported
 	  # Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	  # support --undefined.  This deserves some investigation.  FIXME
@@ -13022,7 +13065,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
         always_export_symbols_CXX=no
         enable_shared_with_static_runtimes_CXX=yes
 
-        if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+        if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
           archive_cmds_CXX='$CC -shared -nostdlib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
           # If the export-symbols file already is a .def file (1st line
           # is EXPORTS), use it as is; otherwise, prepend...
@@ -13138,7 +13181,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
             # explicitly linking system object files so we need to strip them
             # from the output so that they don't get included in the library
             # dependencies.
-            output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | $EGREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+            output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | sed -e '"'"'s/\r//g'"'"' | $EGREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
             ;;
           *)
             if test "$GXX" = yes; then
@@ -13203,7 +13246,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | $GREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+	    output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | sed -e '"'"'s/\r//g'"'"' | $GREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
 	    ;;
           *)
 	    if test "$GXX" = yes; then
@@ -13288,7 +13331,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`$CC $CFLAGS -v conftest.$objext -o libconftest$shared_ext 2>&1 | $GREP "ld"`; rm -f libconftest$shared_ext; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+	    output_verbose_link_cmd='templist=`$CC $CFLAGS -v conftest.$objext -o libconftest$shared_ext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP "ld"`; rm -f libconftest$shared_ext; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
 
 	    hardcode_libdir_flag_spec_CXX='${wl}-rpath,$libdir'
 	    export_dynamic_flag_spec_CXX='${wl}--export-dynamic'
@@ -13303,7 +13346,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # version 8.0 and above of icpc choke on multiply defined symbols
 	    # if we add $predep_objects and $postdep_objects, however 7.1 and
 	    # earlier do not add the objects themselves.
-	    case `$CC -V 2>&1` in
+	    case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	      *"Version 7."*)
 	        archive_cmds_CXX='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname -o $lib'
 		archive_expsym_cmds_CXX='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -13324,7 +13367,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    ;;
           pgCC* | pgcpp*)
             # Portland Group C++ compiler
-	    case `$CC -V` in
+	    case `$CC -V | sed -e 's/\r//g'` in
 	    *pgCC\ [1-5].* | *pgcpp\ [1-5].*)
 	      prelink_cmds_CXX='tpldir=Template.dir~
 		rm -rf $tpldir~
@@ -13371,7 +13414,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP "ld"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld .*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "X$list" | $Xsed'
+	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP "ld"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld .*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "X$list" | $Xsed'
 	    ;;
 	  xl* | mpixl* | bgxl*)
 	    # IBM XL 8.0 on PPC, with GNU ld
@@ -13386,7 +13429,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    fi
 	    ;;
 	  *)
-	    case `$CC -V 2>&1 | sed 5q` in
+	    case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	    *Sun\ C*)
 	      # Sun C++ 5.9
 	      no_undefined_flag_CXX=' -zdefs'
@@ -13436,7 +13479,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	;;
 
       netbsd*)
-        if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+        if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	  archive_cmds_CXX='$LD -Bshareable  -o $lib $predep_objects $libobjs $deplibs $postdep_objects $linker_flags'
 	  wlarc=
 	  hardcode_libdir_flag_spec_CXX='-R$libdir'
@@ -13444,7 +13487,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	  hardcode_shlibpath_var_CXX=no
 	fi
 	# Workaround some broken pre-1.5 toolchains
-	output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP conftest.$objext | $SED -e "s:-lgcc -lc -lgcc::"'
+	output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP conftest.$objext | $SED -e "s:-lgcc -lc -lgcc::"'
 	;;
 
       *nto* | *qnx*)
@@ -13463,7 +13506,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	  hardcode_direct_absolute_CXX=yes
 	  archive_cmds_CXX='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $lib'
 	  hardcode_libdir_flag_spec_CXX='${wl}-rpath,$libdir'
-	  if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	    archive_expsym_cmds_CXX='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-retain-symbols-file,$export_symbols -o $lib'
 	    export_dynamic_flag_spec_CXX='${wl}-E'
 	    whole_archive_flag_spec_CXX="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
@@ -13527,7 +13570,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP "ld" | $GREP -v "ld:"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld.*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP "ld" | $GREP -v "ld:"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld.*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
 	    ;;
 	  *)
 	    if test "$GXX" = yes && test "$with_gnu_ld" = no; then
@@ -13547,7 +13590,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	      # Commands to make compiler produce verbose output that lists
 	      # what "hidden" libraries, object files and flags are used when
 	      # linking a shared library.
-	      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+	      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 
 	    else
 	      # FIXME: insert proper C++ library support
@@ -13623,7 +13666,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # GNU C++ compiler with Solaris linker
 	    if test "$GXX" = yes && test "$with_gnu_ld" = no; then
 	      no_undefined_flag_CXX=' ${wl}-z ${wl}defs'
-	      if $CC --version | $GREP -v '^2\.7' > /dev/null; then
+	      if $CC --version | sed -e 's/\r//g' | $GREP -v '^2\.7' > /dev/null; then
 	        archive_cmds_CXX='$CC -shared -nostdlib $LDFLAGS $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-h $wl$soname -o $lib'
 	        archive_expsym_cmds_CXX='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 		  $CC -shared -nostdlib ${wl}-M $wl$lib.exp -o $lib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags~$RM $lib.exp'
@@ -13631,7 +13674,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	        # Commands to make compiler produce verbose output that lists
 	        # what "hidden" libraries, object files and flags are used when
 	        # linking a shared library.
-	        output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+	        output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 	      else
 	        # g++ 2.7 appears to require `-G' NOT `-shared' on this
 	        # platform.
@@ -13642,7 +13685,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	        # Commands to make compiler produce verbose output that lists
 	        # what "hidden" libraries, object files and flags are used when
 	        # linking a shared library.
-	        output_verbose_link_cmd='$CC -G $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+	        output_verbose_link_cmd='$CC -G $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 	      fi
 
 	      hardcode_libdir_flag_spec_CXX='${wl}-R $wl$libdir'
@@ -13762,7 +13805,7 @@ private:
 _LT_EOF
 
 if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -13858,7 +13901,7 @@ interix[3-9]*)
   ;;
 
 linux*)
-  case `$CC -V 2>&1 | sed 5q` in
+  case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
   *Sun\ C*)
     # Sun C++ 5.9
 
@@ -14148,7 +14191,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	    lt_prog_compiler_static_CXX='-qstaticlink'
 	    ;;
 	  *)
-	    case `$CC -V 2>&1 | sed 5q` in
+	    case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	    *Sun\ C*)
 	      # Sun C++ 5.9
 	      lt_prog_compiler_pic_CXX='-KPIC'
@@ -14297,14 +14340,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works_CXX=yes
@@ -14343,10 +14388,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -14396,8 +14442,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -14405,6 +14452,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o_CXX=yes
@@ -14448,8 +14496,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -14457,6 +14506,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o_CXX=yes
@@ -14506,27 +14556,27 @@ fi
     { $as_echo "$as_me:${as_lineno-$LINENO}: checking whether the $compiler linker ($LD) supports shared libraries" >&5
 $as_echo_n "checking whether the $compiler linker ($LD) supports shared libraries... " >&6; }
 
-  export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   case $host_os in
   aix[4-9]*)
     # If we're using GNU nm, then we don't want the "-C" option.
     # -C means demangle to AIX nm, but means don't demangle with GNU nm
     # Also, AIX nm treats weak defined symbols like other global defined
     # symbols, whereas GNU nm marks them as "W".
-    if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-      export_symbols_cmds_CXX='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+    if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+      export_symbols_cmds_CXX='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
     else
-      export_symbols_cmds_CXX='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+      export_symbols_cmds_CXX='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
     fi
     ;;
   pw32*)
     export_symbols_cmds_CXX="$ltdll_cmds"
   ;;
   cygwin* | mingw* | cegcc*)
-    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/;/^.*[ ]__nm__/s/^.*[ ]__nm__\([^ ]*\)[ ][^ ]*/\1 DATA/;/^I[ ]/d;/^[AITW][ ]/s/.* //'\'' | sort | uniq > $export_symbols'
+    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/;/^.*[ ]__nm__/s/^.*[ ]__nm__\([^ ]*\)[ ][^ ]*/\1 DATA/;/^I[ ]/d;/^[AITW][ ]/s/.* //'\'' | sort | uniq > $export_symbols'
   ;;
   *)
-    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   ;;
   esac
   exclude_expsyms_CXX='_GLOBAL_OFFSET_TABLE_|_GLOBAL__F[ID]_.*'
@@ -14568,10 +14618,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -14597,6 +14648,7 @@ else
 	  fi
 	  allow_undefined_flag_CXX=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -14726,7 +14778,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -15092,7 +15144,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -15137,7 +15189,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -15478,7 +15530,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -15495,7 +15547,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -16904,9 +16956,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -16948,7 +17000,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -16979,7 +17031,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -17078,13 +17130,13 @@ fi
   # does some of this, but throws away the result.
   libitm_ld_is_gold=no
   libitm_ld_is_mold=no
-  if $LD --version 2>/dev/null | grep 'GNU gold'> /dev/null 2>&1; then
+  if $LD --version 2>/dev/null | sed -e 's/\r//g' | grep 'GNU gold'> /dev/null 2>&1; then
     libitm_ld_is_gold=yes
-  elif $LD --version 2>/dev/null | grep 'mold' >/dev/null 2>&1; then
+  elif $LD --version 2>/dev/null | sed -e 's/\r//g' | grep 'mold' >/dev/null 2>&1; then
     libitm_ld_is_mold=yes
   fi
 
-  ldver=`$LD --version 2>/dev/null |
+  ldver=`$LD --version 2>/dev/null | sed -e 's/\r//g' |
          sed -e 's/[. ][0-9]\{8\}$//;s/.* \([^ ]\{1,\}\)$/\1/; q'`
 
   libitm_gnu_ld_version=`echo $ldver | \
@@ -17244,6 +17296,7 @@ EOF
     libitm_libgcc_s_suffix=`${CC-cc} $CFLAGS $CPPFLAGS $LDFLAGS \
 			     -shared -shared-libgcc -o conftest.so \
 			     conftest.c -v 2>&1 >/dev/null \
+			     | sed -e 's/\r//g' \
 			     | sed -n 's/^.* -lgcc_s\([^ ]*\) .*$/\1/p'`
     rm -f conftest.c conftest.so
     if test x${libitm_libgcc_s_suffix+set} = xset; then
@@ -20711,7 +20764,7 @@ _LT_EOF
  ;;
     "gstdint.h":C)
 if test "$GCC" = yes; then
-  echo "/* generated for " `$CC --version | sed 1q` "*/" > tmp-stdint.h
+  echo "/* generated for " `$CC --version | sed -e 's/\r//g' | sed 1q` "*/" > tmp-stdint.h
 else
   echo "/* generated for $CC */" > tmp-stdint.h
 fi
diff --git a/gcc/libitm/configure.ac b/gcc/libitm/configure.ac
index 78a682376d..0b2f196c3e 100644
--- a/gcc/libitm/configure.ac
+++ b/gcc/libitm/configure.ac
@@ -107,7 +107,7 @@ case ${enable_version_specific_runtime_libs} in
       toolexecdir='$(libdir)/gcc-lib/$(target_alias)'
       toolexeclibdir='$(libdir)'
     fi
-    multi_os_directory=`$CC -print-multi-os-directory`
+    multi_os_directory=`$CC -print-multi-os-directory | sed -e 's/\r//g'`
     case $multi_os_directory in
       .) ;; # Avoid trailing /.
       *) toolexeclibdir=$toolexeclibdir/$multi_os_directory ;;
diff --git a/gcc/libobjc/configure b/gcc/libobjc/configure
index 5d1b424a66..20e31cccb9 100755
--- a/gcc/libobjc/configure
+++ b/gcc/libobjc/configure
@@ -1526,9 +1526,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1564,9 +1565,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1640,9 +1642,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1678,7 +1681,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -2549,7 +2552,7 @@ case ${version_specific_libs} in
       toolexecdir='$(libdir)/gcc-lib/$(target_noncanonical)'
       toolexeclibdir='$(libdir)'
     fi
-    multi_os_directory=`$CC -print-multi-os-directory`
+    multi_os_directory=`$CC -print-multi-os-directory | sed -e 's/\r//g'`
     case $multi_os_directory in
       .) ;; # Avoid trailing /.
       *) toolexeclibdir=$toolexeclibdir/$multi_os_directory ;;
@@ -2902,9 +2905,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -2928,7 +2932,7 @@ printf ("hello world\n");
 _ACEOF
 # FIXME: Cleanup?
 if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -2983,7 +2987,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3053,7 +3057,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3109,7 +3113,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -3167,7 +3171,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4641,9 +4645,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -4685,7 +4689,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -4716,7 +4720,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -4924,10 +4928,12 @@ else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
   (eval echo "\"\$as_me:$LINENO: $ac_compile\"" >&5)
-  (eval "$ac_compile" 2>conftest.err)
+  (eval "($ac_compile | sed -e 's/\r//g')" 2>conftest.err)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: output\"" >&5)
   cat conftest.out >&5
@@ -5345,7 +5351,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -5407,7 +5413,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu | uclinuxfdpiceabi)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|_pic\.a)$'
@@ -5425,7 +5431,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
@@ -5968,7 +5974,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[ABCDGIRSTW]' ;;
 esac
@@ -5976,11 +5982,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -6014,7 +6020,7 @@ for ac_symprfx in "" "_"; do
 "     s[1]~prfx {split(s[1],t,\"@\"); print t[1], substr(t[1],length(prfx))}"\
 "     ' prfx=^$ac_symprfx"
   else
-    lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
+    lt_cv_sys_global_symbol_pipe="sed -n -e 's/\r//g' -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
   fi
 
   # Check to see that the pipe works correctly.
@@ -6035,14 +6041,14 @@ int main(){nm_test_var='a';nm_test_func();return(0);}
 _LT_EOF
 
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist\""; } >&5
-  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) 2>&5
+    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist\""; } >&5
+  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s "$nlist"; then
@@ -6063,7 +6069,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist"  | sed -e '"'"'s/\r//g'"'"'| $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -6076,7 +6082,7 @@ lt__PROGRAM__LTX_preloaded_symbols[] =
 {
   { "@PROGRAM@", (void *) 0 },
 _LT_EOF
-	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | $GREP -v main >> conftest.$ac_ext
+	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | sed -e 's/\r//g' | $GREP -v main >> conftest.$ac_ext
 	  cat <<\_LT_EOF >> conftest.$ac_ext
   {0, (void *) 0}
 };
@@ -6099,7 +6105,7 @@ _LT_EOF
 	  LIBS="conftstm.$ac_objext"
 	  CFLAGS="$CFLAGS$lt_prog_compiler_no_builtin_flag"
 	  if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext}; then
@@ -6178,7 +6184,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6197,7 +6203,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo '#line '$LINENO' "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6235,7 +6241,7 @@ s390*-*linux*|s390*-*tpf*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6350,7 +6356,7 @@ sparc*-*solaris*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6883,6 +6889,7 @@ else
 	if test -f libconftest.dylib && test ! -s conftest.err && test $_lt_result = 0; then
 	  lt_cv_apple_cc_single_mod=yes
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err >&5
 	fi
 	rm -rf libconftest.dylib*
@@ -6948,6 +6955,7 @@ _LT_EOF
       if test -f conftest && test ! -s conftest.err && test $_lt_result = 0 && $GREP forced_load conftest 2>&1 >/dev/null; then
 	lt_cv_ld_force_load=yes
       else
+        dos2unix -q conftest.err
 	cat conftest.err >&5
       fi
         rm -f conftest.err libconftest.a conftest conftest.c
@@ -7165,7 +7173,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -7182,7 +7190,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -7706,13 +7714,15 @@ compiler_DEFAULT=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -7752,14 +7762,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -7974,7 +7986,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic='-KPIC'
@@ -8105,14 +8117,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works=yes
@@ -8154,10 +8168,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -8210,8 +8225,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8219,6 +8235,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8265,8 +8282,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8274,6 +8292,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8334,7 +8353,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object=no
   enable_shared_with_static_runtimes=no
   export_dynamic_flag_spec=
-  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic=no
   hardcode_direct=no
   hardcode_direct_absolute=no
@@ -8397,7 +8416,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -8423,13 +8442,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -8473,7 +8492,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -8491,9 +8510,9 @@ _LT_EOF
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -8536,7 +8555,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -8567,7 +8586,7 @@ _LT_EOF
 	  compiler_needs_object=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object=yes
@@ -8605,7 +8624,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -8615,7 +8634,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
 
@@ -8627,7 +8646,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -8636,7 +8655,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
@@ -8655,7 +8674,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
 	    archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -8674,7 +8693,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -8718,10 +8737,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -9074,10 +9093,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS -b"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -9161,7 +9181,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -9187,7 +9207,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct=yes
 	hardcode_shlibpath_var=no
 	hardcode_direct_absolute=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
@@ -9256,7 +9276,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -9449,10 +9469,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -9478,6 +9499,7 @@ else
 	  fi
 	  allow_undefined_flag=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -9660,7 +9682,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([A-Za-z]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -9764,7 +9786,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -10135,7 +10157,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -10180,7 +10202,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -10841,7 +10863,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -10947,7 +10969,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -11201,7 +11223,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -11218,7 +11240,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -11593,7 +11615,7 @@ $as_echo_n "checking for bdw garbage collector... " >&6; }
       { $as_echo "$as_me:${as_lineno-$LINENO}: result: using paths configured with --with-target-bdw-gc options" >&5
 $as_echo "using paths configured with --with-target-bdw-gc options" >&6; }
     fi
-    mldir=`${CC-gcc} --print-multi-directory 2>/dev/null`
+    mldir=`${CC-gcc} --print-multi-directory 2>/dev/null | sed -e 's/\r//g'`
     bdw_val=
     if test "x$with_target_bdw_gc" != x; then
       for i in `echo $with_target_bdw_gc | tr ',' ' '`; do
diff --git a/gcc/libobjc/configure.ac b/gcc/libobjc/configure.ac
index f8f577cfbe..a1742194b6 100644
--- a/gcc/libobjc/configure.ac
+++ b/gcc/libobjc/configure.ac
@@ -105,7 +105,7 @@ case ${version_specific_libs} in
       toolexecdir='$(libdir)/gcc-lib/$(target_noncanonical)'
       toolexeclibdir='$(libdir)'
     fi
-    multi_os_directory=`$CC -print-multi-os-directory`
+    multi_os_directory=`$CC -print-multi-os-directory | sed -e 's/\r//g'`
     case $multi_os_directory in
       .) ;; # Avoid trailing /.
       *) toolexeclibdir=$toolexeclibdir/$multi_os_directory ;;
@@ -246,7 +246,7 @@ no)
     else
       AC_MSG_RESULT([using paths configured with --with-target-bdw-gc options])
     fi
-    mldir=`${CC-gcc} --print-multi-directory 2>/dev/null`
+    mldir=`${CC-gcc} --print-multi-directory 2>/dev/null | sed -e 's/\r//g'`
     bdw_val=
     if test "x$with_target_bdw_gc" != x; then
       for i in `echo $with_target_bdw_gc | tr ',' ' '`; do
diff --git a/gcc/liboffloadmic/configure b/gcc/liboffloadmic/configure
index dfa8287fd7..917064721e 100755
--- a/gcc/liboffloadmic/configure
+++ b/gcc/liboffloadmic/configure
@@ -1554,9 +1554,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1592,9 +1593,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1683,9 +1685,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1721,7 +1724,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -1794,9 +1797,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1993,9 +1997,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2031,9 +2036,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -3479,9 +3485,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -3532,7 +3539,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3602,7 +3609,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3658,7 +3665,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -3715,7 +3722,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4104,7 +4111,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -4162,6 +4169,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -4326,9 +4338,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -4489,7 +4502,7 @@ else
 
   am_cv_CXX_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -4547,6 +4560,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -4934,7 +4952,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -4951,7 +4969,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -5152,7 +5170,7 @@ wenotbecray
 #endif
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "webecray" >/dev/null 2>&1; then :
   ac_cv_os_cray=yes
 else
@@ -5340,7 +5358,7 @@ case ${enable_version_specific_runtime_libs} in
       toolexecdir='$(libdir)/gcc-lib/$(target_alias)'
       toolexeclibdir='$(libdir)'
     fi
-    multi_os_directory=`$CC -print-multi-os-directory`
+    multi_os_directory=`$CC -print-multi-os-directory | sed -e 's/\r//g'`
     case $multi_os_directory in
       .) ;; # Avoid trailing /.
       *) toolexeclibdir=$toolexeclibdir/$multi_os_directory ;;
@@ -5630,9 +5648,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -5674,7 +5692,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -5705,7 +5723,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -5913,10 +5931,12 @@ else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
   (eval echo "\"\$as_me:$LINENO: $ac_compile\"" >&5)
-  (eval "$ac_compile" 2>conftest.err)
+  (eval "($ac_compile | sed -e 's/\r//g')" 2>conftest.err)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: output\"" >&5)
   cat conftest.out >&5
@@ -6337,7 +6357,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -6399,7 +6419,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu | uclinuxfdpiceabi)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|_pic\.a)$'
@@ -6417,7 +6437,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
@@ -6918,7 +6938,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[ABCDGIRSTW]' ;;
 esac
@@ -6926,11 +6946,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -6964,7 +6984,7 @@ for ac_symprfx in "" "_"; do
 "     s[1]~prfx {split(s[1],t,\"@\"); print t[1], substr(t[1],length(prfx))}"\
 "     ' prfx=^$ac_symprfx"
   else
-    lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
+    lt_cv_sys_global_symbol_pipe="sed -n -e 's/\r//g' -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
   fi
 
   # Check to see that the pipe works correctly.
@@ -6985,14 +7005,14 @@ int main(){nm_test_var='a';nm_test_func();return(0);}
 _LT_EOF
 
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist\""; } >&5
-  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) 2>&5
+    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist\""; } >&5
+  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s "$nlist"; then
@@ -7013,7 +7033,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | sed -e '"'"'s/\r//g'"'"' | $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -7026,7 +7046,7 @@ lt__PROGRAM__LTX_preloaded_symbols[] =
 {
   { "@PROGRAM@", (void *) 0 },
 _LT_EOF
-	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | $GREP -v main >> conftest.$ac_ext
+	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | sed -e 's/\r//g' | $GREP -v main >> conftest.$ac_ext
 	  cat <<\_LT_EOF >> conftest.$ac_ext
   {0, (void *) 0}
 };
@@ -7049,7 +7069,7 @@ _LT_EOF
 	  LIBS="conftstm.$ac_objext"
 	  CFLAGS="$CFLAGS$lt_prog_compiler_no_builtin_flag"
 	  if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext}; then
@@ -7128,7 +7148,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7147,7 +7167,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo '#line '$LINENO' "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7185,7 +7205,7 @@ s390*-*linux*|s390*-*tpf*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7297,7 +7317,7 @@ sparc*-*solaris*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7830,6 +7850,7 @@ else
 	if test -f libconftest.dylib && test ! -s conftest.err && test $_lt_result = 0; then
 	  lt_cv_apple_cc_single_mod=yes
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err >&5
 	fi
 	rm -rf libconftest.dylib*
@@ -7892,6 +7913,7 @@ _LT_EOF
       if test -f conftest && test ! -s conftest.err && test $_lt_result = 0 && $GREP forced_load conftest 2>&1 >/dev/null; then
 	lt_cv_ld_force_load=yes
       else
+        dos2unix -q conftest.err
 	cat conftest.err >&5
       fi
         rm -f conftest.err libconftest.a conftest conftest.c
@@ -8382,13 +8404,15 @@ compiler_DEFAULT=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -8428,14 +8452,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -8650,7 +8676,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic='-KPIC'
@@ -8781,14 +8807,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works=yes
@@ -8830,10 +8858,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -8886,8 +8915,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8895,6 +8925,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8941,8 +8972,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8950,6 +8982,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -9010,7 +9043,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object=no
   enable_shared_with_static_runtimes=no
   export_dynamic_flag_spec=
-  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic=no
   hardcode_direct=no
   hardcode_direct_absolute=no
@@ -9073,7 +9106,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -9099,13 +9132,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -9149,7 +9182,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -9167,9 +9200,9 @@ _LT_EOF
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -9212,7 +9245,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -9243,7 +9276,7 @@ _LT_EOF
 	  compiler_needs_object=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object=yes
@@ -9281,7 +9314,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -9291,7 +9324,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
 
@@ -9303,7 +9336,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9312,7 +9345,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
@@ -9331,7 +9364,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
 	    archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -9350,7 +9383,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9394,10 +9427,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -9744,10 +9777,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS -b"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -9828,7 +9862,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -9854,7 +9888,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct=yes
 	hardcode_shlibpath_var=no
 	hardcode_direct_absolute=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
@@ -9923,7 +9957,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -10116,10 +10150,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -10145,6 +10180,7 @@ else
 	  fi
 	  allow_undefined_flag=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -10327,7 +10363,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([A-Za-z]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -10431,7 +10467,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -10799,7 +10835,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -10844,7 +10880,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -11490,7 +11526,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -11596,7 +11632,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -11952,13 +11988,15 @@ compiler=$CC
   # save warnings/boilerplate of simple test code
   ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
   ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -12024,9 +12062,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -12068,7 +12106,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -12099,7 +12137,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -12133,7 +12171,7 @@ with_gnu_ld=$lt_cv_prog_gnu_ld
         wlarc='${wl}'
 
         # ancient GNU ld didn't support --whole-archive et. al.
-        if eval "`$CC -print-prog-name=ld` --help 2>&1" |
+        if eval "`$CC -print-prog-name=ld | sed -e 's/\r//g'` --help 2>&1" | sed -e 's/\r//g' |
 	  $GREP 'no-whole-archive' > /dev/null; then
           whole_archive_flag_spec_CXX="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
         else
@@ -12154,7 +12192,7 @@ with_gnu_ld=$lt_cv_prog_gnu_ld
       # Commands to make compiler produce verbose output that lists
       # what "hidden" libraries, object files and flags are used when
       # linking a shared library.
-      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 
     else
       GXX=no
@@ -12356,7 +12394,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
         ;;
 
       beos*)
-	if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	  allow_undefined_flag_CXX=unsupported
 	  # Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	  # support --undefined.  This deserves some investigation.  FIXME
@@ -12384,7 +12422,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
         always_export_symbols_CXX=no
         enable_shared_with_static_runtimes_CXX=yes
 
-        if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+        if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
           archive_cmds_CXX='$CC -shared -nostdlib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
           # If the export-symbols file already is a .def file (1st line
           # is EXPORTS), use it as is; otherwise, prepend...
@@ -12500,7 +12538,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
             # explicitly linking system object files so we need to strip them
             # from the output so that they don't get included in the library
             # dependencies.
-            output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | $EGREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+            output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | sed -e '"'"'s/\r//g'"'"' | $EGREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
             ;;
           *)
             if test "$GXX" = yes; then
@@ -12565,7 +12603,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | $GREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+	    output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | sed -e '"'"'s/\r//g'"'"' | $GREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
 	    ;;
           *)
 	    if test "$GXX" = yes; then
@@ -12650,7 +12688,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`$CC $CFLAGS -v conftest.$objext -o libconftest$shared_ext 2>&1 | $GREP "ld"`; rm -f libconftest$shared_ext; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+	    output_verbose_link_cmd='templist=`$CC $CFLAGS -v conftest.$objext -o libconftest$shared_ext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP "ld"`; rm -f libconftest$shared_ext; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
 
 	    hardcode_libdir_flag_spec_CXX='${wl}-rpath,$libdir'
 	    export_dynamic_flag_spec_CXX='${wl}--export-dynamic'
@@ -12665,7 +12703,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # version 8.0 and above of icpc choke on multiply defined symbols
 	    # if we add $predep_objects and $postdep_objects, however 7.1 and
 	    # earlier do not add the objects themselves.
-	    case `$CC -V 2>&1` in
+	    case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	      *"Version 7."*)
 	        archive_cmds_CXX='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname -o $lib'
 		archive_expsym_cmds_CXX='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -12686,7 +12724,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    ;;
           pgCC* | pgcpp*)
             # Portland Group C++ compiler
-	    case `$CC -V` in
+	    case `$CC -V | sed -e 's/\r//g'` in
 	    *pgCC\ [1-5].* | *pgcpp\ [1-5].*)
 	      prelink_cmds_CXX='tpldir=Template.dir~
 		rm -rf $tpldir~
@@ -12733,7 +12771,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP "ld"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld .*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "X$list" | $Xsed'
+	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP "ld"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld .*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "X$list" | $Xsed'
 	    ;;
 	  xl* | mpixl* | bgxl*)
 	    # IBM XL 8.0 on PPC, with GNU ld
@@ -12748,7 +12786,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    fi
 	    ;;
 	  *)
-	    case `$CC -V 2>&1 | sed 5q` in
+	    case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	    *Sun\ C*)
 	      # Sun C++ 5.9
 	      no_undefined_flag_CXX=' -zdefs'
@@ -12798,7 +12836,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	;;
 
       netbsd*)
-        if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+        if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	  archive_cmds_CXX='$LD -Bshareable  -o $lib $predep_objects $libobjs $deplibs $postdep_objects $linker_flags'
 	  wlarc=
 	  hardcode_libdir_flag_spec_CXX='-R$libdir'
@@ -12806,7 +12844,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	  hardcode_shlibpath_var_CXX=no
 	fi
 	# Workaround some broken pre-1.5 toolchains
-	output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP conftest.$objext | $SED -e "s:-lgcc -lc -lgcc::"'
+	output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP conftest.$objext | $SED -e "s:-lgcc -lc -lgcc::"'
 	;;
 
       *nto* | *qnx*)
@@ -12825,7 +12863,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	  hardcode_direct_absolute_CXX=yes
 	  archive_cmds_CXX='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $lib'
 	  hardcode_libdir_flag_spec_CXX='${wl}-rpath,$libdir'
-	  if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	    archive_expsym_cmds_CXX='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-retain-symbols-file,$export_symbols -o $lib'
 	    export_dynamic_flag_spec_CXX='${wl}-E'
 	    whole_archive_flag_spec_CXX="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
@@ -12889,7 +12927,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP "ld" | $GREP -v "ld:"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld.*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP "ld" | $GREP -v "ld:"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld.*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
 	    ;;
 	  *)
 	    if test "$GXX" = yes && test "$with_gnu_ld" = no; then
@@ -12909,7 +12947,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	      # Commands to make compiler produce verbose output that lists
 	      # what "hidden" libraries, object files and flags are used when
 	      # linking a shared library.
-	      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+	      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 
 	    else
 	      # FIXME: insert proper C++ library support
@@ -12985,7 +13023,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # GNU C++ compiler with Solaris linker
 	    if test "$GXX" = yes && test "$with_gnu_ld" = no; then
 	      no_undefined_flag_CXX=' ${wl}-z ${wl}defs'
-	      if $CC --version | $GREP -v '^2\.7' > /dev/null; then
+	      if $CC --version | sed -e 's/\r//g' | $GREP -v '^2\.7' > /dev/null; then
 	        archive_cmds_CXX='$CC -shared -nostdlib $LDFLAGS $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-h $wl$soname -o $lib'
 	        archive_expsym_cmds_CXX='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 		  $CC -shared -nostdlib ${wl}-M $wl$lib.exp -o $lib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags~$RM $lib.exp'
@@ -12993,7 +13031,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	        # Commands to make compiler produce verbose output that lists
 	        # what "hidden" libraries, object files and flags are used when
 	        # linking a shared library.
-	        output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+	        output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 	      else
 	        # g++ 2.7 appears to require `-G' NOT `-shared' on this
 	        # platform.
@@ -13004,7 +13042,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	        # Commands to make compiler produce verbose output that lists
 	        # what "hidden" libraries, object files and flags are used when
 	        # linking a shared library.
-	        output_verbose_link_cmd='$CC -G $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+	        output_verbose_link_cmd='$CC -G $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 	      fi
 
 	      hardcode_libdir_flag_spec_CXX='${wl}-R $wl$libdir'
@@ -13124,7 +13162,7 @@ private:
 _LT_EOF
 
 if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -13220,7 +13258,7 @@ interix[3-9]*)
   ;;
 
 linux*)
-  case `$CC -V 2>&1 | sed 5q` in
+  case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
   *Sun\ C*)
     # Sun C++ 5.9
 
@@ -13510,7 +13548,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	    lt_prog_compiler_static_CXX='-qstaticlink'
 	    ;;
 	  *)
-	    case `$CC -V 2>&1 | sed 5q` in
+	    case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	    *Sun\ C*)
 	      # Sun C++ 5.9
 	      lt_prog_compiler_pic_CXX='-KPIC'
@@ -13659,14 +13697,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works_CXX=yes
@@ -13705,10 +13745,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -13758,8 +13799,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -13767,6 +13809,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o_CXX=yes
@@ -13810,8 +13853,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -13819,6 +13863,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o_CXX=yes
@@ -13868,27 +13913,27 @@ fi
     { $as_echo "$as_me:${as_lineno-$LINENO}: checking whether the $compiler linker ($LD) supports shared libraries" >&5
 $as_echo_n "checking whether the $compiler linker ($LD) supports shared libraries... " >&6; }
 
-  export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   case $host_os in
   aix[4-9]*)
     # If we're using GNU nm, then we don't want the "-C" option.
     # -C means demangle to AIX nm, but means don't demangle with GNU nm
     # Also, AIX nm treats weak defined symbols like other global defined
     # symbols, whereas GNU nm marks them as "W".
-    if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-      export_symbols_cmds_CXX='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+    if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+      export_symbols_cmds_CXX='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
     else
-      export_symbols_cmds_CXX='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+      export_symbols_cmds_CXX='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
     fi
     ;;
   pw32*)
     export_symbols_cmds_CXX="$ltdll_cmds"
   ;;
   cygwin* | mingw* | cegcc*)
-    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/;/^.*[ ]__nm__/s/^.*[ ]__nm__\([^ ]*\)[ ][^ ]*/\1 DATA/;/^I[ ]/d;/^[AITW][ ]/s/.* //'\'' | sort | uniq > $export_symbols'
+    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/;/^.*[ ]__nm__/s/^.*[ ]__nm__\([^ ]*\)[ ][^ ]*/\1 DATA/;/^I[ ]/d;/^[AITW][ ]/s/.* //'\'' | sort | uniq > $export_symbols'
   ;;
   *)
-    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   ;;
   esac
   exclude_expsyms_CXX='_GLOBAL_OFFSET_TABLE_|_GLOBAL__F[ID]_.*'
@@ -13930,10 +13975,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -13959,6 +14005,7 @@ else
 	  fi
 	  allow_undefined_flag_CXX=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -14088,7 +14135,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -14464,7 +14511,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -14509,7 +14556,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
diff --git a/gcc/liboffloadmic/configure.ac b/gcc/liboffloadmic/configure.ac
index f64f182e8e..362ef2b88f 100644
--- a/gcc/liboffloadmic/configure.ac
+++ b/gcc/liboffloadmic/configure.ac
@@ -108,7 +108,7 @@ case ${enable_version_specific_runtime_libs} in
       toolexecdir='$(libdir)/gcc-lib/$(target_alias)'
       toolexeclibdir='$(libdir)'
     fi
-    multi_os_directory=`$CC -print-multi-os-directory`
+    multi_os_directory=`$CC -print-multi-os-directory | sed -e 's/\r//g'`
     case $multi_os_directory in
       .) ;; # Avoid trailing /.
       *) toolexeclibdir=$toolexeclibdir/$multi_os_directory ;;
diff --git a/gcc/liboffloadmic/plugin/configure b/gcc/liboffloadmic/plugin/configure
index 0b21d7d4ee..aa24532ccb 100755
--- a/gcc/liboffloadmic/plugin/configure
+++ b/gcc/liboffloadmic/plugin/configure
@@ -1551,9 +1551,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1589,9 +1590,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1627,9 +1629,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1703,9 +1706,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1741,7 +1745,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -1849,9 +1853,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1887,9 +1892,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -3337,9 +3343,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -3390,7 +3397,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3460,7 +3467,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3516,7 +3523,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -3573,7 +3580,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3962,7 +3969,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -4020,6 +4027,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -4184,9 +4196,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -4347,7 +4360,7 @@ else
 
   am_cv_CXX_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -4405,6 +4418,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -4589,7 +4607,7 @@ case ${enable_version_specific_runtime_libs} in
       toolexecdir='$(libdir)/gcc-lib/$(target_alias)'
       toolexeclibdir='$(libdir)'
     fi
-    multi_os_directory=`$CC -print-multi-os-directory`
+    multi_os_directory=`$CC -print-multi-os-directory | sed -e 's/\r//g'`
     case $multi_os_directory in
       .) ;; # Avoid trailing /.
       *) toolexeclibdir=$toolexeclibdir/$multi_os_directory ;;
@@ -5009,9 +5027,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -5053,7 +5071,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -5084,7 +5102,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -5292,10 +5310,12 @@ else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
   (eval echo "\"\$as_me:$LINENO: $ac_compile\"" >&5)
-  (eval "$ac_compile" 2>conftest.err)
+  (eval "($ac_compile | sed -e 's/\r//g')" 2>conftest.err)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: output\"" >&5)
   cat conftest.out >&5
@@ -5716,7 +5736,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -5778,7 +5798,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu | uclinuxfdpiceabi)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|_pic\.a)$'
@@ -5796,7 +5816,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
@@ -6297,7 +6317,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[ABCDGIRSTW]' ;;
 esac
@@ -6305,11 +6325,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -6343,7 +6363,7 @@ for ac_symprfx in "" "_"; do
 "     s[1]~prfx {split(s[1],t,\"@\"); print t[1], substr(t[1],length(prfx))}"\
 "     ' prfx=^$ac_symprfx"
   else
-    lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
+    lt_cv_sys_global_symbol_pipe="sed -n -e 's/\r//g' -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
   fi
 
   # Check to see that the pipe works correctly.
@@ -6364,14 +6384,14 @@ int main(){nm_test_var='a';nm_test_func();return(0);}
 _LT_EOF
 
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist\""; } >&5
-  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) 2>&5
+    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist\""; } >&5
+  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s "$nlist"; then
@@ -6392,7 +6412,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | sed -e '"'"'s/\r//g'"'"' | $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -6405,7 +6425,7 @@ lt__PROGRAM__LTX_preloaded_symbols[] =
 {
   { "@PROGRAM@", (void *) 0 },
 _LT_EOF
-	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | $GREP -v main >> conftest.$ac_ext
+	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | sed -e 's/\r//g' | $GREP -v main >> conftest.$ac_ext
 	  cat <<\_LT_EOF >> conftest.$ac_ext
   {0, (void *) 0}
 };
@@ -6428,7 +6448,7 @@ _LT_EOF
 	  LIBS="conftstm.$ac_objext"
 	  CFLAGS="$CFLAGS$lt_prog_compiler_no_builtin_flag"
 	  if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext}; then
@@ -6508,7 +6528,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6527,7 +6547,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo '#line '$LINENO' "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6565,7 +6585,7 @@ s390*-*linux*|s390*-*tpf*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6677,7 +6697,7 @@ sparc*-*solaris*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7210,6 +7230,7 @@ else
 	if test -f libconftest.dylib && test ! -s conftest.err && test $_lt_result = 0; then
 	  lt_cv_apple_cc_single_mod=yes
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err >&5
 	fi
 	rm -rf libconftest.dylib*
@@ -7272,6 +7293,7 @@ _LT_EOF
       if test -f conftest && test ! -s conftest.err && test $_lt_result = 0 && $GREP forced_load conftest 2>&1 >/dev/null; then
 	lt_cv_ld_force_load=yes
       else
+        dos2unix -q conftest.err
 	cat conftest.err >&5
       fi
         rm -f conftest.err libconftest.a conftest conftest.c
@@ -7487,7 +7509,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -7504,7 +7526,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -8029,13 +8051,15 @@ compiler_DEFAULT=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -8075,14 +8099,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -8297,7 +8323,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic='-KPIC'
@@ -8428,14 +8454,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works=yes
@@ -8477,10 +8505,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -8533,8 +8562,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8542,6 +8572,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8588,8 +8619,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8597,6 +8629,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8657,7 +8690,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object=no
   enable_shared_with_static_runtimes=no
   export_dynamic_flag_spec=
-  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic=no
   hardcode_direct=no
   hardcode_direct_absolute=no
@@ -8720,7 +8753,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -8746,13 +8779,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -8796,7 +8829,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -8814,9 +8847,9 @@ _LT_EOF
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -8859,7 +8892,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -8890,7 +8923,7 @@ _LT_EOF
 	  compiler_needs_object=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object=yes
@@ -8928,7 +8961,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -8938,7 +8971,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
 
@@ -8950,7 +8983,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -8959,7 +8992,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
@@ -8978,7 +9011,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
 	    archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -8997,7 +9030,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9041,10 +9074,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -9391,10 +9424,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS -b"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -9475,7 +9509,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -9501,7 +9535,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct=yes
 	hardcode_shlibpath_var=no
 	hardcode_direct_absolute=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
@@ -9570,7 +9604,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -9763,10 +9797,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -9792,6 +9827,7 @@ else
 	  fi
 	  allow_undefined_flag=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -9974,7 +10010,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([A-Za-z]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -10078,7 +10114,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -10446,7 +10482,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -10491,7 +10527,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -11137,7 +11173,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -11243,7 +11279,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -11599,13 +11635,15 @@ compiler=$CC
   # save warnings/boilerplate of simple test code
   ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
   ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -11671,9 +11709,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -11715,7 +11753,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -11746,7 +11784,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -11780,7 +11818,7 @@ with_gnu_ld=$lt_cv_prog_gnu_ld
         wlarc='${wl}'
 
         # ancient GNU ld didn't support --whole-archive et. al.
-        if eval "`$CC -print-prog-name=ld` --help 2>&1" |
+        if eval "`$CC -print-prog-name=ld | sed -e 's/\r//g'` --help 2>&1" | sed -e 's/\r//g' |
 	  $GREP 'no-whole-archive' > /dev/null; then
           whole_archive_flag_spec_CXX="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
         else
@@ -11801,7 +11839,7 @@ with_gnu_ld=$lt_cv_prog_gnu_ld
       # Commands to make compiler produce verbose output that lists
       # what "hidden" libraries, object files and flags are used when
       # linking a shared library.
-      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 
     else
       GXX=no
@@ -12003,7 +12041,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
         ;;
 
       beos*)
-	if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	  allow_undefined_flag_CXX=unsupported
 	  # Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	  # support --undefined.  This deserves some investigation.  FIXME
@@ -12031,7 +12069,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
         always_export_symbols_CXX=no
         enable_shared_with_static_runtimes_CXX=yes
 
-        if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+        if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
           archive_cmds_CXX='$CC -shared -nostdlib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
           # If the export-symbols file already is a .def file (1st line
           # is EXPORTS), use it as is; otherwise, prepend...
@@ -12147,7 +12185,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
             # explicitly linking system object files so we need to strip them
             # from the output so that they don't get included in the library
             # dependencies.
-            output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | $EGREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+            output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | sed -e '"'"'s/\r//g'"'"' | $EGREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
             ;;
           *)
             if test "$GXX" = yes; then
@@ -12212,7 +12250,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | $GREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+	    output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | sed -e '"'"'s/\r//g'"'"' | $GREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
 	    ;;
           *)
 	    if test "$GXX" = yes; then
@@ -12297,7 +12335,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`$CC $CFLAGS -v conftest.$objext -o libconftest$shared_ext 2>&1 | $GREP "ld"`; rm -f libconftest$shared_ext; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+	    output_verbose_link_cmd='templist=`$CC $CFLAGS -v conftest.$objext -o libconftest$shared_ext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP "ld"`; rm -f libconftest$shared_ext; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
 
 	    hardcode_libdir_flag_spec_CXX='${wl}-rpath,$libdir'
 	    export_dynamic_flag_spec_CXX='${wl}--export-dynamic'
@@ -12312,7 +12350,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # version 8.0 and above of icpc choke on multiply defined symbols
 	    # if we add $predep_objects and $postdep_objects, however 7.1 and
 	    # earlier do not add the objects themselves.
-	    case `$CC -V 2>&1` in
+	    case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	      *"Version 7."*)
 	        archive_cmds_CXX='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname -o $lib'
 		archive_expsym_cmds_CXX='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -12333,7 +12371,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    ;;
           pgCC* | pgcpp*)
             # Portland Group C++ compiler
-	    case `$CC -V` in
+	    case `$CC -V | sed -e 's/\r//g'` in
 	    *pgCC\ [1-5].* | *pgcpp\ [1-5].*)
 	      prelink_cmds_CXX='tpldir=Template.dir~
 		rm -rf $tpldir~
@@ -12380,7 +12418,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP "ld"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld .*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "X$list" | $Xsed'
+	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP "ld"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld .*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "X$list" | $Xsed'
 	    ;;
 	  xl* | mpixl* | bgxl*)
 	    # IBM XL 8.0 on PPC, with GNU ld
@@ -12395,7 +12433,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    fi
 	    ;;
 	  *)
-	    case `$CC -V 2>&1 | sed 5q` in
+	    case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	    *Sun\ C*)
 	      # Sun C++ 5.9
 	      no_undefined_flag_CXX=' -zdefs'
@@ -12445,7 +12483,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	;;
 
       netbsd*)
-        if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+        if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	  archive_cmds_CXX='$LD -Bshareable  -o $lib $predep_objects $libobjs $deplibs $postdep_objects $linker_flags'
 	  wlarc=
 	  hardcode_libdir_flag_spec_CXX='-R$libdir'
@@ -12453,7 +12491,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	  hardcode_shlibpath_var_CXX=no
 	fi
 	# Workaround some broken pre-1.5 toolchains
-	output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP conftest.$objext | $SED -e "s:-lgcc -lc -lgcc::"'
+	output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP conftest.$objext | $SED -e "s:-lgcc -lc -lgcc::"'
 	;;
 
       *nto* | *qnx*)
@@ -12472,7 +12510,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	  hardcode_direct_absolute_CXX=yes
 	  archive_cmds_CXX='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $lib'
 	  hardcode_libdir_flag_spec_CXX='${wl}-rpath,$libdir'
-	  if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	    archive_expsym_cmds_CXX='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-retain-symbols-file,$export_symbols -o $lib'
 	    export_dynamic_flag_spec_CXX='${wl}-E'
 	    whole_archive_flag_spec_CXX="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
@@ -12536,7 +12574,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP "ld" | $GREP -v "ld:"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld.*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP "ld" | $GREP -v "ld:"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld.*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
 	    ;;
 	  *)
 	    if test "$GXX" = yes && test "$with_gnu_ld" = no; then
@@ -12556,7 +12594,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	      # Commands to make compiler produce verbose output that lists
 	      # what "hidden" libraries, object files and flags are used when
 	      # linking a shared library.
-	      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+	      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 
 	    else
 	      # FIXME: insert proper C++ library support
@@ -12632,7 +12670,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # GNU C++ compiler with Solaris linker
 	    if test "$GXX" = yes && test "$with_gnu_ld" = no; then
 	      no_undefined_flag_CXX=' ${wl}-z ${wl}defs'
-	      if $CC --version | $GREP -v '^2\.7' > /dev/null; then
+	      if $CC --version | sed -e 's/\r//g' | $GREP -v '^2\.7' > /dev/null; then
 	        archive_cmds_CXX='$CC -shared -nostdlib $LDFLAGS $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-h $wl$soname -o $lib'
 	        archive_expsym_cmds_CXX='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 		  $CC -shared -nostdlib ${wl}-M $wl$lib.exp -o $lib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags~$RM $lib.exp'
@@ -12640,7 +12678,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	        # Commands to make compiler produce verbose output that lists
 	        # what "hidden" libraries, object files and flags are used when
 	        # linking a shared library.
-	        output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+	        output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 	      else
 	        # g++ 2.7 appears to require `-G' NOT `-shared' on this
 	        # platform.
@@ -12651,7 +12689,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	        # Commands to make compiler produce verbose output that lists
 	        # what "hidden" libraries, object files and flags are used when
 	        # linking a shared library.
-	        output_verbose_link_cmd='$CC -G $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+	        output_verbose_link_cmd='$CC -G $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 	      fi
 
 	      hardcode_libdir_flag_spec_CXX='${wl}-R $wl$libdir'
@@ -12771,7 +12809,7 @@ private:
 _LT_EOF
 
 if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -12867,7 +12905,7 @@ interix[3-9]*)
   ;;
 
 linux*)
-  case `$CC -V 2>&1 | sed 5q` in
+  case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
   *Sun\ C*)
     # Sun C++ 5.9
 
@@ -13157,7 +13195,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	    lt_prog_compiler_static_CXX='-qstaticlink'
 	    ;;
 	  *)
-	    case `$CC -V 2>&1 | sed 5q` in
+	    case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	    *Sun\ C*)
 	      # Sun C++ 5.9
 	      lt_prog_compiler_pic_CXX='-KPIC'
@@ -13306,14 +13344,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works_CXX=yes
@@ -13352,11 +13392,12 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
        # Append any errors to the config.log.
+       dos2unix -q conftest.err
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
        $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
@@ -13405,8 +13446,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -13414,6 +13456,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o_CXX=yes
@@ -13457,8 +13500,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -13466,6 +13510,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o_CXX=yes
@@ -13515,27 +13560,27 @@ fi
     { $as_echo "$as_me:${as_lineno-$LINENO}: checking whether the $compiler linker ($LD) supports shared libraries" >&5
 $as_echo_n "checking whether the $compiler linker ($LD) supports shared libraries... " >&6; }
 
-  export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   case $host_os in
   aix[4-9]*)
     # If we're using GNU nm, then we don't want the "-C" option.
     # -C means demangle to AIX nm, but means don't demangle with GNU nm
     # Also, AIX nm treats weak defined symbols like other global defined
     # symbols, whereas GNU nm marks them as "W".
-    if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-      export_symbols_cmds_CXX='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+    if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+      export_symbols_cmds_CXX='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
     else
-      export_symbols_cmds_CXX='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+      export_symbols_cmds_CXX='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
     fi
     ;;
   pw32*)
     export_symbols_cmds_CXX="$ltdll_cmds"
   ;;
   cygwin* | mingw* | cegcc*)
-    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/;/^.*[ ]__nm__/s/^.*[ ]__nm__\([^ ]*\)[ ][^ ]*/\1 DATA/;/^I[ ]/d;/^[AITW][ ]/s/.* //'\'' | sort | uniq > $export_symbols'
+    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/;/^.*[ ]__nm__/s/^.*[ ]__nm__\([^ ]*\)[ ][^ ]*/\1 DATA/;/^I[ ]/d;/^[AITW][ ]/s/.* //'\'' | sort | uniq > $export_symbols'
   ;;
   *)
-    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   ;;
   esac
   exclude_expsyms_CXX='_GLOBAL_OFFSET_TABLE_|_GLOBAL__F[ID]_.*'
@@ -13577,10 +13622,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -13606,6 +13652,7 @@ else
 	  fi
 	  allow_undefined_flag_CXX=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -13735,7 +13782,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -14111,7 +14158,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -14156,7 +14203,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
diff --git a/gcc/liboffloadmic/plugin/configure.ac b/gcc/liboffloadmic/plugin/configure.ac
index cbcd0130d0..5dea7f6cde 100644
--- a/gcc/liboffloadmic/plugin/configure.ac
+++ b/gcc/liboffloadmic/plugin/configure.ac
@@ -124,7 +124,7 @@ case ${enable_version_specific_runtime_libs} in
       toolexecdir='$(libdir)/gcc-lib/$(target_alias)'
       toolexeclibdir='$(libdir)'
     fi
-    multi_os_directory=`$CC -print-multi-os-directory`
+    multi_os_directory=`$CC -print-multi-os-directory | sed -e 's/\r//g'`
     case $multi_os_directory in
       .) ;; # Avoid trailing /.
       *) toolexeclibdir=$toolexeclibdir/$multi_os_directory ;;
diff --git a/gcc/libphobos/configure b/gcc/libphobos/configure
index 9da06f087d..a29246357d 100755
--- a/gcc/libphobos/configure
+++ b/gcc/libphobos/configure
@@ -1629,9 +1629,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1666,9 +1667,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1791,7 +1793,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -1864,9 +1866,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1902,9 +1905,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2072,9 +2076,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2957,9 +2962,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -3010,7 +3016,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3080,7 +3086,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3136,7 +3142,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -3193,7 +3199,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3793,7 +3799,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -3810,7 +3816,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -4856,9 +4862,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -5345,9 +5352,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler --version >&5") 2>conftest.err
+  (eval "($ac_compiler --version | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -5958,9 +5966,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -6002,7 +6010,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -6033,7 +6041,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -6241,10 +6249,12 @@ else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
   (eval echo "\"\$as_me:$LINENO: $ac_compile\"" >&5)
-  (eval "$ac_compile" 2>conftest.err)
+  (eval "($ac_compile | sed -e 's/\r//g')" 2>conftest.err)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: output\"" >&5)
   cat conftest.out >&5
@@ -6665,7 +6675,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -6727,7 +6737,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu | uclinuxfdpiceabi)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|_pic\.a)$'
@@ -6745,7 +6755,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
@@ -7246,7 +7256,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[ABCDGIRSTW]' ;;
 esac
@@ -7254,11 +7264,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -7292,7 +7302,7 @@ for ac_symprfx in "" "_"; do
 "     s[1]~prfx {split(s[1],t,\"@\"); print t[1], substr(t[1],length(prfx))}"\
 "     ' prfx=^$ac_symprfx"
   else
-    lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
+    lt_cv_sys_global_symbol_pipe="sed -n -e 's/\r//g' -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
   fi
 
   # Check to see that the pipe works correctly.
@@ -7313,14 +7323,14 @@ int main(){nm_test_var='a';nm_test_func();return(0);}
 _LT_EOF
 
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist\""; } >&5
-  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) 2>&5
+    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist\""; } >&5
+  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s "$nlist"; then
@@ -7341,7 +7351,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | sed -e '"'"'s/\r//g'"'"' | $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -7354,7 +7364,7 @@ lt__PROGRAM__LTX_preloaded_symbols[] =
 {
   { "@PROGRAM@", (void *) 0 },
 _LT_EOF
-	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | $GREP -v main >> conftest.$ac_ext
+	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | sed -e 's/\r//g' | $GREP -v main >> conftest.$ac_ext
 	  cat <<\_LT_EOF >> conftest.$ac_ext
   {0, (void *) 0}
 };
@@ -7377,7 +7387,7 @@ _LT_EOF
 	  LIBS="conftstm.$ac_objext"
 	  CFLAGS="$CFLAGS$lt_prog_compiler_no_builtin_flag"
 	  if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext}; then
@@ -7456,7 +7466,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7475,7 +7485,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo '#line '$LINENO' "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7513,7 +7523,7 @@ s390*-*linux*|s390*-*tpf*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7625,7 +7635,7 @@ sparc*-*solaris*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -8158,6 +8168,7 @@ else
 	if test -f libconftest.dylib && test ! -s conftest.err && test $_lt_result = 0; then
 	  lt_cv_apple_cc_single_mod=yes
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err >&5
 	fi
 	rm -rf libconftest.dylib*
@@ -8220,6 +8231,7 @@ _LT_EOF
       if test -f conftest && test ! -s conftest.err && test $_lt_result = 0 && $GREP forced_load conftest 2>&1 >/dev/null; then
 	lt_cv_ld_force_load=yes
       else
+        dos2unix -q conftest.err
 	cat conftest.err >&5
       fi
         rm -f conftest.err libconftest.a conftest conftest.c
@@ -8712,13 +8724,15 @@ compiler_DEFAULT=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -8758,14 +8772,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -8980,7 +8996,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic='-KPIC'
@@ -9111,14 +9127,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works=yes
@@ -9160,10 +9178,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -9216,8 +9235,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -9225,6 +9245,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -9271,8 +9292,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -9280,6 +9302,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -9340,7 +9363,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object=no
   enable_shared_with_static_runtimes=no
   export_dynamic_flag_spec=
-  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic=no
   hardcode_direct=no
   hardcode_direct_absolute=no
@@ -9403,7 +9426,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -9429,13 +9452,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -9479,7 +9502,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -9497,9 +9520,9 @@ _LT_EOF
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -9542,7 +9565,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -9573,7 +9596,7 @@ _LT_EOF
 	  compiler_needs_object=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object=yes
@@ -9611,7 +9634,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -9621,7 +9644,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
 
@@ -9633,7 +9656,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9642,7 +9665,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
@@ -9661,7 +9684,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
 	    archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -9680,7 +9703,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9724,10 +9747,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -10074,10 +10097,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS -b"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -10158,7 +10182,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -10184,7 +10208,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct=yes
 	hardcode_shlibpath_var=no
 	hardcode_direct_absolute=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
@@ -10253,7 +10277,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -10446,10 +10470,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -10475,6 +10500,7 @@ else
 	  fi
 	  allow_undefined_flag=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -10657,7 +10683,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([A-Za-z]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -10761,7 +10787,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -11129,7 +11155,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -11174,7 +11200,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -11820,7 +11846,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -11926,7 +11952,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -12139,13 +12165,15 @@ compiler=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -12213,14 +12241,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -12432,7 +12462,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static_D='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic_D='-KPIC'
@@ -12560,14 +12590,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works_D=yes
@@ -12606,10 +12638,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -12659,8 +12692,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -12668,6 +12702,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o_D=yes
@@ -12711,8 +12746,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -12720,6 +12756,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o_D=yes
@@ -12777,7 +12814,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object_D=no
   enable_shared_with_static_runtimes_D=no
   export_dynamic_flag_spec_D=
-  export_symbols_cmds_D='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds_D='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic_D=no
   hardcode_direct_D=no
   hardcode_direct_absolute_D=no
@@ -12840,7 +12877,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -12866,13 +12903,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec_D='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec_D='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec_D="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec_D=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -12916,7 +12953,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag_D=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -12934,9 +12971,9 @@ _LT_EOF
       allow_undefined_flag_D=unsupported
       always_export_symbols_D=no
       enable_shared_with_static_runtimes_D=yes
-      export_symbols_cmds_D='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds_D='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds_D='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -12979,7 +13016,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -13010,7 +13047,7 @@ _LT_EOF
 	  compiler_needs_object_D=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec_D='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object_D=yes
@@ -13048,7 +13085,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds_D='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -13058,7 +13095,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs_D=no
 	cat <<_LT_EOF 1>&2
 
@@ -13070,7 +13107,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds_D='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds_D='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -13079,7 +13116,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs_D=no
 	cat <<_LT_EOF 1>&2
@@ -13098,7 +13135,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec_D='${wl}-rpath ${wl}$libdir'
 	    archive_cmds_D='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds_D='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -13117,7 +13154,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds_D='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds_D='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -13161,10 +13198,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds_D='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds_D='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds_D='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds_D='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -13556,7 +13593,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds_D='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds_D='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -13582,7 +13619,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct_D=yes
 	hardcode_shlibpath_var_D=no
 	hardcode_direct_absolute_D=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds_D='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds_D='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec_D='${wl}-rpath,$libdir'
@@ -13651,7 +13688,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds_D='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds_D='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -13835,10 +13872,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -13864,6 +13902,7 @@ else
 	  fi
 	  allow_undefined_flag_D=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -14351,7 +14390,7 @@ fi
 
   { $as_echo "$as_me:${as_lineno-$LINENO}: checking for thread model used by GDC" >&5
 $as_echo_n "checking for thread model used by GDC... " >&6; }
-  d_thread_model=`$GDC -v 2>&1 | sed -n 's/^Thread model: //p'`
+  d_thread_model=`$GDC -v 2>&1 | sed -e 's/\r//g' | sed -n 's/^Thread model: //p'`
   { $as_echo "$as_me:${as_lineno-$LINENO}: result: $d_thread_model" >&5
 $as_echo "$d_thread_model" >&6; }
 
@@ -14995,7 +15034,7 @@ $as_echo_n "checking libbacktrace: BACKTRACE_SUPPORTED... " >&6; }
       #endif
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "FOUND_LIBBACKTRACE_RESULT_GDC" >/dev/null 2>&1; then :
   BACKTRACE_SUPPORTED=true
 else
@@ -15017,7 +15056,7 @@ $as_echo_n "checking libbacktrace: BACKTRACE_USES_MALLOC... " >&6; }
       #endif
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "FOUND_LIBBACKTRACE_RESULT_GDC" >/dev/null 2>&1; then :
   BACKTRACE_USES_MALLOC=true
 else
@@ -15039,7 +15078,7 @@ $as_echo_n "checking libbacktrace: BACKTRACE_SUPPORTS_THREADS... " >&6; }
       #endif
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "FOUND_LIBBACKTRACE_RESULT_GDC" >/dev/null 2>&1; then :
   BACKTRACE_SUPPORTS_THREADS=true
 else
diff --git a/gcc/libphobos/m4/druntime/os.m4 b/gcc/libphobos/m4/druntime/os.m4
index 15cde3b04b..172462516c 100644
--- a/gcc/libphobos/m4/druntime/os.m4
+++ b/gcc/libphobos/m4/druntime/os.m4
@@ -10,7 +10,7 @@ AC_DEFUN([DRUNTIME_OS_THREAD_MODEL],
 [
   AC_REQUIRE([AC_PROG_GDC])
   AC_MSG_CHECKING([for thread model used by GDC])
-  d_thread_model=`$GDC -v 2>&1 | sed -n 's/^Thread model: //p'`
+  d_thread_model=`$GDC -v 2>&1 | sed -e 's/\r//g' | sed -n 's/^Thread model: //p'`
   AC_MSG_RESULT([$d_thread_model])
 
   # Map from thread model to thread interface.
@@ -210,7 +210,7 @@ AC_DEFUN([DRUNTIME_OS_LINK_SPEC],
       # 64-bit Solaris/x86 ld breaks calls to __tls_get_addr with non-TLS
       # relocs.  Work around by disabling TLS transitions.  Not necessary
       # on 32-bit x86, but cannot be distinguished reliably in specs.
-      druntime_ld_prog=`$CC -print-prog-name=ld`
+      druntime_ld_prog=`$CC -print-prog-name=ld | sed -e 's/\r//g'`
       druntime_ld_gld=no
       druntime_ld_relax_transtls=no
       if test -n "$druntime_ld_prog" \
diff --git a/gcc/libquadmath/configure b/gcc/libquadmath/configure
index b3ee64f9c7..b218858269 100755
--- a/gcc/libquadmath/configure
+++ b/gcc/libquadmath/configure
@@ -1562,9 +1562,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1599,9 +1600,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1724,7 +1726,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -1797,9 +1799,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -3446,9 +3449,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -3472,7 +3476,7 @@ printf ("hello world\n");
 _ACEOF
 # FIXME: Cleanup?
 if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3527,7 +3531,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3566,24 +3570,25 @@ test "$ac_cv_exeext" = no && ac_cv_exeext=
 else
   ac_file=''
 fi
-if test -z "$ac_file"; then :
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
-$as_echo "no" >&6; }
-$as_echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-{ { $as_echo "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
-$as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
-as_fn_error 77 "C compiler cannot create executables
-See \`config.log' for more details" "$LINENO" 5; }
-else
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: yes" >&5
-$as_echo "yes" >&6; }
-fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for C compiler default output file name" >&5
-$as_echo_n "checking for C compiler default output file name... " >&6; }
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_file" >&5
-$as_echo "$ac_file" >&6; }
+#if test -z "$ac_file"; then :
+#  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+#$as_echo "no" >&6; }
+#$as_echo "$as_me: failed program was:" >&5
+#sed 's/^/| /' conftest.$ac_ext >&5
+#
+#{ { $as_echo "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
+#$as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
+#as_fn_error 77 "C compiler cannot create executables
+#See \`config.log' for more details" "$LINENO" 5; }
+#else
+#  { $as_echo "$as_me:${as_lineno-$LINENO}: result: yes" >&5
+#$as_echo "yes" >&6; }
+#fi
+#{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for C compiler default output file name" >&5
+#$as_echo_n "checking for C compiler default output file name... " >&6; }
+#{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_file" >&5
+#$as_echo "$ac_file" >&6; }
+ac_file='a.out'
 ac_exeext=$ac_cv_exeext
 
 rm -f -r a.out a.out.dSYM a.exe conftest$ac_cv_exeext b.out
@@ -3597,7 +3602,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3653,7 +3658,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -3711,7 +3716,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4037,7 +4042,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -4095,6 +4100,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -4439,7 +4449,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -4456,7 +4466,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -4643,7 +4653,7 @@ $as_echo_n "checking for modern makeinfo... " >&6; }
 if ${gcc_cv_prog_makeinfo_modern+:} false; then :
   $as_echo_n "(cached) " >&6
 else
-  ac_prog_version=`eval $MAKEINFO --version 2>&1 |
+  ac_prog_version=`eval $MAKEINFO --version 2>&1 | sed -e 's/\r//g' |
                                      sed -n 's/^.*GNU texinfo.* \([0-9][0-9.]*\).*$/\1/p'`
 
                     case $ac_prog_version in
@@ -4980,9 +4990,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -5024,7 +5034,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -5055,7 +5065,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -5263,10 +5273,12 @@ else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
   (eval echo "\"\$as_me:$LINENO: $ac_compile\"" >&5)
-  (eval "$ac_compile" 2>conftest.err)
+  (eval "($ac_compile | sed -e 's/\r//g')" 2>conftest.err)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: output\"" >&5)
   cat conftest.out >&5
@@ -5687,7 +5699,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -5749,7 +5761,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu | uclinuxfdpiceabi)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|_pic\.a)$'
@@ -5767,7 +5779,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
@@ -6268,7 +6280,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[ABCDGIRSTW]' ;;
 esac
@@ -6276,11 +6288,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -6314,7 +6326,7 @@ for ac_symprfx in "" "_"; do
 "     s[1]~prfx {split(s[1],t,\"@\"); print t[1], substr(t[1],length(prfx))}"\
 "     ' prfx=^$ac_symprfx"
   else
-    lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
+    lt_cv_sys_global_symbol_pipe="sed -n -e 's/\r//g' -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
   fi
 
   # Check to see that the pipe works correctly.
@@ -6335,14 +6347,14 @@ int main(){nm_test_var='a';nm_test_func();return(0);}
 _LT_EOF
 
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist\""; } >&5
-  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) 2>&5
+    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist\""; } >&5
+  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s "$nlist"; then
@@ -6363,7 +6375,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | sed -e '"'"'s/\r//g'"'"' | $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -6376,7 +6388,7 @@ lt__PROGRAM__LTX_preloaded_symbols[] =
 {
   { "@PROGRAM@", (void *) 0 },
 _LT_EOF
-	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | $GREP -v main >> conftest.$ac_ext
+	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | sed -e 's/\r//g' | $GREP -v main >> conftest.$ac_ext
 	  cat <<\_LT_EOF >> conftest.$ac_ext
   {0, (void *) 0}
 };
@@ -6399,7 +6411,7 @@ _LT_EOF
 	  LIBS="conftstm.$ac_objext"
 	  CFLAGS="$CFLAGS$lt_prog_compiler_no_builtin_flag"
 	  if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext}; then
@@ -6478,7 +6490,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6497,7 +6509,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo '#line '$LINENO' "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6535,7 +6547,7 @@ s390*-*linux*|s390*-*tpf*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6650,7 +6662,7 @@ sparc*-*solaris*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7183,6 +7195,7 @@ else
 	if test -f libconftest.dylib && test ! -s conftest.err && test $_lt_result = 0; then
 	  lt_cv_apple_cc_single_mod=yes
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err >&5
 	fi
 	rm -rf libconftest.dylib*
@@ -7248,6 +7261,7 @@ _LT_EOF
       if test -f conftest && test ! -s conftest.err && test $_lt_result = 0 && $GREP forced_load conftest 2>&1 >/dev/null; then
 	lt_cv_ld_force_load=yes
       else
+        dos2unix -q conftest.err
 	cat conftest.err >&5
       fi
         rm -f conftest.err libconftest.a conftest conftest.c
@@ -7741,13 +7755,15 @@ compiler_DEFAULT=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -7787,14 +7803,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -8009,7 +8027,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic='-KPIC'
@@ -8140,14 +8158,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works=yes
@@ -8189,10 +8209,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -8245,8 +8266,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8254,6 +8276,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8300,8 +8323,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8309,6 +8333,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8369,7 +8394,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object=no
   enable_shared_with_static_runtimes=no
   export_dynamic_flag_spec=
-  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic=no
   hardcode_direct=no
   hardcode_direct_absolute=no
@@ -8432,7 +8457,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -8458,13 +8483,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -8508,7 +8533,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -8526,9 +8551,9 @@ _LT_EOF
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -8571,7 +8596,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -8602,7 +8627,7 @@ _LT_EOF
 	  compiler_needs_object=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object=yes
@@ -8640,7 +8665,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -8650,7 +8675,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
 
@@ -8662,7 +8687,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -8671,7 +8696,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
@@ -8690,7 +8715,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
 	    archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -8709,7 +8734,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -8753,10 +8778,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -9109,10 +9134,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS -b"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -9196,7 +9222,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -9222,7 +9248,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct=yes
 	hardcode_shlibpath_var=no
 	hardcode_direct_absolute=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
@@ -9291,7 +9317,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -9484,10 +9510,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -9513,6 +9540,7 @@ else
 	  fi
 	  allow_undefined_flag=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -9695,7 +9723,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([A-Za-z]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -9799,7 +9827,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -10170,7 +10198,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -10215,7 +10243,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -10876,7 +10904,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -10982,7 +11010,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -11518,26 +11546,27 @@ See \`config.log' for more details" "$LINENO" 5; }
 $as_echo "$as_me:${as_lineno-$LINENO}: checking for C compiler version" >&5
 set X $ac_compile
 ac_compiler=$2
-for ac_option in --version -v -V -qversion; do
-  { { ac_try="$ac_compiler $ac_option >&5"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
-$as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
-  ac_status=$?
-  if test -s conftest.err; then
-    sed '10a\
-... rest of stderr output deleted ...
-         10q' conftest.err >conftest.er1
-    cat conftest.er1 >&5
-  fi
-  rm -f conftest.er1 conftest.err
-  $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
-  test $ac_status = 0; }
-done
+#for ac_option in --version -v -V -qversion; do
+#  { { ac_try="$ac_compiler $ac_option >&5"
+#case "(($ac_try" in
+#  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+#  *) ac_try_echo=$ac_try;;
+#esac
+#eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
+#$as_echo "$ac_try_echo"; } >&5
+#  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
+#  ac_status=$?
+#  if test -s conftest.err; then
+#    dos2unix -q conftest.err
+#    sed '10a\
+#... rest of stderr output deleted ...
+#         10q' conftest.err >conftest.er1
+#    cat conftest.er1 >&5
+#  fi
+#  rm -f conftest.er1 conftest.err
+#  $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
+#  test $ac_status = 0; }
+#done
 
 { $as_echo "$as_me:${as_lineno-$LINENO}: checking whether we are using the GNU C compiler" >&5
 $as_echo_n "checking whether we are using the GNU C compiler... " >&6; }
@@ -11838,7 +11867,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -11896,6 +11925,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -12127,7 +12161,7 @@ case ${version_specific_libs} in
       toolexecdir='$(libdir)/gcc-lib/$(target_alias)'
       toolexeclibdir='$(libdir)'
     fi
-    multi_os_directory=`$CC -print-multi-os-directory`
+    multi_os_directory=`$CC -print-multi-os-directory | sed -e 's/\r//g'`
     case $multi_os_directory in
       .) ;; # Avoid trailing /.
       *) toolexeclibdir=$toolexeclibdir/$multi_os_directory ;;
diff --git a/gcc/libquadmath/configure.ac b/gcc/libquadmath/configure.ac
index eec4084a45..7b706d11c1 100644
--- a/gcc/libquadmath/configure.ac
+++ b/gcc/libquadmath/configure.ac
@@ -111,7 +111,7 @@ case ${version_specific_libs} in
       toolexecdir='$(libdir)/gcc-lib/$(target_alias)'
       toolexeclibdir='$(libdir)'
     fi
-    multi_os_directory=`$CC -print-multi-os-directory`
+    multi_os_directory=`$CC -print-multi-os-directory | sed -e 's/\r//g'`
     case $multi_os_directory in
       .) ;; # Avoid trailing /.
       *) toolexeclibdir=$toolexeclibdir/$multi_os_directory ;;
diff --git a/gcc/libsanitizer/configure b/gcc/libsanitizer/configure
index 771b135573..f1ffa9bf29 100755
--- a/gcc/libsanitizer/configure
+++ b/gcc/libsanitizer/configure
@@ -1595,9 +1595,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1632,9 +1633,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1761,7 +1763,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -1834,9 +1836,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1872,9 +1875,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1984,9 +1988,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2022,9 +2027,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -3094,9 +3100,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -3147,7 +3154,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3217,7 +3224,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3273,7 +3280,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -3330,7 +3337,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3930,7 +3937,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -3947,7 +3954,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -4856,7 +4863,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -4914,6 +4921,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -5065,7 +5077,7 @@ case ${version_specific_libs} in
       toolexecdir='$(libdir)/gcc-lib/$(target_alias)'
       toolexeclibdir='$(libdir)'
     fi
-    multi_os_directory=`$CC -print-multi-os-directory`
+    multi_os_directory=`$CC -print-multi-os-directory | sed -e 's/\r//g'`
     case $multi_os_directory in
       .) ;; # Avoid trailing /.
       *) toolexeclibdir=$toolexeclibdir/$multi_os_directory ;;
@@ -5391,9 +5403,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -5797,9 +5810,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -5960,7 +5974,7 @@ else
 
   am_cv_CXX_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -6018,6 +6032,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -6095,7 +6114,7 @@ else
 
   am_cv_CCAS_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
 
@@ -6151,6 +6170,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -6567,9 +6591,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -6611,7 +6635,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -6642,7 +6666,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -6850,10 +6874,12 @@ else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
   (eval echo "\"\$as_me:$LINENO: $ac_compile\"" >&5)
-  (eval "$ac_compile" 2>conftest.err)
+  (eval "($ac_compile | sed -e 's/\r//g')" 2>conftest.err)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: output\"" >&5)
   cat conftest.out >&5
@@ -7274,7 +7300,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -7336,7 +7362,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu | uclinuxfdpiceabi)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|_pic\.a)$'
@@ -7354,7 +7380,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
@@ -7855,7 +7881,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[ABCDGIRSTW]' ;;
 esac
@@ -7863,11 +7889,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -7901,7 +7927,7 @@ for ac_symprfx in "" "_"; do
 "     s[1]~prfx {split(s[1],t,\"@\"); print t[1], substr(t[1],length(prfx))}"\
 "     ' prfx=^$ac_symprfx"
   else
-    lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
+    lt_cv_sys_global_symbol_pipe="sed -n -e 's/\r//g' -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
   fi
 
   # Check to see that the pipe works correctly.
@@ -7922,14 +7948,14 @@ int main(){nm_test_var='a';nm_test_func();return(0);}
 _LT_EOF
 
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist\""; } >&5
-  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) 2>&5
+    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist\""; } >&5
+  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s "$nlist"; then
@@ -7950,7 +7976,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | sed -e '"'"'s/\r//g'"'"' | $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -7963,7 +7989,7 @@ lt__PROGRAM__LTX_preloaded_symbols[] =
 {
   { "@PROGRAM@", (void *) 0 },
 _LT_EOF
-	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | $GREP -v main >> conftest.$ac_ext
+	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | sed -e 's/\r//g' | $GREP -v main >> conftest.$ac_ext
 	  cat <<\_LT_EOF >> conftest.$ac_ext
   {0, (void *) 0}
 };
@@ -7986,7 +8012,7 @@ _LT_EOF
 	  LIBS="conftstm.$ac_objext"
 	  CFLAGS="$CFLAGS$lt_prog_compiler_no_builtin_flag"
 	  if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext}; then
@@ -8065,7 +8091,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -8084,7 +8110,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo '#line '$LINENO' "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -8122,7 +8148,7 @@ s390*-*linux*|s390*-*tpf*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -8234,7 +8260,7 @@ sparc*-*solaris*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -8767,6 +8793,7 @@ else
 	if test -f libconftest.dylib && test ! -s conftest.err && test $_lt_result = 0; then
 	  lt_cv_apple_cc_single_mod=yes
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err >&5
 	fi
 	rm -rf libconftest.dylib*
@@ -8829,6 +8856,7 @@ _LT_EOF
       if test -f conftest && test ! -s conftest.err && test $_lt_result = 0 && $GREP forced_load conftest 2>&1 >/dev/null; then
 	lt_cv_ld_force_load=yes
       else
+        dos2unix -q conftest.err
 	cat conftest.err >&5
       fi
         rm -f conftest.err libconftest.a conftest conftest.c
@@ -9321,13 +9349,15 @@ compiler_DEFAULT=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -9367,14 +9397,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -9589,7 +9621,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic='-KPIC'
@@ -9720,14 +9752,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works=yes
@@ -9769,10 +9803,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -9825,8 +9860,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -9834,6 +9870,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -9880,8 +9917,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -9889,6 +9927,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -9949,7 +9988,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object=no
   enable_shared_with_static_runtimes=no
   export_dynamic_flag_spec=
-  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic=no
   hardcode_direct=no
   hardcode_direct_absolute=no
@@ -10012,7 +10051,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -10038,13 +10077,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -10088,7 +10127,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -10106,9 +10145,9 @@ _LT_EOF
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -10151,7 +10190,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -10182,7 +10221,7 @@ _LT_EOF
 	  compiler_needs_object=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object=yes
@@ -10220,7 +10259,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -10230,7 +10269,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
 
@@ -10242,7 +10281,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -10251,7 +10290,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
@@ -10270,7 +10309,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
 	    archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -10289,7 +10328,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -10333,10 +10372,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -10683,10 +10722,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS -b"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -10767,7 +10807,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -10793,7 +10833,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct=yes
 	hardcode_shlibpath_var=no
 	hardcode_direct_absolute=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
@@ -10862,7 +10902,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -11055,10 +11095,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -11084,6 +11125,7 @@ else
 	  fi
 	  allow_undefined_flag=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -11266,7 +11308,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([A-Za-z]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -11370,7 +11412,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -11738,7 +11780,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -11783,7 +11825,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -12429,7 +12471,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -12535,7 +12577,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -12891,13 +12933,15 @@ compiler=$CC
   # save warnings/boilerplate of simple test code
   ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
   ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -12963,9 +13007,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -13007,7 +13051,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -13038,7 +13082,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -13072,7 +13116,7 @@ with_gnu_ld=$lt_cv_prog_gnu_ld
         wlarc='${wl}'
 
         # ancient GNU ld didn't support --whole-archive et. al.
-        if eval "`$CC -print-prog-name=ld` --help 2>&1" |
+        if eval "`$CC -print-prog-name=ld | sed -e 's/\r//g'` --help 2>&1" | sed -e 's/\r//g' |
 	  $GREP 'no-whole-archive' > /dev/null; then
           whole_archive_flag_spec_CXX="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
         else
@@ -13093,7 +13137,7 @@ with_gnu_ld=$lt_cv_prog_gnu_ld
       # Commands to make compiler produce verbose output that lists
       # what "hidden" libraries, object files and flags are used when
       # linking a shared library.
-      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 
     else
       GXX=no
@@ -13295,7 +13339,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
         ;;
 
       beos*)
-	if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	  allow_undefined_flag_CXX=unsupported
 	  # Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	  # support --undefined.  This deserves some investigation.  FIXME
@@ -13323,7 +13367,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
         always_export_symbols_CXX=no
         enable_shared_with_static_runtimes_CXX=yes
 
-        if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+        if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
           archive_cmds_CXX='$CC -shared -nostdlib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
           # If the export-symbols file already is a .def file (1st line
           # is EXPORTS), use it as is; otherwise, prepend...
@@ -13439,7 +13483,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
             # explicitly linking system object files so we need to strip them
             # from the output so that they don't get included in the library
             # dependencies.
-            output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | $EGREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+            output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | sed -e '"'"'s/\r//g'"'"' | $EGREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
             ;;
           *)
             if test "$GXX" = yes; then
@@ -13504,7 +13548,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | $GREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+	    output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | sed -e '"'"'s/\r//g'"'"' | $GREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
 	    ;;
           *)
 	    if test "$GXX" = yes; then
@@ -13589,7 +13633,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`$CC $CFLAGS -v conftest.$objext -o libconftest$shared_ext 2>&1 | $GREP "ld"`; rm -f libconftest$shared_ext; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+	    output_verbose_link_cmd='templist=`$CC $CFLAGS -v conftest.$objext -o libconftest$shared_ext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP "ld"`; rm -f libconftest$shared_ext; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
 
 	    hardcode_libdir_flag_spec_CXX='${wl}-rpath,$libdir'
 	    export_dynamic_flag_spec_CXX='${wl}--export-dynamic'
@@ -13604,7 +13648,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # version 8.0 and above of icpc choke on multiply defined symbols
 	    # if we add $predep_objects and $postdep_objects, however 7.1 and
 	    # earlier do not add the objects themselves.
-	    case `$CC -V 2>&1` in
+	    case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	      *"Version 7."*)
 	        archive_cmds_CXX='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname -o $lib'
 		archive_expsym_cmds_CXX='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -13625,7 +13669,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    ;;
           pgCC* | pgcpp*)
             # Portland Group C++ compiler
-	    case `$CC -V` in
+	    case `$CC -V | sed -e 's/\r//g'` in
 	    *pgCC\ [1-5].* | *pgcpp\ [1-5].*)
 	      prelink_cmds_CXX='tpldir=Template.dir~
 		rm -rf $tpldir~
@@ -13672,7 +13716,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP "ld"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld .*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "X$list" | $Xsed'
+	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP "ld"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld .*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "X$list" | $Xsed'
 	    ;;
 	  xl* | mpixl* | bgxl*)
 	    # IBM XL 8.0 on PPC, with GNU ld
@@ -13687,7 +13731,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    fi
 	    ;;
 	  *)
-	    case `$CC -V 2>&1 | sed 5q` in
+	    case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	    *Sun\ C*)
 	      # Sun C++ 5.9
 	      no_undefined_flag_CXX=' -zdefs'
@@ -13737,7 +13781,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	;;
 
       netbsd*)
-        if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+        if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	  archive_cmds_CXX='$LD -Bshareable  -o $lib $predep_objects $libobjs $deplibs $postdep_objects $linker_flags'
 	  wlarc=
 	  hardcode_libdir_flag_spec_CXX='-R$libdir'
@@ -13745,7 +13789,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	  hardcode_shlibpath_var_CXX=no
 	fi
 	# Workaround some broken pre-1.5 toolchains
-	output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP conftest.$objext | $SED -e "s:-lgcc -lc -lgcc::"'
+	output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP conftest.$objext | $SED -e "s:-lgcc -lc -lgcc::"'
 	;;
 
       *nto* | *qnx*)
@@ -13764,7 +13808,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	  hardcode_direct_absolute_CXX=yes
 	  archive_cmds_CXX='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $lib'
 	  hardcode_libdir_flag_spec_CXX='${wl}-rpath,$libdir'
-	  if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	    archive_expsym_cmds_CXX='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-retain-symbols-file,$export_symbols -o $lib'
 	    export_dynamic_flag_spec_CXX='${wl}-E'
 	    whole_archive_flag_spec_CXX="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
@@ -13828,7 +13872,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP "ld" | $GREP -v "ld:"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld.*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP "ld" | $GREP -v "ld:"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld.*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
 	    ;;
 	  *)
 	    if test "$GXX" = yes && test "$with_gnu_ld" = no; then
@@ -13848,7 +13892,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	      # Commands to make compiler produce verbose output that lists
 	      # what "hidden" libraries, object files and flags are used when
 	      # linking a shared library.
-	      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+	      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 
 	    else
 	      # FIXME: insert proper C++ library support
@@ -13924,7 +13968,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # GNU C++ compiler with Solaris linker
 	    if test "$GXX" = yes && test "$with_gnu_ld" = no; then
 	      no_undefined_flag_CXX=' ${wl}-z ${wl}defs'
-	      if $CC --version | $GREP -v '^2\.7' > /dev/null; then
+	      if $CC --version | sed -e 's/\r//g' | $GREP -v '^2\.7' > /dev/null; then
 	        archive_cmds_CXX='$CC -shared -nostdlib $LDFLAGS $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-h $wl$soname -o $lib'
 	        archive_expsym_cmds_CXX='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 		  $CC -shared -nostdlib ${wl}-M $wl$lib.exp -o $lib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags~$RM $lib.exp'
@@ -13932,7 +13976,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	        # Commands to make compiler produce verbose output that lists
 	        # what "hidden" libraries, object files and flags are used when
 	        # linking a shared library.
-	        output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+	        output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 	      else
 	        # g++ 2.7 appears to require `-G' NOT `-shared' on this
 	        # platform.
@@ -13943,7 +13987,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	        # Commands to make compiler produce verbose output that lists
 	        # what "hidden" libraries, object files and flags are used when
 	        # linking a shared library.
-	        output_verbose_link_cmd='$CC -G $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+	        output_verbose_link_cmd='$CC -G $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 	      fi
 
 	      hardcode_libdir_flag_spec_CXX='${wl}-R $wl$libdir'
@@ -14063,7 +14107,7 @@ private:
 _LT_EOF
 
 if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -14159,7 +14203,7 @@ interix[3-9]*)
   ;;
 
 linux*)
-  case `$CC -V 2>&1 | sed 5q` in
+  case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
   *Sun\ C*)
     # Sun C++ 5.9
 
@@ -14449,7 +14493,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	    lt_prog_compiler_static_CXX='-qstaticlink'
 	    ;;
 	  *)
-	    case `$CC -V 2>&1 | sed 5q` in
+	    case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	    *Sun\ C*)
 	      # Sun C++ 5.9
 	      lt_prog_compiler_pic_CXX='-KPIC'
@@ -14598,14 +14642,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works_CXX=yes
@@ -14644,10 +14690,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -14697,8 +14744,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -14706,6 +14754,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o_CXX=yes
@@ -14749,8 +14798,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -14758,6 +14808,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o_CXX=yes
@@ -14807,27 +14858,27 @@ fi
     { $as_echo "$as_me:${as_lineno-$LINENO}: checking whether the $compiler linker ($LD) supports shared libraries" >&5
 $as_echo_n "checking whether the $compiler linker ($LD) supports shared libraries... " >&6; }
 
-  export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   case $host_os in
   aix[4-9]*)
     # If we're using GNU nm, then we don't want the "-C" option.
     # -C means demangle to AIX nm, but means don't demangle with GNU nm
     # Also, AIX nm treats weak defined symbols like other global defined
     # symbols, whereas GNU nm marks them as "W".
-    if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-      export_symbols_cmds_CXX='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+    if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+      export_symbols_cmds_CXX='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
     else
-      export_symbols_cmds_CXX='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+      export_symbols_cmds_CXX='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
     fi
     ;;
   pw32*)
     export_symbols_cmds_CXX="$ltdll_cmds"
   ;;
   cygwin* | mingw* | cegcc*)
-    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/;/^.*[ ]__nm__/s/^.*[ ]__nm__\([^ ]*\)[ ][^ ]*/\1 DATA/;/^I[ ]/d;/^[AITW][ ]/s/.* //'\'' | sort | uniq > $export_symbols'
+    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/;/^.*[ ]__nm__/s/^.*[ ]__nm__\([^ ]*\)[ ][^ ]*/\1 DATA/;/^I[ ]/d;/^[AITW][ ]/s/.* //'\'' | sort | uniq > $export_symbols'
   ;;
   *)
-    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   ;;
   esac
   exclude_expsyms_CXX='_GLOBAL_OFFSET_TABLE_|_GLOBAL__F[ID]_.*'
@@ -14869,10 +14920,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -14898,6 +14950,7 @@ else
 	  fi
 	  allow_undefined_flag_CXX=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -15027,7 +15080,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -15393,7 +15446,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -15438,7 +15491,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -16689,7 +16742,7 @@ else
 #include <link.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "dl_iterate_phdr" >/dev/null 2>&1; then :
   have_dl_iterate_phdr=yes
 else
@@ -19684,7 +19737,7 @@ _LT_EOF
  ;;
     "gstdint.h":C)
 if test "$GCC" = yes; then
-  echo "/* generated for " `$CC --version | sed 1q` "*/" > tmp-stdint.h
+  echo "/* generated for " `$CC --version | sed -e 's/\r//g' | sed 1q` "*/" > tmp-stdint.h
 else
   echo "/* generated for $CC */" > tmp-stdint.h
 fi
diff --git a/gcc/libsanitizer/configure.ac b/gcc/libsanitizer/configure.ac
index 7f1ef3979c..28d5eb89bf 100644
--- a/gcc/libsanitizer/configure.ac
+++ b/gcc/libsanitizer/configure.ac
@@ -58,7 +58,7 @@ case ${version_specific_libs} in
       toolexecdir='$(libdir)/gcc-lib/$(target_alias)'
       toolexeclibdir='$(libdir)'
     fi
-    multi_os_directory=`$CC -print-multi-os-directory`
+    multi_os_directory=`$CC -print-multi-os-directory | sed -e 's/\r//g'`
     case $multi_os_directory in
       .) ;; # Avoid trailing /.
       *) toolexeclibdir=$toolexeclibdir/$multi_os_directory ;;
diff --git a/gcc/libssp/configure b/gcc/libssp/configure
index 10ba209bde..29d80d95d1 100755
--- a/gcc/libssp/configure
+++ b/gcc/libssp/configure
@@ -1543,9 +1543,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1580,9 +1581,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1618,9 +1620,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1751,7 +1754,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -3387,9 +3390,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -3413,7 +3417,7 @@ printf ("hello world\n");
 _ACEOF
 # FIXME: Cleanup?
 if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3468,7 +3472,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3538,7 +3542,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3594,7 +3598,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -3652,7 +3656,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4041,7 +4045,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -4099,6 +4103,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -4705,7 +4714,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -4722,7 +4731,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -5166,9 +5175,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -5210,7 +5219,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -5241,7 +5250,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -5449,10 +5458,12 @@ else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
   (eval echo "\"\$as_me:$LINENO: $ac_compile\"" >&5)
-  (eval "$ac_compile" 2>conftest.err)
+  (eval "($ac_compile | sed -e 's/\r//g')" 2>conftest.err)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: output\"" >&5)
   cat conftest.out >&5
@@ -5873,7 +5884,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -5935,7 +5946,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu | uclinuxfdpiceabi)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|_pic\.a)$'
@@ -5953,7 +5964,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
@@ -6454,7 +6465,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[ABCDGIRSTW]' ;;
 esac
@@ -6462,11 +6473,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -6500,7 +6511,7 @@ for ac_symprfx in "" "_"; do
 "     s[1]~prfx {split(s[1],t,\"@\"); print t[1], substr(t[1],length(prfx))}"\
 "     ' prfx=^$ac_symprfx"
   else
-    lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
+    lt_cv_sys_global_symbol_pipe="sed -n -e 's/\r//g' -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
   fi
 
   # Check to see that the pipe works correctly.
@@ -6521,14 +6532,14 @@ int main(){nm_test_var='a';nm_test_func();return(0);}
 _LT_EOF
 
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist\""; } >&5
-  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) 2>&5
+    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist\""; } >&5
+  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s "$nlist"; then
@@ -6549,7 +6560,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | sed -e '"'"'s/\r//g'"'"' | $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -6562,7 +6573,7 @@ lt__PROGRAM__LTX_preloaded_symbols[] =
 {
   { "@PROGRAM@", (void *) 0 },
 _LT_EOF
-	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | $GREP -v main >> conftest.$ac_ext
+	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | sed -e 's/\r//g' | $GREP -v main >> conftest.$ac_ext
 	  cat <<\_LT_EOF >> conftest.$ac_ext
   {0, (void *) 0}
 };
@@ -6585,7 +6596,7 @@ _LT_EOF
 	  LIBS="conftstm.$ac_objext"
 	  CFLAGS="$CFLAGS$lt_prog_compiler_no_builtin_flag"
 	  if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext}; then
@@ -6664,7 +6675,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6683,7 +6694,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo '#line '$LINENO' "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6721,7 +6732,7 @@ s390*-*linux*|s390*-*tpf*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6836,7 +6847,7 @@ sparc*-*solaris*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7369,6 +7380,7 @@ else
 	if test -f libconftest.dylib && test ! -s conftest.err && test $_lt_result = 0; then
 	  lt_cv_apple_cc_single_mod=yes
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err >&5
 	fi
 	rm -rf libconftest.dylib*
@@ -7434,6 +7446,7 @@ _LT_EOF
       if test -f conftest && test ! -s conftest.err && test $_lt_result = 0 && $GREP forced_load conftest 2>&1 >/dev/null; then
 	lt_cv_ld_force_load=yes
       else
+        dos2unix -q conftest.err
 	cat conftest.err >&5
       fi
         rm -f conftest.err libconftest.a conftest conftest.c
@@ -7927,13 +7940,15 @@ compiler_DEFAULT=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_linki | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -7973,14 +7988,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -8195,7 +8212,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic='-KPIC'
@@ -8318,7 +8335,7 @@ else
    lt_compiler_flag="$lt_prog_compiler_pic -DPIC"
    # Insert the option either (1) after the last *FLAGS variable, or
    # (2) before a word containing "conftest.", or (3) at the end.
-   # Note that $ac_compile itself does not contain backslashes and begins
+   # Note that $a | sed -e 's/\r//g')c_compile itself does not contain backslashes and begins
    # with a dollar sign (not a hyphen), so the echo should work correctly.
    # The option is referenced via a variable to avoid confusing sed.
    lt_compile=`echo "$ac_compile" | $SED \
@@ -8326,14 +8343,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works=yes
@@ -8375,10 +8394,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -8431,8 +8451,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8440,6 +8461,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8486,8 +8508,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8495,6 +8518,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8555,7 +8579,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object=no
   enable_shared_with_static_runtimes=no
   export_dynamic_flag_spec=
-  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic=no
   hardcode_direct=no
   hardcode_direct_absolute=no
@@ -8618,7 +8642,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -8644,13 +8668,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -8694,7 +8718,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -8712,9 +8736,9 @@ _LT_EOF
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -8757,7 +8781,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -8788,7 +8812,7 @@ _LT_EOF
 	  compiler_needs_object=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object=yes
@@ -8826,7 +8850,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -8836,7 +8860,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
 
@@ -8848,7 +8872,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -8857,7 +8881,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
@@ -8876,7 +8900,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
 	    archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -8895,7 +8919,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -8939,10 +8963,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -9295,10 +9319,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS -b"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -9382,7 +9407,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -9408,7 +9433,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct=yes
 	hardcode_shlibpath_var=no
 	hardcode_direct_absolute=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
@@ -9477,7 +9502,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -9670,10 +9695,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -9699,6 +9725,7 @@ else
 	  fi
 	  allow_undefined_flag=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -9881,7 +9908,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([A-Za-z]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -9985,7 +10012,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -10356,7 +10383,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -10401,7 +10428,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -11062,7 +11089,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -11168,7 +11195,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -11403,7 +11430,7 @@ case ${version_specific_libs} in
       toolexecdir='$(libdir)/gcc-lib/$(target_alias)'
       toolexeclibdir='$(libdir)'
     fi
-    multi_os_directory=`$CC -print-multi-os-directory`
+    multi_os_directory=`$CC -print-multi-os-directory | sed -e 's/\r//g'`
     case $multi_os_directory in
       .) ;; # Avoid trailing /.
       *) toolexeclibdir=$toolexeclibdir/$multi_os_directory ;;
diff --git a/gcc/libssp/configure.ac b/gcc/libssp/configure.ac
index f30f81c54f..68a29428f0 100644
--- a/gcc/libssp/configure.ac
+++ b/gcc/libssp/configure.ac
@@ -192,7 +192,7 @@ case ${version_specific_libs} in
       toolexecdir='$(libdir)/gcc-lib/$(target_alias)'
       toolexeclibdir='$(libdir)'
     fi
-    multi_os_directory=`$CC -print-multi-os-directory`
+    multi_os_directory=`$CC -print-multi-os-directory | sed -e 's/\r//g'`
     case $multi_os_directory in
       .) ;; # Avoid trailing /.
       *) toolexeclibdir=$toolexeclibdir/$multi_os_directory ;;
diff --git a/gcc/libstdc++-v3/acinclude.m4 b/gcc/libstdc++-v3/acinclude.m4
index e3cc3a8e86..620d0f80a0 100644
--- a/gcc/libstdc++-v3/acinclude.m4
+++ b/gcc/libstdc++-v3/acinclude.m4
@@ -209,12 +209,12 @@ AC_DEFUN([GLIBCXX_CHECK_LINKER_FEATURES], [
   if test x"$with_gnu_ld" = x"yes"; then
     AC_MSG_CHECKING([for ld version])
     changequote(,)
-    if $LD --version 2>/dev/null | grep 'GNU gold' >/dev/null 2>&1; then
+    if $LD --version 2>/dev/null | sed -e 's/\r//g' | grep 'GNU gold' >/dev/null 2>&1; then
       glibcxx_ld_is_gold=yes
-    elif $LD --version 2>/dev/null | grep 'mold' >/dev/null 2>&1; then
+    elif $LD --version 2>/dev/null | sed -e 's/\r//g' | grep 'mold' >/dev/null 2>&1; then
       glibcxx_ld_is_mold=yes
     fi
-    ldver=`$LD --version 2>/dev/null |
+    ldver=`$LD --version 2>/dev/null | sed -e 's/\r//g' |
 	   sed -e 's/[. ][0-9]\{8\}$//;s/.* \([^ ]\{1,\}\)$/\1/; q'`
     changequote([,])
     glibcxx_gnu_ld_version=`echo $ldver | \
@@ -225,7 +225,7 @@ AC_DEFUN([GLIBCXX_CHECK_LINKER_FEATURES], [
   # Set --gc-sections.
   glibcxx_have_gc_sections=no
   if test "$glibcxx_ld_is_gold" = "yes" || test "$glibcxx_ld_is_mold" = "yes" ; then
-    if $LD --help 2>/dev/null | grep gc-sections >/dev/null 2>&1; then
+    if $LD --help 2>/dev/null | sed -e 's/\r//g' | grep gc-sections >/dev/null 2>&1; then
       glibcxx_have_gc_sections=yes
     fi
   else
@@ -254,6 +254,7 @@ AC_DEFUN([GLIBCXX_CHECK_LINKER_FEATURES], [
       touch conftest.c
       if $CC -c conftest.c; then
 	if $LD --gc-sections -o conftest conftest.o 2>&1 | \
+	   sed -e 's/\r//g' | \
 	   grep "Warning: gc-sections option ignored" > /dev/null; then
 	  ac_gcsections=no
 	fi
@@ -286,7 +287,7 @@ AC_DEFUN([GLIBCXX_CHECK_LINKER_FEATURES], [
      ;;
     *)
       AC_MSG_CHECKING([for ld that supports -Wl,-z,relro])
-      cxx_z_relo=`$LD -v --help 2>/dev/null | grep "z relro"`
+      cxx_z_relo=`$LD -v --help 2>/dev/null | sed -e 's/\r//g' | grep "z relro"`
       if test -n "$cxx_z_relo"; then
         OPT_LDFLAGS="-Wl,-z,relro"
         ac_ld_relro=yes
@@ -3934,7 +3935,7 @@ dnl  thread_header
 dnl
 AC_DEFUN([GLIBCXX_ENABLE_THREADS], [
   AC_MSG_CHECKING([for thread model used by GCC])
-  target_thread_file=`$CXX -v 2>&1 | sed -n 's/^Thread model: //p'`
+  target_thread_file=`$CXX -v 2>&1 | sed -e 's/\r//g' | sed -n 's/^Thread model: //p'`
   AC_MSG_RESULT([$target_thread_file])
   GCC_AC_THREAD_HEADER([$target_thread_file])
 ])
@@ -3960,7 +3961,7 @@ AC_DEFUN([GLIBCXX_CHECK_GTHREADS], [
   CXXFLAGS="$CXXFLAGS -fno-exceptions \
 	-I${toplevel_srcdir}/libgcc -I${toplevel_builddir}/libgcc"
 
-  target_thread_file=`$CXX -v 2>&1 | sed -n 's/^Thread model: //p'`
+  target_thread_file=`$CXX -v 2>&1 | sed -e 's/\r//g' | sed -n 's/^Thread model: //p'`
   case $target_thread_file in
     posix)
       CXXFLAGS="$CXXFLAGS -DSUPPORTS_WEAK -DGTHREAD_USE_WEAK -D_PTHREADS"
diff --git a/gcc/libstdc++-v3/configure b/gcc/libstdc++-v3/configure
index eac6039212..25d894a524 100755
--- a/gcc/libstdc++-v3/configure
+++ b/gcc/libstdc++-v3/configure
@@ -1809,9 +1809,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1847,9 +1848,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1884,9 +1886,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1922,9 +1925,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1999,7 +2003,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -2110,9 +2114,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2148,9 +2153,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -4245,26 +4251,27 @@ See \`config.log' for more details" "$LINENO" 5; }
 $as_echo "$as_me:${as_lineno-$LINENO}: checking for C compiler version" >&5
 set X $ac_compile
 ac_compiler=$2
-for ac_option in --version -v -V -qversion; do
-  { { ac_try="$ac_compiler $ac_option >&5"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
-$as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
-  ac_status=$?
-  if test -s conftest.err; then
-    sed '10a\
-... rest of stderr output deleted ...
-         10q' conftest.err >conftest.er1
-    cat conftest.er1 >&5
-  fi
-  rm -f conftest.er1 conftest.err
-  $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
-  test $ac_status = 0; }
-done
+#for ac_option in --version -v -V -qversion; do
+#  { { ac_try="$ac_compiler $ac_option >&5"
+#case "(($ac_try" in
+#  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+#  *) ac_try_echo=$ac_try;;
+#esac
+#eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
+#$as_echo "$ac_try_echo"; } >&5
+#  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
+#  ac_status=$?
+#  if test -s conftest.err; then
+#    dos2unix -q conftest.err
+#    sed '10a\
+#... rest of stderr output deleted ...
+#         10q' conftest.err >conftest.er1
+#    cat conftest.er1 >&5
+#  fi
+#  rm -f conftest.er1 conftest.err
+#  $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
+#  test $ac_status = 0; }
+#done
 
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -4279,7 +4286,7 @@ printf ("hello world\n");
 _ACEOF
 # FIXME: Cleanup?
 if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4334,7 +4341,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4373,24 +4380,25 @@ test "$ac_cv_exeext" = no && ac_cv_exeext=
 else
   ac_file=''
 fi
-if test -z "$ac_file"; then :
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
-$as_echo "no" >&6; }
-$as_echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-{ { $as_echo "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
-$as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
-as_fn_error 77 "C compiler cannot create executables
-See \`config.log' for more details" "$LINENO" 5; }
-else
-  { $as_echo "$as_me:${as_lineno-$LINENO}: result: yes" >&5
-$as_echo "yes" >&6; }
-fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for C compiler default output file name" >&5
-$as_echo_n "checking for C compiler default output file name... " >&6; }
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_file" >&5
-$as_echo "$ac_file" >&6; }
+#if test -z "$ac_file"; then :
+#  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+#$as_echo "no" >&6; }
+#$as_echo "$as_me: failed program was:" >&5
+#sed 's/^/| /' conftest.$ac_ext >&5
+#
+#{ { $as_echo "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
+#$as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
+#as_fn_error 77 "C compiler cannot create executables
+#See \`config.log' for more details" "$LINENO" 5; }
+#else
+#  { $as_echo "$as_me:${as_lineno-$LINENO}: result: yes" >&5
+#$as_echo "yes" >&6; }
+#fi
+#{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for C compiler default output file name" >&5
+#$as_echo_n "checking for C compiler default output file name... " >&6; }
+#{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_file" >&5
+#$as_echo "$ac_file" >&6; }
+ac_file='a.out'
 ac_exeext=$ac_cv_exeext
 
 rm -f -r a.out a.out.dSYM a.exe conftest$ac_cv_exeext b.out
@@ -4404,7 +4412,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4460,7 +4468,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -4518,7 +4526,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4938,9 +4946,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -5923,7 +5932,7 @@ fi
   #endif
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "_using_uclibc" >/dev/null 2>&1; then :
   uclibc=yes
 else
@@ -5941,7 +5950,7 @@ rm -f conftest*
   #endif
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "_using_bionic" >/dev/null 2>&1; then :
   bionic=yes
 else
@@ -6248,9 +6257,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -6292,7 +6301,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -6323,7 +6332,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -6531,10 +6540,12 @@ else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
   (eval echo "\"\$as_me:$LINENO: $ac_compile\"" >&5)
-  (eval "$ac_compile" 2>conftest.err)
+  (eval "($ac_compile | sed -e 's/\r//g')" 2>conftest.err)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: output\"" >&5)
   cat conftest.out >&5
@@ -6944,7 +6955,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -7006,7 +7017,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu | uclinuxfdpiceabi)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|_pic\.a)$'
@@ -7024,7 +7035,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
@@ -7525,7 +7536,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[ABCDGIRSTW]' ;;
 esac
@@ -7533,11 +7544,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -7571,7 +7582,7 @@ for ac_symprfx in "" "_"; do
 "     s[1]~prfx {split(s[1],t,\"@\"); print t[1], substr(t[1],length(prfx))}"\
 "     ' prfx=^$ac_symprfx"
   else
-    lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
+    lt_cv_sys_global_symbol_pipe="sed -n -e 's/\r//g' -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
   fi
 
   # Check to see that the pipe works correctly.
@@ -7592,14 +7603,14 @@ int main(){nm_test_var='a';nm_test_func();return(0);}
 _LT_EOF
 
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist\""; } >&5
-  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) 2>&5
+    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist\""; } >&5
+  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s "$nlist"; then
@@ -7620,7 +7631,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | sed -e '"'"'s/\r//g'"'"' | $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -7633,7 +7644,7 @@ lt__PROGRAM__LTX_preloaded_symbols[] =
 {
   { "@PROGRAM@", (void *) 0 },
 _LT_EOF
-	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | $GREP -v main >> conftest.$ac_ext
+	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | sed -e 's/\r//g' | $GREP -v main >> conftest.$ac_ext
 	  cat <<\_LT_EOF >> conftest.$ac_ext
   {0, (void *) 0}
 };
@@ -7656,7 +7667,7 @@ _LT_EOF
 	  LIBS="conftstm.$ac_objext"
 	  CFLAGS="$CFLAGS$lt_prog_compiler_no_builtin_flag"
 	  if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext}; then
@@ -7735,7 +7746,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7754,7 +7765,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo '#line '$LINENO' "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7792,7 +7803,7 @@ s390*-*linux*|s390*-*tpf*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7907,7 +7918,7 @@ sparc*-*solaris*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -8440,6 +8451,7 @@ else
 	if test -f libconftest.dylib && test ! -s conftest.err && test $_lt_result = 0; then
 	  lt_cv_apple_cc_single_mod=yes
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err >&5
 	fi
 	rm -rf libconftest.dylib*
@@ -8505,6 +8517,7 @@ _LT_EOF
       if test -f conftest && test ! -s conftest.err && test $_lt_result = 0 && $GREP forced_load conftest 2>&1 >/dev/null; then
 	lt_cv_ld_force_load=yes
       else
+        dos2unix -q conftest.err
 	cat conftest.err >&5
       fi
         rm -f conftest.err libconftest.a conftest conftest.c
@@ -8584,7 +8597,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -8601,7 +8614,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -9126,13 +9139,15 @@ compiler_DEFAULT=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -9172,14 +9187,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -9394,7 +9411,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic='-KPIC'
@@ -9525,14 +9542,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works=yes
@@ -9574,10 +9593,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -9630,8 +9650,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -9639,6 +9660,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -9685,8 +9707,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -9694,6 +9717,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -9754,7 +9778,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object=no
   enable_shared_with_static_runtimes=no
   export_dynamic_flag_spec=
-  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic=no
   hardcode_direct=no
   hardcode_direct_absolute=no
@@ -9817,7 +9841,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -9843,13 +9867,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -9893,7 +9917,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -9911,9 +9935,9 @@ _LT_EOF
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -9956,7 +9980,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -9987,7 +10011,7 @@ _LT_EOF
 	  compiler_needs_object=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object=yes
@@ -10025,7 +10049,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -10035,7 +10059,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
 
@@ -10047,7 +10071,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -10056,7 +10080,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
@@ -10075,7 +10099,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
 	    archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -10094,7 +10118,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -10138,10 +10162,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -10494,10 +10518,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS -b"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -10581,7 +10606,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -10607,7 +10632,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct=yes
 	hardcode_shlibpath_var=no
 	hardcode_direct_absolute=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
@@ -10676,7 +10701,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -10869,10 +10894,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -10898,6 +10924,7 @@ else
 	  fi
 	  allow_undefined_flag=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -11080,7 +11107,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([A-Za-z]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -11184,7 +11211,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -11555,7 +11582,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -11600,7 +11627,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -12261,7 +12288,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -12367,7 +12394,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -12723,13 +12750,15 @@ compiler=$CC
   # save warnings/boilerplate of simple test code
   ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
   ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -12795,9 +12824,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -12839,7 +12868,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -12870,7 +12899,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -12904,7 +12933,7 @@ with_gnu_ld=$lt_cv_prog_gnu_ld
         wlarc='${wl}'
 
         # ancient GNU ld didn't support --whole-archive et. al.
-        if eval "`$CC -print-prog-name=ld` --help 2>&1" |
+        if eval "`$CC -print-prog-name=ld | sed -e 's/\r//g'` --help 2>&1" | sed -e 's/\r//g' |
 	  $GREP 'no-whole-archive' > /dev/null; then
           whole_archive_flag_spec_CXX="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
         else
@@ -12925,7 +12954,7 @@ with_gnu_ld=$lt_cv_prog_gnu_ld
       # Commands to make compiler produce verbose output that lists
       # what "hidden" libraries, object files and flags are used when
       # linking a shared library.
-      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 
     else
       GXX=no
@@ -13133,7 +13162,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
         ;;
 
       beos*)
-	if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	  allow_undefined_flag_CXX=unsupported
 	  # Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	  # support --undefined.  This deserves some investigation.  FIXME
@@ -13161,7 +13190,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
         always_export_symbols_CXX=no
         enable_shared_with_static_runtimes_CXX=yes
 
-        if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+        if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
           archive_cmds_CXX='$CC -shared -nostdlib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
           # If the export-symbols file already is a .def file (1st line
           # is EXPORTS), use it as is; otherwise, prepend...
@@ -13277,7 +13306,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
             # explicitly linking system object files so we need to strip them
             # from the output so that they don't get included in the library
             # dependencies.
-            output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | $EGREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+            output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | sed -e '"'"'s/\r//g'"'"' | $EGREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
             ;;
           *)
             if test "$GXX" = yes; then
@@ -13342,7 +13371,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | $GREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+	    output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | sed -e '"'"'s/\r//g'"'"' | $GREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
 	    ;;
           *)
 	    if test "$GXX" = yes; then
@@ -13427,7 +13456,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`$CC $CFLAGS -v conftest.$objext -o libconftest$shared_ext 2>&1 | $GREP "ld"`; rm -f libconftest$shared_ext; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+	    output_verbose_link_cmd='templist=`$CC $CFLAGS -v conftest.$objext -o libconftest$shared_ext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP "ld"`; rm -f libconftest$shared_ext; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
 
 	    hardcode_libdir_flag_spec_CXX='${wl}-rpath,$libdir'
 	    export_dynamic_flag_spec_CXX='${wl}--export-dynamic'
@@ -13442,7 +13471,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # version 8.0 and above of icpc choke on multiply defined symbols
 	    # if we add $predep_objects and $postdep_objects, however 7.1 and
 	    # earlier do not add the objects themselves.
-	    case `$CC -V 2>&1` in
+	    case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	      *"Version 7."*)
 	        archive_cmds_CXX='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname -o $lib'
 		archive_expsym_cmds_CXX='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -13463,7 +13492,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    ;;
           pgCC* | pgcpp*)
             # Portland Group C++ compiler
-	    case `$CC -V` in
+	    case `$CC -V | sed -e 's/\r//g'` in
 	    *pgCC\ [1-5].* | *pgcpp\ [1-5].*)
 	      prelink_cmds_CXX='tpldir=Template.dir~
 		rm -rf $tpldir~
@@ -13510,7 +13539,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP "ld"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld .*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "X$list" | $Xsed'
+	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP "ld"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld .*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "X$list" | $Xsed'
 	    ;;
 	  xl* | mpixl* | bgxl*)
 	    # IBM XL 8.0 on PPC, with GNU ld
@@ -13525,7 +13554,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    fi
 	    ;;
 	  *)
-	    case `$CC -V 2>&1 | sed 5q` in
+	    case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	    *Sun\ C*)
 	      # Sun C++ 5.9
 	      no_undefined_flag_CXX=' -zdefs'
@@ -13575,7 +13604,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	;;
 
       netbsd*)
-        if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+        if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	  archive_cmds_CXX='$LD -Bshareable  -o $lib $predep_objects $libobjs $deplibs $postdep_objects $linker_flags'
 	  wlarc=
 	  hardcode_libdir_flag_spec_CXX='-R$libdir'
@@ -13583,7 +13612,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	  hardcode_shlibpath_var_CXX=no
 	fi
 	# Workaround some broken pre-1.5 toolchains
-	output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP conftest.$objext | $SED -e "s:-lgcc -lc -lgcc::"'
+	output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP conftest.$objext | $SED -e "s:-lgcc -lc -lgcc::"'
 	;;
 
       *nto* | *qnx*)
@@ -13602,7 +13631,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	  hardcode_direct_absolute_CXX=yes
 	  archive_cmds_CXX='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $lib'
 	  hardcode_libdir_flag_spec_CXX='${wl}-rpath,$libdir'
-	  if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	    archive_expsym_cmds_CXX='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-retain-symbols-file,$export_symbols -o $lib'
 	    export_dynamic_flag_spec_CXX='${wl}-E'
 	    whole_archive_flag_spec_CXX="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
@@ -13666,7 +13695,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP "ld" | $GREP -v "ld:"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld.*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP "ld" | $GREP -v "ld:"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld.*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
 	    ;;
 	  *)
 	    if test "$GXX" = yes && test "$with_gnu_ld" = no; then
@@ -13686,7 +13715,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	      # Commands to make compiler produce verbose output that lists
 	      # what "hidden" libraries, object files and flags are used when
 	      # linking a shared library.
-	      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+	      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 
 	    else
 	      # FIXME: insert proper C++ library support
@@ -13762,7 +13791,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # GNU C++ compiler with Solaris linker
 	    if test "$GXX" = yes && test "$with_gnu_ld" = no; then
 	      no_undefined_flag_CXX=' ${wl}-z ${wl}defs'
-	      if $CC --version | $GREP -v '^2\.7' > /dev/null; then
+	      if $CC --version | sed -e 's/\r//g' | $GREP -v '^2\.7' > /dev/null; then
 	        archive_cmds_CXX='$CC -shared -nostdlib $LDFLAGS $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-h $wl$soname -o $lib'
 	        archive_expsym_cmds_CXX='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 		  $CC -shared -nostdlib ${wl}-M $wl$lib.exp -o $lib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags~$RM $lib.exp'
@@ -13770,7 +13799,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	        # Commands to make compiler produce verbose output that lists
 	        # what "hidden" libraries, object files and flags are used when
 	        # linking a shared library.
-	        output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+	        output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 	      else
 	        # g++ 2.7 appears to require `-G' NOT `-shared' on this
 	        # platform.
@@ -13781,7 +13810,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	        # Commands to make compiler produce verbose output that lists
 	        # what "hidden" libraries, object files and flags are used when
 	        # linking a shared library.
-	        output_verbose_link_cmd='$CC -G $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+	        output_verbose_link_cmd='$CC -G $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 	      fi
 
 	      hardcode_libdir_flag_spec_CXX='${wl}-R $wl$libdir'
@@ -13901,7 +13930,7 @@ private:
 _LT_EOF
 
 if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -13997,7 +14026,7 @@ interix[3-9]*)
   ;;
 
 linux*)
-  case `$CC -V 2>&1 | sed 5q` in
+  case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
   *Sun\ C*)
     # Sun C++ 5.9
 
@@ -14287,7 +14316,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	    lt_prog_compiler_static_CXX='-qstaticlink'
 	    ;;
 	  *)
-	    case `$CC -V 2>&1 | sed 5q` in
+	    case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	    *Sun\ C*)
 	      # Sun C++ 5.9
 	      lt_prog_compiler_pic_CXX='-KPIC'
@@ -14436,14 +14465,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works_CXX=yes
@@ -14482,10 +14513,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -14535,8 +14567,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -14544,6 +14577,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o_CXX=yes
@@ -14587,8 +14621,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -14596,6 +14631,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o_CXX=yes
@@ -14645,27 +14681,27 @@ fi
     { $as_echo "$as_me:${as_lineno-$LINENO}: checking whether the $compiler linker ($LD) supports shared libraries" >&5
 $as_echo_n "checking whether the $compiler linker ($LD) supports shared libraries... " >&6; }
 
-  export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   case $host_os in
   aix[4-9]*)
     # If we're using GNU nm, then we don't want the "-C" option.
     # -C means demangle to AIX nm, but means don't demangle with GNU nm
     # Also, AIX nm treats weak defined symbols like other global defined
     # symbols, whereas GNU nm marks them as "W".
-    if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-      export_symbols_cmds_CXX='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+    if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+      export_symbols_cmds_CXX='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
     else
-      export_symbols_cmds_CXX='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+      export_symbols_cmds_CXX='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
     fi
     ;;
   pw32*)
     export_symbols_cmds_CXX="$ltdll_cmds"
   ;;
   cygwin* | mingw* | cegcc*)
-    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/;/^.*[ ]__nm__/s/^.*[ ]__nm__\([^ ]*\)[ ][^ ]*/\1 DATA/;/^I[ ]/d;/^[AITW][ ]/s/.* //'\'' | sort | uniq > $export_symbols'
+    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/;/^.*[ ]__nm__/s/^.*[ ]__nm__\([^ ]*\)[ ][^ ]*/\1 DATA/;/^I[ ]/d;/^[AITW][ ]/s/.* //'\'' | sort | uniq > $export_symbols'
   ;;
   *)
-    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   ;;
   esac
   exclude_expsyms_CXX='_GLOBAL_OFFSET_TABLE_|_GLOBAL__F[ID]_.*'
@@ -14707,10 +14743,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -14736,6 +14773,7 @@ else
 	  fi
 	  allow_undefined_flag_CXX=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -14865,7 +14903,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -15234,7 +15272,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -15279,7 +15317,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -15758,7 +15796,7 @@ $as_echo "$enable_libstdcxx_pch" >&6; }
 
   { $as_echo "$as_me:${as_lineno-$LINENO}: checking for thread model used by GCC" >&5
 $as_echo_n "checking for thread model used by GCC... " >&6; }
-  target_thread_file=`$CXX -v 2>&1 | sed -n 's/^Thread model: //p'`
+  target_thread_file=`$CXX -v 2>&1 | sed -e 's/\r//g' | sed -n 's/^Thread model: //p'`
   { $as_echo "$as_me:${as_lineno-$LINENO}: result: $target_thread_file" >&5
 $as_echo "$target_thread_file" >&6; }
 
@@ -16001,7 +16039,7 @@ EOF
     { $as_echo "$as_me:${as_lineno-$LINENO}: checking for atomic builtins for bool" >&5
 $as_echo_n "checking for atomic builtins for bool... " >&6; }
     if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -16036,7 +16074,7 @@ EOF
     { $as_echo "$as_me:${as_lineno-$LINENO}: checking for atomic builtins for short" >&5
 $as_echo_n "checking for atomic builtins for short... " >&6; }
     if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -16072,7 +16110,7 @@ EOF
     { $as_echo "$as_me:${as_lineno-$LINENO}: checking for atomic builtins for int" >&5
 $as_echo_n "checking for atomic builtins for int... " >&6; }
     if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -16107,7 +16145,7 @@ EOF
     { $as_echo "$as_me:${as_lineno-$LINENO}: checking for atomic builtins for long long" >&5
 $as_echo_n "checking for atomic builtins for long long... " >&6; }
     if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -16256,7 +16294,7 @@ EOF
     { $as_echo "$as_me:${as_lineno-$LINENO}: checking for ISO/IEC TR 24733 " >&5
 $as_echo_n "checking for ISO/IEC TR 24733 ... " >&6; }
     if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -16303,7 +16341,7 @@ EOF
     { $as_echo "$as_me:${as_lineno-$LINENO}: checking for __float128" >&5
 $as_echo_n "checking for __float128... " >&6; }
     if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -16502,7 +16540,7 @@ fi
     #endif
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "_GLIBCXX_ok" >/dev/null 2>&1; then :
   enable_clocale_flag=gnu
 else
@@ -21946,7 +21984,7 @@ else
       int f() { STAP_PROBE(hi, bob); }
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP " \",\" " >/dev/null 2>&1; then :
   glibcxx_cv_sys_sdt_h=yes
 else
@@ -22043,9 +22081,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -22087,7 +22125,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -22118,7 +22156,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -22168,12 +22206,12 @@ with_gnu_ld=$lt_cv_prog_gnu_ld
     { $as_echo "$as_me:${as_lineno-$LINENO}: checking for ld version" >&5
 $as_echo_n "checking for ld version... " >&6; }
 
-    if $LD --version 2>/dev/null | grep 'GNU gold' >/dev/null 2>&1; then
+    if $LD --version 2>/dev/null | sed -e 's/\r//g' | grep 'GNU gold' >/dev/null 2>&1; then
       glibcxx_ld_is_gold=yes
-    elif $LD --version 2>/dev/null | grep 'mold' >/dev/null 2>&1; then
+    elif $LD --version 2>/dev/null | sed -e 's/\r//g' | grep 'mold' >/dev/null 2>&1; then
       glibcxx_ld_is_mold=yes
     fi
-    ldver=`$LD --version 2>/dev/null |
+    ldver=`$LD --version 2>/dev/null | sed -e 's/\r//g' |
 	   sed -e 's/[. ][0-9]\{8\}$//;s/.* \([^ ]\{1,\}\)$/\1/; q'`
 
     glibcxx_gnu_ld_version=`echo $ldver | \
@@ -22185,7 +22223,7 @@ $as_echo "$glibcxx_gnu_ld_version" >&6; }
   # Set --gc-sections.
   glibcxx_have_gc_sections=no
   if test "$glibcxx_ld_is_gold" = "yes" || test "$glibcxx_ld_is_mold" = "yes" ; then
-    if $LD --help 2>/dev/null | grep gc-sections >/dev/null 2>&1; then
+    if $LD --help 2>/dev/null | sed -e 's/\r//g' | grep gc-sections >/dev/null 2>&1; then
       glibcxx_have_gc_sections=yes
     fi
   else
@@ -22235,6 +22273,7 @@ rm -f core conftest.err conftest.$ac_objext \
       touch conftest.c
       if $CC -c conftest.c; then
 	if $LD --gc-sections -o conftest conftest.o 2>&1 | \
+	   sed -e 's/\r//g' | \
 	   grep "Warning: gc-sections option ignored" > /dev/null; then
 	  ac_gcsections=no
 	fi
@@ -22269,7 +22308,7 @@ $as_echo "$ac_gcsections" >&6; }
     *)
       { $as_echo "$as_me:${as_lineno-$LINENO}: checking for ld that supports -Wl,-z,relro" >&5
 $as_echo_n "checking for ld that supports -Wl,-z,relro... " >&6; }
-      cxx_z_relo=`$LD -v --help 2>/dev/null | grep "z relro"`
+      cxx_z_relo=`$LD -v --help 2>/dev/null | sed -e 's/\r//g' | grep "z relro"`
       if test -n "$cxx_z_relo"; then
         OPT_LDFLAGS="-Wl,-z,relro"
         ac_ld_relro=yes
@@ -28430,9 +28469,9 @@ $as_echo_n "checking for ld used by GCC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -28473,7 +28512,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some GNU ld's only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      if "$acl_cv_path_LD" -v 2>&1 < /dev/null | egrep '(GNU|with BFD)' > /dev/null; then
+      if "$acl_cv_path_LD" -v 2>&1 < /dev/null | sed -e 's/\r//g' | egrep '(GNU|with BFD)' > /dev/null; then
 	test "$with_gnu_ld" != no && break
       else
 	test "$with_gnu_ld" != yes && break
@@ -28501,7 +28540,7 @@ if ${acl_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU ld's only accept -v.
-if $LD -v 2>&1 </dev/null | egrep '(GNU|with BFD)' 1>&5; then
+if $LD -v 2>&1 </dev/null | sed -e 's/\r//g' | egrep '(GNU|with BFD)' 1>&5; then
   acl_cv_prog_gnu_ld=yes
 else
   acl_cv_prog_gnu_ld=no
@@ -29385,12 +29424,12 @@ ac_compiler_gnu=$ac_cv_c_compiler_gnu
     { $as_echo "$as_me:${as_lineno-$LINENO}: checking for ld version" >&5
 $as_echo_n "checking for ld version... " >&6; }
 
-    if $LD --version 2>/dev/null | grep 'GNU gold' >/dev/null 2>&1; then
+    if $LD --version 2>/dev/null | sed -e 's/\r//g' | grep 'GNU gold' >/dev/null 2>&1; then
       glibcxx_ld_is_gold=yes
-    elif $LD --version 2>/dev/null | grep 'mold' >/dev/null 2>&1; then
+    elif $LD --version 2>/dev/null | sed -e 's/\r//g' | grep 'mold' >/dev/null 2>&1; then
       glibcxx_ld_is_mold=yes
     fi
-    ldver=`$LD --version 2>/dev/null |
+    ldver=`$LD --version 2>/dev/null | sed -e 's/\r//g' |
 	   sed -e 's/[. ][0-9]\{8\}$//;s/.* \([^ ]\{1,\}\)$/\1/; q'`
 
     glibcxx_gnu_ld_version=`echo $ldver | \
@@ -29402,7 +29441,7 @@ $as_echo "$glibcxx_gnu_ld_version" >&6; }
   # Set --gc-sections.
   glibcxx_have_gc_sections=no
   if test "$glibcxx_ld_is_gold" = "yes" || test "$glibcxx_ld_is_mold" = "yes" ; then
-    if $LD --help 2>/dev/null | grep gc-sections >/dev/null 2>&1; then
+    if $LD --help 2>/dev/null | sed -e 's/\r//g' | grep gc-sections >/dev/null 2>&1; then
       glibcxx_have_gc_sections=yes
     fi
   else
@@ -29452,6 +29491,7 @@ rm -f core conftest.err conftest.$ac_objext \
       touch conftest.c
       if $CC -c conftest.c; then
 	if $LD --gc-sections -o conftest conftest.o 2>&1 | \
+	   sed -e 's/\r//g' | \
 	   grep "Warning: gc-sections option ignored" > /dev/null; then
 	  ac_gcsections=no
 	fi
@@ -29486,7 +29526,7 @@ $as_echo "$ac_gcsections" >&6; }
     *)
       { $as_echo "$as_me:${as_lineno-$LINENO}: checking for ld that supports -Wl,-z,relro" >&5
 $as_echo_n "checking for ld that supports -Wl,-z,relro... " >&6; }
-      cxx_z_relo=`$LD -v --help 2>/dev/null | grep "z relro"`
+      cxx_z_relo=`$LD -v --help 2>/dev/null | sed -e 's/\r//g' | grep "z relro"`
       if test -n "$cxx_z_relo"; then
         OPT_LDFLAGS="-Wl,-z,relro"
         ac_ld_relro=yes
@@ -35320,12 +35360,12 @@ done
     { $as_echo "$as_me:${as_lineno-$LINENO}: checking for ld version" >&5
 $as_echo_n "checking for ld version... " >&6; }
 
-    if $LD --version 2>/dev/null | grep 'GNU gold' >/dev/null 2>&1; then
+    if $LD --version 2>/dev/null | sed -e 's/\r//g' | grep 'GNU gold' >/dev/null 2>&1; then
       glibcxx_ld_is_gold=yes
-    elif $LD --version 2>/dev/null | grep 'mold' >/dev/null 2>&1; then
+    elif $LD --version 2>/dev/null | sed -e 's/\r//g' | grep 'mold' >/dev/null 2>&1; then
       glibcxx_ld_is_mold=yes
     fi
-    ldver=`$LD --version 2>/dev/null |
+    ldver=`$LD --version 2>/dev/null | sed -e 's/\r//g' |
 	   sed -e 's/[. ][0-9]\{8\}$//;s/.* \([^ ]\{1,\}\)$/\1/; q'`
 
     glibcxx_gnu_ld_version=`echo $ldver | \
@@ -35337,7 +35377,7 @@ $as_echo "$glibcxx_gnu_ld_version" >&6; }
   # Set --gc-sections.
   glibcxx_have_gc_sections=no
   if test "$glibcxx_ld_is_gold" = "yes" || test "$glibcxx_ld_is_mold" = "yes" ; then
-    if $LD --help 2>/dev/null | grep gc-sections >/dev/null 2>&1; then
+    if $LD --help 2>/dev/null | sed -e 's/\r//g' | grep gc-sections >/dev/null 2>&1; then
       glibcxx_have_gc_sections=yes
     fi
   else
@@ -35387,6 +35427,7 @@ rm -f core conftest.err conftest.$ac_objext \
       touch conftest.c
       if $CC -c conftest.c; then
 	if $LD --gc-sections -o conftest conftest.o 2>&1 | \
+	   sed -e 's/\r//g' | \
 	   grep "Warning: gc-sections option ignored" > /dev/null; then
 	  ac_gcsections=no
 	fi
@@ -35421,7 +35462,7 @@ $as_echo "$ac_gcsections" >&6; }
     *)
       { $as_echo "$as_me:${as_lineno-$LINENO}: checking for ld that supports -Wl,-z,relro" >&5
 $as_echo_n "checking for ld that supports -Wl,-z,relro... " >&6; }
-      cxx_z_relo=`$LD -v --help 2>/dev/null | grep "z relro"`
+      cxx_z_relo=`$LD -v --help 2>/dev/null | sed -e 's/\r//g' | grep "z relro"`
       if test -n "$cxx_z_relo"; then
         OPT_LDFLAGS="-Wl,-z,relro"
         ac_ld_relro=yes
@@ -47254,12 +47295,12 @@ done
     { $as_echo "$as_me:${as_lineno-$LINENO}: checking for ld version" >&5
 $as_echo_n "checking for ld version... " >&6; }
 
-    if $LD --version 2>/dev/null | grep 'GNU gold' >/dev/null 2>&1; then
+    if $LD --version 2>/dev/null | sed -e 's/\r//g' | grep 'GNU gold' >/dev/null 2>&1; then
       glibcxx_ld_is_gold=yes
-    elif $LD --version 2>/dev/null | grep 'mold' >/dev/null 2>&1; then
+    elif $LD --version 2>/dev/null | sed -e 's/\r//g' | grep 'mold' >/dev/null 2>&1; then
       glibcxx_ld_is_mold=yes
     fi
-    ldver=`$LD --version 2>/dev/null |
+    ldver=`$LD --version 2>/dev/null | sed -e 's/\r//g' |
 	   sed -e 's/[. ][0-9]\{8\}$//;s/.* \([^ ]\{1,\}\)$/\1/; q'`
 
     glibcxx_gnu_ld_version=`echo $ldver | \
@@ -47271,7 +47312,7 @@ $as_echo "$glibcxx_gnu_ld_version" >&6; }
   # Set --gc-sections.
   glibcxx_have_gc_sections=no
   if test "$glibcxx_ld_is_gold" = "yes" || test "$glibcxx_ld_is_mold" = "yes" ; then
-    if $LD --help 2>/dev/null | grep gc-sections >/dev/null 2>&1; then
+    if $LD --help 2>/dev/null | sed -e 's/\r//g' | grep gc-sections >/dev/null 2>&1; then
       glibcxx_have_gc_sections=yes
     fi
   else
@@ -47321,6 +47362,7 @@ rm -f core conftest.err conftest.$ac_objext \
       touch conftest.c
       if $CC -c conftest.c; then
 	if $LD --gc-sections -o conftest conftest.o 2>&1 | \
+	   sed -e 's/\r//g' | \
 	   grep "Warning: gc-sections option ignored" > /dev/null; then
 	  ac_gcsections=no
 	fi
@@ -47355,7 +47397,7 @@ $as_echo "$ac_gcsections" >&6; }
     *)
       { $as_echo "$as_me:${as_lineno-$LINENO}: checking for ld that supports -Wl,-z,relro" >&5
 $as_echo_n "checking for ld that supports -Wl,-z,relro... " >&6; }
-      cxx_z_relo=`$LD -v --help 2>/dev/null | grep "z relro"`
+      cxx_z_relo=`$LD -v --help 2>/dev/null | sed -e 's/\r//g' | grep "z relro"`
       if test -n "$cxx_z_relo"; then
         OPT_LDFLAGS="-Wl,-z,relro"
         ac_ld_relro=yes
@@ -47542,12 +47584,12 @@ done
     { $as_echo "$as_me:${as_lineno-$LINENO}: checking for ld version" >&5
 $as_echo_n "checking for ld version... " >&6; }
 
-    if $LD --version 2>/dev/null | grep 'GNU gold' >/dev/null 2>&1; then
+    if $LD --version 2>/dev/null | sed -e 's/\r//g' | grep 'GNU gold' >/dev/null 2>&1; then
       glibcxx_ld_is_gold=yes
-    elif $LD --version 2>/dev/null | grep 'mold' >/dev/null 2>&1; then
+    elif $LD --version 2>/dev/null | sed -e 's/\r//g' | grep 'mold' >/dev/null 2>&1; then
       glibcxx_ld_is_mold=yes
     fi
-    ldver=`$LD --version 2>/dev/null |
+    ldver=`$LD --version 2>/dev/null | sed -e 's/\r//g' |
 	   sed -e 's/[. ][0-9]\{8\}$//;s/.* \([^ ]\{1,\}\)$/\1/; q'`
 
     glibcxx_gnu_ld_version=`echo $ldver | \
@@ -47559,7 +47601,7 @@ $as_echo "$glibcxx_gnu_ld_version" >&6; }
   # Set --gc-sections.
   glibcxx_have_gc_sections=no
   if test "$glibcxx_ld_is_gold" = "yes" || test "$glibcxx_ld_is_mold" = "yes" ; then
-    if $LD --help 2>/dev/null | grep gc-sections >/dev/null 2>&1; then
+    if $LD --help 2>/dev/null | sed -e 's/\r//g' | grep gc-sections >/dev/null 2>&1; then
       glibcxx_have_gc_sections=yes
     fi
   else
@@ -47609,6 +47651,7 @@ rm -f core conftest.err conftest.$ac_objext \
       touch conftest.c
       if $CC -c conftest.c; then
 	if $LD --gc-sections -o conftest conftest.o 2>&1 | \
+	   sed -e 's/\r//g' | \
 	   grep "Warning: gc-sections option ignored" > /dev/null; then
 	  ac_gcsections=no
 	fi
@@ -47643,7 +47686,7 @@ $as_echo "$ac_gcsections" >&6; }
     *)
       { $as_echo "$as_me:${as_lineno-$LINENO}: checking for ld that supports -Wl,-z,relro" >&5
 $as_echo_n "checking for ld that supports -Wl,-z,relro... " >&6; }
-      cxx_z_relo=`$LD -v --help 2>/dev/null | grep "z relro"`
+      cxx_z_relo=`$LD -v --help 2>/dev/null | sed -e 's/\r//g' | grep "z relro"`
       if test -n "$cxx_z_relo"; then
         OPT_LDFLAGS="-Wl,-z,relro"
         ac_ld_relro=yes
@@ -48021,12 +48064,12 @@ ac_compiler_gnu=$ac_cv_c_compiler_gnu
     { $as_echo "$as_me:${as_lineno-$LINENO}: checking for ld version" >&5
 $as_echo_n "checking for ld version... " >&6; }
 
-    if $LD --version 2>/dev/null | grep 'GNU gold' >/dev/null 2>&1; then
+    if $LD --version 2>/dev/null | sed -e 's/\r//g' | grep 'GNU gold' >/dev/null 2>&1; then
       glibcxx_ld_is_gold=yes
-    elif $LD --version 2>/dev/null | grep 'mold' >/dev/null 2>&1; then
+    elif $LD --version 2>/dev/null | sed -e 's/\r//g' | grep 'mold' >/dev/null 2>&1; then
       glibcxx_ld_is_mold=yes
     fi
-    ldver=`$LD --version 2>/dev/null |
+    ldver=`$LD --version 2>/dev/null | sed -e 's/\r//g' |
 	   sed -e 's/[. ][0-9]\{8\}$//;s/.* \([^ ]\{1,\}\)$/\1/; q'`
 
     glibcxx_gnu_ld_version=`echo $ldver | \
@@ -48038,7 +48081,7 @@ $as_echo "$glibcxx_gnu_ld_version" >&6; }
   # Set --gc-sections.
   glibcxx_have_gc_sections=no
   if test "$glibcxx_ld_is_gold" = "yes" || test "$glibcxx_ld_is_mold" = "yes" ; then
-    if $LD --help 2>/dev/null | grep gc-sections >/dev/null 2>&1; then
+    if $LD --help 2>/dev/null | sed -e 's/\r//g' | grep gc-sections >/dev/null 2>&1; then
       glibcxx_have_gc_sections=yes
     fi
   else
@@ -48088,6 +48131,7 @@ rm -f core conftest.err conftest.$ac_objext \
       touch conftest.c
       if $CC -c conftest.c; then
 	if $LD --gc-sections -o conftest conftest.o 2>&1 | \
+	   sed -e 's/\r//g' | \
 	   grep "Warning: gc-sections option ignored" > /dev/null; then
 	  ac_gcsections=no
 	fi
@@ -48122,7 +48166,7 @@ $as_echo "$ac_gcsections" >&6; }
     *)
       { $as_echo "$as_me:${as_lineno-$LINENO}: checking for ld that supports -Wl,-z,relro" >&5
 $as_echo_n "checking for ld that supports -Wl,-z,relro... " >&6; }
-      cxx_z_relo=`$LD -v --help 2>/dev/null | grep "z relro"`
+      cxx_z_relo=`$LD -v --help 2>/dev/null | sed -e 's/\r//g' | grep "z relro"`
       if test -n "$cxx_z_relo"; then
         OPT_LDFLAGS="-Wl,-z,relro"
         ac_ld_relro=yes
@@ -54412,12 +54456,12 @@ _ACEOF
     { $as_echo "$as_me:${as_lineno-$LINENO}: checking for ld version" >&5
 $as_echo_n "checking for ld version... " >&6; }
 
-    if $LD --version 2>/dev/null | grep 'GNU gold' >/dev/null 2>&1; then
+    if $LD --version 2>/dev/null | sed -e 's/\r//g' | grep 'GNU gold' >/dev/null 2>&1; then
       glibcxx_ld_is_gold=yes
-    elif $LD --version 2>/dev/null | grep 'mold' >/dev/null 2>&1; then
+    elif $LD --version 2>/dev/null | sed -e 's/\r//g' | grep 'mold' >/dev/null 2>&1; then
       glibcxx_ld_is_mold=yes
     fi
-    ldver=`$LD --version 2>/dev/null |
+    ldver=`$LD --version 2>/dev/null | sed -e 's/\r//g' |
 	   sed -e 's/[. ][0-9]\{8\}$//;s/.* \([^ ]\{1,\}\)$/\1/; q'`
 
     glibcxx_gnu_ld_version=`echo $ldver | \
@@ -54429,7 +54473,7 @@ $as_echo "$glibcxx_gnu_ld_version" >&6; }
   # Set --gc-sections.
   glibcxx_have_gc_sections=no
   if test "$glibcxx_ld_is_gold" = "yes" || test "$glibcxx_ld_is_mold" = "yes" ; then
-    if $LD --help 2>/dev/null | grep gc-sections >/dev/null 2>&1; then
+    if $LD --help 2>/dev/null | sed -e 's/\r//g' | grep gc-sections >/dev/null 2>&1; then
       glibcxx_have_gc_sections=yes
     fi
   else
@@ -54479,6 +54523,7 @@ rm -f core conftest.err conftest.$ac_objext \
       touch conftest.c
       if $CC -c conftest.c; then
 	if $LD --gc-sections -o conftest conftest.o 2>&1 | \
+	   sed -e 's/\r//g' | \
 	   grep "Warning: gc-sections option ignored" > /dev/null; then
 	  ac_gcsections=no
 	fi
@@ -54513,7 +54558,7 @@ $as_echo "$ac_gcsections" >&6; }
     *)
       { $as_echo "$as_me:${as_lineno-$LINENO}: checking for ld that supports -Wl,-z,relro" >&5
 $as_echo_n "checking for ld that supports -Wl,-z,relro... " >&6; }
-      cxx_z_relo=`$LD -v --help 2>/dev/null | grep "z relro"`
+      cxx_z_relo=`$LD -v --help 2>/dev/null | sed -e 's/\r//g' | grep "z relro"`
       if test -n "$cxx_z_relo"; then
         OPT_LDFLAGS="-Wl,-z,relro"
         ac_ld_relro=yes
@@ -60563,12 +60608,12 @@ $as_echo "#define HAVE_TLS 1" >>confdefs.h
     { $as_echo "$as_me:${as_lineno-$LINENO}: checking for ld version" >&5
 $as_echo_n "checking for ld version... " >&6; }
 
-    if $LD --version 2>/dev/null | grep 'GNU gold' >/dev/null 2>&1; then
+    if $LD --version 2>/dev/null | sed -e 's/\r//g' | grep 'GNU gold' >/dev/null 2>&1; then
       glibcxx_ld_is_gold=yes
-    elif $LD --version 2>/dev/null | grep 'mold' >/dev/null 2>&1; then
+    elif $LD --version 2>/dev/null | sed -e 's/\r//g' | grep 'mold' >/dev/null 2>&1; then
       glibcxx_ld_is_mold=yes
     fi
-    ldver=`$LD --version 2>/dev/null |
+    ldver=`$LD --version 2>/dev/null | sed -e 's/\r//g' |
 	   sed -e 's/[. ][0-9]\{8\}$//;s/.* \([^ ]\{1,\}\)$/\1/; q'`
 
     glibcxx_gnu_ld_version=`echo $ldver | \
@@ -60580,7 +60625,7 @@ $as_echo "$glibcxx_gnu_ld_version" >&6; }
   # Set --gc-sections.
   glibcxx_have_gc_sections=no
   if test "$glibcxx_ld_is_gold" = "yes" || test "$glibcxx_ld_is_mold" = "yes" ; then
-    if $LD --help 2>/dev/null | grep gc-sections >/dev/null 2>&1; then
+    if $LD --help 2>/dev/null | sed -e 's/\r//g' | grep gc-sections >/dev/null 2>&1; then
       glibcxx_have_gc_sections=yes
     fi
   else
@@ -60630,6 +60675,7 @@ rm -f core conftest.err conftest.$ac_objext \
       touch conftest.c
       if $CC -c conftest.c; then
 	if $LD --gc-sections -o conftest conftest.o 2>&1 | \
+	   sed -e 's/\r//g' | \
 	   grep "Warning: gc-sections option ignored" > /dev/null; then
 	  ac_gcsections=no
 	fi
@@ -60664,7 +60710,7 @@ $as_echo "$ac_gcsections" >&6; }
     *)
       { $as_echo "$as_me:${as_lineno-$LINENO}: checking for ld that supports -Wl,-z,relro" >&5
 $as_echo_n "checking for ld that supports -Wl,-z,relro... " >&6; }
-      cxx_z_relo=`$LD -v --help 2>/dev/null | grep "z relro"`
+      cxx_z_relo=`$LD -v --help 2>/dev/null | sed -e 's/\r//g' | grep "z relro"`
       if test -n "$cxx_z_relo"; then
         OPT_LDFLAGS="-Wl,-z,relro"
         ac_ld_relro=yes
@@ -60776,12 +60822,12 @@ done
     { $as_echo "$as_me:${as_lineno-$LINENO}: checking for ld version" >&5
 $as_echo_n "checking for ld version... " >&6; }
 
-    if $LD --version 2>/dev/null | grep 'GNU gold' >/dev/null 2>&1; then
+    if $LD --version 2>/dev/null | sed -e 's/\r//g' | grep 'GNU gold' >/dev/null 2>&1; then
       glibcxx_ld_is_gold=yes
-    elif $LD --version 2>/dev/null | grep 'mold' >/dev/null 2>&1; then
+    elif $LD --version 2>/dev/null | sed -e 's/\r//g' | grep 'mold' >/dev/null 2>&1; then
       glibcxx_ld_is_mold=yes
     fi
-    ldver=`$LD --version 2>/dev/null |
+    ldver=`$LD --version 2>/dev/null | sed -e 's/\r//g' |
 	   sed -e 's/[. ][0-9]\{8\}$//;s/.* \([^ ]\{1,\}\)$/\1/; q'`
 
     glibcxx_gnu_ld_version=`echo $ldver | \
@@ -60793,7 +60839,7 @@ $as_echo "$glibcxx_gnu_ld_version" >&6; }
   # Set --gc-sections.
   glibcxx_have_gc_sections=no
   if test "$glibcxx_ld_is_gold" = "yes" || test "$glibcxx_ld_is_mold" = "yes" ; then
-    if $LD --help 2>/dev/null | grep gc-sections >/dev/null 2>&1; then
+    if $LD --help 2>/dev/null | sed -e 's/\r//g' | grep gc-sections >/dev/null 2>&1; then
       glibcxx_have_gc_sections=yes
     fi
   else
@@ -60843,6 +60889,7 @@ rm -f core conftest.err conftest.$ac_objext \
       touch conftest.c
       if $CC -c conftest.c; then
 	if $LD --gc-sections -o conftest conftest.o 2>&1 | \
+	   sed -e 's/\r//g' | \
 	   grep "Warning: gc-sections option ignored" > /dev/null; then
 	  ac_gcsections=no
 	fi
@@ -60877,7 +60924,7 @@ $as_echo "$ac_gcsections" >&6; }
     *)
       { $as_echo "$as_me:${as_lineno-$LINENO}: checking for ld that supports -Wl,-z,relro" >&5
 $as_echo_n "checking for ld that supports -Wl,-z,relro... " >&6; }
-      cxx_z_relo=`$LD -v --help 2>/dev/null | grep "z relro"`
+      cxx_z_relo=`$LD -v --help 2>/dev/null | sed -e 's/\r//g' | grep "z relro"`
       if test -n "$cxx_z_relo"; then
         OPT_LDFLAGS="-Wl,-z,relro"
         ac_ld_relro=yes
@@ -61008,12 +61055,12 @@ ac_compiler_gnu=$ac_cv_c_compiler_gnu
     { $as_echo "$as_me:${as_lineno-$LINENO}: checking for ld version" >&5
 $as_echo_n "checking for ld version... " >&6; }
 
-    if $LD --version 2>/dev/null | grep 'GNU gold' >/dev/null 2>&1; then
+    if $LD --version 2>/dev/null | sed -e 's/\r//g' | grep 'GNU gold' >/dev/null 2>&1; then
       glibcxx_ld_is_gold=yes
-    elif $LD --version 2>/dev/null | grep 'mold' >/dev/null 2>&1; then
+    elif $LD --version 2>/dev/null | sed -e 's/\r//g' | grep 'mold' >/dev/null 2>&1; then
       glibcxx_ld_is_mold=yes
     fi
-    ldver=`$LD --version 2>/dev/null |
+    ldver=`$LD --version 2>/dev/null | sed -e 's/\r//g' |
 	   sed -e 's/[. ][0-9]\{8\}$//;s/.* \([^ ]\{1,\}\)$/\1/; q'`
 
     glibcxx_gnu_ld_version=`echo $ldver | \
@@ -61025,7 +61072,7 @@ $as_echo "$glibcxx_gnu_ld_version" >&6; }
   # Set --gc-sections.
   glibcxx_have_gc_sections=no
   if test "$glibcxx_ld_is_gold" = "yes" || test "$glibcxx_ld_is_mold" = "yes" ; then
-    if $LD --help 2>/dev/null | grep gc-sections >/dev/null 2>&1; then
+    if $LD --help 2>/dev/null | sed -e 's/\r//g' | grep gc-sections >/dev/null 2>&1; then
       glibcxx_have_gc_sections=yes
     fi
   else
@@ -61075,6 +61122,7 @@ rm -f core conftest.err conftest.$ac_objext \
       touch conftest.c
       if $CC -c conftest.c; then
 	if $LD --gc-sections -o conftest conftest.o 2>&1 | \
+	   sed -e 's/\r//g' | \
 	   grep "Warning: gc-sections option ignored" > /dev/null; then
 	  ac_gcsections=no
 	fi
@@ -61109,7 +61157,7 @@ $as_echo "$ac_gcsections" >&6; }
     *)
       { $as_echo "$as_me:${as_lineno-$LINENO}: checking for ld that supports -Wl,-z,relro" >&5
 $as_echo_n "checking for ld that supports -Wl,-z,relro... " >&6; }
-      cxx_z_relo=`$LD -v --help 2>/dev/null | grep "z relro"`
+      cxx_z_relo=`$LD -v --help 2>/dev/null | sed -e 's/\r//g' | grep "z relro"`
       if test -n "$cxx_z_relo"; then
         OPT_LDFLAGS="-Wl,-z,relro"
         ac_ld_relro=yes
@@ -74763,7 +74811,7 @@ do
       ac_path_CXXFILT="$as_dir/$ac_prog$ac_exec_ext"
       as_fn_executable_p "$ac_path_CXXFILT" || continue
 # Check for GNU $ac_path_CXXFILT
-case `"$ac_path_CXXFILT" --version 2>&1` in
+case `"$ac_path_CXXFILT" --version 2>&1 | sed -e 's/\r//g'` in
 *GNU*)
   ac_cv_path_CXXFILT=$ac_path_CXXFILT && ac_path_CXXFILT_found=:;;
 esac
@@ -74910,6 +74958,7 @@ EOF
     glibcxx_libgcc_s_suffix=`${CC-cc} $CFLAGS $CPPFLAGS $LDFLAGS \
 			     -shared -shared-libgcc -o conftest.so \
 			     conftest.c -v 2>&1 >/dev/null \
+			     | sed -e 's/\r//g' \
 			     | sed -n 's/^.* -lgcc_s\([^ ]*\) .*$/\1/p'`
     rm -f conftest.c conftest.so
     if test x${glibcxx_libgcc_s_suffix+set} = xset; then
@@ -76022,7 +76071,7 @@ ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
   CXXFLAGS="$CXXFLAGS -fno-exceptions \
 	-I${toplevel_srcdir}/libgcc -I${toplevel_builddir}/libgcc"
 
-  target_thread_file=`$CXX -v 2>&1 | sed -n 's/^Thread model: //p'`
+  target_thread_file=`$CXX -v 2>&1 | sed -e 's/\r//g' | sed -n 's/^Thread model: //p'`
   case $target_thread_file in
     posix)
       CXXFLAGS="$CXXFLAGS -DSUPPORTS_WEAK -DGTHREAD_USE_WEAK -D_PTHREADS"
@@ -77404,7 +77453,7 @@ done
 #include <link.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "dl_iterate_phdr" >/dev/null 2>&1; then :
   have_dl_iterate_phdr=yes
 else
@@ -77843,7 +77892,7 @@ $as_echo_n "checking for modern makeinfo... " >&6; }
 if ${gcc_cv_prog_makeinfo_modern+:} false; then :
   $as_echo_n "(cached) " >&6
 else
-  ac_prog_version=`eval $MAKEINFO --version 2>&1 |
+  ac_prog_version=`eval $MAKEINFO --version 2>&1 | sed -e 's/\r//g' |
                                      sed -n 's/^.*GNU texinfo.* \([0-9][0-9.]*\).*$/\1/p'`
 
                     case $ac_prog_version in
@@ -81591,7 +81640,7 @@ _LT_EOF
  ;;
     "include/gstdint.h":C)
 if test "$GCC" = yes; then
-  echo "/* generated for " `$CC --version | sed 1q` "*/" > tmp-stdint.h
+  echo "/* generated for " `$CC --version | sed -e 's/\r//g' | sed 1q` "*/" > tmp-stdint.h
 else
   echo "/* generated for $CC */" > tmp-stdint.h
 fi
diff --git a/gcc/libstdc++-v3/src/Makefile.am b/gcc/libstdc++-v3/src/Makefile.am
index 9c3f4aca65..024bf7a597 100644
--- a/gcc/libstdc++-v3/src/Makefile.am
+++ b/gcc/libstdc++-v3/src/Makefile.am
@@ -300,7 +300,7 @@ libstdc++-symbols.ver:  ${glibcxx_srcdir}/$(SYMVER_FILE) \
 	  fi; \
 	fi
 	$(EGREP) -v '^[ 	]*#(#| |$$)' $@.tmp | \
-	  $(CC) -E -P -include $(CONFIG_HEADER) - > $@ || (rm -f $@ ; exit 1)
+	  $(CC) -E -P -include $(CONFIG_HEADER) - | sed -e 's/\r//g' > $@ || (rm -f $@ ; exit 1)
 	rm -f $@.tmp
 
 CLEANFILES = libstdc++-symbols.ver
diff --git a/gcc/libtool.m4 b/gcc/libtool.m4
index 17f8e5f307..c9e0c5d416 100644
--- a/gcc/libtool.m4
+++ b/gcc/libtool.m4
@@ -2042,7 +2042,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([[A-Za-z]]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -2146,7 +2146,7 @@ aix[[4-9]]*)
       aix4 | aix4.[[01]] | aix4.[[01]].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -2495,7 +2495,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -2540,7 +2540,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[[89]] | openbsd2.[[89]].*)
 	shlibpath_overrides_runpath=no
@@ -2840,9 +2840,9 @@ if test "$GCC" = yes; then
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -2880,7 +2880,7 @@ AC_CACHE_VAL(lt_cv_path_LD,
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -2920,7 +2920,7 @@ dnl AC_DEFUN([AC_PROG_LD], [])
 m4_defun([_LT_PATH_LD_GNU],
 [AC_CACHE_CHECK([if the linker ($LD) is GNU ld], lt_cv_prog_gnu_ld,
 [# I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -3029,7 +3029,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -3091,7 +3091,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu | uclinuxfdpiceabi)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[[^/]]+(\.so\.[[0-9]]+\.[[0-9]]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[[^/]]+(\.so|_pic\.a)$'
@@ -3109,7 +3109,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[[^/]]+(\.so\.[[0-9]]+\.[[0-9]]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[[^/]]+(\.so\.[[0-9]]+\.[[0-9]]+|_pic\.a)$'
@@ -3257,7 +3257,7 @@ AC_CACHE_CHECK([the name lister ($NM) interface], [lt_cv_nm_interface],
   (eval "$ac_compile" 2>conftest.err)
   cat conftest.err >&AS_MESSAGE_LOG_FD
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&AS_MESSAGE_LOG_FD)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
   cat conftest.err >&AS_MESSAGE_LOG_FD
   (eval echo "\"\$as_me:$LINENO: output\"" >&AS_MESSAGE_LOG_FD)
   cat conftest.out >&AS_MESSAGE_LOG_FD
@@ -3389,7 +3389,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[[ABCDGIRSTW]]' ;;
 esac
@@ -3397,11 +3397,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([[^ ]]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([[^ ]]*\) \([[^ ]]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([[^ ]]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([[^ ]]*\) \(lib[[^ ]]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([[^ ]]*\) \([[^ ]]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([[^ ]]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([[^ ]]*\) \([[^ ]]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([[^ ]]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([[^ ]]*\) \(lib[[^ ]]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([[^ ]]*\) \([[^ ]]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -3458,7 +3458,7 @@ _LT_EOF
   if AC_TRY_EVAL(ac_compile); then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if AC_TRY_EVAL(NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) && test -s "$nlist"; then
+    if AC_TRY_EVAL(NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) && test -s "$nlist"; then
       # Try sorting and uniquifying the output.
       if sort "$nlist" | uniq > "$nlist"T; then
 	mv -f "$nlist"T "$nlist"
@@ -3476,7 +3476,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | sed -e '"'"'s/\r//g'"'"' | $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -3771,7 +3771,7 @@ m4_if([$1], [CXX], [
 	    _LT_TAGVAR(lt_prog_compiler_static, $1)='-qstaticlink'
 	    ;;
 	  *)
-	    case `$CC -V 2>&1 | sed 5q` in
+	    case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	    *Sun\ C*)
 	      # Sun C++ 5.9
 	      _LT_TAGVAR(lt_prog_compiler_pic, $1)='-KPIC'
@@ -4069,7 +4069,7 @@ m4_if([$1], [CXX], [
 	_LT_TAGVAR(lt_prog_compiler_static, $1)='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  _LT_TAGVAR(lt_prog_compiler_pic, $1)='-KPIC'
@@ -4217,27 +4217,27 @@ m4_require([_LT_CMD_GLOBAL_SYMBOLS])dnl
 m4_require([_LT_TAG_COMPILER])dnl
 AC_MSG_CHECKING([whether the $compiler linker ($LD) supports shared libraries])
 m4_if([$1], [CXX], [
-  _LT_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  _LT_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   case $host_os in
   aix[[4-9]]*)
     # If we're using GNU nm, then we don't want the "-C" option.
     # -C means demangle to AIX nm, but means don't demangle with GNU nm
     # Also, AIX nm treats weak defined symbols like other global defined
     # symbols, whereas GNU nm marks them as "W".
-    if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-      _LT_TAGVAR(export_symbols_cmds, $1)='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && ([substr](\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+    if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+      _LT_TAGVAR(export_symbols_cmds, $1)='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && ([substr](\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
     else
-      _LT_TAGVAR(export_symbols_cmds, $1)='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && ([substr](\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+      _LT_TAGVAR(export_symbols_cmds, $1)='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && ([substr](\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
     fi
     ;;
   pw32*)
     _LT_TAGVAR(export_symbols_cmds, $1)="$ltdll_cmds"
   ;;
   cygwin* | mingw* | cegcc*)
-    _LT_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[[BCDGRS]][[ ]]/s/.*[[ ]]\([[^ ]]*\)/\1 DATA/;/^.*[[ ]]__nm__/s/^.*[[ ]]__nm__\([[^ ]]*\)[[ ]][[^ ]]*/\1 DATA/;/^I[[ ]]/d;/^[[AITW]][[ ]]/s/.* //'\'' | sort | uniq > $export_symbols'
+    _LT_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[[BCDGRS]][[ ]]/s/.*[[ ]]\([[^ ]]*\)/\1 DATA/;/^.*[[ ]]__nm__/s/^.*[[ ]]__nm__\([[^ ]]*\)[[ ]][[^ ]]*/\1 DATA/;/^I[[ ]]/d;/^[[AITW]][[ ]]/s/.* //'\'' | sort | uniq > $export_symbols'
   ;;
   *)
-    _LT_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+    _LT_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   ;;
   esac
   _LT_TAGVAR(exclude_expsyms, $1)=['_GLOBAL_OFFSET_TABLE_|_GLOBAL__F[ID]_.*']
@@ -4250,7 +4250,7 @@ m4_if([$1], [CXX], [
   _LT_TAGVAR(compiler_needs_object, $1)=no
   _LT_TAGVAR(enable_shared_with_static_runtimes, $1)=no
   _LT_TAGVAR(export_dynamic_flag_spec, $1)=
-  _LT_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  _LT_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   _LT_TAGVAR(hardcode_automatic, $1)=no
   _LT_TAGVAR(hardcode_direct, $1)=no
   _LT_TAGVAR(hardcode_direct_absolute, $1)=no
@@ -4314,7 +4314,7 @@ dnl Note also adjust exclude_expsyms for C++ above.
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[[2-9]]*) ;;
 	  *\ \(GNU\ Binutils\)\ [[3-9]]*) ;;
@@ -4340,13 +4340,13 @@ dnl Note also adjust exclude_expsyms for C++ above.
     _LT_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath ${wl}$libdir'
     _LT_TAGVAR(export_dynamic_flag_spec, $1)='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       _LT_TAGVAR(whole_archive_flag_spec, $1)="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       _LT_TAGVAR(whole_archive_flag_spec, $1)=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [[01]].* | *\ 2.[[0-9]].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -4390,7 +4390,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	_LT_TAGVAR(allow_undefined_flag, $1)=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -4408,9 +4408,9 @@ _LT_EOF
       _LT_TAGVAR(allow_undefined_flag, $1)=unsupported
       _LT_TAGVAR(always_export_symbols, $1)=no
       _LT_TAGVAR(enable_shared_with_static_runtimes, $1)=yes
-      _LT_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[[BCDGRS]][[ ]]/s/.*[[ ]]\([[^ ]]*\)/\1 DATA/'\'' | $SED -e '\''/^[[AITW]][[ ]]/s/.*[[ ]]//'\'' | sort | uniq > $export_symbols'
+      _LT_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[[BCDGRS]][[ ]]/s/.*[[ ]]\([[^ ]]*\)/\1 DATA/'\'' | $SED -e '\''/^[[AITW]][[ ]]/s/.*[[ ]]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         _LT_TAGVAR(archive_cmds, $1)='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -4453,7 +4453,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -4484,7 +4484,7 @@ _LT_EOF
 	  _LT_TAGVAR(compiler_needs_object, $1)=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  _LT_TAGVAR(whole_archive_flag_spec, $1)='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  _LT_TAGVAR(compiler_needs_object, $1)=yes
@@ -4522,7 +4522,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	_LT_TAGVAR(archive_cmds, $1)='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -4532,7 +4532,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	_LT_TAGVAR(ld_shlibs, $1)=no
 	cat <<_LT_EOF 1>&2
 
@@ -4544,7 +4544,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	_LT_TAGVAR(archive_cmds, $1)='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	_LT_TAGVAR(archive_expsym_cmds, $1)='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -4553,7 +4553,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [[01]].* | *\ 2.[[0-9]].* | *\ 2.1[[0-5]].*)
 	_LT_TAGVAR(ld_shlibs, $1)=no
 	cat <<_LT_EOF 1>&2
@@ -4572,7 +4572,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    _LT_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath ${wl}$libdir'
 	    _LT_TAGVAR(archive_cmds, $1)='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    _LT_TAGVAR(archive_expsym_cmds, $1)='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -4591,7 +4591,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	_LT_TAGVAR(archive_cmds, $1)='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	_LT_TAGVAR(archive_expsym_cmds, $1)='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -4635,10 +4635,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  _LT_TAGVAR(export_symbols_cmds, $1)='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && ([substr](\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  _LT_TAGVAR(export_symbols_cmds, $1)='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && ([substr](\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  _LT_TAGVAR(export_symbols_cmds, $1)='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && ([substr](\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  _LT_TAGVAR(export_symbols_cmds, $1)='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && ([substr](\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -4945,7 +4945,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	_LT_TAGVAR(archive_cmds, $1)='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	_LT_TAGVAR(archive_cmds, $1)='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -4971,7 +4971,7 @@ _LT_EOF
 	_LT_TAGVAR(hardcode_direct, $1)=yes
 	_LT_TAGVAR(hardcode_shlibpath_var, $1)=no
 	_LT_TAGVAR(hardcode_direct_absolute, $1)=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  _LT_TAGVAR(archive_cmds, $1)='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  _LT_TAGVAR(archive_expsym_cmds, $1)='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  _LT_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath,$libdir'
@@ -5040,7 +5040,7 @@ _LT_EOF
 	_LT_TAGVAR(archive_expsym_cmds, $1)='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  _LT_TAGVAR(archive_cmds, $1)='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -5534,7 +5534,7 @@ if test "$_lt_caught_CXX_error" != yes; then
         wlarc='${wl}'
 
         # ancient GNU ld didn't support --whole-archive et. al.
-        if eval "`$CC -print-prog-name=ld` --help 2>&1" |
+        if eval "`$CC -print-prog-name=ld | sed -e 's/\r//g'` --help 2>&1" | sed -e 's/\r//g' |
 	  $GREP 'no-whole-archive' > /dev/null; then
           _LT_TAGVAR(whole_archive_flag_spec, $1)="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
         else
@@ -5555,7 +5555,7 @@ if test "$_lt_caught_CXX_error" != yes; then
       # Commands to make compiler produce verbose output that lists
       # what "hidden" libraries, object files and flags are used when
       # linking a shared library.
-      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 
     else
       GXX=no
@@ -5698,7 +5698,7 @@ if test "$_lt_caught_CXX_error" != yes; then
         ;;
 
       beos*)
-	if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	  _LT_TAGVAR(allow_undefined_flag, $1)=unsupported
 	  # Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	  # support --undefined.  This deserves some investigation.  FIXME
@@ -5726,7 +5726,7 @@ if test "$_lt_caught_CXX_error" != yes; then
         _LT_TAGVAR(always_export_symbols, $1)=no
         _LT_TAGVAR(enable_shared_with_static_runtimes, $1)=yes
 
-        if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+        if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
           _LT_TAGVAR(archive_cmds, $1)='$CC -shared -nostdlib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
           # If the export-symbols file already is a .def file (1st line
           # is EXPORTS), use it as is; otherwise, prepend...
@@ -5811,7 +5811,7 @@ if test "$_lt_caught_CXX_error" != yes; then
             # explicitly linking system object files so we need to strip them
             # from the output so that they don't get included in the library
             # dependencies.
-            output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | $EGREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+            output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | sed -e '"'"'s/\r//g'"'"' | $EGREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
             ;;
           *)
             if test "$GXX" = yes; then
@@ -5876,7 +5876,7 @@ if test "$_lt_caught_CXX_error" != yes; then
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | $GREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+	    output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | sed -e '"'"'s/\r//g'"'"' | $GREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
 	    ;;
           *)
 	    if test "$GXX" = yes; then
@@ -5961,7 +5961,7 @@ if test "$_lt_caught_CXX_error" != yes; then
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`$CC $CFLAGS -v conftest.$objext -o libconftest$shared_ext 2>&1 | $GREP "ld"`; rm -f libconftest$shared_ext; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+	    output_verbose_link_cmd='templist=`$CC $CFLAGS -v conftest.$objext -o libconftest$shared_ext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP "ld"`; rm -f libconftest$shared_ext; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
 
 	    _LT_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath,$libdir'
 	    _LT_TAGVAR(export_dynamic_flag_spec, $1)='${wl}--export-dynamic'
@@ -5976,7 +5976,7 @@ if test "$_lt_caught_CXX_error" != yes; then
 	    # version 8.0 and above of icpc choke on multiply defined symbols
 	    # if we add $predep_objects and $postdep_objects, however 7.1 and
 	    # earlier do not add the objects themselves.
-	    case `$CC -V 2>&1` in
+	    case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	      *"Version 7."*)
 	        _LT_TAGVAR(archive_cmds, $1)='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname -o $lib'
 		_LT_TAGVAR(archive_expsym_cmds, $1)='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -5997,7 +5997,7 @@ if test "$_lt_caught_CXX_error" != yes; then
 	    ;;
           pgCC* | pgcpp*)
             # Portland Group C++ compiler
-	    case `$CC -V` in
+	    case `$CC -V | sed -e 's/\r//g'` in
 	    *pgCC\ [[1-5]].* | *pgcpp\ [[1-5]].*)
 	      _LT_TAGVAR(prelink_cmds, $1)='tpldir=Template.dir~
 		rm -rf $tpldir~
@@ -6044,7 +6044,7 @@ if test "$_lt_caught_CXX_error" != yes; then
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP "ld"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld .*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "X$list" | $Xsed'
+	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP "ld"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld .*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "X$list" | $Xsed'
 	    ;;
 	  xl* | mpixl* | bgxl*)
 	    # IBM XL 8.0 on PPC, with GNU ld
@@ -6059,7 +6059,7 @@ if test "$_lt_caught_CXX_error" != yes; then
 	    fi
 	    ;;
 	  *)
-	    case `$CC -V 2>&1 | sed 5q` in
+	    case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	    *Sun\ C*)
 	      # Sun C++ 5.9
 	      _LT_TAGVAR(no_undefined_flag, $1)=' -zdefs'
@@ -6109,7 +6109,7 @@ if test "$_lt_caught_CXX_error" != yes; then
 	;;
 
       netbsd*)
-        if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+        if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	  _LT_TAGVAR(archive_cmds, $1)='$LD -Bshareable  -o $lib $predep_objects $libobjs $deplibs $postdep_objects $linker_flags'
 	  wlarc=
 	  _LT_TAGVAR(hardcode_libdir_flag_spec, $1)='-R$libdir'
@@ -6117,7 +6117,7 @@ if test "$_lt_caught_CXX_error" != yes; then
 	  _LT_TAGVAR(hardcode_shlibpath_var, $1)=no
 	fi
 	# Workaround some broken pre-1.5 toolchains
-	output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP conftest.$objext | $SED -e "s:-lgcc -lc -lgcc::"'
+	output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP conftest.$objext | $SED -e "s:-lgcc -lc -lgcc::"'
 	;;
 
       *nto* | *qnx*)
@@ -6136,7 +6136,7 @@ if test "$_lt_caught_CXX_error" != yes; then
 	  _LT_TAGVAR(hardcode_direct_absolute, $1)=yes
 	  _LT_TAGVAR(archive_cmds, $1)='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $lib'
 	  _LT_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath,$libdir'
-	  if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	    _LT_TAGVAR(archive_expsym_cmds, $1)='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-retain-symbols-file,$export_symbols -o $lib'
 	    _LT_TAGVAR(export_dynamic_flag_spec, $1)='${wl}-E'
 	    _LT_TAGVAR(whole_archive_flag_spec, $1)="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
@@ -6200,7 +6200,7 @@ if test "$_lt_caught_CXX_error" != yes; then
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP "ld" | $GREP -v "ld:"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld.*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP "ld" | $GREP -v "ld:"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld.*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
 	    ;;
 	  *)
 	    if test "$GXX" = yes && test "$with_gnu_ld" = no; then
@@ -6220,7 +6220,7 @@ if test "$_lt_caught_CXX_error" != yes; then
 	      # Commands to make compiler produce verbose output that lists
 	      # what "hidden" libraries, object files and flags are used when
 	      # linking a shared library.
-	      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+	      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 
 	    else
 	      # FIXME: insert proper C++ library support
@@ -6296,7 +6296,7 @@ if test "$_lt_caught_CXX_error" != yes; then
 	    # GNU C++ compiler with Solaris linker
 	    if test "$GXX" = yes && test "$with_gnu_ld" = no; then
 	      _LT_TAGVAR(no_undefined_flag, $1)=' ${wl}-z ${wl}defs'
-	      if $CC --version | $GREP -v '^2\.7' > /dev/null; then
+	      if $CC --version | sed -e 's/\r//g' | $GREP -v '^2\.7' > /dev/null; then
 	        _LT_TAGVAR(archive_cmds, $1)='$CC -shared -nostdlib $LDFLAGS $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-h $wl$soname -o $lib'
 	        _LT_TAGVAR(archive_expsym_cmds, $1)='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 		  $CC -shared -nostdlib ${wl}-M $wl$lib.exp -o $lib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags~$RM $lib.exp'
@@ -6304,7 +6304,7 @@ if test "$_lt_caught_CXX_error" != yes; then
 	        # Commands to make compiler produce verbose output that lists
 	        # what "hidden" libraries, object files and flags are used when
 	        # linking a shared library.
-	        output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+	        output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 	      else
 	        # g++ 2.7 appears to require `-G' NOT `-shared' on this
 	        # platform.
@@ -6315,7 +6315,7 @@ if test "$_lt_caught_CXX_error" != yes; then
 	        # Commands to make compiler produce verbose output that lists
 	        # what "hidden" libraries, object files and flags are used when
 	        # linking a shared library.
-	        output_verbose_link_cmd='$CC -G $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+	        output_verbose_link_cmd='$CC -G $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 	      fi
 
 	      _LT_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-R $wl$libdir'
@@ -6596,7 +6596,7 @@ interix[[3-9]]*)
   ;;
 
 linux*)
-  case `$CC -V 2>&1 | sed 5q` in
+  case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
   *Sun\ C*)
     # Sun C++ 5.9
 
diff --git a/gcc/libvtv/configure b/gcc/libvtv/configure
index d64b4af5c6..9c8ad32be1 100755
--- a/gcc/libvtv/configure
+++ b/gcc/libvtv/configure
@@ -1569,9 +1569,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1606,9 +1607,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1731,7 +1733,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -1804,9 +1806,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1917,9 +1920,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1954,9 +1958,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1992,9 +1997,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2929,9 +2935,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -2982,7 +2989,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3052,7 +3059,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3108,7 +3115,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -3165,7 +3172,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3765,7 +3772,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -3782,7 +3789,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -4627,7 +4634,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -4685,6 +4692,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -4854,7 +4866,7 @@ case ${version_specific_libs} in
       toolexecdir='$(libdir)/gcc-lib/$(target_alias)'
       toolexeclibdir='$(libdir)'
     fi
-    multi_os_directory=`$CC -print-multi-os-directory`
+    multi_os_directory=`$CC -print-multi-os-directory | sed -e 's/\r//g'`
     case $multi_os_directory in
       .) ;; # Avoid trailing /.
       *) toolexeclibdir=$toolexeclibdir/$multi_os_directory ;;
@@ -5221,9 +5233,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -5627,9 +5640,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -5790,7 +5804,7 @@ else
 
   am_cv_CXX_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -5848,6 +5862,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -6462,9 +6481,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -6506,7 +6525,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -6537,7 +6556,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -6745,10 +6764,12 @@ else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
   (eval echo "\"\$as_me:$LINENO: $ac_compile\"" >&5)
-  (eval "$ac_compile" 2>conftest.err)
+  (eval "($ac_compile | sed -e 's/\r//g')" 2>conftest.err)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: output\"" >&5)
   cat conftest.out >&5
@@ -7169,7 +7190,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -7231,7 +7252,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu | uclinuxfdpiceabi)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|_pic\.a)$'
@@ -7249,7 +7270,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
@@ -7750,7 +7771,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[ABCDGIRSTW]' ;;
 esac
@@ -7758,11 +7779,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -7796,7 +7817,7 @@ for ac_symprfx in "" "_"; do
 "     s[1]~prfx {split(s[1],t,\"@\"); print t[1], substr(t[1],length(prfx))}"\
 "     ' prfx=^$ac_symprfx"
   else
-    lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
+    lt_cv_sys_global_symbol_pipe="sed -n -e 's/\r//g' -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
   fi
 
   # Check to see that the pipe works correctly.
@@ -7817,14 +7838,14 @@ int main(){nm_test_var='a';nm_test_func();return(0);}
 _LT_EOF
 
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist\""; } >&5
-  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) 2>&5
+    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist\""; } >&5
+  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s "$nlist"; then
@@ -7845,7 +7866,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist"  | sed -e '"'"'s/\r//g'"'"'| $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -7858,7 +7879,7 @@ lt__PROGRAM__LTX_preloaded_symbols[] =
 {
   { "@PROGRAM@", (void *) 0 },
 _LT_EOF
-	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | $GREP -v main >> conftest.$ac_ext
+	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | sed -e 's/\r//g' | $GREP -v main >> conftest.$ac_ext
 	  cat <<\_LT_EOF >> conftest.$ac_ext
   {0, (void *) 0}
 };
@@ -7881,7 +7902,7 @@ _LT_EOF
 	  LIBS="conftstm.$ac_objext"
 	  CFLAGS="$CFLAGS$lt_prog_compiler_no_builtin_flag"
 	  if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext}; then
@@ -7960,7 +7981,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7979,7 +8000,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo '#line '$LINENO' "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -8017,7 +8038,7 @@ s390*-*linux*|s390*-*tpf*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -8129,7 +8150,7 @@ sparc*-*solaris*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -8662,6 +8683,7 @@ else
 	if test -f libconftest.dylib && test ! -s conftest.err && test $_lt_result = 0; then
 	  lt_cv_apple_cc_single_mod=yes
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err >&5
 	fi
 	rm -rf libconftest.dylib*
@@ -8724,6 +8746,7 @@ _LT_EOF
       if test -f conftest && test ! -s conftest.err && test $_lt_result = 0 && $GREP forced_load conftest 2>&1 >/dev/null; then
 	lt_cv_ld_force_load=yes
       else
+        dos2unix -q conftest.err
 	cat conftest.err >&5
       fi
         rm -f conftest.err libconftest.a conftest conftest.c
@@ -9216,13 +9239,15 @@ compiler_DEFAULT=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -9262,14 +9287,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -9484,7 +9511,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic='-KPIC'
@@ -9615,14 +9642,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works=yes
@@ -9664,10 +9693,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -9720,8 +9750,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -9729,6 +9760,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -9775,8 +9807,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -9784,6 +9817,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -9844,7 +9878,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object=no
   enable_shared_with_static_runtimes=no
   export_dynamic_flag_spec=
-  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic=no
   hardcode_direct=no
   hardcode_direct_absolute=no
@@ -9907,7 +9941,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -9933,13 +9967,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -9983,7 +10017,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -10001,9 +10035,9 @@ _LT_EOF
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -10046,7 +10080,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -10077,7 +10111,7 @@ _LT_EOF
 	  compiler_needs_object=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object=yes
@@ -10115,7 +10149,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -10125,7 +10159,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
 
@@ -10137,7 +10171,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -10146,7 +10180,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
@@ -10165,7 +10199,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
 	    archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -10184,7 +10218,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -10228,10 +10262,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -10578,10 +10612,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS -b"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -10662,7 +10697,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -10688,7 +10723,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct=yes
 	hardcode_shlibpath_var=no
 	hardcode_direct_absolute=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
@@ -10757,7 +10792,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -10950,10 +10985,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -10979,6 +11015,7 @@ else
 	  fi
 	  allow_undefined_flag=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -11161,7 +11198,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([A-Za-z]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -11265,7 +11302,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -11633,7 +11670,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -11678,7 +11715,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -12324,7 +12361,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -12430,7 +12467,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -12786,13 +12823,15 @@ compiler=$CC
   # save warnings/boilerplate of simple test code
   ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
   ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -12858,9 +12897,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -12902,7 +12941,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -12933,7 +12972,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -12967,7 +13006,7 @@ with_gnu_ld=$lt_cv_prog_gnu_ld
         wlarc='${wl}'
 
         # ancient GNU ld didn't support --whole-archive et. al.
-        if eval "`$CC -print-prog-name=ld` --help 2>&1" |
+        if eval "`$CC -print-prog-name=ld | sed -e 's/\r//g'` --help 2>&1" | sed -e 's/\r//g' |
 	  $GREP 'no-whole-archive' > /dev/null; then
           whole_archive_flag_spec_CXX="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
         else
@@ -12988,7 +13027,7 @@ with_gnu_ld=$lt_cv_prog_gnu_ld
       # Commands to make compiler produce verbose output that lists
       # what "hidden" libraries, object files and flags are used when
       # linking a shared library.
-      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 
     else
       GXX=no
@@ -13190,7 +13229,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
         ;;
 
       beos*)
-	if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	  allow_undefined_flag_CXX=unsupported
 	  # Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	  # support --undefined.  This deserves some investigation.  FIXME
@@ -13218,7 +13257,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
         always_export_symbols_CXX=no
         enable_shared_with_static_runtimes_CXX=yes
 
-        if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+        if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
           archive_cmds_CXX='$CC -shared -nostdlib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
           # If the export-symbols file already is a .def file (1st line
           # is EXPORTS), use it as is; otherwise, prepend...
@@ -13334,7 +13373,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
             # explicitly linking system object files so we need to strip them
             # from the output so that they don't get included in the library
             # dependencies.
-            output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | $EGREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+            output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | sed -e '"'"'s/\r//g'"'"' | $EGREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
             ;;
           *)
             if test "$GXX" = yes; then
@@ -13399,7 +13438,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | $GREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+	    output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | sed -e '"'"'s/\r//g'"'"' | $GREP "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
 	    ;;
           *)
 	    if test "$GXX" = yes; then
@@ -13484,7 +13523,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`$CC $CFLAGS -v conftest.$objext -o libconftest$shared_ext 2>&1 | $GREP "ld"`; rm -f libconftest$shared_ext; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+	    output_verbose_link_cmd='templist=`$CC $CFLAGS -v conftest.$objext -o libconftest$shared_ext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP "ld"`; rm -f libconftest$shared_ext; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
 
 	    hardcode_libdir_flag_spec_CXX='${wl}-rpath,$libdir'
 	    export_dynamic_flag_spec_CXX='${wl}--export-dynamic'
@@ -13499,7 +13538,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # version 8.0 and above of icpc choke on multiply defined symbols
 	    # if we add $predep_objects and $postdep_objects, however 7.1 and
 	    # earlier do not add the objects themselves.
-	    case `$CC -V 2>&1` in
+	    case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	      *"Version 7."*)
 	        archive_cmds_CXX='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname -o $lib'
 		archive_expsym_cmds_CXX='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -13520,7 +13559,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    ;;
           pgCC* | pgcpp*)
             # Portland Group C++ compiler
-	    case `$CC -V` in
+	    case `$CC -V | sed -e 's/\r//g'` in
 	    *pgCC\ [1-5].* | *pgcpp\ [1-5].*)
 	      prelink_cmds_CXX='tpldir=Template.dir~
 		rm -rf $tpldir~
@@ -13567,7 +13606,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP "ld"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld .*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "X$list" | $Xsed'
+	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP "ld"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld .*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "X$list" | $Xsed'
 	    ;;
 	  xl* | mpixl* | bgxl*)
 	    # IBM XL 8.0 on PPC, with GNU ld
@@ -13582,7 +13621,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    fi
 	    ;;
 	  *)
-	    case `$CC -V 2>&1 | sed 5q` in
+	    case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	    *Sun\ C*)
 	      # Sun C++ 5.9
 	      no_undefined_flag_CXX=' -zdefs'
@@ -13632,7 +13671,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	;;
 
       netbsd*)
-        if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+        if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	  archive_cmds_CXX='$LD -Bshareable  -o $lib $predep_objects $libobjs $deplibs $postdep_objects $linker_flags'
 	  wlarc=
 	  hardcode_libdir_flag_spec_CXX='-R$libdir'
@@ -13640,7 +13679,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	  hardcode_shlibpath_var_CXX=no
 	fi
 	# Workaround some broken pre-1.5 toolchains
-	output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP conftest.$objext | $SED -e "s:-lgcc -lc -lgcc::"'
+	output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP conftest.$objext | $SED -e "s:-lgcc -lc -lgcc::"'
 	;;
 
       *nto* | *qnx*)
@@ -13659,7 +13698,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	  hardcode_direct_absolute_CXX=yes
 	  archive_cmds_CXX='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $lib'
 	  hardcode_libdir_flag_spec_CXX='${wl}-rpath,$libdir'
-	  if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	    archive_expsym_cmds_CXX='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-retain-symbols-file,$export_symbols -o $lib'
 	    export_dynamic_flag_spec_CXX='${wl}-E'
 	    whole_archive_flag_spec_CXX="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
@@ -13723,7 +13762,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # explicitly linking system object files so we need to strip them
 	    # from the output so that they don't get included in the library
 	    # dependencies.
-	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP "ld" | $GREP -v "ld:"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld.*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
+	    output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP "ld" | $GREP -v "ld:"`; templist=`func_echo_all "$templist" | $SED "s/\(^.*ld.*\)\( .*ld.*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; func_echo_all "$list"'
 	    ;;
 	  *)
 	    if test "$GXX" = yes && test "$with_gnu_ld" = no; then
@@ -13743,7 +13782,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	      # Commands to make compiler produce verbose output that lists
 	      # what "hidden" libraries, object files and flags are used when
 	      # linking a shared library.
-	      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+	      output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 
 	    else
 	      # FIXME: insert proper C++ library support
@@ -13819,7 +13858,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	    # GNU C++ compiler with Solaris linker
 	    if test "$GXX" = yes && test "$with_gnu_ld" = no; then
 	      no_undefined_flag_CXX=' ${wl}-z ${wl}defs'
-	      if $CC --version | $GREP -v '^2\.7' > /dev/null; then
+	      if $CC --version | sed -e 's/\r//g' | $GREP -v '^2\.7' > /dev/null; then
 	        archive_cmds_CXX='$CC -shared -nostdlib $LDFLAGS $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-h $wl$soname -o $lib'
 	        archive_expsym_cmds_CXX='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 		  $CC -shared -nostdlib ${wl}-M $wl$lib.exp -o $lib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags~$RM $lib.exp'
@@ -13827,7 +13866,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	        # Commands to make compiler produce verbose output that lists
 	        # what "hidden" libraries, object files and flags are used when
 	        # linking a shared library.
-	        output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+	        output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 	      else
 	        # g++ 2.7 appears to require `-G' NOT `-shared' on this
 	        # platform.
@@ -13838,7 +13877,7 @@ if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
 	        # Commands to make compiler produce verbose output that lists
 	        # what "hidden" libraries, object files and flags are used when
 	        # linking a shared library.
-	        output_verbose_link_cmd='$CC -G $CFLAGS -v conftest.$objext 2>&1 | $GREP -v "^Configured with:" | $GREP "\-L"'
+	        output_verbose_link_cmd='$CC -G $CFLAGS -v conftest.$objext 2>&1 | sed -e '"'"'s/\r//g'"'"' | $GREP -v "^Configured with:" | $GREP "\-L"'
 	      fi
 
 	      hardcode_libdir_flag_spec_CXX='${wl}-R $wl$libdir'
@@ -13958,7 +13997,7 @@ private:
 _LT_EOF
 
 if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -14054,7 +14093,7 @@ interix[3-9]*)
   ;;
 
 linux*)
-  case `$CC -V 2>&1 | sed 5q` in
+  case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
   *Sun\ C*)
     # Sun C++ 5.9
 
@@ -14344,7 +14383,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	    lt_prog_compiler_static_CXX='-qstaticlink'
 	    ;;
 	  *)
-	    case `$CC -V 2>&1 | sed 5q` in
+	    case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	    *Sun\ C*)
 	      # Sun C++ 5.9
 	      lt_prog_compiler_pic_CXX='-KPIC'
@@ -14493,14 +14532,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works_CXX=yes
@@ -14539,10 +14580,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -14592,8 +14634,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -14601,6 +14644,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o_CXX=yes
@@ -14644,8 +14688,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -14653,6 +14698,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o_CXX=yes
@@ -14702,27 +14748,27 @@ fi
     { $as_echo "$as_me:${as_lineno-$LINENO}: checking whether the $compiler linker ($LD) supports shared libraries" >&5
 $as_echo_n "checking whether the $compiler linker ($LD) supports shared libraries... " >&6; }
 
-  export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   case $host_os in
   aix[4-9]*)
     # If we're using GNU nm, then we don't want the "-C" option.
     # -C means demangle to AIX nm, but means don't demangle with GNU nm
     # Also, AIX nm treats weak defined symbols like other global defined
     # symbols, whereas GNU nm marks them as "W".
-    if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-      export_symbols_cmds_CXX='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+    if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+      export_symbols_cmds_CXX='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
     else
-      export_symbols_cmds_CXX='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+      export_symbols_cmds_CXX='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
     fi
     ;;
   pw32*)
     export_symbols_cmds_CXX="$ltdll_cmds"
   ;;
   cygwin* | mingw* | cegcc*)
-    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/;/^.*[ ]__nm__/s/^.*[ ]__nm__\([^ ]*\)[ ][^ ]*/\1 DATA/;/^I[ ]/d;/^[AITW][ ]/s/.* //'\'' | sort | uniq > $export_symbols'
+    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/;/^.*[ ]__nm__/s/^.*[ ]__nm__\([^ ]*\)[ ][^ ]*/\1 DATA/;/^I[ ]/d;/^[AITW][ ]/s/.* //'\'' | sort | uniq > $export_symbols'
   ;;
   *)
-    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   ;;
   esac
   exclude_expsyms_CXX='_GLOBAL_OFFSET_TABLE_|_GLOBAL__F[ID]_.*'
@@ -14764,10 +14810,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -14793,6 +14840,7 @@ else
 	  fi
 	  allow_undefined_flag_CXX=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -14922,7 +14970,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -15298,7 +15346,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -15343,7 +15391,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
diff --git a/gcc/libvtv/configure.ac b/gcc/libvtv/configure.ac
index f3b937e4b1..1eb4ca3d90 100644
--- a/gcc/libvtv/configure.ac
+++ b/gcc/libvtv/configure.ac
@@ -107,7 +107,7 @@ case ${version_specific_libs} in
       toolexecdir='$(libdir)/gcc-lib/$(target_alias)'
       toolexeclibdir='$(libdir)'
     fi
-    multi_os_directory=`$CC -print-multi-os-directory`
+    multi_os_directory=`$CC -print-multi-os-directory | sed -e 's/\r//g'`
     case $multi_os_directory in
       .) ;; # Avoid trailing /.
       *) toolexeclibdir=$toolexeclibdir/$multi_os_directory ;;
diff --git a/gcc/ltmain.sh b/gcc/ltmain.sh
index 70990740b6..a7c4f69c67 100644
--- a/gcc/ltmain.sh
+++ b/gcc/ltmain.sh
@@ -2571,7 +2571,7 @@ extern \"C\" {
 	  progfiles=`$ECHO "$objs$old_deplibs" | $SP2NL | $SED "$lo2o" | $NL2SP`
 	  for progfile in $progfiles; do
 	    func_verbose "extracting global C symbols from \`$progfile'"
-	    $opt_dry_run || eval "$NM $progfile | $global_symbol_pipe >> '$nlist'"
+	    $opt_dry_run || eval "$NM $progfile | sed -e 's/\r//g' | $global_symbol_pipe >> '$nlist'"
 	  done
 
 	  if test -n "$exclude_expsyms"; then
@@ -2622,7 +2622,7 @@ extern \"C\" {
 	  name="$func_basename_result"
 	  $opt_dry_run || {
 	    $ECHO ": $name " >> "$nlist"
-	    eval "$NM $dlprefile 2>/dev/null | $global_symbol_pipe >> '$nlist'"
+	    eval "$NM $dlprefile 2>/dev/null | sed -e 's/\r//g' | $global_symbol_pipe >> '$nlist'"
 	  }
 	done
 
@@ -2799,6 +2799,7 @@ func_win32_libid ()
     if $OBJDUMP -f "$1" | $SED -e '10q' 2>/dev/null |
        $EGREP 'file format (pe-i386(.*architecture: i386)?|pe-arm-wince|pe-x86-64)' >/dev/null; then
       win32_nmres=`$NM -f posix -A "$1" |
+	$SED -n -e 's/\r//g' |
 	$SED -n -e '
 	    1,100{
 		/ I /{
diff --git a/gcc/lto-plugin/configure b/gcc/lto-plugin/configure
index b820accfd6..792ab6f1cd 100755
--- a/gcc/lto-plugin/configure
+++ b/gcc/lto-plugin/configure
@@ -1547,9 +1547,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1584,9 +1585,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1709,7 +1711,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -1782,9 +1784,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -3539,9 +3542,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -3592,7 +3596,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3662,7 +3666,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3718,7 +3722,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -3775,7 +3779,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4101,7 +4105,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -4159,6 +4163,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -4503,7 +4512,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -4520,7 +4529,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -4974,9 +4983,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -5286,7 +5296,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -5344,6 +5354,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -6288,9 +6303,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -6332,7 +6347,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -6363,7 +6378,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -6571,10 +6586,12 @@ else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
   (eval echo "\"\$as_me:$LINENO: $ac_compile\"" >&5)
-  (eval "$ac_compile" 2>conftest.err)
+  (eval "($ac_compile | sed -e 's/\r//g')" 2>conftest.err)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: output\"" >&5)
   cat conftest.out >&5
@@ -6995,7 +7012,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -7057,7 +7074,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu | uclinuxfdpiceabi)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|_pic\.a)$'
@@ -7075,7 +7092,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
@@ -7576,7 +7593,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[ABCDGIRSTW]' ;;
 esac
@@ -7584,11 +7601,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -7622,7 +7639,7 @@ for ac_symprfx in "" "_"; do
 "     s[1]~prfx {split(s[1],t,\"@\"); print t[1], substr(t[1],length(prfx))}"\
 "     ' prfx=^$ac_symprfx"
   else
-    lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
+    lt_cv_sys_global_symbol_pipe="sed -n -e 's/\r//g' -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
   fi
 
   # Check to see that the pipe works correctly.
@@ -7643,14 +7660,14 @@ int main(){nm_test_var='a';nm_test_func();return(0);}
 _LT_EOF
 
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist\""; } >&5
-  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) 2>&5
+    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist\""; } >&5
+  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s "$nlist"; then
@@ -7671,7 +7688,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | sed -e '"'"'s/\r//g'"'"' | $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -7684,7 +7701,7 @@ lt__PROGRAM__LTX_preloaded_symbols[] =
 {
   { "@PROGRAM@", (void *) 0 },
 _LT_EOF
-	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | $GREP -v main >> conftest.$ac_ext
+	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | sed -e 's/\r//g' | $GREP -v main >> conftest.$ac_ext
 	  cat <<\_LT_EOF >> conftest.$ac_ext
   {0, (void *) 0}
 };
@@ -7707,7 +7724,7 @@ _LT_EOF
 	  LIBS="conftstm.$ac_objext"
 	  CFLAGS="$CFLAGS$lt_prog_compiler_no_builtin_flag"
 	  if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext}; then
@@ -7786,7 +7803,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7805,7 +7822,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo '#line '$LINENO' "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7843,7 +7860,7 @@ s390*-*linux*|s390*-*tpf*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7955,7 +7972,7 @@ sparc*-*solaris*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -8488,6 +8505,7 @@ else
 	if test -f libconftest.dylib && test ! -s conftest.err && test $_lt_result = 0; then
 	  lt_cv_apple_cc_single_mod=yes
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err >&5
 	fi
 	rm -rf libconftest.dylib*
@@ -8550,6 +8568,7 @@ _LT_EOF
       if test -f conftest && test ! -s conftest.err && test $_lt_result = 0 && $GREP forced_load conftest 2>&1 >/dev/null; then
 	lt_cv_ld_force_load=yes
       else
+        dos2unix -q conftest.err
 	cat conftest.err >&5
       fi
         rm -f conftest.err libconftest.a conftest conftest.c
@@ -9043,13 +9062,15 @@ compiler_DEFAULT=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -9089,14 +9110,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -9311,7 +9334,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic='-KPIC'
@@ -9442,14 +9465,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works=yes
@@ -9491,10 +9516,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -9547,8 +9573,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -9556,6 +9583,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -9602,8 +9630,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -9611,6 +9640,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -9671,7 +9701,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object=no
   enable_shared_with_static_runtimes=no
   export_dynamic_flag_spec=
-  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic=no
   hardcode_direct=no
   hardcode_direct_absolute=no
@@ -9734,7 +9764,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -9760,13 +9790,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -9810,7 +9840,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -9828,9 +9858,9 @@ _LT_EOF
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -9873,7 +9903,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -9904,7 +9934,7 @@ _LT_EOF
 	  compiler_needs_object=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object=yes
@@ -9942,7 +9972,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -9952,7 +9982,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
 
@@ -9964,7 +9994,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9973,7 +10003,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
@@ -9992,7 +10022,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
 	    archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -10011,7 +10041,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -10055,10 +10085,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -10405,10 +10435,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS -b"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -10489,7 +10520,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -10515,7 +10546,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct=yes
 	hardcode_shlibpath_var=no
 	hardcode_direct_absolute=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
@@ -10584,7 +10615,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -10777,10 +10808,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -10806,6 +10838,7 @@ else
 	  fi
 	  allow_undefined_flag=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -10988,7 +11021,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([A-Za-z]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -11092,7 +11125,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -11460,7 +11493,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -11505,7 +11538,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -12151,7 +12184,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -12257,7 +12290,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
diff --git a/gcc/newlib/acinclude.m4 b/gcc/newlib/acinclude.m4
index 693bac6257..da7049e541 100644
--- a/gcc/newlib/acinclude.m4
+++ b/gcc/newlib/acinclude.m4
@@ -138,7 +138,7 @@ cat > conftest.c <<EOF
   yes;
 #endif
 EOF
-if AC_TRY_COMMAND(${CC-cc} -E conftest.c) | egrep yes >/dev/null 2>&1; then
+if AC_TRY_COMMAND(${CC-cc} -E conftest.c) | sed -e 's/\r//g' | egrep yes >/dev/null 2>&1; then
   ac_cv_prog_gcc=yes
 else
   ac_cv_prog_gcc=no
diff --git a/gcc/newlib/configure b/gcc/newlib/configure
index 8446566529..2754511d83 100755
--- a/gcc/newlib/configure
+++ b/gcc/newlib/configure
@@ -1642,9 +1642,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1680,9 +1681,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1756,9 +1758,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1794,7 +1797,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -3449,7 +3452,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -3507,6 +3510,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -3618,7 +3626,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
@@ -5063,9 +5071,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -5116,7 +5125,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -5186,7 +5195,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -5242,7 +5251,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -5299,7 +5308,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -5769,9 +5778,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -5813,7 +5822,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -5844,7 +5853,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -6052,10 +6061,12 @@ else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
   (eval echo "\"\$as_me:$LINENO: $ac_compile\"" >&5)
-  (eval "$ac_compile" 2>conftest.err)
+  (eval "($ac_compile | sed -e 's/\r//g')" 2>conftest.err)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: output\"" >&5)
   cat conftest.out >&5
@@ -6473,7 +6484,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -6535,7 +6546,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|_pic\.a)$'
@@ -6553,7 +6564,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
@@ -7054,7 +7065,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[ABCDGIRSTW]' ;;
 esac
@@ -7062,11 +7073,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -7100,7 +7111,7 @@ for ac_symprfx in "" "_"; do
 "     s[1]~prfx {split(s[1],t,\"@\"); print t[1], substr(t[1],length(prfx))}"\
 "     ' prfx=^$ac_symprfx"
   else
-    lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
+    lt_cv_sys_global_symbol_pipe="sed -n -e 's/\r//g' -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
   fi
 
   # Check to see that the pipe works correctly.
@@ -7121,14 +7132,14 @@ int main(){nm_test_var='a';nm_test_func();return(0);}
 _LT_EOF
 
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist\""; } >&5
-  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) 2>&5
+    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist\""; } >&5
+  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s "$nlist"; then
@@ -7149,7 +7160,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | sed -e '"'"'s/\r//g'"'"' | $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -7162,7 +7173,7 @@ lt__PROGRAM__LTX_preloaded_symbols[] =
 {
   { "@PROGRAM@", (void *) 0 },
 _LT_EOF
-	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | $GREP -v main >> conftest.$ac_ext
+	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | sed -e 's/\r//g' | $GREP -v main >> conftest.$ac_ext
 	  cat <<\_LT_EOF >> conftest.$ac_ext
   {0, (void *) 0}
 };
@@ -7185,7 +7196,7 @@ _LT_EOF
 	  LIBS="conftstm.$ac_objext"
 	  CFLAGS="$CFLAGS$lt_prog_compiler_no_builtin_flag"
 	  if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext}; then
@@ -7265,7 +7276,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7284,7 +7295,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo '#line '$LINENO' "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7322,7 +7333,7 @@ s390*-*linux*|s390*-*tpf*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7434,7 +7445,7 @@ sparc*-*solaris*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7967,6 +7978,7 @@ else
 	if test -f libconftest.dylib && test ! -s conftest.err && test $_lt_result = 0; then
 	  lt_cv_apple_cc_single_mod=yes
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err >&5
 	fi
 	rm -rf libconftest.dylib*
@@ -8029,6 +8041,7 @@ _LT_EOF
       if test -f conftest && test ! -s conftest.err && test $_lt_result = 0 && $GREP forced_load conftest 2>&1 >/dev/null; then
 	lt_cv_ld_force_load=yes
       else
+        dos2unix -q conftest.err
 	cat conftest.err >&5
       fi
         rm -f conftest.err libconftest.a conftest conftest.c
@@ -8244,7 +8257,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -8261,7 +8274,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -8785,13 +8798,15 @@ compiler_DEFAULT=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -8831,14 +8846,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -9053,7 +9070,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic='-KPIC'
@@ -9184,14 +9201,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works=yes
@@ -9233,10 +9252,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -9289,8 +9309,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -9298,6 +9319,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -9344,8 +9366,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -9353,6 +9376,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -9413,7 +9437,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object=no
   enable_shared_with_static_runtimes=no
   export_dynamic_flag_spec=
-  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic=no
   hardcode_direct=no
   hardcode_direct_absolute=no
@@ -9476,7 +9500,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -9502,13 +9526,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -9552,7 +9576,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -9570,9 +9594,9 @@ _LT_EOF
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -9615,7 +9639,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -9646,7 +9670,7 @@ _LT_EOF
 	  compiler_needs_object=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object=yes
@@ -9684,7 +9708,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -9694,7 +9718,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
 
@@ -9706,7 +9730,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9715,7 +9739,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
@@ -9734,7 +9758,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
 	    archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -9753,7 +9777,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9797,10 +9821,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -10147,10 +10171,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS -b"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -10231,7 +10256,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -10257,7 +10282,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct=yes
 	hardcode_shlibpath_var=no
 	hardcode_direct_absolute=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
@@ -10326,7 +10351,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -10519,10 +10544,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -10548,6 +10574,7 @@ else
 	  fi
 	  allow_undefined_flag=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -10730,7 +10757,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([A-Za-z]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -10834,7 +10861,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -11207,7 +11234,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -11252,7 +11279,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -11898,7 +11925,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -12004,7 +12031,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
diff --git a/gcc/newlib/iconvdata/configure b/gcc/newlib/iconvdata/configure
index 494d080845..9fae8e93ba 100755
--- a/gcc/newlib/iconvdata/configure
+++ b/gcc/newlib/iconvdata/configure
@@ -1559,9 +1559,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1597,9 +1598,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1673,9 +1675,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1711,7 +1714,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -3066,7 +3069,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -3124,6 +3127,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -3235,7 +3243,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
@@ -4638,9 +4646,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -4691,7 +4700,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4761,7 +4770,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4817,7 +4826,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -4874,7 +4883,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -5344,9 +5353,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -5388,7 +5397,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -5419,7 +5428,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -5627,10 +5636,12 @@ else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
   (eval echo "\"\$as_me:$LINENO: $ac_compile\"" >&5)
-  (eval "$ac_compile" 2>conftest.err)
+  (eval "($ac_compile | sed -e 's/\r//g')" 2>conftest.err)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: output\"" >&5)
   cat conftest.out >&5
@@ -6048,7 +6059,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -6110,7 +6121,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|_pic\.a)$'
@@ -6128,7 +6139,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
@@ -6629,7 +6640,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[ABCDGIRSTW]' ;;
 esac
@@ -6637,11 +6648,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -6675,7 +6686,7 @@ for ac_symprfx in "" "_"; do
 "     s[1]~prfx {split(s[1],t,\"@\"); print t[1], substr(t[1],length(prfx))}"\
 "     ' prfx=^$ac_symprfx"
   else
-    lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
+    lt_cv_sys_global_symbol_pipe="sed -n -e 's/\r//g' -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
   fi
 
   # Check to see that the pipe works correctly.
@@ -6696,14 +6707,14 @@ int main(){nm_test_var='a';nm_test_func();return(0);}
 _LT_EOF
 
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist\""; } >&5
-  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) 2>&5
+    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist\""; } >&5
+  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s "$nlist"; then
@@ -6724,7 +6735,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | sed -e '"'"'s/\r//g'"'"' | $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -6737,7 +6748,7 @@ lt__PROGRAM__LTX_preloaded_symbols[] =
 {
   { "@PROGRAM@", (void *) 0 },
 _LT_EOF
-	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | $GREP -v main >> conftest.$ac_ext
+	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | sed -e 's/\r//g' | $GREP -v main >> conftest.$ac_ext
 	  cat <<\_LT_EOF >> conftest.$ac_ext
   {0, (void *) 0}
 };
@@ -6760,7 +6771,7 @@ _LT_EOF
 	  LIBS="conftstm.$ac_objext"
 	  CFLAGS="$CFLAGS$lt_prog_compiler_no_builtin_flag"
 	  if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext}; then
@@ -6840,7 +6851,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6859,7 +6870,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo '#line '$LINENO' "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6897,7 +6908,7 @@ s390*-*linux*|s390*-*tpf*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7009,7 +7020,7 @@ sparc*-*solaris*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7542,6 +7553,7 @@ else
 	if test -f libconftest.dylib && test ! -s conftest.err && test $_lt_result = 0; then
 	  lt_cv_apple_cc_single_mod=yes
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err >&5
 	fi
 	rm -rf libconftest.dylib*
@@ -7604,6 +7616,7 @@ _LT_EOF
       if test -f conftest && test ! -s conftest.err && test $_lt_result = 0 && $GREP forced_load conftest 2>&1 >/dev/null; then
 	lt_cv_ld_force_load=yes
       else
+        dos2unix -q conftest.err
 	cat conftest.err >&5
       fi
         rm -f conftest.err libconftest.a conftest conftest.c
@@ -7819,7 +7832,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -7836,7 +7849,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -8360,13 +8373,15 @@ compiler_DEFAULT=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -8406,14 +8421,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -8628,7 +8645,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic='-KPIC'
@@ -8759,14 +8776,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works=yes
@@ -8808,10 +8827,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -8864,8 +8884,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8873,6 +8894,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8919,8 +8941,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8928,6 +8951,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8988,7 +9012,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object=no
   enable_shared_with_static_runtimes=no
   export_dynamic_flag_spec=
-  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic=no
   hardcode_direct=no
   hardcode_direct_absolute=no
@@ -9051,7 +9075,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -9077,13 +9101,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -9127,7 +9151,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -9145,9 +9169,9 @@ _LT_EOF
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -9190,7 +9214,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -9221,7 +9245,7 @@ _LT_EOF
 	  compiler_needs_object=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object=yes
@@ -9259,7 +9283,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -9269,7 +9293,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
 
@@ -9281,7 +9305,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9290,7 +9314,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
@@ -9309,7 +9333,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
 	    archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -9328,7 +9352,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9372,10 +9396,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -9722,7 +9746,7 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS -b"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
@@ -9806,7 +9830,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -9832,7 +9856,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct=yes
 	hardcode_shlibpath_var=no
 	hardcode_direct_absolute=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
@@ -9901,7 +9925,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -10094,10 +10118,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -10123,6 +10148,7 @@ else
 	  fi
 	  allow_undefined_flag=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -10305,7 +10331,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([A-Za-z]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -10409,7 +10435,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -10782,7 +10808,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -10827,7 +10853,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -11473,7 +11499,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -11579,7 +11605,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
diff --git a/gcc/newlib/libc/configure b/gcc/newlib/libc/configure
index 28387a5c72..ca79352ec2 100755
--- a/gcc/newlib/libc/configure
+++ b/gcc/newlib/libc/configure
@@ -1611,9 +1611,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1649,9 +1650,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1725,9 +1727,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1763,7 +1766,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -3181,7 +3184,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -3239,6 +3242,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -3350,7 +3358,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
@@ -4762,9 +4770,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -4815,7 +4824,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4885,7 +4894,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4941,7 +4950,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -4998,7 +5007,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -5468,9 +5477,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -5512,7 +5521,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -5543,7 +5552,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -5751,10 +5760,12 @@ else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
   (eval echo "\"\$as_me:$LINENO: $ac_compile\"" >&5)
-  (eval "$ac_compile" 2>conftest.err)
+  (eval "($ac_compile | sed -e 's/\r//g')" 2>conftest.err)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: output\"" >&5)
   cat conftest.out >&5
@@ -6172,7 +6183,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -6234,7 +6245,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|_pic\.a)$'
@@ -6252,7 +6263,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
@@ -6753,7 +6764,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[ABCDGIRSTW]' ;;
 esac
@@ -6761,11 +6772,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -6799,7 +6810,7 @@ for ac_symprfx in "" "_"; do
 "     s[1]~prfx {split(s[1],t,\"@\"); print t[1], substr(t[1],length(prfx))}"\
 "     ' prfx=^$ac_symprfx"
   else
-    lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
+    lt_cv_sys_global_symbol_pipe="sed -n -e 's/\r//g' -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
   fi
 
   # Check to see that the pipe works correctly.
@@ -6820,14 +6831,14 @@ int main(){nm_test_var='a';nm_test_func();return(0);}
 _LT_EOF
 
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist\""; } >&5
-  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) 2>&5
+    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist\""; } >&5
+  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s "$nlist"; then
@@ -6848,7 +6859,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | sed -e '"'"'s/\r//g'"'"' | $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -6861,7 +6872,7 @@ lt__PROGRAM__LTX_preloaded_symbols[] =
 {
   { "@PROGRAM@", (void *) 0 },
 _LT_EOF
-	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | $GREP -v main >> conftest.$ac_ext
+	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | sed -e 's/\r//g' | $GREP -v main >> conftest.$ac_ext
 	  cat <<\_LT_EOF >> conftest.$ac_ext
   {0, (void *) 0}
 };
@@ -6884,7 +6895,7 @@ _LT_EOF
 	  LIBS="conftstm.$ac_objext"
 	  CFLAGS="$CFLAGS$lt_prog_compiler_no_builtin_flag"
 	  if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext}; then
@@ -6964,7 +6975,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6983,7 +6994,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo '#line '$LINENO' "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7021,7 +7032,7 @@ s390*-*linux*|s390*-*tpf*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7133,7 +7144,7 @@ sparc*-*solaris*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7666,6 +7677,7 @@ else
 	if test -f libconftest.dylib && test ! -s conftest.err && test $_lt_result = 0; then
 	  lt_cv_apple_cc_single_mod=yes
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err >&5
 	fi
 	rm -rf libconftest.dylib*
@@ -7728,6 +7740,7 @@ _LT_EOF
       if test -f conftest && test ! -s conftest.err && test $_lt_result = 0 && $GREP forced_load conftest 2>&1 >/dev/null; then
 	lt_cv_ld_force_load=yes
       else
+        dos2unix -q conftest.err
 	cat conftest.err >&5
       fi
         rm -f conftest.err libconftest.a conftest conftest.c
@@ -7943,7 +7956,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -7960,7 +7973,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -8484,13 +8497,15 @@ compiler_DEFAULT=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -8530,14 +8545,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -8752,7 +8769,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic='-KPIC'
@@ -8883,14 +8900,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works=yes
@@ -8932,10 +8951,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -8988,8 +9008,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8997,6 +9018,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -9043,8 +9065,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -9052,6 +9075,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -9112,7 +9136,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object=no
   enable_shared_with_static_runtimes=no
   export_dynamic_flag_spec=
-  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic=no
   hardcode_direct=no
   hardcode_direct_absolute=no
@@ -9175,7 +9199,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -9201,13 +9225,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -9251,7 +9275,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -9269,9 +9293,9 @@ _LT_EOF
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -9314,7 +9338,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -9345,7 +9369,7 @@ _LT_EOF
 	  compiler_needs_object=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object=yes
@@ -9383,7 +9407,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -9393,7 +9417,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
 
@@ -9405,7 +9429,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9414,7 +9438,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
@@ -9433,7 +9457,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
 	    archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -9452,7 +9476,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9496,10 +9520,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -9846,10 +9870,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS -b"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -9930,7 +9955,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -9956,7 +9981,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct=yes
 	hardcode_shlibpath_var=no
 	hardcode_direct_absolute=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
@@ -10025,7 +10050,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -10218,10 +10243,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -10247,6 +10273,7 @@ else
 	  fi
 	  allow_undefined_flag=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -10429,7 +10456,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([A-Za-z]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -10533,7 +10560,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -10906,7 +10933,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -10951,7 +10978,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -11597,7 +11624,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -11703,7 +11730,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
diff --git a/gcc/newlib/libc/machine/a29k/configure b/gcc/newlib/libc/machine/a29k/configure
index cc0372576c..6289480add 100755
--- a/gcc/newlib/libc/machine/a29k/configure
+++ b/gcc/newlib/libc/machine/a29k/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/aarch64/configure b/gcc/newlib/libc/machine/aarch64/configure
index 17572f3f07..b4becc5cb3 100755
--- a/gcc/newlib/libc/machine/aarch64/configure
+++ b/gcc/newlib/libc/machine/aarch64/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/amdgcn/configure b/gcc/newlib/libc/machine/amdgcn/configure
index cc0372576c..6289480add 100755
--- a/gcc/newlib/libc/machine/amdgcn/configure
+++ b/gcc/newlib/libc/machine/amdgcn/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/arc/configure b/gcc/newlib/libc/machine/arc/configure
index cc0372576c..6289480add 100755
--- a/gcc/newlib/libc/machine/arc/configure
+++ b/gcc/newlib/libc/machine/arc/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/arm/configure b/gcc/newlib/libc/machine/arm/configure
index 5de9acf6b1..607569c21f 100755
--- a/gcc/newlib/libc/machine/arm/configure
+++ b/gcc/newlib/libc/machine/arm/configure
@@ -1457,9 +1457,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2741,7 +2742,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2799,6 +2800,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2910,7 +2916,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/bfin/configure b/gcc/newlib/libc/machine/bfin/configure
index cc0372576c..6289480add 100755
--- a/gcc/newlib/libc/machine/bfin/configure
+++ b/gcc/newlib/libc/machine/bfin/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/configure b/gcc/newlib/libc/machine/configure
index 83bf0dec8a..f60a1fc57a 100755
--- a/gcc/newlib/libc/machine/configure
+++ b/gcc/newlib/libc/machine/configure
@@ -1621,9 +1621,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1659,9 +1660,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1735,9 +1737,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1773,7 +1776,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -3128,7 +3131,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -3186,6 +3189,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -3297,7 +3305,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
@@ -4700,9 +4708,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -4753,7 +4762,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4823,7 +4832,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4879,7 +4888,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -4936,7 +4945,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -5406,9 +5415,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -5450,7 +5459,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -5481,7 +5490,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -5689,10 +5698,12 @@ else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
   (eval echo "\"\$as_me:$LINENO: $ac_compile\"" >&5)
-  (eval "$ac_compile" 2>conftest.err)
+  (eval "($ac_compile | sed -e 's/\r//g')" 2>conftest.err)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: output\"" >&5)
   cat conftest.out >&5
@@ -6110,7 +6121,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -6172,7 +6183,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|_pic\.a)$'
@@ -6190,7 +6201,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
@@ -6691,7 +6702,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[ABCDGIRSTW]' ;;
 esac
@@ -6699,11 +6710,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -6737,7 +6748,7 @@ for ac_symprfx in "" "_"; do
 "     s[1]~prfx {split(s[1],t,\"@\"); print t[1], substr(t[1],length(prfx))}"\
 "     ' prfx=^$ac_symprfx"
   else
-    lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
+    lt_cv_sys_global_symbol_pipe="sed -n -e 's/\r//g' -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
   fi
 
   # Check to see that the pipe works correctly.
@@ -6758,14 +6769,14 @@ int main(){nm_test_var='a';nm_test_func();return(0);}
 _LT_EOF
 
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist\""; } >&5
-  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) 2>&5
+    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist\""; } >&5
+  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s "$nlist"; then
@@ -6786,7 +6797,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist"  | sed -e '"'"'s/\r//g'"'"'| $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -6799,7 +6810,7 @@ lt__PROGRAM__LTX_preloaded_symbols[] =
 {
   { "@PROGRAM@", (void *) 0 },
 _LT_EOF
-	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | $GREP -v main >> conftest.$ac_ext
+	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | sed -e 's/\r//g' | $GREP -v main >> conftest.$ac_ext
 	  cat <<\_LT_EOF >> conftest.$ac_ext
   {0, (void *) 0}
 };
@@ -6822,7 +6833,7 @@ _LT_EOF
 	  LIBS="conftstm.$ac_objext"
 	  CFLAGS="$CFLAGS$lt_prog_compiler_no_builtin_flag"
 	  if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext}; then
@@ -6902,7 +6913,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6921,7 +6932,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo '#line '$LINENO' "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6959,7 +6970,7 @@ s390*-*linux*|s390*-*tpf*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7071,7 +7082,7 @@ sparc*-*solaris*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7604,6 +7615,7 @@ else
 	if test -f libconftest.dylib && test ! -s conftest.err && test $_lt_result = 0; then
 	  lt_cv_apple_cc_single_mod=yes
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err >&5
 	fi
 	rm -rf libconftest.dylib*
@@ -7666,6 +7678,7 @@ _LT_EOF
       if test -f conftest && test ! -s conftest.err && test $_lt_result = 0 && $GREP forced_load conftest 2>&1 >/dev/null; then
 	lt_cv_ld_force_load=yes
       else
+        dos2unix -q conftest.err
 	cat conftest.err >&5
       fi
         rm -f conftest.err libconftest.a conftest conftest.c
@@ -7881,7 +7894,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -7898,7 +7911,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -8422,13 +8435,15 @@ compiler_DEFAULT=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -8468,14 +8483,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -8690,7 +8707,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic='-KPIC'
@@ -8821,14 +8838,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works=yes
@@ -8870,10 +8889,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -8926,8 +8946,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8935,6 +8956,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8981,8 +9003,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8990,6 +9013,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -9050,7 +9074,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object=no
   enable_shared_with_static_runtimes=no
   export_dynamic_flag_spec=
-  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic=no
   hardcode_direct=no
   hardcode_direct_absolute=no
@@ -9113,7 +9137,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -9139,13 +9163,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -9189,7 +9213,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -9207,9 +9231,9 @@ _LT_EOF
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -9252,7 +9276,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -9283,7 +9307,7 @@ _LT_EOF
 	  compiler_needs_object=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object=yes
@@ -9321,7 +9345,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -9331,7 +9355,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
 
@@ -9343,7 +9367,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9352,7 +9376,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
@@ -9371,7 +9395,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
 	    archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -9390,7 +9414,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9434,10 +9458,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -9784,10 +9808,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS -b"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -9868,7 +9893,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -9894,7 +9919,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct=yes
 	hardcode_shlibpath_var=no
 	hardcode_direct_absolute=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
@@ -9963,7 +9988,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -10156,10 +10181,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -10185,6 +10211,7 @@ else
 	  fi
 	  allow_undefined_flag=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -10367,7 +10394,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([A-Za-z]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -10471,7 +10498,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -10844,7 +10871,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -10889,7 +10916,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -11535,7 +11562,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -11641,7 +11668,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
diff --git a/gcc/newlib/libc/machine/cr16/configure b/gcc/newlib/libc/machine/cr16/configure
index cc0372576c..6289480add 100644
--- a/gcc/newlib/libc/machine/cr16/configure
+++ b/gcc/newlib/libc/machine/cr16/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/cris/configure b/gcc/newlib/libc/machine/cris/configure
index 9370f6e25f..2426bddf7b 100755
--- a/gcc/newlib/libc/machine/cris/configure
+++ b/gcc/newlib/libc/machine/cris/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/crx/configure b/gcc/newlib/libc/machine/crx/configure
index cc0372576c..6289480add 100755
--- a/gcc/newlib/libc/machine/crx/configure
+++ b/gcc/newlib/libc/machine/crx/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/csky/configure b/gcc/newlib/libc/machine/csky/configure
index 17572f3f07..b4becc5cb3 100755
--- a/gcc/newlib/libc/machine/csky/configure
+++ b/gcc/newlib/libc/machine/csky/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/d10v/configure b/gcc/newlib/libc/machine/d10v/configure
index 17572f3f07..b4becc5cb3 100755
--- a/gcc/newlib/libc/machine/d10v/configure
+++ b/gcc/newlib/libc/machine/d10v/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/d30v/configure b/gcc/newlib/libc/machine/d30v/configure
index 17572f3f07..b4becc5cb3 100755
--- a/gcc/newlib/libc/machine/d30v/configure
+++ b/gcc/newlib/libc/machine/d30v/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/epiphany/configure b/gcc/newlib/libc/machine/epiphany/configure
index cc0372576c..6289480add 100755
--- a/gcc/newlib/libc/machine/epiphany/configure
+++ b/gcc/newlib/libc/machine/epiphany/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/fr30/configure b/gcc/newlib/libc/machine/fr30/configure
index cc0372576c..6289480add 100755
--- a/gcc/newlib/libc/machine/fr30/configure
+++ b/gcc/newlib/libc/machine/fr30/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/frv/configure b/gcc/newlib/libc/machine/frv/configure
index cc0372576c..6289480add 100755
--- a/gcc/newlib/libc/machine/frv/configure
+++ b/gcc/newlib/libc/machine/frv/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/ft32/configure b/gcc/newlib/libc/machine/ft32/configure
index cc0372576c..6289480add 100755
--- a/gcc/newlib/libc/machine/ft32/configure
+++ b/gcc/newlib/libc/machine/ft32/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/h8300/configure b/gcc/newlib/libc/machine/h8300/configure
index 76af7fbfc1..57af62086c 100755
--- a/gcc/newlib/libc/machine/h8300/configure
+++ b/gcc/newlib/libc/machine/h8300/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/h8500/configure b/gcc/newlib/libc/machine/h8500/configure
index 74e8135e20..8c88e8725e 100755
--- a/gcc/newlib/libc/machine/h8500/configure
+++ b/gcc/newlib/libc/machine/h8500/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/hppa/configure b/gcc/newlib/libc/machine/hppa/configure
index fc94e9504c..1febebd5e5 100755
--- a/gcc/newlib/libc/machine/hppa/configure
+++ b/gcc/newlib/libc/machine/hppa/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/i386/configure b/gcc/newlib/libc/machine/i386/configure
index c57e4483ce..c30c3fe442 100755
--- a/gcc/newlib/libc/machine/i386/configure
+++ b/gcc/newlib/libc/machine/i386/configure
@@ -1561,9 +1561,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1599,9 +1600,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1675,9 +1677,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1713,7 +1716,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -3068,7 +3071,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -3126,6 +3129,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -3237,7 +3245,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
@@ -4640,9 +4648,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -4693,7 +4702,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4763,7 +4772,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4819,7 +4828,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -4876,7 +4885,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -5346,9 +5355,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -5390,7 +5399,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -5421,7 +5430,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -5629,10 +5638,12 @@ else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
   (eval echo "\"\$as_me:$LINENO: $ac_compile\"" >&5)
-  (eval "$ac_compile" 2>conftest.err)
+  (eval "($ac_compile | sed -e 's/\r//g')" 2>conftest.err)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: output\"" >&5)
   cat conftest.out >&5
@@ -6050,7 +6061,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -6112,7 +6123,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|_pic\.a)$'
@@ -6130,7 +6141,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
@@ -6631,7 +6642,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[ABCDGIRSTW]' ;;
 esac
@@ -6639,11 +6650,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -6677,7 +6688,7 @@ for ac_symprfx in "" "_"; do
 "     s[1]~prfx {split(s[1],t,\"@\"); print t[1], substr(t[1],length(prfx))}"\
 "     ' prfx=^$ac_symprfx"
   else
-    lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
+    lt_cv_sys_global_symbol_pipe="sed -n -e 's/\r//g' -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
   fi
 
   # Check to see that the pipe works correctly.
@@ -6698,14 +6709,14 @@ int main(){nm_test_var='a';nm_test_func();return(0);}
 _LT_EOF
 
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist\""; } >&5
-  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) 2>&5
+    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist\""; } >&5
+  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s "$nlist"; then
@@ -6726,7 +6737,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | sed -e '"'"'s/\r//g'"'"' | $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -6739,7 +6750,7 @@ lt__PROGRAM__LTX_preloaded_symbols[] =
 {
   { "@PROGRAM@", (void *) 0 },
 _LT_EOF
-	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | $GREP -v main >> conftest.$ac_ext
+	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | sed -e 's/\r//g' | $GREP -v main >> conftest.$ac_ext
 	  cat <<\_LT_EOF >> conftest.$ac_ext
   {0, (void *) 0}
 };
@@ -6762,7 +6773,7 @@ _LT_EOF
 	  LIBS="conftstm.$ac_objext"
 	  CFLAGS="$CFLAGS$lt_prog_compiler_no_builtin_flag"
 	  if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext}; then
@@ -6842,7 +6853,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6861,7 +6872,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo '#line '$LINENO' "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6899,7 +6910,7 @@ s390*-*linux*|s390*-*tpf*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7011,7 +7022,7 @@ sparc*-*solaris*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7544,6 +7555,7 @@ else
 	if test -f libconftest.dylib && test ! -s conftest.err && test $_lt_result = 0; then
 	  lt_cv_apple_cc_single_mod=yes
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err >&5
 	fi
 	rm -rf libconftest.dylib*
@@ -7606,6 +7618,7 @@ _LT_EOF
       if test -f conftest && test ! -s conftest.err && test $_lt_result = 0 && $GREP forced_load conftest 2>&1 >/dev/null; then
 	lt_cv_ld_force_load=yes
       else
+        dos2unix -q conftest.err
 	cat conftest.err >&5
       fi
         rm -f conftest.err libconftest.a conftest conftest.c
@@ -7821,7 +7834,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -7838,7 +7851,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -8362,13 +8375,15 @@ compiler_DEFAULT=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -8408,14 +8423,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -8630,7 +8647,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic='-KPIC'
@@ -8761,14 +8778,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works=yes
@@ -8810,10 +8829,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -8866,8 +8886,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8875,6 +8896,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8921,8 +8943,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8930,6 +8953,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8990,7 +9014,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object=no
   enable_shared_with_static_runtimes=no
   export_dynamic_flag_spec=
-  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic=no
   hardcode_direct=no
   hardcode_direct_absolute=no
@@ -9053,7 +9077,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -9079,13 +9103,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -9129,7 +9153,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -9147,9 +9171,9 @@ _LT_EOF
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -9192,7 +9216,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -9223,7 +9247,7 @@ _LT_EOF
 	  compiler_needs_object=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object=yes
@@ -9261,7 +9285,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -9271,7 +9295,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
 
@@ -9283,7 +9307,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9292,7 +9316,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
@@ -9311,7 +9335,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
 	    archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -9330,7 +9354,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9374,10 +9398,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -9724,10 +9748,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS -b"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -9808,7 +9833,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -9834,7 +9859,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct=yes
 	hardcode_shlibpath_var=no
 	hardcode_direct_absolute=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
@@ -9903,7 +9928,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -10096,10 +10121,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -10125,6 +10151,7 @@ else
 	  fi
 	  allow_undefined_flag=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -10307,7 +10334,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([A-Za-z]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -10411,7 +10438,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -10784,7 +10811,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -10829,7 +10856,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -11475,7 +11502,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -11581,7 +11608,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
diff --git a/gcc/newlib/libc/machine/i960/configure b/gcc/newlib/libc/machine/i960/configure
index 3692142c9e..2b03289480 100755
--- a/gcc/newlib/libc/machine/i960/configure
+++ b/gcc/newlib/libc/machine/i960/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/iq2000/configure b/gcc/newlib/libc/machine/iq2000/configure
index cc0372576c..6289480add 100755
--- a/gcc/newlib/libc/machine/iq2000/configure
+++ b/gcc/newlib/libc/machine/iq2000/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/lm32/configure b/gcc/newlib/libc/machine/lm32/configure
index 17572f3f07..b4becc5cb3 100755
--- a/gcc/newlib/libc/machine/lm32/configure
+++ b/gcc/newlib/libc/machine/lm32/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/m32c/configure b/gcc/newlib/libc/machine/m32c/configure
index 17572f3f07..b4becc5cb3 100755
--- a/gcc/newlib/libc/machine/m32c/configure
+++ b/gcc/newlib/libc/machine/m32c/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/m32r/configure b/gcc/newlib/libc/machine/m32r/configure
index 17572f3f07..b4becc5cb3 100755
--- a/gcc/newlib/libc/machine/m32r/configure
+++ b/gcc/newlib/libc/machine/m32r/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/m68hc11/configure b/gcc/newlib/libc/machine/m68hc11/configure
index 17572f3f07..b4becc5cb3 100755
--- a/gcc/newlib/libc/machine/m68hc11/configure
+++ b/gcc/newlib/libc/machine/m68hc11/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/m68k/configure b/gcc/newlib/libc/machine/m68k/configure
index 17572f3f07..b4becc5cb3 100755
--- a/gcc/newlib/libc/machine/m68k/configure
+++ b/gcc/newlib/libc/machine/m68k/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/m88k/configure b/gcc/newlib/libc/machine/m88k/configure
index 17572f3f07..b4becc5cb3 100755
--- a/gcc/newlib/libc/machine/m88k/configure
+++ b/gcc/newlib/libc/machine/m88k/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/mep/configure b/gcc/newlib/libc/machine/mep/configure
index cc0372576c..6289480add 100755
--- a/gcc/newlib/libc/machine/mep/configure
+++ b/gcc/newlib/libc/machine/mep/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/microblaze/configure b/gcc/newlib/libc/machine/microblaze/configure
index aa784fd7b5..852779b481 100644
--- a/gcc/newlib/libc/machine/microblaze/configure
+++ b/gcc/newlib/libc/machine/microblaze/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/mips/configure b/gcc/newlib/libc/machine/mips/configure
index 17572f3f07..b4becc5cb3 100755
--- a/gcc/newlib/libc/machine/mips/configure
+++ b/gcc/newlib/libc/machine/mips/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/mn10200/configure b/gcc/newlib/libc/machine/mn10200/configure
index 17572f3f07..b4becc5cb3 100755
--- a/gcc/newlib/libc/machine/mn10200/configure
+++ b/gcc/newlib/libc/machine/mn10200/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/mn10300/configure b/gcc/newlib/libc/machine/mn10300/configure
index fc94e9504c..1febebd5e5 100755
--- a/gcc/newlib/libc/machine/mn10300/configure
+++ b/gcc/newlib/libc/machine/mn10300/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/moxie/configure b/gcc/newlib/libc/machine/moxie/configure
index cc0372576c..6289480add 100644
--- a/gcc/newlib/libc/machine/moxie/configure
+++ b/gcc/newlib/libc/machine/moxie/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/msp430/configure b/gcc/newlib/libc/machine/msp430/configure
index a95de58b36..849b4ad990 100755
--- a/gcc/newlib/libc/machine/msp430/configure
+++ b/gcc/newlib/libc/machine/msp430/configure
@@ -1460,9 +1460,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2764,7 +2765,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2822,6 +2823,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2933,7 +2939,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/mt/configure b/gcc/newlib/libc/machine/mt/configure
index cc0372576c..6289480add 100755
--- a/gcc/newlib/libc/machine/mt/configure
+++ b/gcc/newlib/libc/machine/mt/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/nds32/configure b/gcc/newlib/libc/machine/nds32/configure
index a48c1a39aa..17d1973be5 100755
--- a/gcc/newlib/libc/machine/nds32/configure
+++ b/gcc/newlib/libc/machine/nds32/configure
@@ -1477,9 +1477,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2761,7 +2762,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2819,6 +2820,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2930,7 +2936,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
@@ -3854,9 +3860,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -3885,7 +3892,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -3930,7 +3937,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4000,7 +4007,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4056,7 +4063,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -4110,7 +4117,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -4166,7 +4173,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
diff --git a/gcc/newlib/libc/machine/necv70/configure b/gcc/newlib/libc/machine/necv70/configure
index 3353c96b21..83d32cd101 100755
--- a/gcc/newlib/libc/machine/necv70/configure
+++ b/gcc/newlib/libc/machine/necv70/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/nios2/configure b/gcc/newlib/libc/machine/nios2/configure
index c3ccc84b30..78783be405 100755
--- a/gcc/newlib/libc/machine/nios2/configure
+++ b/gcc/newlib/libc/machine/nios2/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/nvptx/configure b/gcc/newlib/libc/machine/nvptx/configure
index cc0372576c..6289480add 100644
--- a/gcc/newlib/libc/machine/nvptx/configure
+++ b/gcc/newlib/libc/machine/nvptx/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/or1k/configure b/gcc/newlib/libc/machine/or1k/configure
index cc0372576c..6289480add 100755
--- a/gcc/newlib/libc/machine/or1k/configure
+++ b/gcc/newlib/libc/machine/or1k/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/powerpc/configure b/gcc/newlib/libc/machine/powerpc/configure
index 475e41b4cd..d4b87626e8 100755
--- a/gcc/newlib/libc/machine/powerpc/configure
+++ b/gcc/newlib/libc/machine/powerpc/configure
@@ -1457,9 +1457,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2741,7 +2742,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2799,6 +2800,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2910,7 +2916,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/pru/configure b/gcc/newlib/libc/machine/pru/configure
index c3ccc84b30..78783be405 100755
--- a/gcc/newlib/libc/machine/pru/configure
+++ b/gcc/newlib/libc/machine/pru/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/riscv/configure b/gcc/newlib/libc/machine/riscv/configure
index 9556f3df0c..63c873e88d 100755
--- a/gcc/newlib/libc/machine/riscv/configure
+++ b/gcc/newlib/libc/machine/riscv/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/rl78/configure b/gcc/newlib/libc/machine/rl78/configure
index 17572f3f07..b4becc5cb3 100755
--- a/gcc/newlib/libc/machine/rl78/configure
+++ b/gcc/newlib/libc/machine/rl78/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/rx/configure b/gcc/newlib/libc/machine/rx/configure
index cc0372576c..6289480add 100755
--- a/gcc/newlib/libc/machine/rx/configure
+++ b/gcc/newlib/libc/machine/rx/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/sh/configure b/gcc/newlib/libc/machine/sh/configure
index 5212901758..cc71df828f 100755
--- a/gcc/newlib/libc/machine/sh/configure
+++ b/gcc/newlib/libc/machine/sh/configure
@@ -1483,9 +1483,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1520,9 +1521,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2806,7 +2808,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2864,6 +2866,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2975,7 +2982,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
@@ -3898,9 +3905,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -3929,7 +3937,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -3974,7 +3982,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4044,7 +4052,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4100,7 +4108,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -4154,7 +4162,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -4210,7 +4218,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4725,7 +4733,7 @@ cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 #endif
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "sh5" >/dev/null 2>&1; then :
   have_sh64=yes
 else
diff --git a/gcc/newlib/libc/machine/sparc/configure b/gcc/newlib/libc/machine/sparc/configure
index 06955ef82d..19de634f34 100755
--- a/gcc/newlib/libc/machine/sparc/configure
+++ b/gcc/newlib/libc/machine/sparc/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/spu/configure b/gcc/newlib/libc/machine/spu/configure
index 64899be783..54d870ec87 100644
--- a/gcc/newlib/libc/machine/spu/configure
+++ b/gcc/newlib/libc/machine/spu/configure
@@ -1458,9 +1458,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2742,7 +2743,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2800,6 +2801,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2911,7 +2917,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
@@ -3528,7 +3534,7 @@ cat > conftest.c <<EOF
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/spu/configure.ac b/gcc/newlib/libc/machine/spu/configure.ac
index a287ff59b1..3c7b39e862 100644
--- a/gcc/newlib/libc/machine/spu/configure.ac
+++ b/gcc/newlib/libc/machine/spu/configure.ac
@@ -18,7 +18,7 @@ cat > conftest.c <<EOF
   yes;
 #endif
 EOF
-if AC_TRY_COMMAND(${CC-cc} -E conftest.c) | egrep yes >/dev/null 2>&1; then
+if AC_TRY_COMMAND(${CC-cc} -E conftest.c) | sed -e 's/\r//g' | egrep yes >/dev/null 2>&1; then
   spu_compiler_has_ea=yes
 else
   spu_compiler_has_ea=no
diff --git a/gcc/newlib/libc/machine/tic4x/configure b/gcc/newlib/libc/machine/tic4x/configure
index 17572f3f07..b4becc5cb3 100755
--- a/gcc/newlib/libc/machine/tic4x/configure
+++ b/gcc/newlib/libc/machine/tic4x/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/tic6x/configure b/gcc/newlib/libc/machine/tic6x/configure
index 17572f3f07..b4becc5cb3 100755
--- a/gcc/newlib/libc/machine/tic6x/configure
+++ b/gcc/newlib/libc/machine/tic6x/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/tic80/configure b/gcc/newlib/libc/machine/tic80/configure
index 17572f3f07..b4becc5cb3 100755
--- a/gcc/newlib/libc/machine/tic80/configure
+++ b/gcc/newlib/libc/machine/tic80/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/v850/configure b/gcc/newlib/libc/machine/v850/configure
index 17572f3f07..b4becc5cb3 100755
--- a/gcc/newlib/libc/machine/v850/configure
+++ b/gcc/newlib/libc/machine/v850/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/visium/configure b/gcc/newlib/libc/machine/visium/configure
index cc0372576c..6289480add 100755
--- a/gcc/newlib/libc/machine/visium/configure
+++ b/gcc/newlib/libc/machine/visium/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/w65/configure b/gcc/newlib/libc/machine/w65/configure
index 74e8135e20..8c88e8725e 100755
--- a/gcc/newlib/libc/machine/w65/configure
+++ b/gcc/newlib/libc/machine/w65/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/x86_64/configure b/gcc/newlib/libc/machine/x86_64/configure
index cc0372576c..6289480add 100755
--- a/gcc/newlib/libc/machine/x86_64/configure
+++ b/gcc/newlib/libc/machine/x86_64/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/xc16x/configure b/gcc/newlib/libc/machine/xc16x/configure
index 17572f3f07..b4becc5cb3 100644
--- a/gcc/newlib/libc/machine/xc16x/configure
+++ b/gcc/newlib/libc/machine/xc16x/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/xscale/configure b/gcc/newlib/libc/machine/xscale/configure
index cc0372576c..6289480add 100755
--- a/gcc/newlib/libc/machine/xscale/configure
+++ b/gcc/newlib/libc/machine/xscale/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/xstormy16/configure b/gcc/newlib/libc/machine/xstormy16/configure
index 17572f3f07..b4becc5cb3 100755
--- a/gcc/newlib/libc/machine/xstormy16/configure
+++ b/gcc/newlib/libc/machine/xstormy16/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/machine/z8k/configure b/gcc/newlib/libc/machine/z8k/configure
index b95670a51d..0e9241f514 100755
--- a/gcc/newlib/libc/machine/z8k/configure
+++ b/gcc/newlib/libc/machine/z8k/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/sys/a29khif/configure b/gcc/newlib/libc/sys/a29khif/configure
index e9e59335c4..c7b05852e4 100755
--- a/gcc/newlib/libc/sys/a29khif/configure
+++ b/gcc/newlib/libc/sys/a29khif/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/sys/amdgcn/configure b/gcc/newlib/libc/sys/amdgcn/configure
index e621e8c5a5..1d23476adf 100755
--- a/gcc/newlib/libc/sys/amdgcn/configure
+++ b/gcc/newlib/libc/sys/amdgcn/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/sys/arm/configure b/gcc/newlib/libc/sys/arm/configure
index 3ff59ed32a..3ddaae0c88 100755
--- a/gcc/newlib/libc/sys/arm/configure
+++ b/gcc/newlib/libc/sys/arm/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/sys/configure b/gcc/newlib/libc/sys/configure
index bd4ff5297f..5b6fe224df 100755
--- a/gcc/newlib/libc/sys/configure
+++ b/gcc/newlib/libc/sys/configure
@@ -1591,9 +1591,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1629,9 +1630,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1705,9 +1707,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1743,7 +1746,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -3098,7 +3101,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -3156,6 +3159,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -3267,7 +3275,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
@@ -4670,9 +4678,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -4723,7 +4732,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4793,7 +4802,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4849,7 +4858,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -4906,7 +4915,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -5376,9 +5385,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -5420,7 +5429,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -5451,7 +5460,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -5659,10 +5668,12 @@ else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
   (eval echo "\"\$as_me:$LINENO: $ac_compile\"" >&5)
-  (eval "$ac_compile" 2>conftest.err)
+  (eval "($ac_compile | sed -e 's/\r//g')" 2>conftest.err)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: output\"" >&5)
   cat conftest.out >&5
@@ -6080,7 +6091,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -6142,7 +6153,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|_pic\.a)$'
@@ -6160,7 +6171,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
@@ -6661,7 +6672,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[ABCDGIRSTW]' ;;
 esac
@@ -6669,11 +6680,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -6707,7 +6718,7 @@ for ac_symprfx in "" "_"; do
 "     s[1]~prfx {split(s[1],t,\"@\"); print t[1], substr(t[1],length(prfx))}"\
 "     ' prfx=^$ac_symprfx"
   else
-    lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
+    lt_cv_sys_global_symbol_pipe="sed -n -e 's/\r//g' -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
   fi
 
   # Check to see that the pipe works correctly.
@@ -6728,14 +6739,14 @@ int main(){nm_test_var='a';nm_test_func();return(0);}
 _LT_EOF
 
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist\""; } >&5
-  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) 2>&5
+    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist\""; } >&5
+  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s "$nlist"; then
@@ -6756,7 +6767,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | sed -e '"'"'s/\r//g'"'"' | $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -6769,7 +6780,7 @@ lt__PROGRAM__LTX_preloaded_symbols[] =
 {
   { "@PROGRAM@", (void *) 0 },
 _LT_EOF
-	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | $GREP -v main >> conftest.$ac_ext
+	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | sed -e 's/\r//g' | $GREP -v main >> conftest.$ac_ext
 	  cat <<\_LT_EOF >> conftest.$ac_ext
   {0, (void *) 0}
 };
@@ -6792,7 +6803,7 @@ _LT_EOF
 	  LIBS="conftstm.$ac_objext"
 	  CFLAGS="$CFLAGS$lt_prog_compiler_no_builtin_flag"
 	  if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext}; then
@@ -6872,7 +6883,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6891,7 +6902,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo '#line '$LINENO' "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6929,7 +6940,7 @@ s390*-*linux*|s390*-*tpf*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7041,7 +7052,7 @@ sparc*-*solaris*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7574,6 +7585,7 @@ else
 	if test -f libconftest.dylib && test ! -s conftest.err && test $_lt_result = 0; then
 	  lt_cv_apple_cc_single_mod=yes
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err >&5
 	fi
 	rm -rf libconftest.dylib*
@@ -7636,6 +7648,7 @@ _LT_EOF
       if test -f conftest && test ! -s conftest.err && test $_lt_result = 0 && $GREP forced_load conftest 2>&1 >/dev/null; then
 	lt_cv_ld_force_load=yes
       else
+        dos2unix -q conftest.err
 	cat conftest.err >&5
       fi
         rm -f conftest.err libconftest.a conftest conftest.c
@@ -7851,7 +7864,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -7868,7 +7881,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -8392,13 +8405,15 @@ compiler_DEFAULT=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -8438,14 +8453,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -8660,7 +8677,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic='-KPIC'
@@ -8791,14 +8808,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works=yes
@@ -8840,10 +8859,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -8896,8 +8916,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8905,6 +8926,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8951,8 +8973,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8960,6 +8983,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -9020,7 +9044,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object=no
   enable_shared_with_static_runtimes=no
   export_dynamic_flag_spec=
-  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic=no
   hardcode_direct=no
   hardcode_direct_absolute=no
@@ -9083,7 +9107,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -9109,13 +9133,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -9159,7 +9183,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -9177,9 +9201,9 @@ _LT_EOF
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -9222,7 +9246,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -9253,7 +9277,7 @@ _LT_EOF
 	  compiler_needs_object=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object=yes
@@ -9291,7 +9315,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -9301,7 +9325,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
 
@@ -9313,7 +9337,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9322,7 +9346,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
@@ -9341,7 +9365,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
 	    archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -9360,7 +9384,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9404,10 +9428,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -9754,10 +9778,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS -b"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -9838,7 +9863,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -9864,7 +9889,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct=yes
 	hardcode_shlibpath_var=no
 	hardcode_direct_absolute=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
@@ -9933,7 +9958,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -10126,10 +10151,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -10155,6 +10181,7 @@ else
 	  fi
 	  allow_undefined_flag=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -10337,7 +10364,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([A-Za-z]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -10441,7 +10468,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -10814,7 +10841,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -10859,7 +10886,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -11505,7 +11532,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -11611,7 +11638,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
diff --git a/gcc/newlib/libc/sys/d10v/configure b/gcc/newlib/libc/sys/d10v/configure
index fb72e6c2b1..2cd69e7bba 100755
--- a/gcc/newlib/libc/sys/d10v/configure
+++ b/gcc/newlib/libc/sys/d10v/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/sys/decstation/configure b/gcc/newlib/libc/sys/decstation/configure
index 5fae260bc7..d72d0ff91f 100755
--- a/gcc/newlib/libc/sys/decstation/configure
+++ b/gcc/newlib/libc/sys/decstation/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/sys/epiphany/configure b/gcc/newlib/libc/sys/epiphany/configure
index aff22b4f4e..91c2df9620 100755
--- a/gcc/newlib/libc/sys/epiphany/configure
+++ b/gcc/newlib/libc/sys/epiphany/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/sys/h8300hms/configure b/gcc/newlib/libc/sys/h8300hms/configure
index 4d9ede17e8..a390a90de9 100755
--- a/gcc/newlib/libc/sys/h8300hms/configure
+++ b/gcc/newlib/libc/sys/h8300hms/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/sys/h8500hms/configure b/gcc/newlib/libc/sys/h8500hms/configure
index e89906ffc2..a6b3096256 100755
--- a/gcc/newlib/libc/sys/h8500hms/configure
+++ b/gcc/newlib/libc/sys/h8500hms/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/sys/linux/configure b/gcc/newlib/libc/sys/linux/configure
index 7f2a310b62..0311e73d4e 100755
--- a/gcc/newlib/libc/sys/linux/configure
+++ b/gcc/newlib/libc/sys/linux/configure
@@ -1565,9 +1565,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1603,9 +1604,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1679,9 +1681,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1717,7 +1720,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -3072,7 +3075,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -3130,6 +3133,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -3241,7 +3249,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
@@ -4686,9 +4694,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -4739,7 +4748,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4809,7 +4818,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4865,7 +4874,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -4922,7 +4931,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -5392,9 +5401,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -5436,7 +5445,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -5467,7 +5476,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -5675,10 +5684,12 @@ else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
   (eval echo "\"\$as_me:$LINENO: $ac_compile\"" >&5)
-  (eval "$ac_compile" 2>conftest.err)
+  (eval "($ac_compile | sed -e 's/\r//g')" 2>conftest.err)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: output\"" >&5)
   cat conftest.out >&5
@@ -6096,7 +6107,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -6158,7 +6169,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|_pic\.a)$'
@@ -6176,7 +6187,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
@@ -6677,7 +6688,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[ABCDGIRSTW]' ;;
 esac
@@ -6685,11 +6696,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -6723,7 +6734,7 @@ for ac_symprfx in "" "_"; do
 "     s[1]~prfx {split(s[1],t,\"@\"); print t[1], substr(t[1],length(prfx))}"\
 "     ' prfx=^$ac_symprfx"
   else
-    lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
+    lt_cv_sys_global_symbol_pipe="sed -n -e 's/\r//g' -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
   fi
 
   # Check to see that the pipe works correctly.
@@ -6744,14 +6755,14 @@ int main(){nm_test_var='a';nm_test_func();return(0);}
 _LT_EOF
 
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist\""; } >&5
-  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) 2>&5
+    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist\""; } >&5
+  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s "$nlist"; then
@@ -6772,7 +6783,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | sed -e '"'"'s/\r//g'"'"' | $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -6785,7 +6796,7 @@ lt__PROGRAM__LTX_preloaded_symbols[] =
 {
   { "@PROGRAM@", (void *) 0 },
 _LT_EOF
-	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | $GREP -v main >> conftest.$ac_ext
+	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | sed -e 's/\r//g' | $GREP -v main >> conftest.$ac_ext
 	  cat <<\_LT_EOF >> conftest.$ac_ext
   {0, (void *) 0}
 };
@@ -6808,7 +6819,7 @@ _LT_EOF
 	  LIBS="conftstm.$ac_objext"
 	  CFLAGS="$CFLAGS$lt_prog_compiler_no_builtin_flag"
 	  if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext}; then
@@ -6888,7 +6899,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6907,7 +6918,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo '#line '$LINENO' "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6945,7 +6956,7 @@ s390*-*linux*|s390*-*tpf*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7057,7 +7068,7 @@ sparc*-*solaris*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7590,6 +7601,7 @@ else
 	if test -f libconftest.dylib && test ! -s conftest.err && test $_lt_result = 0; then
 	  lt_cv_apple_cc_single_mod=yes
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err >&5
 	fi
 	rm -rf libconftest.dylib*
@@ -7652,6 +7664,7 @@ _LT_EOF
       if test -f conftest && test ! -s conftest.err && test $_lt_result = 0 && $GREP forced_load conftest 2>&1 >/dev/null; then
 	lt_cv_ld_force_load=yes
       else
+        dos2unix -q conftest.err
 	cat conftest.err >&5
       fi
         rm -f conftest.err libconftest.a conftest conftest.c
@@ -7867,7 +7880,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -7884,7 +7897,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -8408,13 +8421,15 @@ compiler_DEFAULT=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -8454,14 +8469,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -8676,7 +8693,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic='-KPIC'
@@ -8807,14 +8824,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works=yes
@@ -8856,10 +8875,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -8912,8 +8932,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8921,6 +8942,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8967,8 +8989,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8976,6 +8999,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -9036,7 +9060,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object=no
   enable_shared_with_static_runtimes=no
   export_dynamic_flag_spec=
-  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic=no
   hardcode_direct=no
   hardcode_direct_absolute=no
@@ -9099,7 +9123,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -9125,13 +9149,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -9175,7 +9199,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -9193,9 +9217,9 @@ _LT_EOF
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -9238,7 +9262,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -9269,7 +9293,7 @@ _LT_EOF
 	  compiler_needs_object=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object=yes
@@ -9307,7 +9331,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -9317,7 +9341,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
 
@@ -9329,7 +9353,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9338,7 +9362,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
@@ -9357,7 +9381,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
 	    archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -9376,7 +9400,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9420,10 +9444,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -9770,10 +9794,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS -b"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -9854,7 +9879,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -9880,7 +9905,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct=yes
 	hardcode_shlibpath_var=no
 	hardcode_direct_absolute=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
@@ -9949,7 +9974,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -10142,10 +10167,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -10171,6 +10197,7 @@ else
 	  fi
 	  allow_undefined_flag=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -10353,7 +10380,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([A-Za-z]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -10457,7 +10484,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -10830,7 +10857,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -10875,7 +10902,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -11521,7 +11548,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -11627,7 +11654,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
diff --git a/gcc/newlib/libc/sys/linux/linuxthreads/configure b/gcc/newlib/libc/sys/linux/linuxthreads/configure
index 8df4f20cb4..eccfd232fc 100755
--- a/gcc/newlib/libc/sys/linux/linuxthreads/configure
+++ b/gcc/newlib/libc/sys/linux/linuxthreads/configure
@@ -1563,9 +1563,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1601,9 +1602,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1677,9 +1679,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1715,7 +1718,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -3070,7 +3073,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -3128,6 +3131,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -3239,7 +3247,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
@@ -4684,9 +4692,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -4737,7 +4746,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4807,7 +4816,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4863,7 +4872,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -4920,7 +4929,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -5390,9 +5399,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -5434,7 +5443,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -5465,7 +5474,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -5673,10 +5682,12 @@ else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
   (eval echo "\"\$as_me:$LINENO: $ac_compile\"" >&5)
-  (eval "$ac_compile" 2>conftest.err)
+  (eval "($ac_compile | sed -e 's/\r//g')" 2>conftest.err)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: output\"" >&5)
   cat conftest.out >&5
@@ -6094,7 +6105,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -6156,7 +6167,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|_pic\.a)$'
@@ -6174,7 +6185,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
@@ -6675,7 +6686,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[ABCDGIRSTW]' ;;
 esac
@@ -6683,11 +6694,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -6721,7 +6732,7 @@ for ac_symprfx in "" "_"; do
 "     s[1]~prfx {split(s[1],t,\"@\"); print t[1], substr(t[1],length(prfx))}"\
 "     ' prfx=^$ac_symprfx"
   else
-    lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
+    lt_cv_sys_global_symbol_pipe="sed -n -e 's/\r//g' -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
   fi
 
   # Check to see that the pipe works correctly.
@@ -6742,14 +6753,14 @@ int main(){nm_test_var='a';nm_test_func();return(0);}
 _LT_EOF
 
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist\""; } >&5
-  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) 2>&5
+    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist\""; } >&5
+  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s "$nlist"; then
@@ -6770,7 +6781,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | sed -e '"'"'s/\r//g'"'"' | $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -6783,7 +6794,7 @@ lt__PROGRAM__LTX_preloaded_symbols[] =
 {
   { "@PROGRAM@", (void *) 0 },
 _LT_EOF
-	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | $GREP -v main >> conftest.$ac_ext
+	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | sed -e 's/\r//g' | $GREP -v main >> conftest.$ac_ext
 	  cat <<\_LT_EOF >> conftest.$ac_ext
   {0, (void *) 0}
 };
@@ -6806,7 +6817,7 @@ _LT_EOF
 	  LIBS="conftstm.$ac_objext"
 	  CFLAGS="$CFLAGS$lt_prog_compiler_no_builtin_flag"
 	  if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext}; then
@@ -6886,7 +6897,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6905,7 +6916,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo '#line '$LINENO' "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6943,7 +6954,7 @@ s390*-*linux*|s390*-*tpf*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7055,7 +7066,7 @@ sparc*-*solaris*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7588,6 +7599,7 @@ else
 	if test -f libconftest.dylib && test ! -s conftest.err && test $_lt_result = 0; then
 	  lt_cv_apple_cc_single_mod=yes
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err >&5
 	fi
 	rm -rf libconftest.dylib*
@@ -7650,6 +7662,7 @@ _LT_EOF
       if test -f conftest && test ! -s conftest.err && test $_lt_result = 0 && $GREP forced_load conftest 2>&1 >/dev/null; then
 	lt_cv_ld_force_load=yes
       else
+        dos2unix -q conftest.err
 	cat conftest.err >&5
       fi
         rm -f conftest.err libconftest.a conftest conftest.c
@@ -7865,7 +7878,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -7882,7 +7895,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -8406,13 +8419,15 @@ compiler_DEFAULT=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -8452,14 +8467,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -8674,7 +8691,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic='-KPIC'
@@ -8805,14 +8822,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works=yes
@@ -8854,10 +8873,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -8910,8 +8930,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8919,6 +8940,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8965,8 +8987,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8974,6 +8997,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -9034,7 +9058,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object=no
   enable_shared_with_static_runtimes=no
   export_dynamic_flag_spec=
-  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic=no
   hardcode_direct=no
   hardcode_direct_absolute=no
@@ -9097,7 +9121,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -9123,13 +9147,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -9173,7 +9197,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -9191,9 +9215,9 @@ _LT_EOF
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -9236,7 +9260,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -9267,7 +9291,7 @@ _LT_EOF
 	  compiler_needs_object=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object=yes
@@ -9305,7 +9329,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -9315,7 +9339,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
 
@@ -9327,7 +9351,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9336,7 +9360,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
@@ -9355,7 +9379,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
 	    archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -9374,7 +9398,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9418,10 +9442,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -9768,10 +9792,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS -b"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -9852,7 +9877,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -9878,7 +9903,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct=yes
 	hardcode_shlibpath_var=no
 	hardcode_direct_absolute=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
@@ -9947,7 +9972,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -10140,10 +10165,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -10169,6 +10195,7 @@ else
 	  fi
 	  allow_undefined_flag=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -10351,7 +10378,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([A-Za-z]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -10455,7 +10482,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -10828,7 +10855,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -10873,7 +10900,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -11519,7 +11546,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -11625,7 +11652,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
diff --git a/gcc/newlib/libc/sys/linux/linuxthreads/machine/configure b/gcc/newlib/libc/sys/linux/linuxthreads/machine/configure
index a08fb85797..052185a520 100755
--- a/gcc/newlib/libc/sys/linux/linuxthreads/machine/configure
+++ b/gcc/newlib/libc/sys/linux/linuxthreads/machine/configure
@@ -1563,9 +1563,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1601,9 +1602,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1677,9 +1679,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1715,7 +1718,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -3070,7 +3073,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -3128,6 +3131,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -3239,7 +3247,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
@@ -4642,9 +4650,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -4695,7 +4704,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4765,7 +4774,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4821,7 +4830,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -4878,7 +4887,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -5348,9 +5357,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -5392,7 +5401,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -5423,7 +5432,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -5631,10 +5640,12 @@ else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
   (eval echo "\"\$as_me:$LINENO: $ac_compile\"" >&5)
-  (eval "$ac_compile" 2>conftest.err)
+  (eval "($ac_compile | sed -e 's/\r//g')" 2>conftest.err)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: output\"" >&5)
   cat conftest.out >&5
@@ -6052,7 +6063,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -6114,7 +6125,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|_pic\.a)$'
@@ -6132,7 +6143,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
@@ -6633,7 +6644,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[ABCDGIRSTW]' ;;
 esac
@@ -6641,11 +6652,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -6679,7 +6690,7 @@ for ac_symprfx in "" "_"; do
 "     s[1]~prfx {split(s[1],t,\"@\"); print t[1], substr(t[1],length(prfx))}"\
 "     ' prfx=^$ac_symprfx"
   else
-    lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
+    lt_cv_sys_global_symbol_pipe="sed -n -e 's/\r//g' -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
   fi
 
   # Check to see that the pipe works correctly.
@@ -6700,14 +6711,14 @@ int main(){nm_test_var='a';nm_test_func();return(0);}
 _LT_EOF
 
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist\""; } >&5
-  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) 2>&5
+    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist\""; } >&5
+  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s "$nlist"; then
@@ -6728,7 +6739,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | sed -e '"'"'s/\r//g'"'"' | $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -6741,7 +6752,7 @@ lt__PROGRAM__LTX_preloaded_symbols[] =
 {
   { "@PROGRAM@", (void *) 0 },
 _LT_EOF
-	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | $GREP -v main >> conftest.$ac_ext
+	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | sed -e 's/\r//g' | $GREP -v main >> conftest.$ac_ext
 	  cat <<\_LT_EOF >> conftest.$ac_ext
   {0, (void *) 0}
 };
@@ -6764,7 +6775,7 @@ _LT_EOF
 	  LIBS="conftstm.$ac_objext"
 	  CFLAGS="$CFLAGS$lt_prog_compiler_no_builtin_flag"
 	  if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext}; then
@@ -6844,7 +6855,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6863,7 +6874,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo '#line '$LINENO' "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6901,7 +6912,7 @@ s390*-*linux*|s390*-*tpf*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7013,7 +7024,7 @@ sparc*-*solaris*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7546,6 +7557,7 @@ else
 	if test -f libconftest.dylib && test ! -s conftest.err && test $_lt_result = 0; then
 	  lt_cv_apple_cc_single_mod=yes
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err >&5
 	fi
 	rm -rf libconftest.dylib*
@@ -7608,6 +7620,7 @@ _LT_EOF
       if test -f conftest && test ! -s conftest.err && test $_lt_result = 0 && $GREP forced_load conftest 2>&1 >/dev/null; then
 	lt_cv_ld_force_load=yes
       else
+        dos2unix -q conftest.err
 	cat conftest.err >&5
       fi
         rm -f conftest.err libconftest.a conftest conftest.c
@@ -7823,7 +7836,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -7840,7 +7853,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -8364,13 +8377,15 @@ compiler_DEFAULT=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -8410,14 +8425,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -8632,7 +8649,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic='-KPIC'
@@ -8763,14 +8780,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works=yes
@@ -8812,10 +8831,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -8868,8 +8888,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8877,6 +8898,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8923,8 +8945,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8932,6 +8955,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8992,7 +9016,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object=no
   enable_shared_with_static_runtimes=no
   export_dynamic_flag_spec=
-  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic=no
   hardcode_direct=no
   hardcode_direct_absolute=no
@@ -9055,7 +9079,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -9081,13 +9105,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -9131,7 +9155,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -9149,9 +9173,9 @@ _LT_EOF
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -9194,7 +9218,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -9225,7 +9249,7 @@ _LT_EOF
 	  compiler_needs_object=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object=yes
@@ -9263,7 +9287,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -9273,7 +9297,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
 
@@ -9285,7 +9309,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9294,7 +9318,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
@@ -9313,7 +9337,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
 	    archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -9332,7 +9356,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9376,10 +9400,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -9726,10 +9750,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS -b"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -9810,7 +9835,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -9836,7 +9861,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct=yes
 	hardcode_shlibpath_var=no
 	hardcode_direct_absolute=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
@@ -9905,7 +9930,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -10098,10 +10123,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -10127,6 +10153,7 @@ else
 	  fi
 	  allow_undefined_flag=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -10309,7 +10336,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([A-Za-z]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -10413,7 +10440,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -10786,7 +10813,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -10831,7 +10858,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -11477,7 +11504,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -11583,7 +11610,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
diff --git a/gcc/newlib/libc/sys/linux/linuxthreads/machine/i386/configure b/gcc/newlib/libc/sys/linux/linuxthreads/machine/i386/configure
index 286a3ceb7a..cdb460aa95 100755
--- a/gcc/newlib/libc/sys/linux/linuxthreads/machine/i386/configure
+++ b/gcc/newlib/libc/sys/linux/linuxthreads/machine/i386/configure
@@ -1559,9 +1559,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1597,9 +1598,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1673,9 +1675,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1711,7 +1714,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -3066,7 +3069,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -3124,6 +3127,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -3235,7 +3243,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
@@ -4680,9 +4688,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -4733,7 +4742,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4803,7 +4812,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4859,7 +4868,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -4916,7 +4925,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -5386,9 +5395,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -5430,7 +5439,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -5461,7 +5470,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -5669,10 +5678,12 @@ else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
   (eval echo "\"\$as_me:$LINENO: $ac_compile\"" >&5)
-  (eval "$ac_compile" 2>conftest.err)
+  (eval "($ac_compile | sed -e 's/\r//g')" 2>conftest.err)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: output\"" >&5)
   cat conftest.out >&5
@@ -6090,7 +6101,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -6152,7 +6163,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|_pic\.a)$'
@@ -6170,7 +6181,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
@@ -6671,7 +6682,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[ABCDGIRSTW]' ;;
 esac
@@ -6679,11 +6690,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -6717,7 +6728,7 @@ for ac_symprfx in "" "_"; do
 "     s[1]~prfx {split(s[1],t,\"@\"); print t[1], substr(t[1],length(prfx))}"\
 "     ' prfx=^$ac_symprfx"
   else
-    lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
+    lt_cv_sys_global_symbol_pipe="sed -n -e 's/\r//g' -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
   fi
 
   # Check to see that the pipe works correctly.
@@ -6738,14 +6749,14 @@ int main(){nm_test_var='a';nm_test_func();return(0);}
 _LT_EOF
 
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist\""; } >&5
-  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) 2>&5
+    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist\""; } >&5
+  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s "$nlist"; then
@@ -6766,7 +6777,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | sed -e '"'"'s/\r//g'"'"' | $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -6779,7 +6790,7 @@ lt__PROGRAM__LTX_preloaded_symbols[] =
 {
   { "@PROGRAM@", (void *) 0 },
 _LT_EOF
-	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | $GREP -v main >> conftest.$ac_ext
+	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | sed -e 's/\r//g' | $GREP -v main >> conftest.$ac_ext
 	  cat <<\_LT_EOF >> conftest.$ac_ext
   {0, (void *) 0}
 };
@@ -6802,7 +6813,7 @@ _LT_EOF
 	  LIBS="conftstm.$ac_objext"
 	  CFLAGS="$CFLAGS$lt_prog_compiler_no_builtin_flag"
 	  if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext}; then
@@ -6882,7 +6893,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6901,7 +6912,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo '#line '$LINENO' "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6939,7 +6950,7 @@ s390*-*linux*|s390*-*tpf*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7051,7 +7062,7 @@ sparc*-*solaris*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7584,6 +7595,7 @@ else
 	if test -f libconftest.dylib && test ! -s conftest.err && test $_lt_result = 0; then
 	  lt_cv_apple_cc_single_mod=yes
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err >&5
 	fi
 	rm -rf libconftest.dylib*
@@ -7646,6 +7658,7 @@ _LT_EOF
       if test -f conftest && test ! -s conftest.err && test $_lt_result = 0 && $GREP forced_load conftest 2>&1 >/dev/null; then
 	lt_cv_ld_force_load=yes
       else
+        dos2unix -q conftest.err
 	cat conftest.err >&5
       fi
         rm -f conftest.err libconftest.a conftest conftest.c
@@ -7861,7 +7874,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -7878,7 +7891,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -8402,13 +8415,15 @@ compiler_DEFAULT=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -8448,14 +8463,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -8670,7 +8687,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic='-KPIC'
@@ -8801,14 +8818,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works=yes
@@ -8850,10 +8869,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -8906,8 +8926,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8915,6 +8936,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8961,8 +8983,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8970,6 +8993,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -9030,7 +9054,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object=no
   enable_shared_with_static_runtimes=no
   export_dynamic_flag_spec=
-  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic=no
   hardcode_direct=no
   hardcode_direct_absolute=no
@@ -9093,7 +9117,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -9119,13 +9143,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -9169,7 +9193,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -9187,9 +9211,9 @@ _LT_EOF
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -9232,7 +9256,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -9263,7 +9287,7 @@ _LT_EOF
 	  compiler_needs_object=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object=yes
@@ -9301,7 +9325,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -9311,7 +9335,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
 
@@ -9323,7 +9347,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9332,7 +9356,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
@@ -9351,7 +9375,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
 	    archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -9370,7 +9394,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9414,10 +9438,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -9764,10 +9788,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS -b"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -9848,7 +9873,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -9874,7 +9899,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct=yes
 	hardcode_shlibpath_var=no
 	hardcode_direct_absolute=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
@@ -9943,7 +9968,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -10136,10 +10161,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -10165,6 +10191,7 @@ else
 	  fi
 	  allow_undefined_flag=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -10347,7 +10374,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([A-Za-z]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -10451,7 +10478,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -10824,7 +10851,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -10869,7 +10896,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -11515,7 +11542,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -11621,7 +11648,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
diff --git a/gcc/newlib/libc/sys/linux/machine/configure b/gcc/newlib/libc/sys/linux/machine/configure
index 6a8a4f15c6..7d7bcaf358 100755
--- a/gcc/newlib/libc/sys/linux/machine/configure
+++ b/gcc/newlib/libc/sys/linux/machine/configure
@@ -1564,9 +1564,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1602,9 +1603,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1678,9 +1680,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1716,7 +1719,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -3071,7 +3074,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -3129,6 +3132,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -3240,7 +3248,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
@@ -4643,9 +4651,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -4696,7 +4705,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4766,7 +4775,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4822,7 +4831,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -4879,7 +4888,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -5349,9 +5358,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -5393,7 +5402,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -5424,7 +5433,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -5632,10 +5641,12 @@ else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
   (eval echo "\"\$as_me:$LINENO: $ac_compile\"" >&5)
-  (eval "$ac_compile" 2>conftest.err)
+  (eval "($ac_compile | sed -e 's/\r//g')" 2>conftest.err)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: output\"" >&5)
   cat conftest.out >&5
@@ -6053,7 +6064,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -6115,7 +6126,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|_pic\.a)$'
@@ -6133,7 +6144,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
@@ -6634,7 +6645,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[ABCDGIRSTW]' ;;
 esac
@@ -6642,11 +6653,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -6680,7 +6691,7 @@ for ac_symprfx in "" "_"; do
 "     s[1]~prfx {split(s[1],t,\"@\"); print t[1], substr(t[1],length(prfx))}"\
 "     ' prfx=^$ac_symprfx"
   else
-    lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
+    lt_cv_sys_global_symbol_pipe="sed -n -e 's/\r//g' -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
   fi
 
   # Check to see that the pipe works correctly.
@@ -6701,14 +6712,14 @@ int main(){nm_test_var='a';nm_test_func();return(0);}
 _LT_EOF
 
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist\""; } >&5
-  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) 2>&5
+    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist\""; } >&5
+  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s "$nlist"; then
@@ -6729,7 +6740,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | sed -e '"'"'s/\r//g'"'"' | $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -6742,7 +6753,7 @@ lt__PROGRAM__LTX_preloaded_symbols[] =
 {
   { "@PROGRAM@", (void *) 0 },
 _LT_EOF
-	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | $GREP -v main >> conftest.$ac_ext
+	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | sed -e 's/\r//g' | $GREP -v main >> conftest.$ac_ext
 	  cat <<\_LT_EOF >> conftest.$ac_ext
   {0, (void *) 0}
 };
@@ -6765,7 +6776,7 @@ _LT_EOF
 	  LIBS="conftstm.$ac_objext"
 	  CFLAGS="$CFLAGS$lt_prog_compiler_no_builtin_flag"
 	  if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext}; then
@@ -6845,7 +6856,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6864,7 +6875,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo '#line '$LINENO' "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6902,7 +6913,7 @@ s390*-*linux*|s390*-*tpf*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7014,7 +7025,7 @@ sparc*-*solaris*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7547,6 +7558,7 @@ else
 	if test -f libconftest.dylib && test ! -s conftest.err && test $_lt_result = 0; then
 	  lt_cv_apple_cc_single_mod=yes
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err >&5
 	fi
 	rm -rf libconftest.dylib*
@@ -7609,6 +7621,7 @@ _LT_EOF
       if test -f conftest && test ! -s conftest.err && test $_lt_result = 0 && $GREP forced_load conftest 2>&1 >/dev/null; then
 	lt_cv_ld_force_load=yes
       else
+        dos2unix -q conftest.err
 	cat conftest.err >&5
       fi
         rm -f conftest.err libconftest.a conftest conftest.c
@@ -7824,7 +7837,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -7841,7 +7854,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -8365,13 +8378,15 @@ compiler_DEFAULT=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -8411,14 +8426,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -8633,7 +8650,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic='-KPIC'
@@ -8764,14 +8781,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works=yes
@@ -8813,10 +8832,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -8869,8 +8889,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8878,6 +8899,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8924,8 +8946,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8933,6 +8956,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8993,7 +9017,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object=no
   enable_shared_with_static_runtimes=no
   export_dynamic_flag_spec=
-  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic=no
   hardcode_direct=no
   hardcode_direct_absolute=no
@@ -9056,7 +9080,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -9082,13 +9106,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -9132,7 +9156,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -9150,9 +9174,9 @@ _LT_EOF
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -9195,7 +9219,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -9226,7 +9250,7 @@ _LT_EOF
 	  compiler_needs_object=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object=yes
@@ -9264,7 +9288,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -9274,7 +9298,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
 
@@ -9286,7 +9310,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9295,7 +9319,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
@@ -9314,7 +9338,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
 	    archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -9333,7 +9357,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9377,10 +9401,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -9727,10 +9751,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS -b"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -9811,7 +9836,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -9837,7 +9862,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct=yes
 	hardcode_shlibpath_var=no
 	hardcode_direct_absolute=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
@@ -9906,7 +9931,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -10099,10 +10124,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -10128,6 +10154,7 @@ else
 	  fi
 	  allow_undefined_flag=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -10310,7 +10337,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([A-Za-z]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -10414,7 +10441,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -10787,7 +10814,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -10832,7 +10859,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -11478,7 +11505,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -11584,7 +11611,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
diff --git a/gcc/newlib/libc/sys/linux/machine/i386/configure b/gcc/newlib/libc/sys/linux/machine/i386/configure
index 906baa429a..b2193eb925 100755
--- a/gcc/newlib/libc/sys/linux/machine/i386/configure
+++ b/gcc/newlib/libc/sys/linux/machine/i386/configure
@@ -1559,9 +1559,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1597,9 +1598,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1673,9 +1675,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1711,7 +1714,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -3066,7 +3069,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -3124,6 +3127,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -3235,7 +3243,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
@@ -4680,9 +4688,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -4733,7 +4742,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4803,7 +4812,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4859,7 +4868,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -4916,7 +4925,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -5386,9 +5395,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -5430,7 +5439,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -5461,7 +5470,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -5669,10 +5678,12 @@ else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
   (eval echo "\"\$as_me:$LINENO: $ac_compile\"" >&5)
-  (eval "$ac_compile" 2>conftest.err)
+  (eval "($ac_compile | sed -e 's/\r//g')" 2>conftest.err)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: output\"" >&5)
   cat conftest.out >&5
@@ -6090,7 +6101,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -6152,7 +6163,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|_pic\.a)$'
@@ -6170,7 +6181,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
@@ -6671,7 +6682,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[ABCDGIRSTW]' ;;
 esac
@@ -6679,11 +6690,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -6717,7 +6728,7 @@ for ac_symprfx in "" "_"; do
 "     s[1]~prfx {split(s[1],t,\"@\"); print t[1], substr(t[1],length(prfx))}"\
 "     ' prfx=^$ac_symprfx"
   else
-    lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
+    lt_cv_sys_global_symbol_pipe="sed -n -e 's/\r//g' -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
   fi
 
   # Check to see that the pipe works correctly.
@@ -6738,14 +6749,14 @@ int main(){nm_test_var='a';nm_test_func();return(0);}
 _LT_EOF
 
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist\""; } >&5
-  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) 2>&5
+    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist\""; } >&5
+  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s "$nlist"; then
@@ -6766,7 +6777,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | sed -e '"'"'s/\r//g'"'"' | $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -6779,7 +6790,7 @@ lt__PROGRAM__LTX_preloaded_symbols[] =
 {
   { "@PROGRAM@", (void *) 0 },
 _LT_EOF
-	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | $GREP -v main >> conftest.$ac_ext
+	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | sed -e 's/\r//g' | $GREP -v main >> conftest.$ac_ext
 	  cat <<\_LT_EOF >> conftest.$ac_ext
   {0, (void *) 0}
 };
@@ -6802,7 +6813,7 @@ _LT_EOF
 	  LIBS="conftstm.$ac_objext"
 	  CFLAGS="$CFLAGS$lt_prog_compiler_no_builtin_flag"
 	  if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext}; then
@@ -6882,7 +6893,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6901,7 +6912,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo '#line '$LINENO' "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6939,7 +6950,7 @@ s390*-*linux*|s390*-*tpf*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7051,7 +7062,7 @@ sparc*-*solaris*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7584,6 +7595,7 @@ else
 	if test -f libconftest.dylib && test ! -s conftest.err && test $_lt_result = 0; then
 	  lt_cv_apple_cc_single_mod=yes
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err >&5
 	fi
 	rm -rf libconftest.dylib*
@@ -7646,6 +7658,7 @@ _LT_EOF
       if test -f conftest && test ! -s conftest.err && test $_lt_result = 0 && $GREP forced_load conftest 2>&1 >/dev/null; then
 	lt_cv_ld_force_load=yes
       else
+        dos2unix -q conftest.err
 	cat conftest.err >&5
       fi
         rm -f conftest.err libconftest.a conftest conftest.c
@@ -7861,7 +7874,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -7878,7 +7891,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -8402,13 +8415,15 @@ compiler_DEFAULT=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -8448,14 +8463,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -8670,7 +8687,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic='-KPIC'
@@ -8801,14 +8818,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works=yes
@@ -8850,10 +8869,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -8906,8 +8926,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8915,6 +8936,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8961,8 +8983,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8970,6 +8993,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -9030,7 +9054,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object=no
   enable_shared_with_static_runtimes=no
   export_dynamic_flag_spec=
-  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic=no
   hardcode_direct=no
   hardcode_direct_absolute=no
@@ -9093,7 +9117,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -9119,13 +9143,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -9169,7 +9193,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -9187,9 +9211,9 @@ _LT_EOF
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -9232,7 +9256,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -9263,7 +9287,7 @@ _LT_EOF
 	  compiler_needs_object=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object=yes
@@ -9301,7 +9325,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -9311,7 +9335,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
 
@@ -9323,7 +9347,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9332,7 +9356,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
@@ -9351,7 +9375,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
 	    archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -9370,7 +9394,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9414,10 +9438,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -9764,10 +9788,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS -b"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -9848,7 +9873,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -9874,7 +9899,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct=yes
 	hardcode_shlibpath_var=no
 	hardcode_direct_absolute=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
@@ -9943,7 +9968,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -10136,10 +10161,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -10165,6 +10191,7 @@ else
 	  fi
 	  allow_undefined_flag=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -10347,7 +10374,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([A-Za-z]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -10451,7 +10478,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -10824,7 +10851,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -10869,7 +10896,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -11515,7 +11542,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -11621,7 +11648,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
diff --git a/gcc/newlib/libc/sys/m88kbug/configure b/gcc/newlib/libc/sys/m88kbug/configure
index 7939636015..7fc4615b24 100755
--- a/gcc/newlib/libc/sys/m88kbug/configure
+++ b/gcc/newlib/libc/sys/m88kbug/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/sys/mmixware/configure b/gcc/newlib/libc/sys/mmixware/configure
index 283572fc6b..7588b8aaf8 100755
--- a/gcc/newlib/libc/sys/mmixware/configure
+++ b/gcc/newlib/libc/sys/mmixware/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/sys/netware/configure b/gcc/newlib/libc/sys/netware/configure
index 041a7c28ae..527030026a 100755
--- a/gcc/newlib/libc/sys/netware/configure
+++ b/gcc/newlib/libc/sys/netware/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/sys/or1k/configure b/gcc/newlib/libc/sys/or1k/configure
index 568926938a..792e4516e9 100755
--- a/gcc/newlib/libc/sys/or1k/configure
+++ b/gcc/newlib/libc/sys/or1k/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/sys/phoenix/configure b/gcc/newlib/libc/sys/phoenix/configure
index 67015c2dff..da4249addb 100644
--- a/gcc/newlib/libc/sys/phoenix/configure
+++ b/gcc/newlib/libc/sys/phoenix/configure
@@ -1459,9 +1459,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2743,7 +2744,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2801,6 +2802,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2912,7 +2918,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/sys/phoenix/machine/arm/configure b/gcc/newlib/libc/sys/phoenix/machine/arm/configure
index 49e13b45f6..074a5bf30e 100644
--- a/gcc/newlib/libc/sys/phoenix/machine/arm/configure
+++ b/gcc/newlib/libc/sys/phoenix/machine/arm/configure
@@ -1438,9 +1438,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2722,7 +2723,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2780,6 +2781,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2891,7 +2897,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/sys/phoenix/machine/configure b/gcc/newlib/libc/sys/phoenix/machine/configure
index 163f2e3a90..0b79061e0a 100644
--- a/gcc/newlib/libc/sys/phoenix/machine/configure
+++ b/gcc/newlib/libc/sys/phoenix/machine/configure
@@ -1446,9 +1446,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2730,7 +2731,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2788,6 +2789,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2899,7 +2905,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/sys/rdos/configure b/gcc/newlib/libc/sys/rdos/configure
index e621e8c5a5..1d23476adf 100755
--- a/gcc/newlib/libc/sys/rdos/configure
+++ b/gcc/newlib/libc/sys/rdos/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/sys/rtems/configure b/gcc/newlib/libc/sys/rtems/configure
index 90748f74da..9d7b036165 100755
--- a/gcc/newlib/libc/sys/rtems/configure
+++ b/gcc/newlib/libc/sys/rtems/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/sys/sh/configure b/gcc/newlib/libc/sys/sh/configure
index fb72e6c2b1..2cd69e7bba 100755
--- a/gcc/newlib/libc/sys/sh/configure
+++ b/gcc/newlib/libc/sys/sh/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/sys/sparc64/Makefile.am b/gcc/newlib/libc/sys/sparc64/Makefile.am
index 2d8d56ac80..3fba83f1ae 100644
--- a/gcc/newlib/libc/sys/sparc64/Makefile.am
+++ b/gcc/newlib/libc/sys/sparc64/Makefile.am
@@ -85,9 +85,11 @@ $(COPYOMFILES):
 stamp-srcs: Makefile template.S template_r.S
 	for f in $(TEMPLATE_SFILES:_=);	do \
 	  $(COMPILE) -E -Dfunc=$$f $(srcdir)/template.S >$$f.S; \
+	  dos2unix -q $$f.S; \
 	done
 	for f in $(TEMPLATE_SFILES_R:_=); do \
 	  $(COMPILE) -E -Dfunc=$$f $(srcdir)/template_r.S | sed -e 's/^_/#/' >$$f.S; \
+	  dos2unix -q $$f.S; \
 	done
 	touch stamp-srcs
 
diff --git a/gcc/newlib/libc/sys/sparc64/Makefile.in b/gcc/newlib/libc/sys/sparc64/Makefile.in
index 4223ca937b..993172569c 100644
--- a/gcc/newlib/libc/sys/sparc64/Makefile.in
+++ b/gcc/newlib/libc/sys/sparc64/Makefile.in
@@ -549,9 +549,11 @@ $(COPYOMFILES):
 stamp-srcs: Makefile template.S template_r.S
 	for f in $(TEMPLATE_SFILES:_=);	do \
 	  $(COMPILE) -E -Dfunc=$$f $(srcdir)/template.S >$$f.S; \
+	  dos2unix -q $$f.S; \
 	done
 	for f in $(TEMPLATE_SFILES_R:_=); do \
 	  $(COMPILE) -E -Dfunc=$$f $(srcdir)/template_r.S | sed -e 's/^_/#/' >$$f.S; \
+	  dos2unix -q $$f.S; \
 	done
 	touch stamp-srcs
 
diff --git a/gcc/newlib/libc/sys/sparc64/configure b/gcc/newlib/libc/sys/sparc64/configure
index a1a6dd9397..5b2d5859de 100755
--- a/gcc/newlib/libc/sys/sparc64/configure
+++ b/gcc/newlib/libc/sys/sparc64/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/sys/sun4/configure b/gcc/newlib/libc/sys/sun4/configure
index 6b2e90ef54..de00abc184 100755
--- a/gcc/newlib/libc/sys/sun4/configure
+++ b/gcc/newlib/libc/sys/sun4/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/sys/sysmec/configure b/gcc/newlib/libc/sys/sysmec/configure
index 4d9ede17e8..a390a90de9 100755
--- a/gcc/newlib/libc/sys/sysmec/configure
+++ b/gcc/newlib/libc/sys/sysmec/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/sys/sysnec810/configure b/gcc/newlib/libc/sys/sysnec810/configure
index 9cf7791fd0..f31b3683fc 100755
--- a/gcc/newlib/libc/sys/sysnec810/configure
+++ b/gcc/newlib/libc/sys/sysnec810/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/sys/sysnecv850/configure b/gcc/newlib/libc/sys/sysnecv850/configure
index 4d9ede17e8..a390a90de9 100755
--- a/gcc/newlib/libc/sys/sysnecv850/configure
+++ b/gcc/newlib/libc/sys/sysnecv850/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/sys/sysvi386/configure b/gcc/newlib/libc/sys/sysvi386/configure
index 2331761c41..ada5538cdd 100755
--- a/gcc/newlib/libc/sys/sysvi386/configure
+++ b/gcc/newlib/libc/sys/sysvi386/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/sys/sysvnecv70/configure b/gcc/newlib/libc/sys/sysvnecv70/configure
index cabbf3ab1d..54ac32ea80 100755
--- a/gcc/newlib/libc/sys/sysvnecv70/configure
+++ b/gcc/newlib/libc/sys/sysvnecv70/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/sys/tic80/configure b/gcc/newlib/libc/sys/tic80/configure
index 283572fc6b..7588b8aaf8 100755
--- a/gcc/newlib/libc/sys/tic80/configure
+++ b/gcc/newlib/libc/sys/tic80/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/sys/tirtos/configure b/gcc/newlib/libc/sys/tirtos/configure
index c6caeb2cf2..b3b2b8e423 100755
--- a/gcc/newlib/libc/sys/tirtos/configure
+++ b/gcc/newlib/libc/sys/tirtos/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/sys/w65/configure b/gcc/newlib/libc/sys/w65/configure
index 1ea67950b9..155144554f 100755
--- a/gcc/newlib/libc/sys/w65/configure
+++ b/gcc/newlib/libc/sys/w65/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libc/sys/z8ksim/configure b/gcc/newlib/libc/sys/z8ksim/configure
index b458723e98..9e91111ab8 100755
--- a/gcc/newlib/libc/sys/z8ksim/configure
+++ b/gcc/newlib/libc/sys/z8ksim/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libm/configure b/gcc/newlib/libm/configure
index 970bfec0a9..b0f7d46907 100755
--- a/gcc/newlib/libm/configure
+++ b/gcc/newlib/libm/configure
@@ -1568,9 +1568,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1606,9 +1607,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1682,9 +1684,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1720,7 +1723,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -3130,7 +3133,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -3188,6 +3191,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -3299,7 +3307,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
@@ -4702,9 +4710,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -4755,7 +4764,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4825,7 +4834,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4881,7 +4890,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -4938,7 +4947,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -5408,9 +5417,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -5452,7 +5461,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -5483,7 +5492,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -5691,10 +5700,12 @@ else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
   (eval echo "\"\$as_me:$LINENO: $ac_compile\"" >&5)
-  (eval "$ac_compile" 2>conftest.err)
+  (eval "($ac_compile | sed -e 's/\r//g')" 2>conftest.err)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: output\"" >&5)
   cat conftest.out >&5
@@ -6112,7 +6123,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -6174,7 +6185,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|_pic\.a)$'
@@ -6192,7 +6203,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
@@ -6693,7 +6704,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[ABCDGIRSTW]' ;;
 esac
@@ -6701,11 +6712,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -6739,7 +6750,7 @@ for ac_symprfx in "" "_"; do
 "     s[1]~prfx {split(s[1],t,\"@\"); print t[1], substr(t[1],length(prfx))}"\
 "     ' prfx=^$ac_symprfx"
   else
-    lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
+    lt_cv_sys_global_symbol_pipe="sed -n -e 's/\r//g' -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
   fi
 
   # Check to see that the pipe works correctly.
@@ -6760,14 +6771,14 @@ int main(){nm_test_var='a';nm_test_func();return(0);}
 _LT_EOF
 
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist\""; } >&5
-  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) 2>&5
+    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist\""; } >&5
+  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s "$nlist"; then
@@ -6788,7 +6799,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | sed -e '"'"'s/\r//g'"'"' | $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -6801,7 +6812,7 @@ lt__PROGRAM__LTX_preloaded_symbols[] =
 {
   { "@PROGRAM@", (void *) 0 },
 _LT_EOF
-	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | $GREP -v main >> conftest.$ac_ext
+	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | sed -e 's/\r//g' | $GREP -v main >> conftest.$ac_ext
 	  cat <<\_LT_EOF >> conftest.$ac_ext
   {0, (void *) 0}
 };
@@ -6824,7 +6835,7 @@ _LT_EOF
 	  LIBS="conftstm.$ac_objext"
 	  CFLAGS="$CFLAGS$lt_prog_compiler_no_builtin_flag"
 	  if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext}; then
@@ -6904,7 +6915,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6923,7 +6934,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo '#line '$LINENO' "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6961,7 +6972,7 @@ s390*-*linux*|s390*-*tpf*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7073,7 +7084,7 @@ sparc*-*solaris*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7606,6 +7617,7 @@ else
 	if test -f libconftest.dylib && test ! -s conftest.err && test $_lt_result = 0; then
 	  lt_cv_apple_cc_single_mod=yes
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err >&5
 	fi
 	rm -rf libconftest.dylib*
@@ -7668,6 +7680,7 @@ _LT_EOF
       if test -f conftest && test ! -s conftest.err && test $_lt_result = 0 && $GREP forced_load conftest 2>&1 >/dev/null; then
 	lt_cv_ld_force_load=yes
       else
+        dos2unix -q conftest.err
 	cat conftest.err >&5
       fi
         rm -f conftest.err libconftest.a conftest conftest.c
@@ -7883,7 +7896,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -7900,7 +7913,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -8424,13 +8437,15 @@ compiler_DEFAULT=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -8470,14 +8485,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -8692,7 +8709,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic='-KPIC'
@@ -8823,14 +8840,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works=yes
@@ -8872,10 +8891,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -8928,8 +8948,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8937,6 +8958,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8983,8 +9005,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8992,6 +9015,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -9052,7 +9076,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object=no
   enable_shared_with_static_runtimes=no
   export_dynamic_flag_spec=
-  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic=no
   hardcode_direct=no
   hardcode_direct_absolute=no
@@ -9115,7 +9139,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -9141,13 +9165,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -9191,7 +9215,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -9209,9 +9233,9 @@ _LT_EOF
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -9254,7 +9278,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -9285,7 +9309,7 @@ _LT_EOF
 	  compiler_needs_object=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object=yes
@@ -9323,7 +9347,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -9333,7 +9357,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
 
@@ -9345,7 +9369,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9354,7 +9378,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
@@ -9373,7 +9397,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
 	    archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -9392,7 +9416,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9436,10 +9460,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -9786,10 +9810,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS -b"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -9870,7 +9895,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -9896,7 +9921,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct=yes
 	hardcode_shlibpath_var=no
 	hardcode_direct_absolute=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
@@ -9965,7 +9990,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -10158,10 +10183,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -10187,6 +10213,7 @@ else
 	  fi
 	  allow_undefined_flag=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -10369,7 +10396,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([A-Za-z]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -10473,7 +10500,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -10846,7 +10873,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -10891,7 +10918,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -11537,7 +11564,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -11643,7 +11670,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
diff --git a/gcc/newlib/libm/machine/aarch64/configure b/gcc/newlib/libm/machine/aarch64/configure
index cc0372576c..6289480add 100755
--- a/gcc/newlib/libm/machine/aarch64/configure
+++ b/gcc/newlib/libm/machine/aarch64/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libm/machine/arm/configure b/gcc/newlib/libm/machine/arm/configure
index cc0372576c..6289480add 100755
--- a/gcc/newlib/libm/machine/arm/configure
+++ b/gcc/newlib/libm/machine/arm/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libm/machine/configure b/gcc/newlib/libm/machine/configure
index bfba25b21b..5238e55749 100755
--- a/gcc/newlib/libm/machine/configure
+++ b/gcc/newlib/libm/machine/configure
@@ -1574,9 +1574,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1612,9 +1613,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1688,9 +1690,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1726,7 +1729,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -3081,7 +3084,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -3139,6 +3142,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -3250,7 +3258,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
@@ -4653,9 +4661,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -4706,7 +4715,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4776,7 +4785,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4832,7 +4841,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -4889,7 +4898,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -5359,9 +5368,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -5403,7 +5412,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -5434,7 +5443,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -5642,10 +5651,12 @@ else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
   (eval echo "\"\$as_me:$LINENO: $ac_compile\"" >&5)
-  (eval "$ac_compile" 2>conftest.err)
+  (eval "($ac_compile | sed -e 's/\r//g')" 2>conftest.err)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: output\"" >&5)
   cat conftest.out >&5
@@ -6063,7 +6074,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -6125,7 +6136,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|_pic\.a)$'
@@ -6143,7 +6154,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
@@ -6644,7 +6655,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[ABCDGIRSTW]' ;;
 esac
@@ -6652,11 +6663,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -6690,7 +6701,7 @@ for ac_symprfx in "" "_"; do
 "     s[1]~prfx {split(s[1],t,\"@\"); print t[1], substr(t[1],length(prfx))}"\
 "     ' prfx=^$ac_symprfx"
   else
-    lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
+    lt_cv_sys_global_symbol_pipe="sed -n -e 's/\r//g' -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
   fi
 
   # Check to see that the pipe works correctly.
@@ -6711,14 +6722,14 @@ int main(){nm_test_var='a';nm_test_func();return(0);}
 _LT_EOF
 
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist\""; } >&5
-  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) 2>&5
+    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist\""; } >&5
+  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s "$nlist"; then
@@ -6739,7 +6750,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | sed -e '"'"'s/\r//g'"'"' | $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -6752,7 +6763,7 @@ lt__PROGRAM__LTX_preloaded_symbols[] =
 {
   { "@PROGRAM@", (void *) 0 },
 _LT_EOF
-	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | $GREP -v main >> conftest.$ac_ext
+	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | sed -e 's/\r//g' | $GREP -v main >> conftest.$ac_ext
 	  cat <<\_LT_EOF >> conftest.$ac_ext
   {0, (void *) 0}
 };
@@ -6775,7 +6786,7 @@ _LT_EOF
 	  LIBS="conftstm.$ac_objext"
 	  CFLAGS="$CFLAGS$lt_prog_compiler_no_builtin_flag"
 	  if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext}; then
@@ -6855,7 +6866,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6874,7 +6885,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo '#line '$LINENO' "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6912,7 +6923,7 @@ s390*-*linux*|s390*-*tpf*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7024,7 +7035,7 @@ sparc*-*solaris*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7557,6 +7568,7 @@ else
 	if test -f libconftest.dylib && test ! -s conftest.err && test $_lt_result = 0; then
 	  lt_cv_apple_cc_single_mod=yes
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err >&5
 	fi
 	rm -rf libconftest.dylib*
@@ -7619,6 +7631,7 @@ _LT_EOF
       if test -f conftest && test ! -s conftest.err && test $_lt_result = 0 && $GREP forced_load conftest 2>&1 >/dev/null; then
 	lt_cv_ld_force_load=yes
       else
+        dos2unix -q conftest.err
 	cat conftest.err >&5
       fi
         rm -f conftest.err libconftest.a conftest conftest.c
@@ -7834,7 +7847,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -7851,7 +7864,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -8375,13 +8388,15 @@ compiler_DEFAULT=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -8421,14 +8436,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -8643,7 +8660,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic='-KPIC'
@@ -8774,14 +8791,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works=yes
@@ -8823,10 +8842,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -8879,8 +8899,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8888,6 +8909,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8934,8 +8956,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8943,6 +8966,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -9003,7 +9027,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object=no
   enable_shared_with_static_runtimes=no
   export_dynamic_flag_spec=
-  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic=no
   hardcode_direct=no
   hardcode_direct_absolute=no
@@ -9066,7 +9090,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -9092,13 +9116,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -9142,7 +9166,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -9160,9 +9184,9 @@ _LT_EOF
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -9205,7 +9229,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -9236,7 +9260,7 @@ _LT_EOF
 	  compiler_needs_object=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object=yes
@@ -9274,7 +9298,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -9284,7 +9308,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
 
@@ -9296,7 +9320,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9305,7 +9329,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
@@ -9324,7 +9348,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
 	    archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -9343,7 +9367,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9387,10 +9411,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -9737,10 +9761,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS -b"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -9821,7 +9846,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -9847,7 +9872,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct=yes
 	hardcode_shlibpath_var=no
 	hardcode_direct_absolute=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
@@ -9916,7 +9941,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -10109,10 +10134,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -10138,6 +10164,7 @@ else
 	  fi
 	  allow_undefined_flag=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -10320,7 +10347,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([A-Za-z]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -10424,7 +10451,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -10797,7 +10824,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -10842,7 +10869,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -11488,7 +11515,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -11594,7 +11621,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
diff --git a/gcc/newlib/libm/machine/i386/configure b/gcc/newlib/libm/machine/i386/configure
index 2e34fcc83d..2cb4bc2ba0 100755
--- a/gcc/newlib/libm/machine/i386/configure
+++ b/gcc/newlib/libm/machine/i386/configure
@@ -1559,9 +1559,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1597,9 +1598,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1673,9 +1675,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1711,7 +1714,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -3066,7 +3069,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -3124,6 +3127,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -3235,7 +3243,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
@@ -4638,9 +4646,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -4691,7 +4700,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4761,7 +4770,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4817,7 +4826,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -4874,7 +4883,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -5344,9 +5353,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -5388,7 +5397,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -5419,7 +5428,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -5627,10 +5636,12 @@ else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
   (eval echo "\"\$as_me:$LINENO: $ac_compile\"" >&5)
-  (eval "$ac_compile" 2>conftest.err)
+  (eval "($ac_compile | sed -e 's/\r//g')" 2>conftest.err)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: output\"" >&5)
   cat conftest.out >&5
@@ -6048,7 +6059,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -6110,7 +6121,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|_pic\.a)$'
@@ -6128,7 +6139,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
@@ -6629,7 +6640,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[ABCDGIRSTW]' ;;
 esac
@@ -6637,11 +6648,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -6675,7 +6686,7 @@ for ac_symprfx in "" "_"; do
 "     s[1]~prfx {split(s[1],t,\"@\"); print t[1], substr(t[1],length(prfx))}"\
 "     ' prfx=^$ac_symprfx"
   else
-    lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
+    lt_cv_sys_global_symbol_pipe="sed -n -e 's/\r//g' -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
   fi
 
   # Check to see that the pipe works correctly.
@@ -6696,14 +6707,14 @@ int main(){nm_test_var='a';nm_test_func();return(0);}
 _LT_EOF
 
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist\""; } >&5
-  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) 2>&5
+    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist\""; } >&5
+  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s "$nlist"; then
@@ -6724,7 +6735,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | sed -e '"'"'s/\r//g'"'"' | $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -6737,7 +6748,7 @@ lt__PROGRAM__LTX_preloaded_symbols[] =
 {
   { "@PROGRAM@", (void *) 0 },
 _LT_EOF
-	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | $GREP -v main >> conftest.$ac_ext
+	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | sed -e 's/\r//g' | $GREP -v main >> conftest.$ac_ext
 	  cat <<\_LT_EOF >> conftest.$ac_ext
   {0, (void *) 0}
 };
@@ -6760,7 +6771,7 @@ _LT_EOF
 	  LIBS="conftstm.$ac_objext"
 	  CFLAGS="$CFLAGS$lt_prog_compiler_no_builtin_flag"
 	  if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext}; then
@@ -6840,7 +6851,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6859,7 +6870,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo '#line '$LINENO' "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6897,7 +6908,7 @@ s390*-*linux*|s390*-*tpf*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7009,7 +7020,7 @@ sparc*-*solaris*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7542,6 +7553,7 @@ else
 	if test -f libconftest.dylib && test ! -s conftest.err && test $_lt_result = 0; then
 	  lt_cv_apple_cc_single_mod=yes
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err >&5
 	fi
 	rm -rf libconftest.dylib*
@@ -7604,6 +7616,7 @@ _LT_EOF
       if test -f conftest && test ! -s conftest.err && test $_lt_result = 0 && $GREP forced_load conftest 2>&1 >/dev/null; then
 	lt_cv_ld_force_load=yes
       else
+        dos2unix -q conftest.err
 	cat conftest.err >&5
       fi
         rm -f conftest.err libconftest.a conftest conftest.c
@@ -7819,7 +7832,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -7836,7 +7849,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -8360,13 +8373,15 @@ compiler_DEFAULT=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -8406,14 +8421,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -8628,7 +8645,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic='-KPIC'
@@ -8759,14 +8776,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works=yes
@@ -8808,10 +8827,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -8864,8 +8884,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8873,6 +8894,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8919,8 +8941,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8928,6 +8951,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8988,7 +9012,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object=no
   enable_shared_with_static_runtimes=no
   export_dynamic_flag_spec=
-  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic=no
   hardcode_direct=no
   hardcode_direct_absolute=no
@@ -9051,7 +9075,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -9077,13 +9101,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $L$LD -vD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -9127,7 +9151,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -9145,9 +9169,9 @@ _LT_EOF
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -9190,7 +9214,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -9221,7 +9245,7 @@ _LT_EOF
 	  compiler_needs_object=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object=yes
@@ -9259,7 +9283,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -9269,7 +9293,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
 
@@ -9281,7 +9305,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9290,7 +9314,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
@@ -9309,7 +9333,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
 	    archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -9328,7 +9352,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9372,10 +9396,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -9722,10 +9746,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS -b"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -9806,7 +9831,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -9832,7 +9857,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct=yes
 	hardcode_shlibpath_var=no
 	hardcode_direct_absolute=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
@@ -9901,7 +9926,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -10094,10 +10119,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -10123,6 +10149,7 @@ else
 	  fi
 	  allow_undefined_flag=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -10305,7 +10332,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([A-Za-z]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -10409,7 +10436,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -10782,7 +10809,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -10827,7 +10854,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -11473,7 +11500,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -11579,7 +11606,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
diff --git a/gcc/newlib/libm/machine/mips/configure b/gcc/newlib/libm/machine/mips/configure
index cc0372576c..6289480add 100755
--- a/gcc/newlib/libm/machine/mips/configure
+++ b/gcc/newlib/libm/machine/mips/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libm/machine/nds32/configure b/gcc/newlib/libm/machine/nds32/configure
index 657cb0eec6..a83fa67c5f 100644
--- a/gcc/newlib/libm/machine/nds32/configure
+++ b/gcc/newlib/libm/machine/nds32/configure
@@ -1479,9 +1479,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2763,7 +2764,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2821,6 +2822,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2932,7 +2938,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
@@ -3857,9 +3863,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -3888,7 +3895,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -3933,7 +3940,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4003,7 +4010,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4059,7 +4066,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -4113,7 +4120,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -4169,7 +4176,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
diff --git a/gcc/newlib/libm/machine/powerpc/configure b/gcc/newlib/libm/machine/powerpc/configure
index cc0372576c..6289480add 100755
--- a/gcc/newlib/libm/machine/powerpc/configure
+++ b/gcc/newlib/libm/machine/powerpc/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libm/machine/pru/configure b/gcc/newlib/libm/machine/pru/configure
index cc0372576c..6289480add 100755
--- a/gcc/newlib/libm/machine/pru/configure
+++ b/gcc/newlib/libm/machine/pru/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libm/machine/riscv/configure b/gcc/newlib/libm/machine/riscv/configure
index cc0372576c..6289480add 100755
--- a/gcc/newlib/libm/machine/riscv/configure
+++ b/gcc/newlib/libm/machine/riscv/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libm/machine/sparc/configure b/gcc/newlib/libm/machine/sparc/configure
index cc0372576c..6289480add 100755
--- a/gcc/newlib/libm/machine/sparc/configure
+++ b/gcc/newlib/libm/machine/sparc/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libm/machine/spu/configure b/gcc/newlib/libm/machine/spu/configure
index cc0372576c..6289480add 100644
--- a/gcc/newlib/libm/machine/spu/configure
+++ b/gcc/newlib/libm/machine/spu/configure
@@ -1456,9 +1456,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -2740,7 +2741,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -2798,6 +2799,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -2909,7 +2915,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
diff --git a/gcc/newlib/libm/machine/x86_64/configure b/gcc/newlib/libm/machine/x86_64/configure
index 11ff9960b1..0f7a6a569c 100755
--- a/gcc/newlib/libm/machine/x86_64/configure
+++ b/gcc/newlib/libm/machine/x86_64/configure
@@ -1559,9 +1559,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1597,9 +1598,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1673,9 +1675,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1711,7 +1714,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -3066,7 +3069,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -3124,6 +3127,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -3235,7 +3243,7 @@ else
 EOF
 if { ac_try='${CC-cc} -E conftest.c'
   { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_try\""; } >&5
-  (eval $ac_try) 2>&5
+  (eval $ac_try | sed -e 's/\r//g') 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; } | egrep yes >/dev/null 2>&1; then
@@ -4638,9 +4646,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -4691,7 +4700,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4761,7 +4770,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4817,7 +4826,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -4874,7 +4883,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -5344,9 +5353,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -5388,7 +5397,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -5419,7 +5428,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -5627,10 +5636,12 @@ else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
   (eval echo "\"\$as_me:$LINENO: $ac_compile\"" >&5)
-  (eval "$ac_compile" 2>conftest.err)
+  (eval "($ac_compile | sed -e 's/\r//g')" 2>conftest.err)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: output\"" >&5)
   cat conftest.out >&5
@@ -6048,7 +6059,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -6110,7 +6121,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|_pic\.a)$'
@@ -6128,7 +6139,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
@@ -6629,7 +6640,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[ABCDGIRSTW]' ;;
 esac
@@ -6637,11 +6648,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -6675,7 +6686,7 @@ for ac_symprfx in "" "_"; do
 "     s[1]~prfx {split(s[1],t,\"@\"); print t[1], substr(t[1],length(prfx))}"\
 "     ' prfx=^$ac_symprfx"
   else
-    lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
+    lt_cv_sys_global_symbol_pipe="sed -n -e 's/\r//g' -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
   fi
 
   # Check to see that the pipe works correctly.
@@ -6696,14 +6707,14 @@ int main(){nm_test_var='a';nm_test_func();return(0);}
 _LT_EOF
 
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist\""; } >&5
-  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) 2>&5
+    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist\""; } >&5
+  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s "$nlist"; then
@@ -6724,7 +6735,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | sed -e '"'"'s/\r//g'"'"' | $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -6737,7 +6748,7 @@ lt__PROGRAM__LTX_preloaded_symbols[] =
 {
   { "@PROGRAM@", (void *) 0 },
 _LT_EOF
-	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | $GREP -v main >> conftest.$ac_ext
+	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | sed -e 's/\r//g' | $GREP -v main >> conftest.$ac_ext
 	  cat <<\_LT_EOF >> conftest.$ac_ext
   {0, (void *) 0}
 };
@@ -6760,7 +6771,7 @@ _LT_EOF
 	  LIBS="conftstm.$ac_objext"
 	  CFLAGS="$CFLAGS$lt_prog_compiler_no_builtin_flag"
 	  if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext}; then
@@ -6840,7 +6851,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6859,7 +6870,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo '#line '$LINENO' "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6897,7 +6908,7 @@ s390*-*linux*|s390*-*tpf*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7009,7 +7020,7 @@ sparc*-*solaris*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -7542,6 +7553,7 @@ else
 	if test -f libconftest.dylib && test ! -s conftest.err && test $_lt_result = 0; then
 	  lt_cv_apple_cc_single_mod=yes
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err >&5
 	fi
 	rm -rf libconftest.dylib*
@@ -7604,6 +7616,7 @@ _LT_EOF
       if test -f conftest && test ! -s conftest.err && test $_lt_result = 0 && $GREP forced_load conftest 2>&1 >/dev/null; then
 	lt_cv_ld_force_load=yes
       else
+        dos2unix -q conftest.err
 	cat conftest.err >&5
       fi
         rm -f conftest.err libconftest.a conftest conftest.c
@@ -7819,7 +7832,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -7836,7 +7849,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -8360,13 +8373,15 @@ compiler_DEFAULT=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -8406,14 +8421,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -8628,7 +8645,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic='-KPIC'
@@ -8759,14 +8776,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works=yes
@@ -8808,10 +8827,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -8864,8 +8884,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8873,6 +8894,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8919,8 +8941,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8928,6 +8951,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8988,7 +9012,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object=no
   enable_shared_with_static_runtimes=no
   export_dynamic_flag_spec=
-  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic=no
   hardcode_direct=no
   hardcode_direct_absolute=no
@@ -9051,7 +9075,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -9077,13 +9101,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -9127,7 +9151,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -9145,9 +9169,9 @@ _LT_EOF
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -9190,7 +9214,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -9221,7 +9245,7 @@ _LT_EOF
 	  compiler_needs_object=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object=yes
@@ -9259,7 +9283,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -9269,7 +9293,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
 
@@ -9281,7 +9305,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9290,7 +9314,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
@@ -9309,7 +9333,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
 	    archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -9328,7 +9352,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -9372,10 +9396,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -9722,10 +9746,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS -b"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -9806,7 +9831,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -9832,7 +9857,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct=yes
 	hardcode_shlibpath_var=no
 	hardcode_direct_absolute=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
@@ -9901,7 +9926,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -10094,10 +10119,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -10123,6 +10149,7 @@ else
 	  fi
 	  allow_undefined_flag=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -10305,7 +10332,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([A-Za-z]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -10409,7 +10436,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -10782,7 +10809,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -10827,7 +10854,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -11473,7 +11500,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -11579,7 +11606,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
diff --git a/gcc/zlib/configure b/gcc/zlib/configure
index f489f31bc7..3d912ef1b1 100755
--- a/gcc/zlib/configure
+++ b/gcc/zlib/configure
@@ -1539,9 +1539,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>conftest.err
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1577,9 +1578,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>conftest.err
+  (eval "($ac_link | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1653,9 +1655,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     grep -v '^ *+' conftest.err >conftest.er1
     cat conftest.er1 >&5
     mv -f conftest.er1 conftest.err
@@ -1691,7 +1694,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
@@ -3388,9 +3391,10 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  (eval "($ac_compiler $ac_option | sed -e 's/\r//g') >&5") 2>conftest.err
   ac_status=$?
   if test -s conftest.err; then
+    dos2unix -q conftest.err
     sed '10a\
 ... rest of stderr output deleted ...
          10q' conftest.err >conftest.er1
@@ -3414,7 +3418,7 @@ printf ("hello world\n");
 _ACEOF
 # FIXME: Cleanup?
 if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3469,7 +3473,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link_default") 2>&5
+  (eval "($ac_link_default | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3539,7 +3543,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -3595,7 +3599,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_link") 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }
@@ -3653,7 +3657,7 @@ case "(($ac_try" in
 esac
 eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
 $as_echo "$ac_try_echo"; } >&5
-  (eval "$ac_compile") 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then :
@@ -4042,7 +4046,7 @@ else
 
   am_cv_CC_dependencies_compiler_type=none
   if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
+     am_compiler_list=`sed -n -e 's/\r//g' -e 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
   fi
   am__universal=false
   case " $depcc " in #(
@@ -4100,6 +4104,11 @@ else
        depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
        $SHELL ./depcomp $depcc -c $am__minus_obj sub/conftest.c \
          >/dev/null 2>conftest.err &&
+       dos2unix -q conftest.err && 
+       dos2unix -q sub/conftst1.h && 
+       dos2unix -q sub/conftst6.h && 
+       dos2unix -q sub/conftest.Po && 
+       dos2unix -q sub/conftest.TPo && 
        grep sub/conftst1.h sub/conftest.Po > /dev/null 2>&1 &&
        grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
@@ -4642,9 +4651,9 @@ $as_echo_n "checking for ld used by $CC... " >&6; }
   case $host in
   *-*-mingw*)
     # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g' | tr -d '\015'` ;;
   *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | sed -e 's/\r//g'` ;;
   esac
   case $ac_prog in
     # Accept absolute paths.
@@ -4686,7 +4695,7 @@ else
       # Check to see if the program is GNU ld.  I'd rather use --version,
       # but apparently some variants of GNU ld only accept -v.
       # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
+      case `"$lt_cv_path_LD" -v 2>&1 </dev/null | sed -e 's/\r//g'` in
       *GNU* | *'with BFD'*)
 	test "$with_gnu_ld" != no && break
 	;;
@@ -4717,7 +4726,7 @@ if ${lt_cv_prog_gnu_ld+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   # I'd rather use --version here, but apparently some GNU lds only accept -v.
-case `$LD -v 2>&1 </dev/null` in
+case `$LD -v 2>&1 </dev/null | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   lt_cv_prog_gnu_ld=yes
   ;;
@@ -4925,10 +4934,12 @@ else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
   (eval echo "\"\$as_me:$LINENO: $ac_compile\"" >&5)
-  (eval "$ac_compile" 2>conftest.err)
+  (eval "($ac_compile | sed -e 's/\r//g')" 2>conftest.err)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
-  (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
+  (eval "($NM \"conftest.$ac_objext\" | sed -e 's/\r//g')" 2>conftest.err > conftest.out)
+  dos2unix -q conftest.err
   cat conftest.err >&5
   (eval echo "\"\$as_me:$LINENO: output\"" >&5)
   cat conftest.out >&5
@@ -5349,7 +5360,7 @@ darwin* | rhapsody*)
   ;;
 
 freebsd* | dragonfly*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     case $host_cpu in
     i*86 )
       # Not sure whether the presence of OpenBSD here was a mistake.
@@ -5411,7 +5422,7 @@ linux* | k*bsd*-gnu | kopensolaris*-gnu | uclinuxfdpiceabi)
   ;;
 
 netbsd*)
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ > /dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ > /dev/null; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|_pic\.a)$'
@@ -5429,7 +5440,7 @@ newos6*)
   ;;
 
 openbsd*)
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
     lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
@@ -5930,7 +5941,7 @@ sysv4)
 esac
 
 # If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
+case `$NM -V 2>&1 | sed -e 's/\r//g'` in
 *GNU* | *'with BFD'*)
   symcode='[ABCDGIRSTW]' ;;
 esac
@@ -5938,11 +5949,11 @@ esac
 # Transform an extracted symbol line into a proper C declaration.
 # Some systems (esp. on ia64) link data and code symbols differently,
 # so use this general approach.
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
+lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/\r//g' -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
 
 # Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
-lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (void *) \&\2},/p'"
+lt_cv_sys_global_symbol_to_c_name_address_lib_prefix="sed -n -e 's/\r//g' -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (void *) 0},/p' -e 's/^$symcode* \([^ ]*\) \(lib[^ ]*\)$/  {\"\2\", (void *) \&\2},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"lib\2\", (void *) \&\2},/p'"
 
 # Handle CRLF in mingw tool chain
 opt_cr=
@@ -5976,7 +5987,7 @@ for ac_symprfx in "" "_"; do
 "     s[1]~prfx {split(s[1],t,\"@\"); print t[1], substr(t[1],length(prfx))}"\
 "     ' prfx=^$ac_symprfx"
   else
-    lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
+    lt_cv_sys_global_symbol_pipe="sed -n -e 's/\r//g' -e 's/^.*[	 ]\($symcode$symcode*\)[	 ][	 ]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'"
   fi
 
   # Check to see that the pipe works correctly.
@@ -5997,14 +6008,14 @@ int main(){nm_test_var='a';nm_test_func();return(0);}
 _LT_EOF
 
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
     # Now try to grab the symbols.
     nlist=conftest.nm
-    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist\""; } >&5
-  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \> $nlist) 2>&5
+    if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist\""; } >&5
+  (eval $NM conftest.$ac_objext \| "$lt_cv_sys_global_symbol_pipe" \| "sed -e 's/\r//g'" \> $nlist) 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s "$nlist"; then
@@ -6025,7 +6036,7 @@ extern "C" {
 
 _LT_EOF
 	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | $GREP -v main >> conftest.$ac_ext'
+	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | sed -e '"'"'s/\r//g'"'"' | $GREP -v main >> conftest.$ac_ext'
 
 	  cat <<_LT_EOF >> conftest.$ac_ext
 
@@ -6038,7 +6049,7 @@ lt__PROGRAM__LTX_preloaded_symbols[] =
 {
   { "@PROGRAM@", (void *) 0 },
 _LT_EOF
-	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | $GREP -v main >> conftest.$ac_ext
+	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (void *) \&\2},/" < "$nlist" | sed -e 's/\r//g' | $GREP -v main >> conftest.$ac_ext
 	  cat <<\_LT_EOF >> conftest.$ac_ext
   {0, (void *) 0}
 };
@@ -6061,7 +6072,7 @@ _LT_EOF
 	  LIBS="conftstm.$ac_objext"
 	  CFLAGS="$CFLAGS$lt_prog_compiler_no_builtin_flag"
 	  if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext}; then
@@ -6140,7 +6151,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6159,7 +6170,7 @@ ia64-*-hpux*)
   # Find out which ABI we are using.
   echo '#line '$LINENO' "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6197,7 +6208,7 @@ s390*-*linux*|s390*-*tpf*|sparc*-*linux*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6312,7 +6323,7 @@ sparc*-*solaris*)
   # Find out which ABI we are using.
   echo 'int i;' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; }; then
@@ -6845,6 +6856,7 @@ else
 	if test -f libconftest.dylib && test ! -s conftest.err && test $_lt_result = 0; then
 	  lt_cv_apple_cc_single_mod=yes
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err >&5
 	fi
 	rm -rf libconftest.dylib*
@@ -6910,6 +6922,7 @@ _LT_EOF
       if test -f conftest && test ! -s conftest.err && test $_lt_result = 0 && $GREP forced_load conftest 2>&1 >/dev/null; then
 	lt_cv_ld_force_load=yes
       else
+        dos2unix -q conftest.err
 	cat conftest.err >&5
       fi
         rm -f conftest.err libconftest.a conftest conftest.c
@@ -7127,7 +7140,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <string.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "memchr" >/dev/null 2>&1; then :
 
 else
@@ -7144,7 +7157,7 @@ if test $ac_cv_header_stdc = yes; then
 #include <stdlib.h>
 
 _ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   $EGREP "free" >/dev/null 2>&1; then :
 
 else
@@ -7670,13 +7683,15 @@ compiler_DEFAULT=$CC
 # save warnings/boilerplate of simple test code
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_compile_test_code" >conftest.$ac_ext
-eval "$ac_compile" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_compile | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_compiler_boilerplate=`cat conftest.err`
 $RM conftest*
 
 ac_outfile=conftest.$ac_objext
 echo "$lt_simple_link_test_code" >conftest.$ac_ext
-eval "$ac_link" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+eval "($ac_link | sed -e 's/\r//g')" 2>&1 >/dev/null | $SED '/^$/d; /^ *+/d' >conftest.err
+dos2unix -q conftest.err
 _lt_linker_boilerplate=`cat conftest.err`
 $RM -r conftest*
 
@@ -7716,14 +7731,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_rtti_exceptions=yes
@@ -7938,7 +7955,7 @@ $as_echo_n "checking for $compiler option to produce PIC... " >&6; }
 	lt_prog_compiler_static='-qstaticlink'
 	;;
       *)
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ F* | *Sun*Fortran*)
 	  # Sun Fortran 8.3 passes all unrecognized flags to the linker
 	  lt_prog_compiler_pic='-KPIC'
@@ -8069,14 +8086,16 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>conftest.err)
    ac_status=$?
+   dos2unix -q conftest.err
    cat conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' >conftest.exp
+     dos2unix -q conftest.exp
      $SED '/^$/d; /^ *+/d' conftest.err >conftest.er2
      if test ! -s conftest.er2 || diff conftest.exp conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_pic_works=yes
@@ -8118,10 +8137,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS $lt_tmp_static_flag"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -8174,8 +8194,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8183,6 +8204,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8229,8 +8251,9 @@ else
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
    (eval echo "\"\$as_me:$LINENO: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
+   (eval "($lt_compile | sed -e 's/\r//g')" 2>out/conftest.err)
    ac_status=$?
+   dos2unix -q out/conftest.err
    cat out/conftest.err >&5
    echo "$as_me:$LINENO: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
@@ -8238,6 +8261,7 @@ else
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings
      $ECHO "$_lt_compiler_boilerplate" | $SED '/^$/d' > out/conftest.exp
+     dos2unix -q out/conftest.exp
      $SED '/^$/d; /^ *+/d' out/conftest.err >out/conftest.er2
      if test ! -s out/conftest.er2 || diff out/conftest.exp out/conftest.er2 >/dev/null; then
        lt_cv_prog_compiler_c_o=yes
@@ -8298,7 +8322,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
   compiler_needs_object=no
   enable_shared_with_static_runtimes=no
   export_dynamic_flag_spec=
-  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
+  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
   hardcode_automatic=no
   hardcode_direct=no
   hardcode_direct_absolute=no
@@ -8361,7 +8385,7 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
 	# with the native linker.  However, as the warning in the GNU ld
 	# block says, versions before 2.19.5* couldn't really create working
 	# shared libraries, regardless of the interface used.
-	case `$LD -v 2>&1` in
+	case `$LD -v 2>&1 | sed -e 's/\r//g'` in
 	  *\ \(GNU\ Binutils\)\ 2.19.5*) ;;
 	  *\ \(GNU\ Binutils\)\ 2.[2-9]*) ;;
 	  *\ \(GNU\ Binutils\)\ [3-9]*) ;;
@@ -8387,13 +8411,13 @@ $as_echo_n "checking whether the $compiler linker ($LD) supports shared librarie
     hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
     export_dynamic_flag_spec='${wl}--export-dynamic'
     # ancient GNU ld didn't support --whole-archive et. al.
-    if $LD --help 2>&1 | $GREP 'no-whole-archive' > /dev/null; then
+    if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'no-whole-archive' > /dev/null; then
       whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
     else
       whole_archive_flag_spec=
     fi
     supports_anon_versioning=no
-    case `$LD -v 2>&1` in
+    case `$LD -v 2>&1 | sed -e 's/\r//g'` in
       *GNU\ gold*) supports_anon_versioning=yes ;;
       *\ [01].* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
       *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
@@ -8437,7 +8461,7 @@ _LT_EOF
       ;;
 
     beos*)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	allow_undefined_flag=unsupported
 	# Joseph Beckenbach <jrb3@best.com> says some releases of gcc
 	# support --undefined.  This deserves some investigation.  FIXME
@@ -8455,9 +8479,9 @@ _LT_EOF
       allow_undefined_flag=unsupported
       always_export_symbols=no
       enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
+      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/\r//'\'' | $SED -e '\''/^[BCDGRS][ ]/s/.*[ ]\([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW][ ]/s/.*[ ]//'\'' | sort | uniq > $export_symbols'
 
-      if $LD --help 2>&1 | $GREP 'auto-import' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP 'auto-import' > /dev/null; then
         archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--enable-auto-image-base -Xlinker --out-implib -Xlinker $lib'
 	# If the export-symbols file already is a .def file (1st line
 	# is EXPORTS), use it as is; otherwise, prepend...
@@ -8500,7 +8524,7 @@ _LT_EOF
 	  diet\ *) tmp_diet=yes;;	# linux-dietlibc with static linking (!diet-dyn)
 	esac
       fi
-      if $LD --help 2>&1 | $EGREP ': supported targets:.* elf' > /dev/null \
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $EGREP ': supported targets:.* elf' > /dev/null \
 	 && test "$tmp_diet" = no
       then
 	tmp_addflag=' $pic_flag'
@@ -8531,7 +8555,7 @@ _LT_EOF
 	  compiler_needs_object=yes
 	  ;;
 	esac
-	case `$CC -V 2>&1 | sed 5q` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g' | sed 5q` in
 	*Sun\ C*)			# Sun C 5.9
 	  whole_archive_flag_spec='${wl}--whole-archive`new_convenience=; for conv in $convenience\"\"; do test -z \"$conv\" || new_convenience=\"$new_convenience,$conv\"; done; func_echo_all \"$new_convenience\"` ${wl}--no-whole-archive'
 	  compiler_needs_object=yes
@@ -8569,7 +8593,7 @@ _LT_EOF
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
 	wlarc=
       else
@@ -8579,7 +8603,7 @@ _LT_EOF
       ;;
 
     solaris*)
-      if $LD -v 2>&1 | $GREP 'BFD 2\.8' > /dev/null; then
+      if $LD -v 2>&1 | sed -e 's/\r//g' | $GREP 'BFD 2\.8' > /dev/null; then
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
 
@@ -8591,7 +8615,7 @@ _LT_EOF
 *** used, and then restart.
 
 _LT_EOF
-      elif $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      elif $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -8600,7 +8624,7 @@ _LT_EOF
       ;;
 
     sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)
-      case `$LD -v 2>&1` in
+      case `$LD -v 2>&1 | sed -e 's/\r//g'` in
         *\ [01].* | *\ 2.[0-9].* | *\ 2.1[0-5].*)
 	ld_shlibs=no
 	cat <<_LT_EOF 1>&2
@@ -8619,7 +8643,7 @@ _LT_EOF
 	  # use absolute paths for naming shared libraries, and exclude the
 	  # DT_RUNPATH tag from executables and libraries.  But doing so
 	  # requires that you compile everything twice, which is a pain.
-	  if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+	  if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
 	    archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	    archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
@@ -8638,7 +8662,7 @@ _LT_EOF
       ;;
 
     *)
-      if $LD --help 2>&1 | $GREP ': supported targets:.* elf' > /dev/null; then
+      if $LD --help 2>&1 | sed -e 's/\r//g' | $GREP ': supported targets:.* elf' > /dev/null; then
 	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
 	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
       else
@@ -8682,10 +8706,10 @@ _LT_EOF
 	# -C means demangle to AIX nm, but means don't demangle with GNU nm
 	# Also, AIX nm treats weak defined symbols like other global
 	# defined symbols, whereas GNU nm marks them as "W".
-	if $NM -V 2>&1 | $GREP 'GNU' > /dev/null; then
-	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	if $NM -V 2>&1 | sed -e 's/\r//g' | $GREP 'GNU' > /dev/null; then
+	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "W")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	else
-	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
+	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | $SED '\''s/\r//'\'' | awk '\''{ if (((\$ 2 == "T") || (\$ 2 == "D") || (\$ 2 == "B") || (\$ 2 == "L")) && (substr(\$ 3,1,1) != ".")) { print \$ 3 } }'\'' | sort -u > $export_symbols'
 	fi
 	aix_use_runtimelinking=no
 
@@ -9038,10 +9062,11 @@ else
    save_LDFLAGS="$LDFLAGS"
    LDFLAGS="$LDFLAGS -b"
    echo "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
+   if (eval "($ac_link | sed -e 's/\r//g')" 2>conftest.err) && test -s conftest$ac_exeext; then
      # The linker can only warn and ignore the option if not recognized
      # So say no if there are warnings
      if test -s conftest.err; then
+       dos2unix -q conftest.err
        # Append any errors to the config.log.
        cat conftest.err 1>&5
        $ECHO "$_lt_linker_boilerplate" | $SED '/^$/d' > conftest.exp
@@ -9125,7 +9150,7 @@ rm -f core conftest.err conftest.$ac_objext \
       ;;
 
     netbsd*)
-      if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+      if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
 	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
       else
 	archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
@@ -9151,7 +9176,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	hardcode_direct=yes
 	hardcode_shlibpath_var=no
 	hardcode_direct_absolute=yes
-	if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+	if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	  archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
 	  archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	  hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
@@ -9220,7 +9245,7 @@ rm -f core conftest.err conftest.$ac_objext \
 	archive_expsym_cmds='echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~echo "local: *; };" >> $lib.exp~
 	  $CC -shared ${wl}-z ${wl}text ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$RM $lib.exp'
       else
-	case `$CC -V 2>&1` in
+	case `$CC -V 2>&1 | sed -e 's/\r//g'` in
 	*"Compilers 5.0"*)
 	  wlarc=''
 	  archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
@@ -9413,10 +9438,11 @@ else
 	echo "$lt_simple_compile_test_code" > conftest.$ac_ext
 
 	if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
-  (eval $ac_compile) 2>&5
+  (eval "($ac_compile | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } 2>conftest.err; then
+          dos2unix -q conftest.err
 	  soname=conftest
 	  lib=conftest
 	  libobjs=conftest.$ac_objext
@@ -9442,6 +9468,7 @@ else
 	  fi
 	  allow_undefined_flag=$lt_save_allow_undefined_flag
 	else
+          dos2unix -q conftest.err
 	  cat conftest.err 1>&5
 	fi
 	$RM conftest*
@@ -9624,7 +9651,7 @@ if test "$GCC" = yes; then
     mingw* | cegcc*) lt_sed_strip_eq="s,=\([A-Za-z]:\),\1,g" ;;
     *) lt_sed_strip_eq="s,=/,/,g" ;;
   esac
-  lt_search_path_spec=`$CC -print-search-dirs | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
+  lt_search_path_spec=`$CC -print-search-dirs | sed -e 's/\r//g' | awk $lt_awk_arg | $SED -e "s/^libraries://" -e $lt_sed_strip_eq`
   case $lt_search_path_spec in
   *\;*)
     # if the path contains ";" then we assume it to be the separator
@@ -9728,7 +9755,7 @@ aix[4-9]*)
       aix4 | aix4.[01] | aix4.[01].*)
       if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
 	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | $GREP yes > /dev/null; then
+	   echo '#endif'; } | ${CC} -E - | sed -e 's/\r//g' | $GREP yes > /dev/null; then
 	:
       else
 	can_build_shared=no
@@ -10099,7 +10126,7 @@ netbsd*)
   version_type=sunos
   need_lib_prefix=no
   need_version=no
-  if echo __ELF__ | $CC -E - | $GREP __ELF__ >/dev/null; then
+  if echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__ >/dev/null; then
     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
     finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
     dynamic_linker='NetBSD (a.out) ld.so'
@@ -10144,7 +10171,7 @@ openbsd*)
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+  if test -z "`echo __ELF__ | $CC -E - | sed -e 's/\r//g' | $GREP __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
     case $host_os in
       openbsd2.[89] | openbsd2.[89].*)
 	shlibpath_overrides_runpath=no
@@ -10805,7 +10832,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -10911,7 +10938,7 @@ int main ()
 }
 _LT_EOF
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_link\""; } >&5
-  (eval $ac_link) 2>&5
+  (eval "($ac_link | sed -e 's/\r//g')") 2>&5
   ac_status=$?
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
   test $ac_status = 0; } && test -s conftest${ac_exeext} 2>/dev/null; then
@@ -11498,7 +11525,7 @@ else
   toolexeclibdir='$(libdir)'
 fi
 if test "$GCC" = yes && $CC -print-multi-os-directory > /dev/null 2>&1; then
-  multiosdir=/`$CC -print-multi-os-directory`
+  multiosdir=/`$CC -print-multi-os-directory | sed -e 's/\r//g'`
   case $multiosdir in
     /.) multiosdir= ;; # Avoid trailing /.
   esac
diff --git a/gcc/zlib/configure.ac b/gcc/zlib/configure.ac
index be1cfe2965..4c163a817c 100644
--- a/gcc/zlib/configure.ac
+++ b/gcc/zlib/configure.ac
@@ -103,7 +103,7 @@ else
   toolexeclibdir='$(libdir)'
 fi
 if test "$GCC" = yes && $CC -print-multi-os-directory > /dev/null 2>&1; then
-  multiosdir=/`$CC -print-multi-os-directory`
+  multiosdir=/`$CC -print-multi-os-directory | sed -e 's/\r//g'`
   case $multiosdir in
     /.) multiosdir= ;; # Avoid trailing /.
   esac
diff --git a/hfsutils/Makefile.in b/hfsutils/Makefile.in
index e77f49e733..66baf88dff 100644
--- a/hfsutils/Makefile.in
+++ b/hfsutils/Makefile.in
@@ -62,10 +62,10 @@ LDFLAGS =	$(LDOPTS)
 
 TARGETS =	$(CLITARGETS) $(TCLTARGETS) $(TKTARGETS)
 
-CLITARGETS =	hattrib hcd hcopy hdel hdir hformat hls hmkdir hmount hpwd  \
-		hrename hrmdir humount hvol
-TCLTARGETS =	hfssh hfs
-TKTARGETS =	xhfs
+CLITARGETS =	hattrib.exe hcd.exe hcopy.exe hdel.exe hdir.exe hformat.exe hls.exe hmkdir.exe hmount.exe hpwd.exe  \
+		hrename.exe hrmdir.exe humount.exe hvol.exe
+TCLTARGETS =	hfssh.exe hfs.exe
+TKTARGETS =	xhfs.exe
 
 LIBHFS =	libhfs/libhfs.a
 INCHFS =	libhfs/hfs.h
@@ -111,13 +111,14 @@ check :: all
 install :: @INSTALL_TARGETS@
 
 install_cli :: all_cli
-	$(BININSTALL) $(HFSUTIL) "$(BINDEST)/."
+	mkdir -p "$(BINDEST)"
+	$(BININSTALL) $(HFSUTIL).exe "$(BINDEST)/$(HFSUTIL).exe"
 
 	for file in $(CLITARGETS); do  \
-		$(HARDLINK) "$(BINDEST)/$(HFSUTIL)" "$(BINDEST)/$$file";  \
+		$(HARDLINK) "$(BINDEST)/$(HFSUTIL).exe" "$(BINDEST)/$$file";  \
 	done
 
-	rm -f "$(BINDEST)/$(HFSUTIL)"
+	rm -f "$(BINDEST)/$(HFSUTIL).exe"
 
 	for file in $(GENERALDOCS) $(CLIDOCS); do  \
 		$(LIBINSTALL) $(src)/doc/man/$$file  \
@@ -125,8 +126,9 @@ install_cli :: all_cli
 	done
 
 install_tcl :: all_tcl
+	mkdir -p "$(BINDEST)"
 	for file in $(TCLTARGETS); do  \
-		$(BININSTALL) $$file "$(BINDEST)/.";  \
+		$(BININSTALL) $$file "$(BINDEST)/$$file";  \
 	done
 
 	if [ -f "$(BINDEST)/hfs" ]; then  \
@@ -141,8 +143,9 @@ install_tcl :: all_tcl
 	done
 
 install_tk :: all_tk
+	mkdir -p "$(BINDEST)"
 	for file in $(TKTARGETS); do  \
-		$(BININSTALL) $$file "$(BINDEST)/.";  \
+		$(BININSTALL) $$file "$(BINDEST)/$$file";  \
 	done
 
 	for file in $(TKDOCS); do  \
@@ -173,7 +176,7 @@ clean ::
 	done
 
 	rm -f $(TARGETS) *.o gmon.* core
-	rm -f $(HFSUTIL) xhfs.c
+	rm -f $(HFSUTIL).exe xhfs.c
 
 distclean :: clean
 	for dir in $(ACSUBDIRS); do  \
@@ -232,7 +235,7 @@ $(HFSUTIL): $(LIBHFS) hfsutil.o hcwd.o $(CLIOBJS) $(UTILOBJS) $(LIBOBJS)
 		-lhfs $(LIBS) $(LIBOBJS) -o $@
 
 $(CLITARGETS): $(HFSUTIL)
-	-$(HARDLINK) $(HFSUTIL) $@
+	-$(HARDLINK) $(HFSUTIL).exe $@
 
 hfssh: $(LIBHFS) hfssh.o tclhfs.o $(UTILOBJS) $(LIBOBJS)
 	$(CC) $(LDFLAGS) hfssh.o tclhfs.o $(UTILOBJS)  \
diff --git a/hfsutils/configure b/hfsutils/configure
index e6e752e8dd..64f9a8c165 100755
--- a/hfsutils/configure
+++ b/hfsutils/configure
@@ -711,12 +711,12 @@ cross_compiling=$ac_cv_prog_cc_cross
 cat > conftest.$ac_ext <<EOF
 #line 713 "configure"
 #include "confdefs.h"
-main(){return(0);}
+int main(void){return(0);}
 EOF
-if { (eval echo configure:717: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
+if { (eval echo configure:717: \"$ac_link\") 1>&5; (eval "($ac_link | sed -e 's/\r//g')") 2>&5; } && test -s conftest.exe; then
   ac_cv_prog_cc_works=yes
   # If we can't run a trivial program, we are probably using a cross compiler.
-  if (./conftest; exit) 2>/dev/null; then
+  if (./conftest.exe; exit) 2>/dev/null; then
     ac_cv_prog_cc_cross=no
   else
     ac_cv_prog_cc_cross=yes
@@ -747,7 +747,7 @@ else
   yes;
 #endif
 EOF
-if { ac_try='${CC-cc} -E conftest.c'; { (eval echo configure:751: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }; } | egrep yes >/dev/null 2>&1; then
+if { ac_try='${CC-cc} -E conftest.c'; { (eval echo configure:751: \"$ac_try\") 1>&5; (eval $ac_try | sed -e 's/\r//g') 2>&5; }; } | egrep yes >/dev/null 2>&1; then
   ac_cv_prog_gcc=yes
 else
   ac_cv_prog_gcc=no
@@ -901,7 +901,8 @@ else
 Syntax Error
 EOF
 ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
-{ (eval echo configure:905: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+{ (eval echo configure:905: \"$ac_try\") 1>&5; (eval "($ac_try | sed -e 's/\r//g')") 2>&5; }
+dos2unix -q conftest.out
 ac_err=`grep -v '^ *+' conftest.out`
 if test -z "$ac_err"; then
   :
@@ -918,7 +919,8 @@ else
 Syntax Error
 EOF
 ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
-{ (eval echo configure:922: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+{ (eval echo configure:922: \"$ac_try\") 1>&5; (eval "($ac_try | sed -e 's/\r//g')") 2>&5; }
+dos2unix -q conftest.out
 ac_err=`grep -v '^ *+' conftest.out`
 if test -z "$ac_err"; then
   :
@@ -953,7 +955,7 @@ else
 #include <sgtty.h>
 Autoconf TIOCGETP
 EOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   egrep "$ac_pattern" >/dev/null 2>&1; then
   rm -rf conftest*
   ac_cv_prog_gcc_traditional=yes
@@ -971,7 +973,7 @@ rm -f conftest*
 #include <termio.h>
 Autoconf TCGETA
 EOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   egrep "$ac_pattern" >/dev/null 2>&1; then
   rm -rf conftest*
   ac_cv_prog_gcc_traditional=yes
@@ -1003,7 +1005,8 @@ else
 #include <float.h>
 EOF
 ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
-{ (eval echo configure:1007: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+{ (eval echo configure:1007: \"$ac_try\") 1>&5; (eval "($ac_try | sed -e 's/\r//g')") 2>&5; }
+dos2unix -q conftest.out
 ac_err=`grep -v '^ *+' conftest.out`
 if test -z "$ac_err"; then
   rm -rf conftest*
@@ -1024,7 +1027,7 @@ cat > conftest.$ac_ext <<EOF
 #include "confdefs.h"
 #include <string.h>
 EOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   egrep "memchr" >/dev/null 2>&1; then
   :
 else
@@ -1042,7 +1045,7 @@ cat > conftest.$ac_ext <<EOF
 #include "confdefs.h"
 #include <stdlib.h>
 EOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   egrep "free" >/dev/null 2>&1; then
   :
 else
@@ -1070,7 +1073,7 @@ if (XOR (islower (i), ISLOWER (i)) || toupper (i) != TOUPPER (i)) exit(2);
 exit (0); }
 
 EOF
-if { (eval echo configure:1074: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest && (./conftest; exit) 2>/dev/null
+if { (eval echo configure:1074: \"$ac_link\") 1>&5; (eval "($ac_link | sed -e 's/\r//g')") 2>&5; } && test -s conftest && (./conftest; exit) 2>/dev/null
 then
   :
 else
@@ -1107,7 +1110,8 @@ else
 #include <$ac_hdr>
 EOF
 ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
-{ (eval echo configure:1111: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+{ (eval echo configure:1111: \"$ac_try\") 1>&5; (eval "($ac_try | sed -e 's/\r//g')") 2>&5; }
+dos2unix -q conftest.out
 ac_err=`grep -v '^ *+' conftest.out`
 if test -z "$ac_err"; then
   rm -rf conftest*
@@ -1145,7 +1149,7 @@ else
 #include "confdefs.h"
 #include <sys/types.h>
 EOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   egrep "uid_t" >/dev/null 2>&1; then
   rm -rf conftest*
   ac_cv_type_uid_t=yes
@@ -1183,7 +1187,7 @@ else
 #include <stddef.h>
 #endif
 EOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   egrep "size_t[^a-zA-Z_0-9]" >/dev/null 2>&1; then
   rm -rf conftest*
   ac_cv_type_size_t=yes
@@ -1258,7 +1262,7 @@ ccp = (char const *const *) p;
 
 ; return 0; }
 EOF
-if { (eval echo configure:1262: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:1262: \"$ac_compile\") 1>&5; (eval "($ac_compile | sed -e 's/\r//g')") 2>&5; }; then
   rm -rf conftest*
   ac_cv_c_const=yes
 else
@@ -1311,7 +1315,7 @@ $ac_func();
 
 ; return 0; }
 EOF
-if { (eval echo configure:1315: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
+if { (eval echo configure:1315: \"$ac_link\") 1>&5; (eval "($ac_link | sed -e 's/\r//g')") 2>&5; } && test -s conftest; then
   rm -rf conftest*
   eval "ac_cv_func_$ac_func=yes"
 else
@@ -1368,7 +1372,7 @@ $ac_func();
 
 ; return 0; }
 EOF
-if { (eval echo configure:1372: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
+if { (eval echo configure:1372: \"$ac_link\") 1>&5; (eval "($ac_link | sed -e 's/\r//g')") 2>&5; } && test -s conftest; then
   rm -rf conftest*
   eval "ac_cv_func_$ac_func=yes"
 else
@@ -1412,7 +1416,7 @@ int main() {
     
 ; return 0; }
 EOF
-if { (eval echo configure:1416: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
+if { (eval echo configure:1416: \"$ac_link\") 1>&5; (eval "($ac_link | sed -e 's/\r//g')") 2>&5; } && test -s conftest; then
   rm -rf conftest*
   hfs_cv_decl_syserrlist=yes
 else
diff --git a/hfsutils/copyin.c b/hfsutils/copyin.c
index 061f042e1b..c007245408 100644
--- a/hfsutils/copyin.c
+++ b/hfsutils/copyin.c
@@ -328,7 +328,7 @@ int opensrc(const char *srcname, const char **dsthint, const char *ext,
       srcname = "";
     }
   else
-    fd = open(srcname, O_RDONLY);
+    fd = open(srcname, O_RDONLY | _O_BINARY);
 
   if (fd == -1)
     {
diff --git a/hfsutils/copyout.c b/hfsutils/copyout.c
index e2f6b4ef68..267601f807 100644
--- a/hfsutils/copyout.c
+++ b/hfsutils/copyout.c
@@ -510,7 +510,7 @@ int opendst(const char *dstname, const char *hint)
 	  dstname = path;
 	}
 
-      fd = open(dstname, O_WRONLY | O_CREAT | O_TRUNC, 0666);
+      fd = open(dstname, O_WRONLY | O_CREAT | O_TRUNC | _O_BINARY, 0666);
 
       if (path)
 	free(path);
diff --git a/hfsutils/hcwd.c b/hfsutils/hcwd.c
index 4c9d1810d0..b8686013fc 100644
--- a/hfsutils/hcwd.c
+++ b/hfsutils/hcwd.c
@@ -94,9 +94,9 @@ int hcwd_init(void)
   strcpy(path, home);
   strcat(path, "/" STATEFNAME);
 
-  statef = fopen(path, "r+");
+  statef = fopen(path, "rb+");
   if (statef == 0 && errno == ENOENT)
-    statef = fopen(path, "w+");
+    statef = fopen(path, "wb+");
 
   free(path);
 
diff --git a/hfsutils/libhfs/Makefile.in b/hfsutils/libhfs/Makefile.in
index 6b73164f2d..0e90480618 100644
--- a/hfsutils/libhfs/Makefile.in
+++ b/hfsutils/libhfs/Makefile.in
@@ -72,8 +72,10 @@ check :: all
 	@echo "No self-tests available."
 
 install ::
-	$(LIBINSTALL) libhfs.a "$(LIBDEST)/."
-	$(LIBINSTALL) $(src)/hfs.h "$(INCDEST)/."
+	mkdir -p "$(LIBDEST)"
+	mkdir -p "$(INCDEST)"
+	$(LIBINSTALL) libhfs.a "$(LIBDEST)/libhfs.a"
+	$(LIBINSTALL) $(src)/hfs.h "$(INCDEST)/hfs.h"
 
 again :: clean all
 
diff --git a/hfsutils/libhfs/configure b/hfsutils/libhfs/configure
index 403cc5c7db..bbb94d20b2 100755
--- a/hfsutils/libhfs/configure
+++ b/hfsutils/libhfs/configure
@@ -657,12 +657,12 @@ cross_compiling=$ac_cv_prog_cc_cross
 cat > conftest.$ac_ext <<EOF
 #line 659 "configure"
 #include "confdefs.h"
-main(){return(0);}
+int main(void){return(0);}
 EOF
-if { (eval echo configure:663: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
+if { (eval echo configure:663: \"$ac_link\") 1>&5; (eval "($ac_link | sed -e 's/\r//g')") 2>&5; } && test -s conftest.exe; then
   ac_cv_prog_cc_works=yes
   # If we can't run a trivial program, we are probably using a cross compiler.
-  if (./conftest; exit) 2>/dev/null; then
+  if (./conftest.exe; exit) 2>/dev/null; then
     ac_cv_prog_cc_cross=no
   else
     ac_cv_prog_cc_cross=yes
@@ -693,7 +693,7 @@ else
   yes;
 #endif
 EOF
-if { ac_try='${CC-cc} -E conftest.c'; { (eval echo configure:697: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }; } | egrep yes >/dev/null 2>&1; then
+if { ac_try='${CC-cc} -E conftest.c'; { (eval echo configure:697: \"$ac_try\") 1>&5; (eval $ac_try | sed -e 's/\r//g') 2>&5; }; } | egrep yes >/dev/null 2>&1; then
   ac_cv_prog_gcc=yes
 else
   ac_cv_prog_gcc=no
@@ -887,7 +887,8 @@ else
 Syntax Error
 EOF
 ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
-{ (eval echo configure:891: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+{ (eval echo configure:891: \"$ac_try\") 1>&5; (eval "($ac_try | sed -e 's/\r//g')") 2>&5; }
+dos2unix -q conftest.out
 ac_err=`grep -v '^ *+' conftest.out`
 if test -z "$ac_err"; then
   :
@@ -904,7 +905,8 @@ else
 Syntax Error
 EOF
 ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
-{ (eval echo configure:908: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+{ (eval echo configure:908: \"$ac_try\") 1>&5; (eval "($ac_try | sed -e 's/\r//g')") 2>&5; }
+dos2unix -q conftest.out
 ac_err=`grep -v '^ *+' conftest.out`
 if test -z "$ac_err"; then
   :
@@ -939,7 +941,7 @@ else
 #include <sgtty.h>
 Autoconf TIOCGETP
 EOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   egrep "$ac_pattern" >/dev/null 2>&1; then
   rm -rf conftest*
   ac_cv_prog_gcc_traditional=yes
@@ -957,7 +959,7 @@ rm -f conftest*
 #include <termio.h>
 Autoconf TCGETA
 EOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   egrep "$ac_pattern" >/dev/null 2>&1; then
   rm -rf conftest*
   ac_cv_prog_gcc_traditional=yes
@@ -989,7 +991,8 @@ else
 #include <float.h>
 EOF
 ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
-{ (eval echo configure:993: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+{ (eval echo configure:993: \"$ac_try\") 1>&5; (eval "($ac_try | sed -e 's/\r//g')") 2>&5; }
+dos2unix -q conftest.out
 ac_err=`grep -v '^ *+' conftest.out`
 if test -z "$ac_err"; then
   rm -rf conftest*
@@ -1010,7 +1013,7 @@ cat > conftest.$ac_ext <<EOF
 #include "confdefs.h"
 #include <string.h>
 EOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   egrep "memchr" >/dev/null 2>&1; then
   :
 else
@@ -1028,7 +1031,7 @@ cat > conftest.$ac_ext <<EOF
 #include "confdefs.h"
 #include <stdlib.h>
 EOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   egrep "free" >/dev/null 2>&1; then
   :
 else
@@ -1056,7 +1059,7 @@ if (XOR (islower (i), ISLOWER (i)) || toupper (i) != TOUPPER (i)) exit(2);
 exit (0); }
 
 EOF
-if { (eval echo configure:1060: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest && (./conftest; exit) 2>/dev/null
+if { (eval echo configure:1060: \"$ac_link\") 1>&5; (eval "($ac_link | sed -e 's/\r//g')") 2>&5; } && test -s conftest && (./conftest; exit) 2>/dev/null
 then
   :
 else
@@ -1093,7 +1096,8 @@ else
 #include <$ac_hdr>
 EOF
 ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
-{ (eval echo configure:1097: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+{ (eval echo configure:1097: \"$ac_try\") 1>&5; (eval "($ac_try | sed -e 's/\r//g')") 2>&5; }
+dos2unix -q conftest.out
 ac_err=`grep -v '^ *+' conftest.out`
 if test -z "$ac_err"; then
   rm -rf conftest*
@@ -1135,7 +1139,7 @@ else
 #include <stddef.h>
 #endif
 EOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   egrep "size_t[^a-zA-Z_0-9]" >/dev/null 2>&1; then
   rm -rf conftest*
   ac_cv_type_size_t=yes
@@ -1168,7 +1172,7 @@ int main() {
 struct tm *tp; tp->tm_sec;
 ; return 0; }
 EOF
-if { (eval echo configure:1172: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:1172: \"$ac_compile\") 1>&5; (eval "($ac_compile | sed -e 's/\r//g')") 2>&5; }; then
   rm -rf conftest*
   ac_cv_struct_tm=time.h
 else
@@ -1244,7 +1248,7 @@ ccp = (char const *const *) p;
 
 ; return 0; }
 EOF
-if { (eval echo configure:1248: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:1248: \"$ac_compile\") 1>&5; (eval "($ac_compile | sed -e 's/\r//g')") 2>&5; }; then
   rm -rf conftest*
   ac_cv_c_const=yes
 else
@@ -1278,14 +1282,14 @@ else
 #line 1279 "configure"
 #include "confdefs.h"
 
-main()
+int main(void)
 {
   char c0 = 0x40, c1 = 0x80, c2 = 0x81;
   exit(memcmp(&c0, &c2, 1) < 0 && memcmp(&c1, &c2, 1) < 0 ? 0 : 1);
 }
 
 EOF
-if { (eval echo configure:1289: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest && (./conftest; exit) 2>/dev/null
+if { (eval echo configure:1289: \"$ac_link\") 1>&5; (eval "($ac_link | sed -e 's/\r//g')") 2>&5; } && test -s conftest.exe && (./conftest.exe; exit) 2>/dev/null
 then
   ac_cv_func_memcmp_clean=yes
 else
@@ -1333,7 +1337,7 @@ $ac_func();
 
 ; return 0; }
 EOF
-if { (eval echo configure:1337: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
+if { (eval echo configure:1337: \"$ac_link\") 1>&5; (eval "($ac_link | sed -e 's/\r//g')") 2>&5; } && test -s conftest; then
   rm -rf conftest*
   eval "ac_cv_func_$ac_func=yes"
 else
diff --git a/hfsutils/libhfs/os.c b/hfsutils/libhfs/os.c
index 736243d333..929c36f659 100644
--- a/hfsutils/libhfs/os.c
+++ b/hfsutils/libhfs/os.c
@@ -23,6 +23,17 @@
 #  include "config.h"
 # endif
 
+#if (defined _WIN32 || defined __WIN32__) && ! defined __CYGWIN__
+/* LockFileEx */
+# define WIN32_LEAN_AND_MEAN
+# include <windows.h>
+
+//# include <errno.h>
+
+/* _get_osfhandle */
+//# include "msvc-nothrow.h"
+# endif
+
 # ifdef HAVE_FCNTL_H
 #  include <fcntl.h>
 # else
@@ -54,7 +65,10 @@ int fstat(int, struct stat *);
 int os_open(void **priv, const char *path, int mode)
 {
   int fd;
+#if (defined _WIN32 || defined __WIN32__) && ! defined __CYGWIN__
+# else
   struct flock lock;
+# endif
 
   switch (mode)
     {
@@ -67,6 +81,7 @@ int os_open(void **priv, const char *path, int mode)
       mode = O_RDWR;
       break;
     }
+    mode |=  _O_BINARY;
 
   fd = open(path, mode);
   if (fd == -1)
@@ -74,6 +89,27 @@ int os_open(void **priv, const char *path, int mode)
 
   /* lock descriptor against concurrent access */
 
+#if (defined _WIN32 || defined __WIN32__) && ! defined __CYGWIN__
+  HANDLE h = (HANDLE) _get_osfhandle (fd);
+  BOOL res;
+  DWORD size_lower, size_upper;
+  OVERLAPPED ovlp;
+  int flags = 0;
+
+  if(h == 0)
+    ERROR(errno, "error opening medium");
+
+  /* We're going to lock the whole file, so get the file size. */
+  size_lower = GetFileSize (h, &size_upper);
+
+  /* Start offset is 0, and also zero the remaining members of this struct. */
+  memset (&ovlp, 0, sizeof ovlp);
+
+  flags = (mode == O_RDONLY) ? 0 : LOCKFILE_EXCLUSIVE_LOCK;
+
+  if(LockFileEx (h, flags, 0, size_lower, size_upper, &ovlp) == 0)
+    ERROR(EAGAIN, "unable to obtain lock for medium");
+# else
   lock.l_type   = (mode == O_RDONLY) ? F_RDLCK : F_WRLCK;
   lock.l_start  = 0;
   lock.l_whence = SEEK_SET;
@@ -82,6 +118,7 @@ int os_open(void **priv, const char *path, int mode)
   if (fcntl(fd, F_SETLK, &lock) == -1 &&
       (errno == EACCES || errno == EAGAIN))
     ERROR(EAGAIN, "unable to obtain lock for medium");
+# endif
 
   *priv = (void *) fd;
 
diff --git a/hfsutils/librsrc/Makefile.in b/hfsutils/librsrc/Makefile.in
index d62edd2448..82e5cd2990 100644
--- a/hfsutils/librsrc/Makefile.in
+++ b/hfsutils/librsrc/Makefile.in
@@ -68,8 +68,10 @@ check :: all
 	@echo "No self-tests available."
 
 install ::
-	$(LIBINSTALL) librsrc.a "$(LIBDEST)/."
-	$(LIBINSTALL) $(src)/rsrc.h "$(INCDEST)/."
+	mkdir -p "$(LIBDEST)"
+	mkdir -p "$(INCDEST)"
+	$(LIBINSTALL) librsrc.a "$(LIBDEST)/librsrc.a"
+	$(LIBINSTALL) $(src)/rsrc.h "$(INCDEST)/rsrc.h"
 
 again :: clean all
 
diff --git a/hfsutils/librsrc/configure b/hfsutils/librsrc/configure
index 302f1661ce..ec4b9b41fb 100755
--- a/hfsutils/librsrc/configure
+++ b/hfsutils/librsrc/configure
@@ -657,12 +657,12 @@ cross_compiling=$ac_cv_prog_cc_cross
 cat > conftest.$ac_ext <<EOF
 #line 659 "configure"
 #include "confdefs.h"
-main(){return(0);}
+int main(void){return(0);}
 EOF
-if { (eval echo configure:663: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
+if { (eval echo configure:663: \"$ac_link\") 1>&5; (eval "($ac_link | sed -e 's/\r//g')") 2>&5; } && test -s conftest.exe; then
   ac_cv_prog_cc_works=yes
   # If we can't run a trivial program, we are probably using a cross compiler.
-  if (./conftest; exit) 2>/dev/null; then
+  if (./conftest.exe; exit) 2>/dev/null; then
     ac_cv_prog_cc_cross=no
   else
     ac_cv_prog_cc_cross=yes
@@ -693,7 +693,7 @@ else
   yes;
 #endif
 EOF
-if { ac_try='${CC-cc} -E conftest.c'; { (eval echo configure:697: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }; } | egrep yes >/dev/null 2>&1; then
+if { ac_try='${CC-cc} -E conftest.c'; { (eval echo configure:697: \"$ac_try\") 1>&5; (eval $ac_try | sed -e 's/\r//g') 2>&5; }; } | egrep yes >/dev/null 2>&1; then
   ac_cv_prog_gcc=yes
 else
   ac_cv_prog_gcc=no
@@ -866,7 +866,8 @@ else
 Syntax Error
 EOF
 ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
-{ (eval echo configure:870: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+{ (eval echo configure:870: \"$ac_try\") 1>&5; (eval "($ac_try | sed -e 's/\r//g')") 2>&5; }
+dos2unix -q conftest.out
 ac_err=`grep -v '^ *+' conftest.out`
 if test -z "$ac_err"; then
   :
@@ -883,7 +884,8 @@ else
 Syntax Error
 EOF
 ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
-{ (eval echo configure:887: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+{ (eval echo configure:887: \"$ac_try\") 1>&5; (eval "($ac_try | sed -e 's/\r//g')") 2>&5; }
+dos2unix -q conftest.out
 ac_err=`grep -v '^ *+' conftest.out`
 if test -z "$ac_err"; then
   :
@@ -918,7 +920,7 @@ else
 #include <sgtty.h>
 Autoconf TIOCGETP
 EOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   egrep "$ac_pattern" >/dev/null 2>&1; then
   rm -rf conftest*
   ac_cv_prog_gcc_traditional=yes
@@ -936,7 +938,7 @@ rm -f conftest*
 #include <termio.h>
 Autoconf TCGETA
 EOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   egrep "$ac_pattern" >/dev/null 2>&1; then
   rm -rf conftest*
   ac_cv_prog_gcc_traditional=yes
@@ -968,7 +970,8 @@ else
 #include <float.h>
 EOF
 ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
-{ (eval echo configure:972: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+{ (eval echo configure:972: \"$ac_try\") 1>&5; (eval "($ac_try | sed -e 's/\r//g')") 2>&5; }
+dos2unix -q conftest.out
 ac_err=`grep -v '^ *+' conftest.out`
 if test -z "$ac_err"; then
   rm -rf conftest*
@@ -989,7 +992,7 @@ cat > conftest.$ac_ext <<EOF
 #include "confdefs.h"
 #include <string.h>
 EOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   egrep "memchr" >/dev/null 2>&1; then
   :
 else
@@ -1007,7 +1010,7 @@ cat > conftest.$ac_ext <<EOF
 #include "confdefs.h"
 #include <stdlib.h>
 EOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   egrep "free" >/dev/null 2>&1; then
   :
 else
@@ -1035,7 +1038,7 @@ if (XOR (islower (i), ISLOWER (i)) || toupper (i) != TOUPPER (i)) exit(2);
 exit (0); }
 
 EOF
-if { (eval echo configure:1039: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest && (./conftest; exit) 2>/dev/null
+if { (eval echo configure:1039: \"$ac_link\") 1>&5; (eval "($ac_link | sed -e 's/\r//g')") 2>&5; } && test -s conftest && (./conftest; exit) 2>/dev/null
 then
   :
 else
@@ -1072,7 +1075,8 @@ else
 #include <$ac_hdr>
 EOF
 ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
-{ (eval echo configure:1076: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+{ (eval echo configure:1076: \"$ac_try\") 1>&5; (eval "($ac_try | sed -e 's/\r//g')") 2>&5; }
+dos2unix -q conftest.out
 ac_err=`grep -v '^ *+' conftest.out`
 if test -z "$ac_err"; then
   rm -rf conftest*
@@ -1114,7 +1118,7 @@ else
 #include <stddef.h>
 #endif
 EOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+if (eval "($ac_cpp conftest.$ac_ext | sed -e 's/\r//g')") 2>&5 |
   egrep "size_t[^a-zA-Z_0-9]" >/dev/null 2>&1; then
   rm -rf conftest*
   ac_cv_type_size_t=yes
@@ -1147,7 +1151,7 @@ int main() {
 struct tm *tp; tp->tm_sec;
 ; return 0; }
 EOF
-if { (eval echo configure:1151: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:1151: \"$ac_compile\") 1>&5; (eval "($ac_compile | sed -e 's/\r//g')") 2>&5; }; then
   rm -rf conftest*
   ac_cv_struct_tm=time.h
 else
@@ -1223,7 +1227,7 @@ ccp = (char const *const *) p;
 
 ; return 0; }
 EOF
-if { (eval echo configure:1227: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:1227: \"$ac_compile\") 1>&5; (eval "($ac_compile | sed -e 's/\r//g')") 2>&5; }; then
   rm -rf conftest*
   ac_cv_c_const=yes
 else
@@ -1277,7 +1281,7 @@ $ac_func();
 
 ; return 0; }
 EOF
-if { (eval echo configure:1281: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then
+if { (eval echo configure:1281: \"$ac_link\") 1>&5; (eval "($ac_link | sed -e 's/\r//g')") 2>&5; } && test -s conftest; then
   rm -rf conftest*
   eval "ac_cv_func_$ac_func=yes"
 else
diff --git a/hfsutils/librsrc/main.c b/hfsutils/librsrc/main.c
index 55cb2e8245..19e2842ff8 100644
--- a/hfsutils/librsrc/main.c
+++ b/hfsutils/librsrc/main.c
@@ -80,7 +80,7 @@ int main(int argc, char *argv[])
 		     len == 1 ? "" : "s");
 	      fflush(stdout);
 
-	      hex = popen("hex", "w");
+	      hex = popen("hex", "wb");
 	      if (hex == 0)
 		die("error forking `hex'");
 
diff --git a/hfsutils/suid.c b/hfsutils/suid.c
index be21ee2e2c..b3e7778a6d 100644
--- a/hfsutils/suid.c
+++ b/hfsutils/suid.c
@@ -25,6 +25,8 @@
 
 # include <sys/types.h>
 
+#if (defined _WIN32 || defined __WIN32__) && ! defined __CYGWIN__
+#else
 # ifdef HAVE_UNISTD_H
 #  include <unistd.h>
 # else
@@ -40,6 +42,7 @@ int setuid(uid_t);
 int setgid(gid_t);
 #  endif
 # endif
+#endif
 
 # include "suid.h"
 
@@ -52,11 +55,14 @@ static gid_t gid, egid;
  */
 void suid_init(void)
 {
+#if (defined _WIN32 || defined __WIN32__) && ! defined __CYGWIN__
+#else
   uid  = getuid();
   gid  = getgid();
 
   euid = geteuid();
   egid = getegid();
+#endif
 
   suid_disable();
 }
@@ -67,6 +73,8 @@ void suid_init(void)
  */
 void suid_enable(void)
 {
+#if (defined _WIN32 || defined __WIN32__) && ! defined __CYGWIN__
+#else
 # ifdef HAVE_SETREUID
 
   setreuid(-1, euid);
@@ -78,6 +86,7 @@ void suid_enable(void)
   setgid(egid);
 
 # endif
+#endif
 }
 
 /*
@@ -86,6 +95,8 @@ void suid_enable(void)
  */
 void suid_disable(void)
 {
+#if (defined _WIN32 || defined __WIN32__) && ! defined __CYGWIN__
+#else
 # ifdef HAVE_SETREUID
 
   setreuid(-1, uid);
@@ -97,4 +108,5 @@ void suid_disable(void)
   setgid(gid);
 
 # endif
+#endif
 }
diff --git a/interfaces-and-libraries.sh b/interfaces-and-libraries.sh
index 109d469163..0613d5a17d 100755
--- a/interfaces-and-libraries.sh
+++ b/interfaces-and-libraries.sh
@@ -58,8 +58,8 @@ function explainInterfaces()
     echo "  - a directory with C header files (usually \"CIncludes\")"
     echo "  - a directory with Rez header files (usually \"RIncludes\")"
     echo "  - (for 68K) a directory containing Interface.o (usually \"Libraries\")"
-    echo "  - (for PPC) a directory containing InterfaceLib (usually \"SharedLibraries\")"
-    echo "  - (for Carbon) Carbon.h and CarbonLib, in the same directories"
+    echo "  - (for PPC) a directory containing InterfaceLib.bin or InterfaceLib (usually \"SharedLibraries\")"
+    echo "  - (for Carbon) Carbon.h and CarbonLib.bin or CarbonLib, in the same directories"
     echo
     echo "Especially on non-macOS platforms, make sure that the Mac resource fork of the"
     echo "PowerPC library files is included in a format recognized by Retro68."
@@ -125,9 +125,11 @@ function locateAndCheckInterfacesAndLibraries()
 
         if locateInterfaceThing INTERFACELIB InterfaceLib; then
             SHAREDLIBRARIES=`dirname "$INTERFACELIB"`
+        elif locateInterfaceThing INTERFACELIB InterfaceLib.bin; then
+            SHAREDLIBRARIES=`dirname "$INTERFACELIB"`
         else
             SHAREDLIBRARIES=""
-            echo "Could not find InterfaceLib, using included import libraries."
+            echo "Could not find InterfaceLib or InterfaceLib.bin, using included import libraries."
         fi
 
         if locateInterfaceThing OPENTRANSPORTAPPPPC OpenTransportAppPPC.o; then
@@ -164,6 +166,15 @@ function locateAndCheckInterfacesAndLibraries()
                 explainInterfaces
                 return
             fi
+        elif locateInterfaceThing CARBONLIB CarbonLib.bin; then
+            carbondir=`dirname "$CARBONLIB"`
+            if [ "$carbondir" != "$SHAREDLIBRARIES" ]; then
+                echo "CarbonLib.bin found, but not in the same directory as InterfaceLib."
+                echo "This is confusing."
+                echo
+                explainInterfaces
+                return
+            fi
         else
             echo "Could not find CarbonLib anywhere inside $INTERFACES_DIR"
             echo "(This file is required for Carbon support only)"
@@ -255,9 +266,9 @@ function setup68KLibraries()
 
             rm -f $lib
 
-            if ConvertObj "$macobj" > "$asm"; then
-                m68k-apple-macos-as "$asm" -o "$obj"
-                m68k-apple-macos-ar cqs "$lib" "$obj"
+            if ConvertObj.exe "$macobj" > "$asm"; then
+                m68k-apple-macos-as.exe "$asm" -o "$obj"
+                m68k-apple-macos-ar.exe cqs "$lib" "$obj"
             fi
             rm -f "$asm"
         fi
@@ -268,7 +279,7 @@ function setupPPCLibraries()
 {
     DEST=${1:-"$PREFIX/universal"}
     mkdir -p "$DEST/libppc"
-    case `ResInfo -n "$INTERFACELIB" 2> /dev/null || echo 0` in
+    case `ResInfo.exe -n "$INTERFACELIB" 2> /dev/null || echo 0` in
         0)
             if [ -n "$INTERFACELIB" ]; then
                 echo "WARNING: Couldn't read resource fork for \"$INTERFACELIB\"."
@@ -283,7 +294,7 @@ function setupPPCLibraries()
                 libname=`basename "$shlib"`
                 implib=lib${libname%.bin}.a
                 printf "    %30s => %-30s\n" ${libname} ${implib}
-                MakeImport "$shlib" "$DEST/libppc/$implib" || true
+                MakeImport.exe "$shlib" "$DEST/libppc/$implib" || true
             done
             ;;
     esac
@@ -298,7 +309,7 @@ function setupPPCLibraries()
                 # and wrap it in a .a archive for convenience
                 lib="$DEST"/libppc/lib$basename.a
                 rm -f "$lib"
-                powerpc-apple-macos-ar cqs "$lib" "$obj"
+                powerpc-apple-macos-ar.exe cqs "$lib" "$obj"
             fi
         done
     fi
diff --git a/libelf/CMakeLists.txt b/libelf/CMakeLists.txt
index 50f8bea30f..8de0fcff5c 100644
--- a/libelf/CMakeLists.txt
+++ b/libelf/CMakeLists.txt
@@ -1,7 +1,9 @@
-file(GLOB ELF_FILES src/*.c src/*.h include/*.h)
+file(GLOB ELF_FILES src/*.cpp src/*.c src/*.h include/*.h)
+file(GLOB SPECIAL_ELF_FILES src/fchmod.cpp)
 add_library(ELF ${ELF_FILES}
 	)
 target_include_directories(ELF PRIVATE src)
 target_include_directories(ELF PUBLIC include)
 target_link_libraries(ELF -lz)
 target_compile_definitions(ELF PRIVATE HAVE_CONFIG_H)
+set_property(SOURCE ${SPECIAL_ELF_FILES} PROPERTY COMPILE_FLAGS -mgeneral-regs-only)
diff --git a/libelf/include/libelf.h b/libelf/include/libelf.h
index 547c0f5081..f6ce04b007 100644
--- a/libelf/include/libelf.h
+++ b/libelf/include/libelf.h
@@ -187,6 +187,11 @@ typedef enum
   ELF_K_NUM
 } Elf_Kind;
 
+#ifndef __uid_t_defined
+#define __uid_t_defined 1
+#define uid_t int
+#endif
+#define gid_t int
 
 /* Archive member header.  */
 typedef struct
diff --git a/libelf/src/common.h b/libelf/src/common.h
index 85a7c1f9d1..df756e7788 100644
--- a/libelf/src/common.h
+++ b/libelf/src/common.h
@@ -30,7 +30,31 @@
 #ifndef _COMMON_H
 #define _COMMON_H       1
 
-#include <ar.h>
+//#include <ar.h>
+#ifndef INCLUDED_AR_H
+#define INCLUDED_AR_H
+#define ARMAG  "!<arch>\n"
+#define SARMAG  8
+
+#define ARFMAG  "`\n"
+
+#pragma pack(push,1)
+struct __attribute__((packed, aligned(1))) ar_hdr
+{
+    char ar_name[ 16 ];
+    char ar_date[ 12 ];
+    char ar_uid[ 6 ];
+    char ar_gid[ 6 ];
+    char ar_mode[ 8 ];
+    char ar_size[ 10 ];
+    char ar_fmag[ 2 ];
+};
+#pragma pack(pop)
+
+#define SARFMAG  2
+#define SARHDR  sizeof( struct ar_hdr )
+#endif
+
 #include <stdlib.h>
 #include <string.h>
 #include "portable_endian.h"
diff --git a/libelf/src/elf32_updatefile.c b/libelf/src/elf32_updatefile.c
index 7ac9951056..88514be516 100644
--- a/libelf/src/elf32_updatefile.c
+++ b/libelf/src/elf32_updatefile.c
@@ -38,7 +38,9 @@
 #include <stdlib.h>
 #include <string.h>
 #include <unistd.h>
-#include <sys/mman.h>
+//#include <sys/mman.h>
+#include "mman.h"
+#include "sysconf.h"
 
 #include <system.h>
 #include "libelfP.h"
diff --git a/libelf/src/elf_begin.c b/libelf/src/elf_begin.c
index 6f85038252..7c187d9170 100644
--- a/libelf/src/elf_begin.c
+++ b/libelf/src/elf_begin.c
@@ -39,7 +39,9 @@
 #include <stddef.h>
 #include <string.h>
 #include <unistd.h>
-#include <sys/mman.h>
+//#include <sys/mman.h>
+#include "mman.h"
+#include "fcntl.h"
 #include <sys/stat.h>
 
 #include <system.h>
diff --git a/libelf/src/elf_end.c b/libelf/src/elf_end.c
index 160f0b885b..618a3f3f43 100644
--- a/libelf/src/elf_end.c
+++ b/libelf/src/elf_end.c
@@ -34,7 +34,8 @@
 #include <assert.h>
 #include <stddef.h>
 #include <stdlib.h>
-#include <sys/mman.h>
+//#include <sys/mman.h>
+#include "mman.h"
 
 #include "libelfP.h"
 
diff --git a/libelf/src/elf_update.c b/libelf/src/elf_update.c
index 89ee0a0f63..577f8b20a6 100644
--- a/libelf/src/elf_update.c
+++ b/libelf/src/elf_update.c
@@ -34,7 +34,10 @@
 #include <libelf.h>
 #include <fcntl.h>
 #include <unistd.h>
-#include <sys/mman.h>
+//#include <sys/mman.h>
+#include "mman.h"
+#include "fchmod.h"
+#include "fallocate.h"
 #include <sys/stat.h>
 
 #include "libelfP.h"
diff --git a/libelf/src/libelfP.h b/libelf/src/libelfP.h
index 66f6b9ea9a..28e3313288 100644
--- a/libelf/src/libelfP.h
+++ b/libelf/src/libelfP.h
@@ -30,7 +30,32 @@
 #ifndef _LIBELFP_H
 #define _LIBELFP_H 1
 
-#include <ar.h>
+//#include <ar.h>
+
+#ifndef INCLUDED_AR_H
+#define INCLUDED_AR_H
+#define ARMAG  "!<arch>\n"
+#define SARMAG  8
+
+#define ARFMAG  "`\n"
+
+#pragma pack(push,1)
+struct __attribute__((packed, aligned(1))) ar_hdr
+{
+    char ar_name[ 16 ];
+    char ar_date[ 12 ];
+    char ar_uid[ 6 ];
+    char ar_gid[ 6 ];
+    char ar_mode[ 8 ];
+    char ar_size[ 10 ];
+    char ar_fmag[ 2 ];
+};
+#pragma pack(pop)
+
+#define SARFMAG  2
+#define SARHDR  sizeof( struct ar_hdr )
+#endif
+
 #include <gelf.h>
 
 #include <errno.h>
diff --git a/libelf/src/nlist.c b/libelf/src/nlist.c
index c7b32fdbe1..00bee95421 100644
--- a/libelf/src/nlist.c
+++ b/libelf/src/nlist.c
@@ -37,8 +37,17 @@
 #include <nlist.h>
 #include <unistd.h>
 
+#include <sys/stat.h>
+
 #include "libelfP.h"
 
+#define _O_RDONLY      0
+#define _O_WRONLY      1
+#define _O_RDWR        2
+
+#define O_RDONLY _O_RDONLY
+#define O_WRONLY _O_WRONLY
+#define O_RDWR _O_RDWR
 
 struct hashentry
 {
@@ -71,7 +80,7 @@ nlist (const char *filename, struct nlist *nl)
   size_t cnt;
 
   /* Open the file.  */
-  fd = open (filename, O_RDONLY);
+  fd = open (filename, _O_RDONLY | _O_BINARY);
   if (fd == -1)
     {
       __libelf_seterrno (ELF_E_NOFILE);
diff --git a/libelf/src/portable_endian.h b/libelf/src/portable_endian.h
index 55f8cc2525..c58a8d8331 100644
--- a/libelf/src/portable_endian.h
+++ b/libelf/src/portable_endian.h
@@ -80,6 +80,33 @@
 #		define be64toh(x) ntohll(x)
 #		define le64toh(x) (x)
 
+static long long unsigned int ntohll(long long unsigned int x)
+{
+	return ((unsigned long long)(((unsigned char *)(&x))[7]) << 0LL)
+	     | ((unsigned long long)(((unsigned char *)(&x))[6]) << 8LL)
+	     | ((unsigned long long)(((unsigned char *)(&x))[5]) << 16LL)
+	     | ((unsigned long long)(((unsigned char *)(&x))[4]) << 24LL)
+	     | ((unsigned long long)(((unsigned char *)(&x))[3]) << 32LL)
+	     | ((unsigned long long)(((unsigned char *)(&x))[2]) << 40LL)
+	     | ((unsigned long long)(((unsigned char *)(&x))[1]) << 48LL)
+	     | ((unsigned long long)(((unsigned char *)(&x))[0]) << 56LL);
+}
+
+static long long unsigned int htonll(long long unsigned int x)
+{
+	unsigned char data[8] = {};
+	data[0] = (x & 0xFF00000000000000LL) >> 56LL;
+	data[1] = (x & 0x00FF000000000000LL) >> 48LL;
+	data[2] = (x & 0x0000FF0000000000LL) >> 40LL;
+	data[3] = (x & 0x000000FF00000000LL) >> 32LL;
+	data[4] = (x & 0x00000000FF000000LL) >> 24LL;
+	data[5] = (x & 0x0000000000FF0000LL) >> 16LL;
+	data[6] = (x & 0x000000000000FF00LL) >> 8LL;
+	data[7] = (x & 0x00000000000000FFLL) >> 0LL;
+
+	return *(long long unsigned int *)(data);
+}
+
 #	elif BYTE_ORDER == BIG_ENDIAN
 
 		/* that would be xbox 360 */
@@ -97,6 +124,8 @@
 #		define htole64(x) __builtin_bswap64(x)
 #		define be64toh(x) (x)
 #		define le64toh(x) __builtin_bswap64(x)
+#		define htonll(x) (x)
+#		define ntohll(x) __builtin_bswap64(x)
 
 #	else
 
diff --git a/libelf/src/system.h b/libelf/src/system.h
index ebf34799a1..8fa7f27a5c 100644
--- a/libelf/src/system.h
+++ b/libelf/src/system.h
@@ -42,6 +42,10 @@
 # define BE32(n)	be32toh (n)
 # define BE64(n)	be64toh (n)
 
+#ifndef powerof2
+#define powerof2(x)     ((((x) - 1) & (x)) == 0)
+#endif
+
 #ifndef MAX
 #define MAX(m, n) ((m) < (n) ? (n) : (m))
 #endif
@@ -71,6 +75,40 @@
      __res; })
 #endif
 
+static inline ssize_t
+pwrite (int fd, const void *buf, size_t len, off_t off)
+{
+  long long filePos = _lseeki64 (fd, 0, SEEK_CUR);
+  long long newFilePos = _lseeki64 (fd, off, SEEK_SET);
+  int writeResult = -1;
+  if(newFilePos == -1L)
+  {
+         return -1L;
+  }
+
+  writeResult = _write(fd, buf, len);
+  _lseeki64 (fd, filePos, SEEK_SET);
+
+  return writeResult;
+}
+
+static inline ssize_t
+pread (int fd, void *buf, size_t len, off_t off)
+{
+  long long filePos = _lseeki64 (fd, 0, SEEK_CUR);
+  long long newFilePos = _lseeki64 (fd, off, SEEK_SET);
+  int readResult = -1;
+  if(newFilePos == -1L)
+  {
+         return -1L;
+  }
+
+  readResult = _read(fd, buf, len);
+  _lseeki64 (fd, filePos, SEEK_SET);
+
+  return readResult;
+}
+
 static inline ssize_t __attribute__ ((unused))
 pwrite_retry (int fd, const void *buf, size_t len, off_t off)
 {
@@ -138,4 +176,8 @@ extern char *__cxa_demangle (const char *mangled_name, char *output_buffer,
   extern int never_defined_just_used_for_checking[(expr) ? 1 : -1]	\
     __attribute__ ((unused))
 
+#define S_ISUID 0004000
+#define S_ISGID 0002000
+#define S_ISVTX 0001000
+
 #endif /* system.h */
